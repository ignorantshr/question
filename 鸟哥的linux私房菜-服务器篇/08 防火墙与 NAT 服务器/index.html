



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content="ignorantshr">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.4.3">
    
    
      
        <title>08 防火墙与 NAT 服务器 - Person Sink</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#1" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Person Sink" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Person Sink
            </span>
            <span class="md-header-nav__topic">
              
                08 防火墙与 NAT 服务器
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ignorantshr/question/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Person Sink" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Person Sink
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ignorantshr/question/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Linux
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/epel%E6%BA%90/" title="Epel源" class="md-nav__link">
      Epel源
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E4%B8%BB%E6%9C%BA%E4%B8%8D%E8%83%BD%E8%BF%9E%E6%8E%A5mariadb/" title="主机不能连接mariadb" class="md-nav__link">
      主机不能连接mariadb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E4%BF%AE%E6%94%B9centos7%E8%AF%AD%E8%A8%80/" title="修改centos7语言" class="md-nav__link">
      修改centos7语言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E4%BF%AE%E6%94%B9mariadb%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/" title="修改mariadb编码类型" class="md-nav__link">
      修改mariadb编码类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E5%85%B3%E9%97%ADselinux/" title="关闭selinux" class="md-nav__link">
      关闭selinux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E5%BC%80%E5%90%AF%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2/" title="开启图形界面" class="md-nav__link">
      开启图形界面
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E6%96%87%E6%9C%AC%E5%AE%89%E8%A3%85%E6%97%B6%E7%A3%81%E7%9B%98%E5%8F%AF%E9%80%89/" title="文本安装时磁盘可选" class="md-nav__link">
      文本安装时磁盘可选
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E6%94%B9%E5%8F%98%E7%B3%BB%E7%BB%9F%E6%97%B6%E5%8C%BA/" title="改变系统时区" class="md-nav__link">
      改变系统时区
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E7%A3%81%E7%9B%98%E5%AE%B9%E9%87%8F%E6%89%A9%E5%85%85/" title="磁盘容量扩充" class="md-nav__link">
      磁盘容量扩充
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E7%BD%91%E5%8D%A1%E4%B8%8D%E5%AD%98%E5%9C%A8/" title="网卡不存在" class="md-nav__link">
      网卡不存在
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E5%88%A0%E9%99%A4%E7%BD%91%E6%A1%A5/" title="删除网桥" class="md-nav__link">
      删除网桥
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/Linux%E9%80%BB%E8%BE%91%E5%8D%B7%E5%88%92%E5%88%86%E7%A4%BA%E6%84%8F%E5%9B%BE/" title="Linux逻辑卷划分示意图" class="md-nav__link">
      Linux逻辑卷划分示意图
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E8%BD%AF%E9%93%BE%E6%8E%A5%E4%B8%8E%E7%A1%AC%E9%93%BE%E6%8E%A5/" title="软链接与硬链接" class="md-nav__link">
      软链接与硬链接
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/Linux%E4%B8%8B%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B/" title="Linux下查看文件类型" class="md-nav__link">
      Linux下查看文件类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84%E6%A0%87%E5%87%86FHS/" title="Linux文件系统层次结构标准FHS" class="md-nav__link">
      Linux文件系统层次结构标准FHS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/centos%E9%87%8D%E5%90%AF%E5%8D%A1%E6%AD%BB/" title="Centos重启卡死" class="md-nav__link">
      Centos重启卡死
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/Windows%E3%80%81Mac%E4%B8%8EUnix%E7%9A%84%E6%8D%A2%E8%A1%8C%E7%AC%A6%E4%B8%8E%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2/" title="Windows、Mac与Unix的换行符与编码转换" class="md-nav__link">
      Windows、Mac与Unix的换行符与编码转换
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/sanlock/" title="Sanlock" class="md-nav__link">
      Sanlock
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/%E6%9F%A5%E7%9C%8B%E7%AB%AF%E5%8F%A3%E5%8D%A0%E7%94%A8%E6%83%85%E5%86%B5/" title="查看端口占用情况" class="md-nav__link">
      查看端口占用情况
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      鸟哥的linux私房菜
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        鸟哥的linux私房菜
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/00%20linux%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3/" title="00 linux帮助文档" class="md-nav__link">
      00 linux帮助文档
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/01%20%E6%AD%A3%E7%A1%AE%E7%9A%84%E5%85%B3%E6%9C%BA%E6%96%B9%E6%B3%95/" title="01 正确的关机方法" class="md-nav__link">
      01 正确的关机方法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/03%20%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%E4%B8%8E%E7%9B%AE%E5%BD%95%E6%9D%83%E9%99%90/" title="03 文件类型与目录权限" class="md-nav__link">
      03 文件类型与目录权限
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/04%20%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E6%9F%A5%E9%98%85%E4%B8%8E%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7/" title="04 文件内容查阅与文件属性" class="md-nav__link">
      04 文件内容查阅与文件属性
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/05%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" title="05 文件系统" class="md-nav__link">
      05 文件系统
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/06%20%E7%A3%81%E7%9B%98/" title="06 磁盘" class="md-nav__link">
      06 磁盘
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/07%20%E6%89%93%E5%8C%85%E3%80%81%E5%8E%8B%E7%BC%A9%E4%B8%8E%E5%A4%87%E4%BB%BD/" title="07 打包、压缩与备份" class="md-nav__link">
      07 打包、压缩与备份
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/08%20bash/" title="08 bash" class="md-nav__link">
      08 bash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/09%20shell%E8%84%9A%E6%9C%AC/" title="09 shell脚本" class="md-nav__link">
      09 shell脚本
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/10%20linux%E8%B4%A6%E5%8F%B7%E4%B8%8E%E7%BE%A4%E7%BB%84/" title="10 linux账号与群组" class="md-nav__link">
      10 linux账号与群组
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/11%20ACL/" title="11 ACL" class="md-nav__link">
      11 ACL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/12%20%E8%BA%AB%E4%BB%BD%E5%88%87%E6%8D%A2/" title="12 身份切换" class="md-nav__link">
      12 身份切换
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/13%20%E5%AF%86%E7%A0%81%E6%A3%80%E6%9F%A5%E6%9B%B4%E6%96%B0%E4%B8%8E%E6%89%B9%E9%87%8F%E5%88%9B%E5%BB%BA%E8%B4%A6%E5%8F%B7/" title="13 密码检查更新与批量创建账号" class="md-nav__link">
      13 密码检查更新与批量创建账号
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/14%20quota/" title="14 quota" class="md-nav__link">
      14 quota
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/15%20%E7%A3%81%E7%9B%98%E9%98%B5%E5%88%97/" title="15 磁盘阵列" class="md-nav__link">
      15 磁盘阵列
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/16%20LVM/" title="16 LVM" class="md-nav__link">
      16 LVM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/17%20crontab/" title="17 crontab" class="md-nav__link">
      17 crontab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/18%20%E8%BF%9B%E7%A8%8B/" title="18 进程" class="md-nav__link">
      18 进程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/19%20%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E8%B5%84%E6%BA%90/" title="19 查看系统资源" class="md-nav__link">
      19 查看系统资源
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/20%20SELinux/" title="20 SELinux" class="md-nav__link">
      20 SELinux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/21%20%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1/" title="21 系统服务" class="md-nav__link">
      21 系统服务
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/22%20%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6/" title="22 日志文件" class="md-nav__link">
      22 日志文件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/23%20%E5%BC%80%E6%9C%BA%E6%B5%81%E7%A8%8B/" title="23 开机流程" class="md-nav__link">
      23 开机流程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/24%20grub2/" title="24 grub2" class="md-nav__link">
      24 grub2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/25%20%E5%BC%80%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/" title="25 开机过程的问题解决" class="md-nav__link">
      25 开机过程的问题解决
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/26%20%E7%B3%BB%E7%BB%9F%E5%9F%BA%E6%9C%AC%E8%AE%BE%E5%AE%9A/" title="26 系统基本设定" class="md-nav__link">
      26 系统基本设定
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/27%20%E7%A1%AC%E4%BB%B6%E6%95%B0%E6%8D%AE%E7%9A%84%E6%94%B6%E9%9B%86/" title="27 硬件数据的收集" class="md-nav__link">
      27 硬件数据的收集
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/28%20%E5%A4%87%E4%BB%BD/" title="28 备份" class="md-nav__link">
      28 备份
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/29%20Tarball%20%E7%9A%84%E7%AE%A1%E7%90%86%E4%B8%8E%E5%BB%BA%E8%AE%AE/" title="29 Tarball 的管理与建议" class="md-nav__link">
      29 Tarball 的管理与建议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/30%20%E5%BA%93%E6%96%87%E4%BB%B6%E7%9A%84%E7%AE%A1%E7%90%86%E4%B8%8E%E6%96%87%E4%BB%B6%E6%AD%A3%E7%A1%AE%E6%80%A7%E6%A3%80%E6%9F%A5/" title="30 库文件的管理与文件正确性检查" class="md-nav__link">
      30 库文件的管理与文件正确性检查
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/31%20RPM%20%E4%B8%8E%20YUM/" title="31 RPM 与 YUM" class="md-nav__link">
      31 RPM 与 YUM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/32%20%E5%86%85%E6%A0%B8%E7%BC%96%E8%AF%91/" title="32 内核编译" class="md-nav__link">
      32 内核编译
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      鸟哥的linux私房菜-服务器篇
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        鸟哥的linux私房菜-服务器篇
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../00%20%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%80%83%E8%99%91%E4%BA%8B%E9%A1%B9/" title="00 搭建服务器考虑事项" class="md-nav__link">
      00 搭建服务器考虑事项
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../01%20%E5%9F%BA%E7%A1%80%E7%BD%91%E7%BB%9C%E6%A6%82%E5%BF%B5/" title="01 基础网络概念" class="md-nav__link">
      01 基础网络概念
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../02%20%E5%B1%80%E5%9F%9F%E7%BD%91%E6%9E%B6%E6%9E%84%E7%AE%80%E4%BB%8B/" title="02 局域网架构简介" class="md-nav__link">
      02 局域网架构简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03%20%E8%BF%9E%E6%8E%A5%20Internet/" title="03 连接 Internet" class="md-nav__link">
      03 连接 Internet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../04%20%E5%B8%B8%E7%94%A8%E7%BD%91%E7%BB%9C%E5%91%BD%E4%BB%A4/" title="04 常用网络命令" class="md-nav__link">
      04 常用网络命令
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../05%20%E7%BD%91%E7%BB%9C%E4%BE%A6%E9%94%99/" title="05 网络侦错" class="md-nav__link">
      05 网络侦错
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06%20%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E4%BA%8E%E4%B8%BB%E6%9C%BA%E5%9F%BA%E6%9C%AC%E9%98%B2%E6%8A%A4/" title="06 网络安全于主机基本防护" class="md-nav__link">
      06 网络安全于主机基本防护
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07%20%E8%B7%AF%E7%94%B1%E4%B8%8E%E8%B7%AF%E7%94%B1%E5%99%A8/" title="07 路由与路由器" class="md-nav__link">
      07 路由与路由器
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        08 防火墙与 NAT 服务器
      </label>
    
    <a href="./" title="08 防火墙与 NAT 服务器" class="md-nav__link md-nav__link--active">
      08 防火墙与 NAT 服务器
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 认识防火墙
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    1.1 防火墙的作用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-linux" class="md-nav__link">
    1.2 Linux 系统上防火墙的分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121-netfilter" class="md-nav__link">
    1.2.1 Netfilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-tcp-wrappers" class="md-nav__link">
    1.2.2 TCP Wrappers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123" class="md-nav__link">
    1.2.3 代理服务器
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    1.3 防火墙的一般网络布线示意
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131" class="md-nav__link">
    1.3.1 单一网域，仅有一个路由器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132" class="md-nav__link">
    1.3.2 内部网络包含安全性更高的子网，需内部防火墙切开子网
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133" class="md-nav__link">
    1.3.3 在防火墙的后面架设网络服务器主机
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14" class="md-nav__link">
    1.4 防火墙的使用限制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-tcp-wrappers" class="md-nav__link">
    2. TCP Wrappers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 配置文件的语法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211" class="md-nav__link">
    2.1.1 举例说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-iptables" class="md-nav__link">
    3. iptables
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-iptables-tablechain" class="md-nav__link">
    3.1 iptables 的表（table）与链（chain）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-iptables" class="md-nav__link">
    3.2 iptables 语法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321" class="md-nav__link">
    3.2.1 规则的查看
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322" class="md-nav__link">
    3.2.2 规则的清除
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-policy" class="md-nav__link">
    3.2.3 定义预设政策 (policy)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#324" class="md-nav__link">
    3.2.4 规则的制定
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#325-icmp-ping" class="md-nav__link">
    3.2.5 ICMP 封包规则的比对： 针对是否响应 ping 来设计
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#326-iptables-mac-state" class="md-nav__link">
    3.2.6 iptables 外挂模块： mac 与 state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    3.3 超简单客户端防火墙设计与防火墙规则储存
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-ipv4" class="md-nav__link">
    4. IPv4 的内核管理功能
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-nat" class="md-nav__link">
    5. NAT 服务器的设定
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-snat" class="md-nav__link">
    5.1 SNAT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-dnat" class="md-nav__link">
    5.2 DNAT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53" class="md-nav__link">
    5.3 设置
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-snat" class="md-nav__link">
    5.3.1 SNAT 设置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532-dnat" class="md-nav__link">
    5.3.2 DNAT 设置
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54" class="md-nav__link">
    5.4 其他设置
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541" class="md-nav__link">
    5.4.1 重定向设置
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-iptables" class="md-nav__link">
    6. iptables 的额外内核模块功能
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7. 单机防火墙的一个实例
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71" class="md-nav__link">
    7.1 脚本
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../09%20firewall/" title="09 firewall" class="md-nav__link">
      09 firewall
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      命令
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        命令
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/linux%E6%8C%82%E8%BD%BDwindows%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9/" title="Linux挂载windows共享文件夹" class="md-nav__link">
      Linux挂载windows共享文件夹
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/sed/" title="Sed" class="md-nav__link">
      Sed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/gawk/" title="Gawk" class="md-nav__link">
      Gawk
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/ssh%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95/" title="Ssh免密登录" class="md-nav__link">
      Ssh免密登录
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E8%87%AA%E5%8A%A8%E6%B7%BB%E5%8A%A0%E6%89%A7%E8%A1%8C%E6%9D%83%E9%99%90/" title="创建文件自动添加执行权限" class="md-nav__link">
      创建文件自动添加执行权限
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/tar%E5%91%BD%E4%BB%A4%E6%89%93%E5%8C%85%E5%8E%BB%E6%8E%89%E8%B7%AF%E5%BE%84%E5%89%8D%E7%BC%80/" title="Tar命令打包去掉路径前缀" class="md-nav__link">
      Tar命令打包去掉路径前缀
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/wget%E7%94%A8%E6%B3%95/" title="Wget用法" class="md-nav__link">
      Wget用法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/%E6%98%BE%E7%A4%BA%E6%96%87%E4%BB%B6%E5%A4%B9%E5%A4%A7%E5%B0%8F/" title="显示文件夹大小" class="md-nav__link">
      显示文件夹大小
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/%E6%9B%B4%E6%96%B0%E3%80%81%E7%A6%81%E7%94%A8yum%E4%BB%93%E5%BA%93%E3%80%81%E5%8F%AA%E4%B8%8B%E8%BD%BDrpm/" title="更新、禁用yum仓库、只下载rpm" class="md-nav__link">
      更新、禁用yum仓库、只下载rpm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/locate%E5%88%9D%E5%A7%8B%E5%8C%96/" title="Locate初始化" class="md-nav__link">
      Locate初始化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/rsync/" title="Rsync" class="md-nav__link">
      Rsync
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/echo%E7%9A%84%E9%A2%9C%E8%89%B2%E8%BE%93%E5%87%BA%E4%B8%8E%E5%85%89%E6%A0%87%E5%AE%9A%E4%BD%8D/" title="Echo的颜色输出与光标定位" class="md-nav__link">
      Echo的颜色输出与光标定位
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/xargs%E4%B8%8E%E7%AE%A1%E9%81%93/" title="Xargs与管道" class="md-nav__link">
      Xargs与管道
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/trap/" title="Trap" class="md-nav__link">
      Trap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/%E5%AD%97%E7%AC%A6%E8%BD%AC%E6%8D%A2%E5%91%BD%E4%BB%A4/" title="字符转换命令" class="md-nav__link">
      字符转换命令
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/split/" title="Split" class="md-nav__link">
      Split
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/%E6%96%87%E4%BB%B6%E5%AF%B9%E6%AF%94/" title="文件对比" class="md-nav__link">
      文件对比
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/gpg/" title="Gpg" class="md-nav__link">
      Gpg
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%91%BD%E4%BB%A4/%E8%A7%A3%E6%9E%90%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%9A%84%E9%80%89%E9%A1%B9%E5%92%8C%E5%8F%82%E6%95%B0/" title="解析命令行的选项和参数" class="md-nav__link">
      解析命令行的选项和参数
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Shell
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Shell
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../shell/shell%E8%84%9A%E6%9C%AC%E8%87%AA%E5%8A%A8%E8%BE%93%E5%85%A5/" title="Shell脚本自动输入" class="md-nav__link">
      Shell脚本自动输入
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../shell/%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%BC%96%E5%86%99%E5%BE%AA%E7%8E%AF%E4%BD%93/" title="命令行编写循环体" class="md-nav__link">
      命令行编写循环体
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../shell/%E5%9C%A8%E5%90%8E%E5%8F%B0%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4/" title="在后台执行命令" class="md-nav__link">
      在后台执行命令
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../shell/%E9%80%9A%E8%BF%87shell%E5%91%BD%E4%BB%A4%E5%86%99%E6%96%87%E4%BB%B6/" title="通过shell命令写文件" class="md-nav__link">
      通过shell命令写文件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../shell/%E5%8F%98%E9%87%8F%E7%9A%84%E6%88%AA%E5%8F%96%E4%B8%8E%E6%9B%BF%E6%8D%A2/" title="变量的截取与替换" class="md-nav__link">
      变量的截取与替换
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../shell/%E7%BC%96%E5%86%99%E9%AB%98%E5%8F%AF%E9%9D%A0%E6%80%A7%E8%84%9A%E6%9C%AC/" title="编写高可靠性脚本" class="md-nav__link">
      编写高可靠性脚本
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Python
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/event%E7%BA%BF%E7%A8%8B/" title="event线程" class="md-nav__link">
      event线程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/json%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86/" title="json格式处理" class="md-nav__link">
      json格式处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/%E6%89%A7%E8%A1%8Cshell%E5%91%BD%E4%BB%A4/" title="执行shell命令" class="md-nav__link">
      执行shell命令
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/%E8%B6%85%E6%97%B6%E8%A3%85%E9%A5%B0%E5%99%A8/" title="超时装饰器" class="md-nav__link">
      超时装饰器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/%40Property/" title="@Property" class="md-nav__link">
      @Property
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/%E7%B1%BB%E5%B1%9E%E6%80%A7%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7/" title="类属性和实例属性" class="md-nav__link">
      类属性和实例属性
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/" title="高阶函数" class="md-nav__link">
      高阶函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/%E8%8E%B7%E5%8F%96%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0/" title="获取命令行参数" class="md-nav__link">
      获取命令行参数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/asyncore%E6%A8%A1%E5%9D%97/" title="Asyncore模块" class="md-nav__link">
      Asyncore模块
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/select%E6%A8%A1%E5%9D%97/" title="Select模块" class="md-nav__link">
      Select模块
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/subprocess%E6%A8%A1%E5%9D%97/" title="Subprocess模块" class="md-nav__link">
      Subprocess模块
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8/" title="上下文管理器" class="md-nav__link">
      上下文管理器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="网络编程" class="md-nav__link">
      网络编程
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      其它
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        其它
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E5%AE%83/CSDN%E8%AF%AD%E6%B3%95/" title="CSDN语法" class="md-nav__link">
      CSDN语法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E5%AE%83/h5ai%E7%BE%8E%E5%8C%96%E7%9B%AE%E5%BD%95/" title="h5ai美化目录" class="md-nav__link">
      h5ai美化目录
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E5%AE%83/vdsm%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5/" title="vdsm启动失败" class="md-nav__link">
      vdsm启动失败
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E5%AE%83/%E5%88%B6%E4%BD%9Ciso%E9%95%9C%E5%83%8F/" title="制作iso镜像" class="md-nav__link">
      制作iso镜像
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E5%AE%83/%E6%B2%A1%E6%9C%89%E6%89%93%E5%8D%B0%E6%97%A5%E5%BF%97/" title="没有打印日志" class="md-nav__link">
      没有打印日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E5%AE%83/%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85vdsm%E4%B9%8B%E5%90%8E%E4%B8%BB%E6%9C%BA%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5/" title="编译安装vdsm之后主机安装失败" class="md-nav__link">
      编译安装vdsm之后主机安装失败
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E5%AE%83/Stomp%E5%8D%8F%E8%AE%AE/" title="Stomp协议" class="md-nav__link">
      Stomp协议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E5%AE%83/Windows%E6%A0%BC%E5%BC%8F%E5%8C%96%E7%A3%81%E7%9B%98/" title="Windows格式化磁盘" class="md-nav__link">
      Windows格式化磁盘
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Ansible
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Ansible
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ansible/01.%20%E7%AE%80%E4%BB%8B/" title="01. 简介" class="md-nav__link">
      01. 简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ansible/02.%20Inventory%E6%96%87%E4%BB%B6/" title="02. Inventory文件" class="md-nav__link">
      02. Inventory文件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ansible/03.%20playbooks-roles/" title="03. playbooks roles" class="md-nav__link">
      03. playbooks roles
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      RPM
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        RPM
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../rpm/00%20%E7%A4%BA%E4%BE%8B/" title="00 示例" class="md-nav__link">
      00 示例
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rpm/01%20%E6%89%93%E5%8C%85%E5%89%8D%E7%9A%84%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C/" title="01 打包前的准备工作" class="md-nav__link">
      01 打包前的准备工作
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rpm/02%20%E6%89%93%E5%8C%85%E8%BD%AF%E4%BB%B6/" title="02 打包软件" class="md-nav__link">
      02 打包软件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rpm/03%20%E9%AB%98%E7%BA%A7%E8%AF%9D%E9%A2%98/" title="03 高级话题" class="md-nav__link">
      03 高级话题
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Nginx
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Nginx
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../nginx/01%20%E7%AE%80%E4%BB%8B/" title="01 简介" class="md-nav__link">
      01 简介
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../java/IO/" title="IO" class="md-nav__link">
      IO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../java/%E4%BD%9C%E7%94%A8%E8%8C%83%E5%9B%B4%E7%BA%A7%E5%88%AB/" title="作用范围级别" class="md-nav__link">
      作用范围级别
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../java/synchronized%E5%85%B3%E9%94%AE%E5%AD%97/" title="synchronized关键字" class="md-nav__link">
      synchronized关键字
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      servlet
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        servlet
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/1.%E7%AE%80%E4%BB%8B/" title="1.简介" class="md-nav__link">
      1.简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/2.%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/" title="2.生命周期" class="md-nav__link">
      2.生命周期
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/3.%E7%A4%BA%E4%BE%8B/" title="3.示例" class="md-nav__link">
      3.示例
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/4.%E8%BF%87%E6%BB%A4%E5%99%A8/" title="4.过滤器" class="md-nav__link">
      4.过滤器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/5.%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" title="5.异常处理" class="md-nav__link">
      5.异常处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/6.Cookie/" title="6.Cookie" class="md-nav__link">
      6.Cookie
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/7.Session%20%E8%B7%9F%E8%B8%AA/" title="7.Session 跟踪" class="md-nav__link">
      7.Session 跟踪
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/8.%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" title="8.文件上传" class="md-nav__link">
      8.文件上传
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/8.1%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/" title="8.1文件下载" class="md-nav__link">
      8.1文件下载
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/9.%E9%87%8D%E5%AE%9A%E5%90%91/" title="9.重定向" class="md-nav__link">
      9.重定向
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/10.%E4%BD%9C%E7%94%A8%E5%9F%9F/" title="10.作用域" class="md-nav__link">
      10.作用域
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../servlet/11.%E7%9B%91%E5%90%AC%E5%99%A8/" title="11.监听器" class="md-nav__link">
      11.监听器
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      Spring
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        Spring
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../spring/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" title="文件上传" class="md-nav__link">
      文件上传
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../spring/%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/" title="文件下载" class="md-nav__link">
      文件下载
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      Spring Boot
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        Spring Boot
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../springboot/1.%E8%AF%B4%E6%98%8E/" title="1.说明" class="md-nav__link">
      1.说明
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../springboot/2.Maven/" title="2.Maven" class="md-nav__link">
      2.Maven
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../springboot/24.Application%20%E5%B1%9E%E6%80%A7%E6%96%87%E4%BB%B6/" title="24.Application 属性文件" class="md-nav__link">
      24.Application 属性文件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../springboot/25.Profiles/" title="25.Profiles" class="md-nav__link">
      25.Profiles
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../springboot/26.%E6%97%A5%E5%BF%97/" title="26.日志" class="md-nav__link">
      26.日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../springboot/29.%E5%BC%80%E5%8F%91web%E5%BA%94%E7%94%A8/" title="29.开发web应用" class="md-nav__link">
      29.开发web应用
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-16" type="checkbox" id="nav-16">
    
    <label class="md-nav__link" for="nav-16">
      设计模式
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-16">
        设计模式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/" title="设计原则" class="md-nav__link">
      设计原则
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E5%BC%8F/" title="模式" class="md-nav__link">
      模式
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-17" type="checkbox" id="nav-17">
    
    <label class="md-nav__link" for="nav-17">
      MySQL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-17">
        MySQL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/1.%20%E7%AE%80%E4%BB%8B/" title="1. 简介" class="md-nav__link">
      1. 简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/2.%20%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B/" title="2. 关系模型" class="md-nav__link">
      2. 关系模型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/3.%20%E7%AE%A1%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93/" title="3. 管理数据库" class="md-nav__link">
      3. 管理数据库
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/4.%20%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE/" title="4. 查询数据" class="md-nav__link">
      4. 查询数据
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/5.%20%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE/" title="5. 修改数据" class="md-nav__link">
      5. 修改数据
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/6.%20%E4%BA%8B%E5%8A%A1/" title="6. 事务" class="md-nav__link">
      6. 事务
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/7.%20%E5%AE%9E%E7%94%A8SQL%E8%AF%AD%E5%8F%A5/" title="7. 实用SQL语句" class="md-nav__link">
      7. 实用SQL语句
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/8.%20MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="8. MySQL数据类型" class="md-nav__link">
      8. MySQL数据类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/9.%20MySQL%E7%9A%84%E8%BF%90%E7%AE%97%E7%AC%A6/" title="9. MySQL的运算符" class="md-nav__link">
      9. MySQL的运算符
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/10.%20MySQL%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/" title="10. MySQL常用函数" class="md-nav__link">
      10. MySQL常用函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/11.%20MySQL%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/" title="11. MySQL存储引擎" class="md-nav__link">
      11. MySQL存储引擎
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/12.%20MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E9%80%89%E6%8B%A9/" title="12. MySQL数据类型的选择" class="md-nav__link">
      12. MySQL数据类型的选择
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/13.%20MySQL%E5%AD%97%E7%AC%A6%E9%9B%86/" title="13. MySQL字符集" class="md-nav__link">
      13. MySQL字符集
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/14.%20MySQL%E7%B4%A2%E5%BC%95%E7%9A%84%E8%AE%BE%E8%AE%A1%E5%92%8C%E4%BD%BF%E7%94%A8/" title="14. MySQL索引的设计和使用" class="md-nav__link">
      14. MySQL索引的设计和使用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/15.%20MySQL%E8%A7%86%E5%9B%BE/" title="15. MySQL视图" class="md-nav__link">
      15. MySQL视图
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/16.%20MySQL%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/" title="16. MySQL存储过程和函数" class="md-nav__link">
      16. MySQL存储过程和函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/17.0%20MySQL%E5%A4%8D%E5%90%88%E8%AF%AD%E5%8F%A5/" title="17.0 MySQL复合语句" class="md-nav__link">
      17.0 MySQL复合语句
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/17.1%20BEGIN...END%E5%A4%8D%E5%90%88%E8%AF%AD%E5%8F%A5/" title="17.1 BEGIN...END复合语句" class="md-nav__link">
      17.1 BEGIN...END复合语句
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/17.2%20%E8%AF%AD%E5%8F%A5%E6%A0%87%E7%AD%BE/" title="17.2 语句标签" class="md-nav__link">
      17.2 语句标签
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/17.3%20%E5%A3%B0%E6%98%8E%E8%AF%AD%E6%B3%95/" title="17.3 声明语法" class="md-nav__link">
      17.3 声明语法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/17.4%20%E5%8F%98%E9%87%8F/" title="17.4 变量" class="md-nav__link">
      17.4 变量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/17.5%20%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/" title="17.5 流程控制" class="md-nav__link">
      17.5 流程控制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/17.6%20%E6%B8%B8%E6%A0%87/" title="17.6 游标" class="md-nav__link">
      17.6 游标
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/17.7%20%E9%94%99%E8%AF%AF%E7%8A%B6%E5%86%B5%E5%8F%8A%E5%A4%84%E7%90%86/" title="17.7 错误状况及处理" class="md-nav__link">
      17.7 错误状况及处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/17.8%20SIGNAL/" title="17.8 SIGNAL" class="md-nav__link">
      17.8 SIGNAL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/17.9%20RESIGNAL/" title="17.9 RESIGNAL" class="md-nav__link">
      17.9 RESIGNAL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/18.%20MySQL%E8%A7%A6%E5%8F%91%E5%99%A8/" title="18. MySQL触发器" class="md-nav__link">
      18. MySQL触发器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/19.%20MySQL%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%94%81%E5%AE%9A%E8%AF%AD%E5%8F%A5/" title="19. MySQL事务与锁定语句" class="md-nav__link">
      19. MySQL事务与锁定语句
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/20.%20SQL%E4%B8%AD%E7%9A%84%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/" title="20. SQL中的安全问题" class="md-nav__link">
      20. SQL中的安全问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/21.%20SQL%20Mode/" title="21. SQL Mode" class="md-nav__link">
      21. SQL Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/22.%20%E5%B8%B8%E7%94%A8%20SQL%20%E6%8A%80%E5%B7%A7%E5%92%8C%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" title="22. 常用 SQL 技巧和常见问题" class="md-nav__link">
      22. 常用 SQL 技巧和常见问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/23.%20MySQL%E5%88%86%E5%8C%BA/" title="23. MySQL分区" class="md-nav__link">
      23. MySQL分区
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/24.%20MySQL%E5%88%86%E5%8C%BA%E9%99%90%E5%88%B6/" title="24. MySQL分区限制" class="md-nav__link">
      24. MySQL分区限制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/25.%20SQL%E4%BC%98%E5%8C%96/" title="25. SQL优化" class="md-nav__link">
      25. SQL优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/26.%20%E4%BC%98%E5%8C%96%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1/" title="26. 优化数据库对象" class="md-nav__link">
      26. 优化数据库对象
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/27.%20%E9%94%81/" title="27. 锁" class="md-nav__link">
      27. 锁
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/28.%20MySQL%20Server%E7%9A%84%E4%BC%98%E5%8C%96/" title="28. MySQL Server的优化" class="md-nav__link">
      28. MySQL Server的优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/29.%20MySQL%E7%A3%81%E7%9B%98%20IO%20%E9%97%AE%E9%A2%98/" title="29. MySQL磁盘 IO 问题" class="md-nav__link">
      29. MySQL磁盘 IO 问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/30.%20MySQL%20%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/" title="30. MySQL 常用工具" class="md-nav__link">
      30. MySQL 常用工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/31.%20MySQL%20%E6%97%A5%E5%BF%97/" title="31. MySQL 日志" class="md-nav__link">
      31. MySQL 日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/32.%20MySQL%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/" title="32. MySQL备份与恢复" class="md-nav__link">
      32. MySQL备份与恢复
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/33.%20MySQL%20%E6%9D%83%E9%99%90%E4%B8%8E%E5%AE%89%E5%85%A8/" title="33. MySQL 权限与安全" class="md-nav__link">
      33. MySQL 权限与安全
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/34.%20MySQL%20%E7%9B%91%E6%8E%A7/" title="34. MySQL 监控" class="md-nav__link">
      34. MySQL 监控
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/35.%20MySQL%20%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%92%8C%E5%BA%94%E7%94%A8%E6%8A%80%E5%B7%A7/" title="35. MySQL 常见问题和应用技巧" class="md-nav__link">
      35. MySQL 常见问题和应用技巧
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/36.%20MySQL%20%E5%A4%8D%E5%88%B6/" title="36. MySQL 复制" class="md-nav__link">
      36. MySQL 复制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/37.%20MySQL%20Cluster/" title="37. MySQL Cluster" class="md-nav__link">
      37. MySQL Cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/38.%20%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84/" title="38. 高可用架构" class="md-nav__link">
      38. 高可用架构
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-18" type="checkbox" id="nav-18">
    
    <label class="md-nav__link" for="nav-18">
      MyBatis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-18">
        MyBatis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mybatis/%E7%AE%80%E4%BB%8B/" title="简介.md" class="md-nav__link">
      简介.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mybatis/XML%E9%85%8D%E7%BD%AE/" title="XML配置.md" class="md-nav__link">
      XML配置.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mybatis/%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/" title="注意事项.md" class="md-nav__link">
      注意事项.md
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-19" type="checkbox" id="nav-19">
    
    <label class="md-nav__link" for="nav-19">
      HTTP协议
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-19">
        HTTP协议
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../http%E5%8D%8F%E8%AE%AE/%E7%AE%80%E4%BB%8B/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../http%E5%8D%8F%E8%AE%AE/HTTP%20%E6%8A%A5%E6%96%87%E5%86%85%E7%9A%84%20HTTP%20%E4%BF%A1%E6%81%AF/" title="HTTP 报文内的 HTTP 信息" class="md-nav__link">
      HTTP 报文内的 HTTP 信息
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../http%E5%8D%8F%E8%AE%AE/%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E7%9A%84%20HTTP%20%E7%8A%B6%E6%80%81%E7%A0%81/" title="返回结果的 HTTP 状态码" class="md-nav__link">
      返回结果的 HTTP 状态码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../http%E5%8D%8F%E8%AE%AE/%E4%B8%8E%20HTTP%20%E5%8D%8F%E4%BD%9C%E7%9A%84%20Web%20%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="与 HTTP 协作的 Web 服务器" class="md-nav__link">
      与 HTTP 协作的 Web 服务器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../http%E5%8D%8F%E8%AE%AE/HTTP%20%E9%A6%96%E9%83%A8/" title="HTTP 首部" class="md-nav__link">
      HTTP 首部
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../http%E5%8D%8F%E8%AE%AE/HTTPS/" title="HTTPS" class="md-nav__link">
      HTTPS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-20" type="checkbox" id="nav-20">
    
    <label class="md-nav__link" for="nav-20">
      CS50
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-20">
        CS50
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CS50/1.%20%E7%AE%80%E4%BB%8B/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CS50/2.%20%E7%BC%96%E8%AF%91%E5%99%A8/" title="编译器" class="md-nav__link">
      编译器
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-21" type="checkbox" id="nav-21">
    
    <label class="md-nav__link" for="nav-21">
      Linux网络编程
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-21">
        Linux网络编程
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E5%87%BD%E6%95%B0/" title="函数" class="md-nav__link">
      函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/socket%E9%80%9A%E4%BF%A1%E6%B5%81%E7%A8%8B/" title="socket通信流程" class="md-nav__link">
      socket通信流程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%AE%80%E5%8D%95tcp%E9%80%9A%E4%BF%A1%E5%AE%9E%E7%8E%B0/" title="简单tcp通信实现" class="md-nav__link">
      简单tcp通信实现
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-22" type="checkbox" id="nav-22">
    
    <label class="md-nav__link" for="nav-22">
      GlusterFS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-22">
        GlusterFS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../gluster/gluster%E5%AE%89%E8%A3%85/" title="gluster安装" class="md-nav__link">
      gluster安装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../gluster/ovirt%E7%9A%84gluster%E6%95%B0%E6%8D%AE%E6%81%A2%E5%A4%8Dbug/" title="ovirt的gluster数据恢复bug" class="md-nav__link">
      ovirt的gluster数据恢复bug
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../gluster/%E6%B8%85%E7%90%86%E4%B8%8D%E5%8F%AF%E7%94%A8%E7%9A%84brick/" title="清理不可用的brick" class="md-nav__link">
      清理不可用的brick
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../gluster/%E7%BB%93%E7%82%B9%E6%95%85%E9%9A%9C/" title="结点故障" class="md-nav__link">
      结点故障
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-23" type="checkbox" id="nav-23">
    
    <label class="md-nav__link" for="nav-23">
      Docker
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-23">
        Docker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/01.%20%E5%85%A5%E9%97%A8-%E5%AE%89%E8%A3%85/" title="01. 入门 安装" class="md-nav__link">
      01. 入门 安装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/02.%20%E5%85%A5%E9%97%A8-%E5%AE%B9%E5%99%A8/" title="02. 入门 容器" class="md-nav__link">
      02. 入门 容器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/03.%20%E5%85%A5%E9%97%A8-%E6%9C%8D%E5%8A%A1/" title="03. 入门 服务" class="md-nav__link">
      03. 入门 服务
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/04.%20%E5%85%A5%E9%97%A8-%E9%9B%86%E7%BE%A4/" title="04. 入门 集群" class="md-nav__link">
      04. 入门 集群
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/05.%20%E5%85%A5%E9%97%A8-%E6%A0%88/" title="05. 入门 栈" class="md-nav__link">
      05. 入门 栈
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/06.%20%E4%BD%BF%E7%94%A8docker%E9%95%9C%E5%83%8F/" title="06. 使用docker镜像" class="md-nav__link">
      06. 使用docker镜像
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/07.%20%E5%AE%B9%E5%99%A8%E6%93%8D%E4%BD%9C/" title="07. 容器操作" class="md-nav__link">
      07. 容器操作
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/08.%20docker%E4%BB%93%E5%BA%93/" title="08. docker仓库" class="md-nav__link">
      08. docker仓库
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/09.%20Docker%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/" title="09. Docker数据管理" class="md-nav__link">
      09. Docker数据管理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/10%20%E7%AB%AF%E5%8F%A3%E6%98%A0%E5%B0%84%E4%B8%8E%E5%AE%B9%E5%99%A8%E4%BA%92%E8%81%94/" title="10 端口映射与容器互联" class="md-nav__link">
      10 端口映射与容器互联
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/11.%20Dockerfile/" title="11. Dockerfile" class="md-nav__link">
      11. Dockerfile
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-24" type="checkbox" id="nav-24">
    
    <label class="md-nav__link" for="nav-24">
      Git
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-24">
        Git
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../git/%E6%8B%89%E5%8F%96%E4%B8%8E%E6%8E%A8%E9%80%81/" title="拉取与推送" class="md-nav__link">
      拉取与推送
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../git/git%20rebase%28%E4%BF%AE%E6%94%B9%E5%8E%86%E5%8F%B2%E6%8F%90%E4%BA%A4%29/" title="git rebase(修改历史提交)" class="md-nav__link">
      git rebase(修改历史提交)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../git/windows%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8git%E5%85%8B%E9%9A%86/" title="windows无法使用git克隆" class="md-nav__link">
      windows无法使用git克隆
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../git/%E4%BF%AE%E6%94%B9%E5%8E%86%E5%8F%B2/" title="修改历史" class="md-nav__link">
      修改历史
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../git/%E4%BF%AE%E6%94%B9%E5%8E%86%E5%8F%B2%E6%8F%90%E4%BA%A4%E8%80%85%E7%9A%84%E9%82%AE%E7%AE%B1/" title="修改历史提交者的邮箱" class="md-nav__link">
      修改历史提交者的邮箱
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../git/git%20bash%20%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81/" title="Git bash 中文乱码" class="md-nav__link">
      Git bash 中文乱码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../git/%E5%9B%9E%E6%BB%9A/" title="回滚" class="md-nav__link">
      回滚
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../git/%E8%BF%9C%E7%A8%8B%E7%9B%B8%E5%85%B3/" title="远程相关" class="md-nav__link">
      远程相关
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-25" type="checkbox" id="nav-25">
    
    <label class="md-nav__link" for="nav-25">
      Gerrit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-25">
        Gerrit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../gerrit/Apache%E4%BB%A3%E7%90%86%E6%B7%BB%E5%8A%A0%E6%96%B0%E7%94%A8%E6%88%B7/" title="Apache代理添加新用户" class="md-nav__link">
      Apache代理添加新用户
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../gerrit/Gerrit%20submit%20change%20after%20abandoning%20its%20parent/" title="Gerrit submit change after abandoning its parent" class="md-nav__link">
      Gerrit submit change after abandoning its parent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../gerrit/%E4%BD%BF%E7%94%A8Apache%E4%BB%A3%E7%90%86%E8%B7%AF%E5%BE%84%E9%94%99%E8%AF%AF/" title="使用Apache代理路径错误" class="md-nav__link">
      使用Apache代理路径错误
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../gerrit/%E5%88%B7%E6%96%B0gerrit%E9%A1%B9%E7%9B%AE%E5%88%97%E8%A1%A8/" title="刷新gerrit项目列表" class="md-nav__link">
      刷新gerrit项目列表
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-26" type="checkbox" id="nav-26">
    
    <label class="md-nav__link" for="nav-26">
      小玩具
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-26">
        小玩具
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../little%20toys/%E6%91%A9%E6%96%AF%E8%BD%AC%E6%8D%A2/" title="摩斯转换" class="md-nav__link">
      摩斯转换
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../little%20toys/shell-%E5%B0%8F%E4%BA%8E%E7%AD%89%E4%BA%8E%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E6%95%B0%E8%BD%AC%E5%8D%81%E8%BF%9B%E5%88%B6%E5%92%8C%E4%BA%8C%E8%BF%9B%E5%88%B6/" title="Shell 小于等于十六进制数转十进制和二进制" class="md-nav__link">
      Shell 小于等于十六进制数转十进制和二进制
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-27" type="checkbox" id="nav-27">
    
    <label class="md-nav__link" for="nav-27">
      Datastruct
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-27">
        Datastruct
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../datastruct/%E4%BA%8C%E5%8F%89%E6%A0%91/" title="二叉树" class="md-nav__link">
      二叉树
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../datastruct/%E6%95%A3%E5%88%97%E8%A1%A8/" title="散列表" class="md-nav__link">
      散列表
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../datastruct/%E7%BA%A2%E9%BB%91%E6%A0%91/" title="红黑树" class="md-nav__link">
      红黑树
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-28" type="checkbox" id="nav-28">
    
    <label class="md-nav__link" for="nav-28">
      C
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-28">
        C
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../c/%E5%8A%A8%E6%80%81%E7%BC%96%E8%AF%91/" title="动态编译" class="md-nav__link">
      动态编译
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../c/%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4/" title="程序运行时间" class="md-nav__link">
      程序运行时间
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../c/%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88/" title="结构体中的函数指针" class="md-nav__link">
      结构体中的函数指针
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../c/mutiple%20definition%20of%20xxx/" title="Mutiple definition of xxx" class="md-nav__link">
      Mutiple definition of xxx
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-29" type="checkbox" id="nav-29">
    
    <label class="md-nav__link" for="nav-29">
      Algorithm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-29">
        Algorithm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../algorithm/%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90/" title="复杂度分析" class="md-nav__link">
      复杂度分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../algorithm/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F/" title="选择排序" class="md-nav__link">
      选择排序
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-30" type="checkbox" id="nav-30">
    
    <label class="md-nav__link" for="nav-30">
      奇技淫巧
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-30">
        奇技淫巧
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/%E4%BD%8D%E8%BF%90%E7%AE%97/" title="位运算" class="md-nav__link">
      位运算
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. 认识防火墙
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    1.1 防火墙的作用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-linux" class="md-nav__link">
    1.2 Linux 系统上防火墙的分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121-netfilter" class="md-nav__link">
    1.2.1 Netfilter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-tcp-wrappers" class="md-nav__link">
    1.2.2 TCP Wrappers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123" class="md-nav__link">
    1.2.3 代理服务器
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    1.3 防火墙的一般网络布线示意
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131" class="md-nav__link">
    1.3.1 单一网域，仅有一个路由器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132" class="md-nav__link">
    1.3.2 内部网络包含安全性更高的子网，需内部防火墙切开子网
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133" class="md-nav__link">
    1.3.3 在防火墙的后面架设网络服务器主机
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14" class="md-nav__link">
    1.4 防火墙的使用限制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-tcp-wrappers" class="md-nav__link">
    2. TCP Wrappers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 配置文件的语法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211" class="md-nav__link">
    2.1.1 举例说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-iptables" class="md-nav__link">
    3. iptables
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-iptables-tablechain" class="md-nav__link">
    3.1 iptables 的表（table）与链（chain）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-iptables" class="md-nav__link">
    3.2 iptables 语法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321" class="md-nav__link">
    3.2.1 规则的查看
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322" class="md-nav__link">
    3.2.2 规则的清除
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-policy" class="md-nav__link">
    3.2.3 定义预设政策 (policy)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#324" class="md-nav__link">
    3.2.4 规则的制定
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#325-icmp-ping" class="md-nav__link">
    3.2.5 ICMP 封包规则的比对： 针对是否响应 ping 来设计
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#326-iptables-mac-state" class="md-nav__link">
    3.2.6 iptables 外挂模块： mac 与 state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    3.3 超简单客户端防火墙设计与防火墙规则储存
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-ipv4" class="md-nav__link">
    4. IPv4 的内核管理功能
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-nat" class="md-nav__link">
    5. NAT 服务器的设定
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-snat" class="md-nav__link">
    5.1 SNAT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-dnat" class="md-nav__link">
    5.2 DNAT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53" class="md-nav__link">
    5.3 设置
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-snat" class="md-nav__link">
    5.3.1 SNAT 设置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532-dnat" class="md-nav__link">
    5.3.2 DNAT 设置
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54" class="md-nav__link">
    5.4 其他设置
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541" class="md-nav__link">
    5.4.1 重定向设置
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-iptables" class="md-nav__link">
    6. iptables 的额外内核模块功能
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7. 单机防火墙的一个实例
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71" class="md-nav__link">
    7.1 脚本
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ignorantshr/question/edit/master/docs/鸟哥的linux私房菜-服务器篇/08 防火墙与 NAT 服务器.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>08 防火墙与 NAT 服务器</h1>
                
                <p>Linux 的防火墙主要是透过 <code>Netfilter</code> 与 <code>TCP Wrappers</code> 两个机制来管理的。</p>
<h2 id="1">1. 认识防火墙<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p>只要能够分析与过滤进出我们管理的网络的数据包，就可以称为防火墙。</p>
<p>防火墙又可以分为硬件防火墙与本机的软件防火墙。硬件防火墙包过滤的效率较佳。</p>
<p>鸟哥建议利用 <em>shell script</em> 来撰写属于自己的防火墙机制比较好，因为对于规则的排序与汇总有比较好的观察性，可以让防火墙规则比较清晰一点。</p>
<h3 id="11">1.1 防火墙的作用<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<p>防火墙最重要的任务就是规划出：</p>
<ul>
<li>切割被信任（如子域）与不被信任（如 Internet）的网段；</li>
<li>划分出可提供 Internet 的服务与必须受保护的服务；</li>
<li>分析出可接受与不可接受的包状态。</li>
</ul>
<p>Linux 的 <code>iptables</code> 防火墙软件还可以进行更细部深入的 NAT （Network Address Translation）的设定，进行更弹性的 IP 数据包伪装功能。</p>
<h3 id="12-linux">1.2 Linux 系统上防火墙的分类<a class="headerlink" href="#12-linux" title="Permanent link">&para;</a></h3>
<p>依据防火墙管理的范围，我们可以将防火墙区分为网域型与单一主机型的管控。</p>
<p>单一主机型的控管方面，主要的防火墙有包过滤型的 <code>Netfilter</code> 与依据服务软件程序作为分析的 <code>TCP Wrappers</code> 两种。</p>
<p>若以区域型的防火墙而言，由于此类防火墙都是当作路由器角色，因此防火墙类型主要则有 <code>Netfilter</code> 与利用<code>代理服务器</code> (proxy server) 进行存取代理的方式了。</p>
<h4 id="121-netfilter">1.2.1 Netfilter<a class="headerlink" href="#121-netfilter" title="Permanent link">&para;</a></h4>
<p>分析进入主机的网络包，将包的表头数据拿出来进行分析，以决定对该联机实行放行或抵挡。</p>
<p>包括 <em>硬件地址(MAC), 软件地址 (IP), TCP, UDP, ICMP</em> 等包的信息都可以进行过滤分析的功能。主要分析的是 OSI 七层协议的 2, 3, 4 层。</p>
<p>在 Linux 上面使用<code>iptables</code>或<code>firewall</code>来实现。非常适合于一般小型环境。</p>
<h4 id="122-tcp-wrappers">1.2.2 TCP Wrappers<a class="headerlink" href="#122-tcp-wrappers" title="Permanent link">&para;</a></h4>
<p>通过服务器程序的外挂 （<code>tcpd</code>）来处置的。分析谁对某<strong>程序</strong>进行存取，然后透过规则去分析该服务器程序谁能够联机、谁不能联机。</p>
<h4 id="123">1.2.3 代理服务器<a class="headerlink" href="#123" title="Permanent link">&para;</a></h4>
<p>其实代理服务器是一种网络服务，它可以<strong>代理</strong>用户的需求，而代为前往服务器取得相关的资源。</p>
<h3 id="13">1.3 防火墙的一般网络布线示意<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<h4 id="131">1.3.1 单一网域，仅有一个路由器<a class="headerlink" href="#131" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/%E5%8D%95%E4%B8%80%E7%BD%91%E5%9F%9F_%E5%8D%95%E4%B8%80%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E7%8E%AF%E5%A2%83.png" /></p>
<p>将 Linux 架设在路由器上面以管控整个局域网络的包进出。</p>
<ul>
<li>因为内外网域已经分开，所以安全维护在内部可以开放的权限较大</li>
<li>安全机制的设定可以针对 Linux 防火墙主机来维护即可</li>
<li>对外只看的到 Linux 防火墙主机，所以对于内部可以达到有效的安全防护</li>
</ul>
<h4 id="132">1.3.2 内部网络包含安全性更高的子网，需内部防火墙切开子网<a class="headerlink" href="#132" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/%E5%86%85%E9%83%A8%E5%8C%85%E5%90%AB%E5%AE%89%E5%85%A8%E6%80%A7%E6%9B%B4%E9%AB%98%E5%AD%90%E7%BD%91%E7%9A%84%E7%8E%AF%E5%A2%83.png" /></p>
<p>如果有特别重要的部门需要更安全的保护网络环境,那么将 LAN 里面再加设一个防火墙，将安全等级分类，可以防止一些内部破坏和盗取。</p>
<h4 id="133">1.3.3 在防火墙的后面架设网络服务器主机<a class="headerlink" href="#133" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../img/%E5%B0%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%94%BE%E5%9C%A8%E9%98%B2%E7%81%AB%E5%A2%99%E5%90%8E%E7%9A%84%E7%8E%AF%E5%A2%83.png" /></p>
<p>将提供网络服务的服务器放在防火墙后面。通常像上图的环境中，将网络服务器独立放置在两个防火墙中间的网络，我们称之为非军事区域 (<code>DMZ</code>)，即缓冲地带的意思。</p>
<p>Web, Mail 与 FTP 都是透过防火墙连到 Internet 上面去，所以，这四部主机在 Internet 上面的 Public IP 都是一样的。</p>
<p>内部网络如果发生状况时，是不会影响到网络服务器的正常运作的。</p>
<p>在配置一个拥有DMZ区的网络的时候通常定义以下的<a href="https://baike.baidu.com/item/DMZ/631225?fr=aladdin#4">访问控制策略</a>以实现DMZ区的屏障功能：</p>
<ol>
<li><strong>内网可以访问外网</strong></li>
<li><strong>内网可以访问DMZ</strong></li>
<li><strong>外网不能访问内网</strong></li>
<li><strong>外网可以访问DMZ</strong></li>
<li><strong>DMZ访问内网有限制</strong></li>
<li><strong>DMZ不能访问外网</strong>：邮件服务器等必须访问的除外。</li>
</ol>
<p>DMZ的目的是把敏感的内部网络和其他提供访问服务的网络分开，阻止内网和外网直接通信，以保证内网安全。</p>
<h3 id="14">1.4 防火墙的使用限制<a class="headerlink" href="#14" title="Permanent link">&para;</a></h3>
<ul>
<li>防火墙并不能很有效的抵挡病毒或木马程序</li>
<li>防火墙对于来自内部 LAN 的攻击较无承受力</li>
</ul>
<p>此时就需要前文的网络安全知识来预防了。</p>
<h2 id="2-tcp-wrappers">2. TCP Wrappers<a class="headerlink" href="#2-tcp-wrappers" title="Permanent link">&para;</a></h2>
<p>TCP wrappers 就是透过 <code>/etc/hosts.allow, /etc/hosts.deny</code>这两个文件来管理的一个类似防火墙的机制。</p>
<p>支持该规则的只有以下软件：</p>
<ul>
<li>
<p>由 <code>super daemon (xinetd)</code> 所管理的服务，即</p>
<p>配置文件在<code>/etc/xinetd.d/</code>下面的服务；//TODO 在centos6.x中查看</p>
</li>
<li>
<p>支持 <code>libwrap.so</code> 模块的服务。</p>
</li>
</ul>
<p>可以使用<code>ldd</code>指令来查看一个服务是否包含<code>libwrap.so</code>库文件：</p>
<div class="codehilite"><pre><span></span><code><span class="err">root@sink:~# ldd $(which sshd) | grep libwrap.so</span>
<span class="err">    libwrap.so.0 =&gt; /lib/x86_64-linux-gnu/libwrap.so.0 (0x00007f2618235000)</span>
</code></pre></div>


<h3 id="21">2.1 配置文件的语法<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<p><code>/etc/hosts.allow, /etc/hosts.deny</code>两个文件的语法（更复杂的语法参考<code>man hosts_access</code>）是一样的：</p>
<div class="codehilite"><pre><span></span><code><span class="err">&lt;service(program_name)&gt; : &lt;IP, domain, hostname&gt;</span>
</code></pre></div>


<p>这两个文件与规则的优先级是这样的：</p>
<ol>
<li>先以 /etc/hosts.allow 比对，该规则符合就予以放行；</li>
<li>再以 /etc/hosts.deny 比对，规则符合就予以抵挡；</li>
<li>若不在这两个文件内，亦即规则都不符合，最终则予以放行。</li>
</ol>
<h4 id="211">2.1.1 举例说明<a class="headerlink" href="#211" title="Permanent link">&para;</a></h4>
<p>先开放本机的 127.0.0.1 可以进行任何本机的服务，然后,让区网 (192.168.1.0/24) 可以使用 rsync ，同时 10.0.0.100 也能够使用 rsync ，但其他来源则不允许使用 rsync。那么规则设置如下：</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="nv">@sink</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span><span class="p">.</span><span class="n">allow</span><span class="w"></span>
<span class="ow">ALL</span><span class="err">:</span><span class="w"> </span><span class="mf">127.0.0.1</span><span class="w"></span>
<span class="nl">rsync</span><span class="p">:</span><span class="w"> </span><span class="mf">192.168.1.0</span><span class="o">/</span><span class="mf">255.255.255.0</span><span class="p">,</span><span class="w"> </span><span class="mf">10.0.0.100</span><span class="w"></span>

<span class="n">root</span><span class="nv">@sink</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span><span class="p">.</span><span class="k">deny</span><span class="w"></span>
<span class="nl">rsync</span><span class="p">:</span><span class="w"> </span><span class="ow">ALL</span><span class="w"></span>
</code></pre></div>


<p>tcp wrappers 理论上不支持 192.168.1.0/24 这种透过 bit 数值来定义的网段，只支持 netmask 的地址显示方式。</p>
<h2 id="3-iptables">3. iptables<a class="headerlink" href="#3-iptables" title="Permanent link">&para;</a></h2>
<p><img alt="" src="../img/%E7%BD%91%E7%BB%9C%E5%8C%85%E8%BF%87%E6%BB%A4%E8%A7%84%E5%88%99%E6%B5%81%E7%A8%8B.png" /></p>
<p>上图的主要目的是告诉你：<strong>规则是有顺序的</strong>！当符合了一个规则时，就不会继续进行规则的对比了。使用<code>iptables-save</code>查看规则顺序，越靠下的顺序越靠前。</p>
<h3 id="31-iptables-tablechain">3.1 iptables 的表（table）与链（chain）<a class="headerlink" href="#31-iptables-tablechain" title="Permanent link">&para;</a></h3>
<p><code>iptables</code>中有多个表，每个表格中又有多个链，每个链下又有规则。</p>
<p>那么 iptables 中主要有三张表：</p>
<ul>
<li>filter：管理本机进出的数据包，为默认的table<ul>
<li>INPUT：过滤进入的数据包；</li>
<li>OUTPUT：过滤输出；</li>
<li>FORWARD：过滤转发包，即与 <code>ip forward</code>有关，和下面的<code>nat table</code>相关性较高。</li>
</ul>
</li>
<li>nat：主要在进行来源与目的的 IP 或 port 的转换<ul>
<li>PREROUTING：在进行路由判断之前所要对比的规则；</li>
<li>POSTROUTING：路由判断之后；</li>
<li>OUTPUT。</li>
</ul>
</li>
<li>mangle：主要是与特殊的封包的路由旗标（flag）有关。</li>
</ul>
<p>各个表之间的关系图：</p>
<p><img alt="" src="../img/iptables%E4%B8%AD%E8%A1%A8%E7%9A%84%E5%85%B3%E7%B3%BB.png" /></p>
<p>由上图可以看出，iptables 可以控制三种包的流向：</p>
<ul>
<li>包进入 Linux 主机使用资源（A）：路由判断之后确定是从主机获取资源；</li>
<li>包经由 Linux 主机的转发，向后端主机流动（B）；</li>
<li>包由 Linux 本机发送出去（C）。</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>因为网络是<strong>双向的</strong>，所以进入与输出要分开来看，故有两次路由判断！</p>
</div>
<h3 id="32-iptables">3.2 iptables 语法<a class="headerlink" href="#32-iptables" title="Permanent link">&para;</a></h3>
<h4 id="321">3.2.1 规则的查看<a class="headerlink" href="#321" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">iptables</span> <span class="p">[</span><span class="o">-</span><span class="n">t</span> <span class="n">tables</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">L</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">nv</span><span class="p">]</span>

    <span class="o">-</span><span class="n">t</span> <span class="p">:</span><span class="err">后面接</span> <span class="k">table</span> <span class="err">，例如</span> <span class="n">nat</span> <span class="err">或</span> <span class="n">filter</span> <span class="err">，若省略此项目</span><span class="p">,</span><span class="err">则使用默认的</span> <span class="n">filter</span>
    <span class="o">-</span><span class="n">L</span> <span class="p">:</span><span class="err">列出目前的</span> <span class="k">table</span> <span class="err">的规则</span>
    <span class="o">-</span><span class="n">n</span> <span class="p">:</span><span class="err">不进行</span> <span class="n">IP</span> <span class="err">与</span> <span class="n">HOSTNAME</span> <span class="err">的反查，显示讯息的速度会快很多！</span>
    <span class="o">-</span><span class="n">v</span> <span class="p">:</span><span class="err">列出更多的信息</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="nv">@sink</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">iptables</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"></span>
<span class="n">Chain</span><span class="w"> </span><span class="k">INPUT</span><span class="w"> </span><span class="p">(</span><span class="n">policy</span><span class="w"> </span><span class="n">ACCEPT</span><span class="p">)</span><span class="w"></span>
<span class="n">target</span><span class="w">     </span><span class="n">prot</span><span class="w"> </span><span class="n">opt</span><span class="w"> </span><span class="n">source</span><span class="w">               </span><span class="n">destination</span><span class="w">         </span>

<span class="n">Chain</span><span class="w"> </span><span class="n">FORWARD</span><span class="w"> </span><span class="p">(</span><span class="n">policy</span><span class="w"> </span><span class="k">DROP</span><span class="p">)</span><span class="w"></span>
<span class="n">target</span><span class="w">     </span><span class="n">prot</span><span class="w"> </span><span class="n">opt</span><span class="w"> </span><span class="n">source</span><span class="w">               </span><span class="n">destination</span><span class="w">                    </span>
<span class="n">ACCEPT</span><span class="w">     </span><span class="ow">all</span><span class="w">  </span><span class="c1">--  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED</span>
<span class="err">……</span><span class="w"></span>
</code></pre></div>


<p>表头的含义：</p>
<ul>
<li>policy：预设的政策（动作）</li>
<li>target：本条规则的动作</li>
<li>prot：是什么协议</li>
<li>opt：额外的选项说明</li>
<li>source：此规则针对的<em>源IP</em></li>
<li>destination：<em>目的IP</em></li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">iptables</span><span class="o">-</span><span class="n">save</span> <span class="p">[</span><span class="o">-</span><span class="n">t</span> <span class="k">table</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">f</span> <span class="n">filename</span><span class="p">]</span>

    <span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="c1">--file filename      Specify a filename to log the output to. 默认输出到STDOUT.</span>
</code></pre></div>


<p>虽然<code>iptables-save</code>是一个存储指令，但是可以详细查看防火墙规则：</p>
<div class="codehilite"><pre><span></span><code><span class="err">root@sink:~# iptables-save</span>
<span class="err"># Generated by xtables-save v1.8.2 on Sun Mar 22 21:24:03 2020</span>
<span class="err">*filter</span>
<span class="err">:INPUT ACCEPT [0:0]</span>
<span class="err">:FORWARD DROP [0:0]</span>
<span class="err">:OUTPUT ACCEPT [0:0]</span>
<span class="err">-A FORWARD -o docker0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT</span>
<span class="err">……</span>
<span class="err">COMMIT</span>
<span class="err">*nat</span>
<span class="err">:PREROUTING ACCEPT [0:0]</span>
<span class="err">:INPUT ACCEPT [0:0]</span>
<span class="err">……</span>
</code></pre></div>


<h4 id="322">3.2.2 规则的清除<a class="headerlink" href="#322" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">iptables</span> <span class="p">[</span><span class="o">-</span><span class="n">t</span> <span class="n">tables</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">DFXZ</span><span class="p">]</span>

    <span class="o">-</span><span class="n">D</span> <span class="k">chain</span> <span class="err">：从</span> <span class="k">chain</span> <span class="err">中清除符合条件的规则；</span>
    <span class="o">-</span><span class="n">D</span> <span class="k">chain</span> <span class="n">rulenum</span> <span class="err">：</span><span class="n">rulenum</span> <span class="p">(</span><span class="mi">1</span> <span class="o">=</span> <span class="k">first</span><span class="p">)</span><span class="err">；</span>

    <span class="o">-</span><span class="n">F</span> <span class="err">：清除所有的规则；</span>
    <span class="o">-</span><span class="n">X</span> <span class="err">：清除所有使用者</span> <span class="ss">&quot;自定义&quot;</span> <span class="err">的</span> <span class="k">chain</span> <span class="p">(</span><span class="err">应该说的是</span> <span class="n">tables</span> <span class="p">)</span><span class="err">啰；</span>
    <span class="o">-</span><span class="n">Z</span> <span class="err">：将所有的</span> <span class="k">chain</span> <span class="err">的计数与流量统计都归零</span>
</code></pre></div>


<h4 id="323-policy">3.2.3 定义预设政策 (policy)<a class="headerlink" href="#323-policy" title="Permanent link">&para;</a></h4>
<p>假设你对于内部的使用者有信心的话，那么 filter 内的 INPUT 链方面可以定义的比较严格一点，而 FORWARD 与 OUTPUT 则可以宽松一点。</p>
<div class="codehilite"><pre><span></span><code><span class="n">iptables</span> <span class="p">[</span><span class="o">-</span><span class="n">t</span> <span class="n">nat</span><span class="p">]</span> <span class="o">-</span><span class="n">P</span> <span class="p">[</span><span class="k">INPUT</span><span class="p">,</span><span class="k">OUTPUT</span><span class="p">,</span><span class="k">FORWARD</span><span class="p">]</span> <span class="p">[</span><span class="n">ACCEPT</span><span class="p">,</span><span class="k">DROP</span><span class="p">]</span>

    <span class="o">-</span><span class="n">P</span> <span class="err">：定义政策</span><span class="p">(</span> <span class="n">Policy</span> <span class="p">)</span><span class="err">。</span>
    <span class="n">ACCEPT</span> <span class="err">：该包可接受</span>
    <span class="k">DROP</span>   <span class="err">：该包直接丢弃，不会让</span> <span class="n">client</span> <span class="err">端知道为何被丢弃。</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">root@sink:~# iptables -P INPUT DROP</span>
<span class="err">root@sink:~# iptables -L</span>
<span class="err">Chain INPUT (policy DROP)</span>
<span class="err">……</span>
</code></pre></div>


<h4 id="324">3.2.4 规则的制定<a class="headerlink" href="#324" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">iptables</span> <span class="o">-</span><span class="n">AI</span> <span class="err">链</span> <span class="p">[</span><span class="o">-</span><span class="n">io</span> <span class="err">网络接口</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="err">来源</span> <span class="n">IP</span><span class="o">/</span><span class="err">网域</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">p</span> <span class="n">tcp</span><span class="p">,</span><span class="n">udp</span> <span class="p">[</span><span class="c1">--sport 端口范围] [-d 目标 IP/网域] [--dport 端口范围] [--syn]] -j [ACCEPT|DROP|REJECT|LOG]</span>

    <span class="o">-</span><span class="n">A</span>  <span class="err">在最后面新增一条规则</span>
    <span class="o">-</span><span class="n">I</span> <span class="n">num</span>  <span class="err">若没有指定顺序，则插入变成第一条规则</span>
    <span class="o">-</span><span class="n">i</span>  <span class="err">包进入的网口，例如</span> <span class="n">eth0</span><span class="err">；需要与</span> <span class="k">INPUT</span> <span class="err">配合</span>
    <span class="o">-</span><span class="n">o</span>  
    <span class="o">-</span><span class="n">p</span>  <span class="err">指定规则针对的协议类型。可以使用</span><span class="ss">&quot;all&quot;</span>
    <span class="o">-</span><span class="n">s</span>  <span class="err">来源</span> <span class="n">IP</span><span class="o">/</span><span class="err">网域，格式为“</span><span class="n">address</span><span class="p">[</span><span class="o">/</span><span class="n">mask</span><span class="p">][...]</span><span class="err">”</span>
    <span class="o">-</span><span class="n">d</span>  
    <span class="o">-</span><span class="n">j</span>  <span class="err">动作。</span><span class="n">LOG</span><span class="err">：仅仅记录到</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">messages</span> <span class="err">中，不进行对比。</span>
    <span class="c1">--syn 主动联机旗标，与 -p tcp 联用，表示针对该旗标的联机定制规则</span>

<span class="err">其中</span> <span class="n">i</span><span class="err">，</span><span class="n">o</span><span class="err">，</span><span class="n">s</span><span class="err">，</span><span class="n">d</span><span class="err">，</span><span class="n">p</span> <span class="err">选项的参数前面都是可以加前缀</span><span class="ss">&quot;!&quot;</span><span class="err">的，表示相反的意思。若设置的时候没有指定某个参数，表示该参数完全接受！</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1"># 将 lo 设置为信任网口</span>
root@sink:~# iptables -A INPUT -i lo -j ACCEPT
root@sink:~# iptables -L INPUT
Chain INPUT <span class="o">(</span>policy ACCEPT<span class="o">)</span>
target     prot opt <span class="nb">source</span>               destination         
ACCEPT     all  --  anywhere             anywhere
</code></pre></div>


<p>一般来说， client 端启用的 port 都是大于 1024 以上的端口， 而 server 端则是启用小于 1023 以下的端口在监听的。 所以我们可以让来自远程的小于 1023 以下的端口数据的主动联机都给他丢弃（但不适用于 FTP 的主动联机中）：</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># 将来自任何地方来源 port 1:1023 的主动联机到本机端的 1:1023 联机丢弃</span>
<span class="o">[</span>root@router ~<span class="o">]</span><span class="c1"># iptables -i ens33 -A INPUT -p tcp --sport 1:1023 --dport 1:1023 --syn -j DROP</span>
</code></pre></div>


<h4 id="325-icmp-ping">3.2.5 ICMP 封包规则的比对： 针对是否响应 ping 来设计<a class="headerlink" href="#325-icmp-ping" title="Permanent link">&para;</a></h4>
<p>ICMP 的类型相当的多， 而且很多 ICMP 封包的类型都是为了要用来进行网络检测用的！ 所以最好不要将所有的 ICMP 封包都丢弃 。</p>
<div class="codehilite"><pre><span></span><code><span class="err">iptables -AI 链 [-io 网络接口] [-s 来源 IP/网域] [-p icmp [--icmp-type 类型]] -j [ACCEPT|DROP|REJECT|LOG]</span>
</code></pre></div>


<p>如果不是做为路由器的主机时，通常我们会把 ICMP type 8 (echo request) 拿掉而已，让远程主机不知道我们是否存在，也不会接受 ping 的响应：</p>
<div class="codehilite"><pre><span></span><code><span class="err">[root@router ~]# iptables -A INPUT -p icmp --icmp-type 8 -j DROP</span>
</code></pre></div>


<h4 id="326-iptables-mac-state">3.2.6 iptables 外挂模块： mac 与 state<a class="headerlink" href="#326-iptables-mac-state" title="Permanent link">&para;</a></h4>
<p>模块查询：<code>man iptables-extensions</code></p>
<div class="codehilite"><pre><span></span><code><span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="k">INPUT</span> <span class="p">[</span><span class="o">-</span><span class="n">m</span> <span class="k">state</span><span class="p">]</span> <span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="p">[</span><span class="c1">--state 状态] [-j ACCEPT|DROP|REJECT|LOG]</span>

    <span class="o">-</span><span class="n">m</span> <span class="err">：</span> <span class="err">一些</span> <span class="n">iptables</span> <span class="err">的外挂模块，</span> <span class="err">主要常见的有：</span>
        <span class="k">state</span> <span class="err">：</span> <span class="err">状态模块</span>
    <span class="c1">--state ： 一些封包的状态， 主要有：</span>
        <span class="n">INVALID</span> <span class="err">：</span> <span class="err">无效的封包，</span> <span class="err">例如数据破损的封包状态</span>
        <span class="n">ESTABLISHED</span><span class="err">：</span> <span class="err">已经联机成功的联机状态；</span>
        <span class="k">NEW</span> <span class="err">：</span> <span class="err">想要新建立联机的封包状态；</span>
        <span class="n">RELATED</span> <span class="err">：</span> <span class="err">这个最常用！</span> <span class="err">表示这个封包是与我们主机发送出去的封包有关</span>
</code></pre></div>


<p>如果你想要联机到远程主机的 port 22 时， 你必须要针对两条规则来设定： </p>
<ul>
<li>本机端的 1024:65535 到远程的 port 22 必须要放行 (OUTPUT 链)；</li>
<li>远程主机 port 22 到本机的 1024:65535 必须放行 (INPUT 链)； </li>
</ul>
<p>当主机比较多时，会变得很麻烦！那如果开启全部的 port 22 呢？ 又担心某些恶意主机会主动以 port 22 联机到你的机器上！ </p>
<p>好在 iptables 可以透过一个状态模块来分析 <em>这个想要进入的封包是否为刚刚我发出去的响应？</em>如果是刚刚我发出去的响应， 那么就可以予以接受放行：</p>
<div class="codehilite"><pre><span></span><code><span class="err">[root@router ~]# iptables -A INPUT -m state --stat INVALID -j DROP</span>
<span class="err">[root@router ~]# iptables -L</span>
<span class="err">Chain INPUT (policy DROP)</span>
<span class="err">target     prot opt source               destination</span>
<span class="err">ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:ssh</span>
<span class="err">DROP       tcp  --  anywhere             anywhere             tcp spts:tcpmux:1023 dpts:tcpmux:1023 flags:FIN,SYN,RST,ACK/SYN</span>
<span class="err">ACCEPT     all  --  anywhere             anywhere             state RELATED,ESTABLISHED</span>
<span class="err">DROP       all  --  anywhere             anywhere             state INVALID</span>
</code></pre></div>


<p>下面是针对一个MAC地址的模块：</p>
<div class="codehilite"><pre><span></span><code><span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="k">INPUT</span> <span class="p">[</span><span class="o">-</span><span class="n">m</span> <span class="n">mac</span><span class="p">]</span> <span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="p">[</span><span class="c1">--mac-source MAC地址] [-j ACCEPT|DROP|REJECT|LOG]</span>

    <span class="n">mac</span> <span class="err">：</span> <span class="err">网络卡硬件地址</span> <span class="p">(</span><span class="n">hardware</span> <span class="n">address</span><span class="p">)</span><span class="err">模块</span>
</code></pre></div>


<p>MAC 是不能跨路由的， 因此在局域网内才有效。</p>
<h3 id="33">3.3 超简单客户端防火墙设计与防火墙规则储存<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<p>如果站在客户端且不提供网络服务的 Linux 本机角度时，理论上，应该要有的规则如下：</p>
<ol>
<li>规则归零： 清除所有已经存在的规则 (iptables -F...)</li>
<li>预设政策： 除了 INPUT 这个自定义链设为 DROP 外，其他为预设 ACCEPT；</li>
<li>信任本机： 由于 lo 对本机来说是相当重要的，因此 lo 必须设定为信任设备；</li>
<li>回应封包： 让本机主动向外要求而响应的封包可以进入本机 (ESTABLISHED,RELATED)；</li>
<li>信任用户： 这是非必要的，如果你想要让区网的来源可用你的主机资源时。</li>
</ol>
<p>CentOS6 对防火墙规则的存储：</p>
<p>你这次修改的各种设定想要在下次开机还保存， 那就得要进行<code>/etc/init.d/iptables save</code>这个指令加参数。 或者直接去修改 <code>/etc/sysconfig/iptables</code>  。当然还可以将执行的命令保存在脚本中。</p>
<p>CentOS7 对防火墙规则的存储：</p>
<p>//TODO</p>
<p>指定好规则之后一定要<strong>测试</strong>！！！</p>
<h2 id="4-ipv4">4. IPv4 的内核管理功能<a class="headerlink" href="#4-ipv4" title="Permanent link">&para;</a></h2>
<p>除了 iptables 这个防火墙软件之外， 其实咱们 Linux kernel 提供很多内核预设的攻击抵挡机制喔！由于是内核的网络功能，所以相关的设定数据都是放置在 <code>/proc/sys/net/ipv4/</code> 这个目录当中。 至于该目录下各个文件的详细资料，可以参考核心的说明文件 (你得要先安装 <code>kernel-doc</code> 软件)： </p>
<p><code>/usr/share/doc/kernel-doc-3.10.0/Documentation/networking/ip-sysctl.txt</code></p>
<p>下面介绍几个简单的。</p>
<ul>
<li>
<p>/proc/sys/net/ipv4/tcp_syncookies</p>
<p>阻断式服务 (DoS) 攻击法当中的一种方式，就是利用 TCP 封包的 SYN 三向交握原理所达成的，这种方式称为 SYN Flooding 。 </p>
<p>SYN Cookie 模块可以预防这种攻击，它在系统用来启动随机联机的端口 (1024:65535) 即将用完时自动启动。主机在发送 SYN/ACK 确认封包前， 会要求 Client 端在短时间内回复一个序号， 这个序号包含许多原本 SYN 封包内的信息， 包括 IP、 port 等。 若Client 端可以回复正确的序号， 那么主机就确定该封包为可信的， 因此会发送 SYN/ACK 封包， 否则就不理会此封包。 </p>
<p>但是这个设定值由于违反 TCP 的三次握手 ，所以可能会造成某些服务的延迟现象。不适合用在负载已经很高的服务器，因为负载太高的主机有时会让核心误判遭受 SYN Flooding 的攻击。如果是为了系统的 TCP 封包联机优化， 则可以参考 tcp_max_syn_backlog, tcp_synack_retries, tcp_abort_on_overflow 这几个设定值。</p>
</li>
<li>
<p>/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts</p>
<p>我们知道系统其实可以接受使用 ping 的响应，而 ping 的封包数据量是可以给很大的！如果有个搞破坏的人使用 1000 台主机传送 ping 给你的主机， 而且每个 ping 都高达数百 K bytes时， 你的网络带宽会被吃光， 要嘛可能系统会宕机！ 这种方式分别被称为 ping flooding (不断发 ping) 及 ping of death (发送大的 ping 封包)。  </p>
<p>避免的方式是取消 ICMP 类型 8 的 ICMP 封包回应。除了防火墙可以做到这点之外，内核也可以达到效果。不过你必须要了解， 某些局域网络内常见的服务 (例如动态 IP 分配 DHCP 协议) 会使用 ping 的方式来侦测是否有重复的 IP ， 所以你最好不要取消所有的 ping 响应比较好。</p>
</li>
<li>
<p>/proc/sys/net/ipv4/conf/网络接口/* </p>
<p>针对不同的网络接口进行不一样的参数设定。</p>
<ul>
<li>rp_filter：逆向路径过滤 (Reverse Path Filtering) 。可以通过分析网络接口的路由信息配合封包的来源地址， 来分析该封包是否合理。 </li>
<li>log_martians： 这个设定数据可以用来启动记录不合法的 IP 来源 。例如来源为 0.0.0.0、127.x.x.x、及 Class E 的 IP 来源， 因为这些来源的 IP 不应该应用于 Internet 啊。 记录在<code>/var/log/messages</code>中。</li>
<li>accept_redirects：接受 ICMP 重定向消息。建议关闭。</li>
<li>send_redirects： 发送 ICMP 重定向消息。建议关闭。</li>
</ul>
</li>
</ul>
<p>以上这些内核提供的功能都建议使用<code>sysctl</code>来修改保存！</p>
<h2 id="5-nat">5. NAT 服务器的设定<a class="headerlink" href="#5-nat" title="Permanent link">&para;</a></h2>
<p>NAT（Network Address Translation）：网络地址转换。</p>
<p>NAT 服务器与路由器有啥不同？基本上，NAT 服务器一定是路由器，不过， NAT 服务器由于会修改 IP 表头数据， 因此与单纯转递封包的路由器不同。最常见的 IP 分享器就是一个路由器，但是这个 IP 分享器一定会有一个 Public IP 与一个 Private IP，让 LAN 内的 Private IP 可以透过 IP 分享器的 Public IP 传送出去喔！ 至于路由器通常两边都是 Public IP 或同时为 Private IP。</p>
<p>根据上图 iptables 表与链的关系，若内部 LAN 有任何一部主机想要传送封包出去时，它的流程是这样的：</p>
<ol>
<li>先经过 NAT table 的 PREROUTING 链；</li>
<li>经由路由判断确定这个封包是要进入本机与否，若不进入本机，则下一步；</li>
<li>再经过 Filter table 的 FORWARD 链；</li>
<li>通过 NAT table 的 POSTROUTING 链，最后传送出去。</li>
</ol>
<p>PREROUTING 则在修改目标 IP ， POSTROUTING 在修改来源 IP 。 由于修改的 IP 不一样，所以就称为来源 NAT (Source NAT, <code>SNAT</code>) 及目标 NAT (Destination NAT, <code>DNAT</code>)。</p>
<p>关于 SNAT 与 DNAT 的详细解释参考《鸟哥的linux私房菜-服务器篇》网页版喽：http://cn.linux.vbird.org/linux_server/0250simple_firewall_5.php，下面简要说明以下原理。</p>
<h3 id="51-snat">5.1 SNAT<a class="headerlink" href="#51-snat" title="Permanent link">&para;</a></h3>
<p>主要针对的是内部局域网的 PC 连网情况。</p>
<ol>
<li>NAT 服务器的 POSTROUTING 链将内部 PC 发送包的 源IP 改成 NAT 服务器的 public IP，然后记录一些数据到内存中；</li>
<li>internet 的主机返回相应给 NAT 服务器后，NAT 服务器会分析网络包的序号，并与内存数据作对比，对比成功后在 PREROUTING 链会将 目的IP 改成内部 PC 的IP，然后经过路由分析之后继续向下流通，最终到达内部 PC。</li>
</ol>
<h3 id="52-dnat">5.2 DNAT<a class="headerlink" href="#52-dnat" title="Permanent link">&para;</a></h3>
<p>主要针对的是外部 Internet 访问搭建的服务器的情况，例如非军事区 DMZ 内的服务器。</p>
<ol>
<li>internet 将请求发送到NAT 服务器的 public IP ；</li>
<li>NAT 服务器通过预设的端口分析规则，由 PREROUTING 链将包的 目的IP 改成对应内部服务器的 IP，并在内存记录一些信息，等待内部服务器的响应；</li>
<li>包在经过路由分析之后到达了内部服务器，内部服务器响应发送响应包；</li>
<li>NAT 服务器通过对比内存中的记录，在  POSTROUTING 链中将 源IP 改成 public IP，再发送到 internet。</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>通过上述解释知道，凡是在 NAT 服务器中需要修改的包，只要是出去的包都是通过 POSTROUTING 链修改；只要是进来的包都是通过 PREROUTING 链修改。</p>
</div>
<h3 id="53">5.3 设置<a class="headerlink" href="#53" title="Permanent link">&para;</a></h3>
<h4 id="531-snat">5.3.1 SNAT 设置<a class="headerlink" href="#531-snat" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">iptables</span> <span class="o">-</span><span class="n">t</span> <span class="n">nat</span> <span class="o">-</span><span class="n">A</span><span class="o">|-</span><span class="n">I</span> <span class="n">POSTROUTING</span> <span class="o">-</span><span class="n">s</span> <span class="err">网段</span> <span class="o">-</span><span class="n">o</span> <span class="err">网卡</span> <span class="o">-</span><span class="n">j</span> <span class="n">MASQUERADE</span><span class="o">|</span><span class="p">(</span><span class="n">SNAT</span> <span class="c1">--to-source [ipaddr[-ipaddr]][:port[-port]])</span>

    <span class="err">网段：你要修改掉的网段</span>
    <span class="err">网卡：你要伪装的</span><span class="n">IP所在的网卡</span>
    <span class="n">MASQUERADE</span><span class="err">：</span><span class="n">IP</span> <span class="err">伪装成为封包出去</span> <span class="p">(</span><span class="o">-</span><span class="n">o</span><span class="p">)</span> <span class="err">的那块网卡上的</span> <span class="n">IP</span><span class="err">，适用于</span> <span class="n">NAT</span> <span class="err">服务器的</span><span class="k">Public</span> <span class="n">IP是动态IP</span><span class="err">。只能应用于</span> <span class="n">nat</span> <span class="err">表的</span> <span class="n">POSTROUTING</span> <span class="err">链</span>
    <span class="n">SNAT</span><span class="err">：与</span><span class="n">MASQUERADE相同</span><span class="err">，但是适用于静态</span><span class="n">IP的情况</span><span class="err">。只能应用于</span> <span class="n">nat</span> <span class="err">表的</span> <span class="n">POSTROUTING</span><span class="err">、</span><span class="k">INPUT</span> <span class="err">链</span>
    <span class="c1">--to-source：与 SNAT 联用，指定静态IP</span>
</code></pre></div>


<p>若根据《路由与路由器》中的 <em>Linux 静态路由</em> 小节的拓扑来看，那么可以在 Router 上这样设置 SNAT：</p>
<div class="codehilite"><pre><span></span><code><span class="err">[root@router ~]# iptables -t nat -A POSTROUTING -s 192.168.50.0/24 -o ens33 -j MASQUERADE</span>
</code></pre></div>


<p>或者这样设置：</p>
<div class="codehilite"><pre><span></span><code><span class="err">[root@router ~]# iptables -t nat -A POSTROUTING -s 192.168.50.0/24 -o ens33 -j SNAT --to-source 192.168.1.20</span>
</code></pre></div>


<p>若 NAT 服务器对外 IP 有好几个，想要轮流使用不同的 IP 时：</p>
<div class="codehilite"><pre><span></span><code><span class="err">[root@router ~]# iptables -t nat -A POSTROUTING -s 192.168.50.0/24 -o ens33 -j SNAT --to-source 192.168.1.20-192.168.1.30</span>
</code></pre></div>


<p>不过，除非你使用的是固定 IP ，且有多个 IP 可以对外联机，否则一般使用 IP 伪装即可，不需要使用到这个 SNAT 啦！</p>
<h4 id="532-dnat">5.3.2 DNAT 设置<a class="headerlink" href="#532-dnat" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">iptables</span> <span class="o">-</span><span class="n">t</span> <span class="n">nat</span> <span class="o">-</span><span class="n">A</span><span class="o">|-</span><span class="n">I</span> <span class="n">PREROUTING</span> <span class="o">-</span><span class="n">p</span> <span class="err">协议</span> <span class="c1">--dport 端口 -i 网卡 -j DNAT --to-destination [ipaddr[-ipaddr]][:port[-port]]</span>

    <span class="n">DNAT</span><span class="err">：只能应用于</span> <span class="n">nat</span> <span class="err">表的</span> <span class="n">PREROUTING</span><span class="err">、</span><span class="k">OUTPUT</span> <span class="err">链</span>
</code></pre></div>


<h3 id="54">5.4 其他设置<a class="headerlink" href="#54" title="Permanent link">&para;</a></h3>
<h4 id="541">5.4.1 重定向设置<a class="headerlink" href="#541" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="n">j</span> <span class="n">REDIRECT</span> <span class="c1">--to-ports port[-port]</span>

    <span class="n">REDIRECT</span><span class="err">：它将数据包重定向到计算机本身，将目标</span> <span class="n">IP</span> <span class="err">更改为传入接口的主地址。只能应用于</span> <span class="n">nat</span> <span class="err">表的</span> <span class="n">PREROUTING</span><span class="err">、</span><span class="k">OUTPUT</span> <span class="err">链</span>
</code></pre></div>


<p>最常见的使用场景是在本机上进行端口转换。</p>
<h2 id="6-iptables">6. iptables 的额外内核模块功能<a class="headerlink" href="#6-iptables" title="Permanent link">&para;</a></h2>
<p>iptables 提供很多模块，这些模块可以辅助封包的过滤用途，让我们可以节省很多 iptables 规则的制定。后续会详细的说明这部分内容。// TODO</p>
<h2 id="7">7. 单机防火墙的一个实例<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<p><img alt="一个局域网络的路由器架构示意图" src="../img/%E4%B8%80%E4%B8%AA%E5%B1%80%E5%9F%9F%E7%BD%91%E7%BB%9C%E7%9A%84%E8%B7%AF%E7%94%B1%E5%99%A8%E6%9E%B6%E6%9E%84%E7%A4%BA%E6%84%8F%E5%9B%BE.gif" /></p>
<p>最重要的防火墙政策是：<strong>关闭所有的联机，仅开放特定的服务</strong>。而且假设内部使用者已经受过良好的训练，因此在 filter table 的三条链个预设政策是：</p>
<ul>
<li>INPUT 为 DROP</li>
<li>OUTPUT 及 FORWARD 为 ACCEPT</li>
</ul>
<p>这样的规划是很不合格的， 因为你不能保证内部所有的人都可以<strong>按照你的规定来使用 Network</strong> ！</p>
<p>鸟哥底下预计提供的防火墙流程是这样的：</p>
<p><img alt="本机的防火墙规则流程示意图" src="../img/%E6%9C%AC%E6%9C%BA%E7%9A%84%E9%98%B2%E7%81%AB%E5%A2%99%E8%A7%84%E5%88%99%E6%B5%81%E7%A8%8B%E7%A4%BA%E6%84%8F%E5%9B%BE.png" /></p>
<h3 id="71">7.1 脚本<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<p>鸟哥将整个 script 拆成三部分，分别是：</p>
<ul>
<li>iptables.rule：设定最基本的规则，包括清除防火墙规则、加载模块、设定服务可接受等；</li>
<li>iptables.deny：设定抵挡某些恶意主机的进入；</li>
<li>iptables.allow：设定允许某些自定义的后门来源主机！</li>
</ul>
<p>注意，这是CentOS6版本的脚本：</p>
<p>iptables.rule</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># 请先输入您的相关参数，不要输入错误了！</span>
  <span class="nv">EXTIF</span><span class="o">=</span><span class="s2">&quot;eth0&quot;</span>             <span class="c1"># 这个是可以连上 Public IP 的网络接口</span>
  <span class="nv">INIF</span><span class="o">=</span><span class="s2">&quot;eth1&quot;</span>              <span class="c1"># 内部 LAN 的连接接口；若无则写成 INIF=&quot;&quot;</span>
  <span class="nv">INNET</span><span class="o">=</span><span class="s2">&quot;192.168.100.0/24&quot;</span> <span class="c1"># 若无内部网域接口，请填写成 INNET=&quot;&quot;</span>
  <span class="si">${</span><span class="nv">iptables_scripts_dir</span><span class="si">}</span> <span class="o">=</span> /usr/local/virus/iptables/
  <span class="nb">export</span> EXTIF INIF INNET

<span class="c1"># 第一部份，针对本机的防火墙设定！##########################################</span>
<span class="c1"># 1. 先设定好核心的网络功能：</span>
  <span class="nb">echo</span> <span class="s2">&quot;1&quot;</span> &gt; /proc/sys/net/ipv4/tcp_syncookies
  <span class="nb">echo</span> <span class="s2">&quot;1&quot;</span> &gt; /proc/sys/net/ipv4/icmp_echo_ignore_broadcasts
  <span class="k">for</span> i in /proc/sys/net/ipv4/conf/*/<span class="o">{</span>rp_filter,log_martians<span class="o">}</span><span class="p">;</span> <span class="k">do</span>
        <span class="nb">echo</span> <span class="s2">&quot;1&quot;</span> &gt; <span class="nv">$i</span>
  <span class="k">done</span>
  <span class="k">for</span> i in /proc/sys/net/ipv4/conf/*/<span class="o">{</span>accept_source_route,accept_redirects,send_redirects<span class="o">}</span><span class="p">;</span> <span class="k">do</span>
        <span class="nb">echo</span> <span class="s2">&quot;0&quot;</span> &gt; <span class="nv">$i</span>
  <span class="k">done</span>

<span class="c1"># 2. 清除规则、设定默认政策及开放 lo 与相关的设定值</span>
  <span class="nv">PATH</span><span class="o">=</span>/sbin:/usr/sbin:/bin:/usr/bin:/usr/local/sbin:/usr/local/bin<span class="p">;</span> <span class="nb">export</span> PATH
  iptables -F
  iptables -X
  iptables -Z
  iptables -P INPUT   DROP
  iptables -P OUTPUT  ACCEPT
  iptables -P FORWARD ACCEPT
  iptables -A INPUT -i lo -j ACCEPT
  iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT

<span class="c1"># 3. 启动额外的防火墙 script 模块</span>
  <span class="k">if</span> <span class="o">[</span> -f <span class="si">${</span><span class="nv">iptables_scripts_dir</span><span class="si">}</span>iptables.deny <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        sh <span class="si">${</span><span class="nv">iptables_scripts_dir</span><span class="si">}</span>iptables.deny
  <span class="k">fi</span>
  <span class="k">if</span> <span class="o">[</span> -f <span class="si">${</span><span class="nv">iptables_scripts_dir</span><span class="si">}</span>ipbles.allow <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        sh <span class="si">${</span><span class="nv">iptables_scripts_dir</span><span class="si">}</span>iptables.allow
  <span class="k">fi</span>
  <span class="k">if</span> <span class="o">[</span> -f <span class="si">${</span><span class="nv">iptables_scripts_dir</span><span class="si">}</span>iptables.http <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        sh <span class="si">${</span><span class="nv">iptables_scripts_dir</span><span class="si">}</span>iptables.http
  <span class="k">fi</span>

<span class="c1"># 4. 允许某些类型的 ICMP 封包进入</span>
  <span class="nv">AICMP</span><span class="o">=</span><span class="s2">&quot;0 3 3/4 4 11 12 14 16 18&quot;</span>
  <span class="k">for</span> tyicmp in <span class="nv">$AICMP</span>
  <span class="k">do</span>
    iptables -A INPUT -i <span class="nv">$EXTIF</span> -p icmp --icmp-type <span class="nv">$tyicmp</span> -j ACCEPT
  <span class="k">done</span>

<span class="c1"># 5. 允许某些服务的进入，请依照你自己的环境开启</span>
<span class="c1"># iptables -A INPUT -p TCP -i $EXTIF --dport  21 --sport 1024:65534 -j ACCEPT # FTP</span>
<span class="c1"># iptables -A INPUT -p TCP -i $EXTIF --dport  22 --sport 1024:65534 -j ACCEPT # SSH</span>
<span class="c1"># iptables -A INPUT -p TCP -i $EXTIF --dport  25 --sport 1024:65534 -j ACCEPT # SMTP</span>
<span class="c1"># iptables -A INPUT -p UDP -i $EXTIF --dport  53 --sport 1024:65534 -j ACCEPT # DNS</span>
<span class="c1"># iptables -A INPUT -p TCP -i $EXTIF --dport  53 --sport 1024:65534 -j ACCEPT # DNS</span>
<span class="c1"># iptables -A INPUT -p TCP -i $EXTIF --dport  80 --sport 1024:65534 -j ACCEPT # WWW</span>
<span class="c1"># iptables -A INPUT -p TCP -i $EXTIF --dport 110 --sport 1024:65534 -j ACCEPT # POP3</span>
<span class="c1"># iptables -A INPUT -p TCP -i $EXTIF --dport 443 --sport 1024:65534 -j ACCEPT # HTTPS</span>


<span class="c1"># 第二部份，针对后端主机的防火墙设定！###############################</span>
<span class="c1"># 1. 先加载一些有用的模块</span>
  <span class="nv">modules</span><span class="o">=</span><span class="s2">&quot;ip_tables iptable_nat ip_nat_ftp ip_nat_irc ip_conntrack ip_conntrack_ftp ip_conntrack_irc&quot;</span>
  <span class="k">for</span> mod in <span class="nv">$modules</span>
  <span class="k">do</span>
      <span class="nv">testmod</span><span class="o">=</span><span class="sb">`</span>lsmod <span class="p">|</span> grep <span class="s2">&quot;^</span><span class="si">${</span><span class="nv">mod</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span><span class="sb">`</span>
      <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$testmod</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
            modprobe <span class="nv">$mod</span>
      <span class="k">fi</span>
  <span class="k">done</span>

<span class="c1"># 2. 清除 NAT table 的规则吧！</span>
  iptables -F -t nat
  iptables -X -t nat
  iptables -Z -t nat
  iptables -t nat -P PREROUTING  ACCEPT
  iptables -t nat -P POSTROUTING ACCEPT
  iptables -t nat -P OUTPUT      ACCEPT

<span class="c1"># 3. 若有内部接口的存在 (双网卡) 开放成为路由器，且为 IP 分享器！</span>
  <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$INIF</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    iptables -A INPUT -i <span class="nv">$INIF</span> -j ACCEPT
    <span class="nb">echo</span> <span class="s2">&quot;1&quot;</span> &gt; /proc/sys/net/ipv4/ip_forward
    <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$INNET</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="k">for</span> innet in <span class="nv">$INNET</span>
        <span class="k">do</span>
            iptables -t nat -A POSTROUTING -s <span class="nv">$innet</span> -o <span class="nv">$EXTIF</span> -j MASQUERADE
        <span class="k">done</span>
    <span class="k">fi</span>
  <span class="k">fi</span>
  <span class="c1"># 如果你的 MSN 一直无法联机，或者是某些网站 OK 某些网站不 OK，</span>
  <span class="c1"># 可能是 MTU 的问题，那你可以将底下这一行给他取消批注来启动 MTU 限制范围</span>
  <span class="c1"># iptables -A FORWARD -p tcp -m tcp --tcp-flags SYN,RST SYN -m tcpmss \</span>
  <span class="c1">#          --mss 1400:1536 -j TCPMSS --clamp-mss-to-pmtu</span>

<span class="c1"># 4. NAT 服务器后端的 LAN 内对外之服务器设定</span>
<span class="c1"># iptables -t nat -A PREROUTING -p tcp -i $EXTIF --dport 80 \</span>
<span class="c1">#          -j DNAT --to-destination 192.168.1.210:80 # WWW</span>

<span class="c1"># 5. 特殊的功能，包括 Windows 远程桌面所产生的规则，假设桌面主机为 1.2.3.4</span>
<span class="c1"># iptables -t nat -A PREROUTING -p tcp -s 1.2.3.4  --dport 6000 \</span>
<span class="c1">#          -j DNAT --to-destination 192.168.100.10</span>
<span class="c1"># iptables -t nat -A PREROUTING -p tcp -s 1.2.3.4  --sport 3389 \</span>
<span class="c1">#          -j DNAT --to-destination 192.168.100.20</span>

<span class="c1"># 6. 最终将这些功能储存下来吧！</span>
  /etc/init.d/iptables save
</code></pre></div>


<p>iptables.allow</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># 底下则填写你允许进入本机的其他网域或主机啊！</span>
  iptables -A INPUT -i <span class="nv">$EXTIF</span> -s <span class="m">140</span>.116.44.0/24 -j ACCEPT
</code></pre></div>


<p>iptables.deny</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># 底下填写的是『你要抵挡的那个咚咚！』</span>
  iptables -A INPUT -i <span class="nv">$EXTIF</span> -s <span class="m">140</span>.116.44.254 -j DROP
</code></pre></div>


<div class="codehilite"><pre><span></span><code>chmod <span class="m">700</span> iptables.*
</code></pre></div>


<p>以防万一可以写入到<code>/etc/rc.d/rc.local</code>文件中</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../07%20%E8%B7%AF%E7%94%B1%E4%B8%8E%E8%B7%AF%E7%94%B1%E5%99%A8/" title="07 路由与路由器" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                07 路由与路由器
              </span>
            </div>
          </a>
        
        
          <a href="../09%20firewall/" title="09 firewall" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                09 firewall
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../.."}})</script>
      
    
  </body>
</html>
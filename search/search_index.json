{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to Work Sink \u00b6 This is the work blog of shihr. \u4f7f\u7528 mkdocs-add-number-plugin \u4e3a\u6587\u7ae0\u76ee\u5f55\u6dfb\u52a0\u5e8f\u53f7 mkdocs Commands \u00b6 mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. mkdocs gh-deploy -r github - Deploy this blog. Project layout \u00b6 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. For full introductional documentation visit mkdocs.org .","title":"1. Home"},{"location":"#welcome-to-work-sink","text":"This is the work blog of shihr. \u4f7f\u7528 mkdocs-add-number-plugin \u4e3a\u6587\u7ae0\u76ee\u5f55\u6dfb\u52a0\u5e8f\u53f7","title":"Welcome to Work Sink"},{"location":"#mkdocs-commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. mkdocs gh-deploy -r github - Deploy this blog.","title":"mkdocs Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. For full introductional documentation visit mkdocs.org .","title":"Project layout"},{"location":"autoconf/10.%E7%BC%96%E5%86%99Autoconf%E5%AE%8F/","text":"10.1 \u5b8f\u7684\u5b9a\u4e49 \u00b6 AC_DEFUN (name, [body]) \u00b6 \u5b9a\u4e49Autoconf\u5b8f\uff0c\u7c7b\u4f3c\u4e8eM4\u7684\u5185\u7f6e\u5b8f m4_define \u3002\u4e5f\u53ef\u4ee5\u5c06\u81ea\u5df1\u7684\u5b8f\u5b9a\u4e49\u5199\u5728.m4\u6587\u4ef6\u4e2d\uff0c\u5728configure.ac\u6587\u4ef6\u4e2d\u8c03\u7528\uff08\u63a8\u8350\u505a\u6cd5\uff09\u3002 AC_DEFUN ( [ AX_PYTHON_MODULE ] , [ shell\u811a\u672c ] ) 10.4 \u5b8f\u4e4b\u95f4\u7684\u4f9d\u8d56 \u00b6 AC_REQUIRE (macro-name) \u00b6 \u81ea\u52a8\u5730\u89e3\u51b3\u5b8f\u8c03\u7528\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u4fdd\u8bc1\u4e00\u4e2a\u5b8f\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u60c5\u51b5\u4e0b\u624d\u4f1a\u88ab\u8c03\u7528\uff0c\u4e14\u53ea\u8c03\u7528\u4e00\u6b21\u3002\u53ea\u80fd\u51fa\u73b0\u5728 AC_DEFUN \u3002 AC_DEFUN ( [ TRAVOLTA ] , [ test \"$body_temperature_in_celsius\" -gt \"38\" && dance_floor=occupied ] ) AC_DEFUN ( [ NEWTON_JOHN ] , [ test \"x$hair_style\" = xcurly && dance_floor=occupied ] ) AC_DEFUN ( [ RESERVE_DANCE_FLOOR ] , [ if date | grep '^Sat.*pm' >/dev/null 2>&1; then AC_REQUIRE([TRAVOLTA ] ) AC_REQUIRE ( [ NEWTON_JOHN ] ) fi ] ) 10.5 \u5e9f\u5f03\u7684\u5b8f \u00b6 AU_ALIAS (old-name, new-name) \u00b6 \u5b8f\u7684\u91cd\u547d\u540d\u3002 AU_ALIAS ( [ AC_PYTHON_MODULE ] , [ AX_PYTHON_MODULE ] )","title":"10.\u7f16\u5199Autoconf\u5b8f"},{"location":"autoconf/10.%E7%BC%96%E5%86%99Autoconf%E5%AE%8F/#101","text":"","title":"10.1 \u5b8f\u7684\u5b9a\u4e49"},{"location":"autoconf/10.%E7%BC%96%E5%86%99Autoconf%E5%AE%8F/#ac_defun-name-body","text":"\u5b9a\u4e49Autoconf\u5b8f\uff0c\u7c7b\u4f3c\u4e8eM4\u7684\u5185\u7f6e\u5b8f m4_define \u3002\u4e5f\u53ef\u4ee5\u5c06\u81ea\u5df1\u7684\u5b8f\u5b9a\u4e49\u5199\u5728.m4\u6587\u4ef6\u4e2d\uff0c\u5728configure.ac\u6587\u4ef6\u4e2d\u8c03\u7528\uff08\u63a8\u8350\u505a\u6cd5\uff09\u3002 AC_DEFUN ( [ AX_PYTHON_MODULE ] , [ shell\u811a\u672c ] )","title":"AC_DEFUN (name, [body])"},{"location":"autoconf/10.%E7%BC%96%E5%86%99Autoconf%E5%AE%8F/#104","text":"","title":"10.4 \u5b8f\u4e4b\u95f4\u7684\u4f9d\u8d56"},{"location":"autoconf/10.%E7%BC%96%E5%86%99Autoconf%E5%AE%8F/#ac_require-macro-name","text":"\u81ea\u52a8\u5730\u89e3\u51b3\u5b8f\u8c03\u7528\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u4fdd\u8bc1\u4e00\u4e2a\u5b8f\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u60c5\u51b5\u4e0b\u624d\u4f1a\u88ab\u8c03\u7528\uff0c\u4e14\u53ea\u8c03\u7528\u4e00\u6b21\u3002\u53ea\u80fd\u51fa\u73b0\u5728 AC_DEFUN \u3002 AC_DEFUN ( [ TRAVOLTA ] , [ test \"$body_temperature_in_celsius\" -gt \"38\" && dance_floor=occupied ] ) AC_DEFUN ( [ NEWTON_JOHN ] , [ test \"x$hair_style\" = xcurly && dance_floor=occupied ] ) AC_DEFUN ( [ RESERVE_DANCE_FLOOR ] , [ if date | grep '^Sat.*pm' >/dev/null 2>&1; then AC_REQUIRE([TRAVOLTA ] ) AC_REQUIRE ( [ NEWTON_JOHN ] ) fi ] )","title":"AC_REQUIRE (macro-name)"},{"location":"autoconf/10.%E7%BC%96%E5%86%99Autoconf%E5%AE%8F/#105","text":"","title":"10.5 \u5e9f\u5f03\u7684\u5b8f"},{"location":"autoconf/10.%E7%BC%96%E5%86%99Autoconf%E5%AE%8F/#au_alias-old-name-new-name","text":"\u5b8f\u7684\u91cd\u547d\u540d\u3002 AU_ALIAS ( [ AC_PYTHON_MODULE ] , [ AX_PYTHON_MODULE ] )","title":"AU_ALIAS (old-name, new-name)"},{"location":"autoconf/11.%E4%BE%BF%E6%90%BA%E5%BC%8Fshell%E7%BC%96%E7%A8%8B/","text":"11.8 shell\u66ff\u6362 \u00b6 \u4e00\u4e9bshell\u8bed\u6cd5\u5b58\u5728\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u672c\u7ae0\u63cf\u8ff0\u600e\u4e48\u89e3\u51b3\u3002 - ${var:-value}\uff1a\u8001\u5f0f\u7684BSD shell\u3002\u731c\u60f3\u5e94\u8be5\u662f\u8d4b\u503c\u64cd\u4f5c\u3002","title":"11.\u4fbf\u643a\u5f0fshell\u7f16\u7a0b"},{"location":"autoconf/11.%E4%BE%BF%E6%90%BA%E5%BC%8Fshell%E7%BC%96%E7%A8%8B/#118-shell","text":"\u4e00\u4e9bshell\u8bed\u6cd5\u5b58\u5728\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u672c\u7ae0\u63cf\u8ff0\u600e\u4e48\u89e3\u51b3\u3002 - ${var:-value}\uff1a\u8001\u5f0f\u7684BSD shell\u3002\u731c\u60f3\u5e94\u8be5\u662f\u8d4b\u503c\u64cd\u4f5c\u3002","title":"11.8 shell\u66ff\u6362"},{"location":"autoconf/14.%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AE/","text":"\u8fd0\u884c\u6d4b\u8bd5\u7a0b\u5e8f\u4e0d\u80fd\u81ea\u52a8\u731c\u6d4b\u4e00\u5c0f\u90e8\u5206\u529f\u80fd\u3002 \u83b7\u53d6\u7cfb\u7edf\u7c7b\u578b \u00b6 \u4e0b\u9762\u7684\u8fd9\u4e9b\u5b8f\u4f7f\u7cfb\u7edf\u7c7b\u578b\u53d8\u91cf\u5bf9\u4e8econfigure\u811a\u672c\u53ef\u7528\u3002 \u5982\u679c\u4f7f\u7528\u8fd9\u4e9b\u5b8f\uff0c\u5fc5\u987b\u5c06config.guess\u4e8econfig.sub\u8ddf\u6e90\u7801\u4e00\u8d77\u53d1\u5e03\u3002 AC_CANONICAL_BUILD \u00b6 \u8ba1\u7b97\u6784\u5efa\u7cfb\u7edf\u7c7b\u578b\u53d8\u91cf build \uff0c\u53ca\u5176\u4e09\u4e2a\u79c1\u6709\u90e8\u5206 build_cpu, build_vendor, build_os \u3002 \u5982\u679c\u6307\u5b9a\u4e86\u9009\u9879 --build \uff0c\u90a3\u4e48build\u662fconfig.sub\u5bf9build_alias\u7684\u89c4\u8303\u5316\uff1b\u5426\u5219\u7531shell\u811a\u672cconfig.guess\u6307\u5b9a\u3002 AC_CANONICAL_HOST \u00b6 \u540c\u4e0a AC_CANONICAL_TARGET \u00b6 \u540c\u4e0a","title":"14.\u624b\u52a8\u914d\u7f6e"},{"location":"autoconf/14.%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AE/#_1","text":"\u4e0b\u9762\u7684\u8fd9\u4e9b\u5b8f\u4f7f\u7cfb\u7edf\u7c7b\u578b\u53d8\u91cf\u5bf9\u4e8econfigure\u811a\u672c\u53ef\u7528\u3002 \u5982\u679c\u4f7f\u7528\u8fd9\u4e9b\u5b8f\uff0c\u5fc5\u987b\u5c06config.guess\u4e8econfig.sub\u8ddf\u6e90\u7801\u4e00\u8d77\u53d1\u5e03\u3002","title":"\u83b7\u53d6\u7cfb\u7edf\u7c7b\u578b"},{"location":"autoconf/14.%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AE/#ac_canonical_build","text":"\u8ba1\u7b97\u6784\u5efa\u7cfb\u7edf\u7c7b\u578b\u53d8\u91cf build \uff0c\u53ca\u5176\u4e09\u4e2a\u79c1\u6709\u90e8\u5206 build_cpu, build_vendor, build_os \u3002 \u5982\u679c\u6307\u5b9a\u4e86\u9009\u9879 --build \uff0c\u90a3\u4e48build\u662fconfig.sub\u5bf9build_alias\u7684\u89c4\u8303\u5316\uff1b\u5426\u5219\u7531shell\u811a\u672cconfig.guess\u6307\u5b9a\u3002","title":"AC_CANONICAL_BUILD"},{"location":"autoconf/14.%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AE/#ac_canonical_host","text":"\u540c\u4e0a","title":"AC_CANONICAL_HOST"},{"location":"autoconf/14.%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AE/#ac_canonical_target","text":"\u540c\u4e0a","title":"AC_CANONICAL_TARGET"},{"location":"autoconf/15.Site%E9%85%8D%E7%BD%AE/","text":"configure\u652f\u6301\u51e0\u79cd\u672c\u5730\u7684\u914d\u7f6e\u7b56\u7565\u3002 15.2 \u4f7f\u7528\u5916\u90e8\u8f6f\u4ef6 \u00b6 AC_ARG_WITH (package, help-string, [action-if-given], [action-if-not-given]) \u00b6 \u5982\u679c\u7528\u6237\u8fd0\u884cconfigure\u7684\u65f6\u5019\u7ed9\u4e86\u9009\u9879 --with-package \u6216 --without-package \uff0c\u8fd0\u884cshell\u547d\u4ee4 action-if-given \uff0c\u6ca1\u6709\u5219\u8fd0\u884c action-if-not-given \u3002 package \u5e94\u8be5\u53ea\u7531\u5b57\u6bcd\u3001\u7834\u6298\u53f7\u3001\u52a0\u53f7\u3001\u70b9\u7ec4\u6210\u3002 --with-package \u9ed8\u8ba4\u503c\u662f yes \uff0c\u53ef\u4f20\u53c2\u7136\u540e\u901a\u8fc7 ${withval} \u83b7\u53d6\u3002 --without-package \u7b49\u4e8e --with-package=no \uff0c\u4e0d\u53ef\u5e26\u53c2\u3002 \u9009\u9879\u7684\u53c2\u6570\u53ef\u4ee5\u901a\u8fc7shell\u53d8\u91cf ${withval} \u83b7\u53d6\uff0c\u5176\u503c\u7684\u547d\u540d\u4e3a with_package \uff0c\u5176\u4e2d\u6240\u6709\u7684\u975e\u5b57\u6bcd\u7b26\u53f7\u90fd\u7528 _ \u4ee3\u66ff\u3002 AC_ARG_WITH ( [ smbios-manufacturer ] , [ AS_HELP_STRING([--with-smbios-manufacturer=NAME ] , [ SMBIOS manufacturer name @<:@default=oVirt@:>@ ] ) ] , [ SMBIOS_MANUFACTURER=\"${withval}\" ] , [ SMBIOS_MANUFACTURER=\"oVirt\" ] ) AC_SUBST ( [ SMBIOS_MANUFACTURER ] ) # \u4e00\u5b9a\u8981\u6ce8\u518c\u4e00\u4e0b \uff0c \u624d\u80fd\u7ed9automake\u4f7f\u7528 configure\u5bf9\u5e94\u7684\u8bed\u53e5 # Check whether --with-smbios-manufacturer was given. if test \" ${ with_smbios_manufacturer + set } \" = set; then : withval= $with_smbios_manufacturer ; SMBIOS_MANUFACTURER=\" ${ withval } \" else SMBIOS_MANUFACTURER=\"oVirt\" fi \u4e0eAC_ARG_ENABLE\u7684\u533a\u522b\u5728\u4e8e\u6b64\u5b8f\u7528\u4e8e\u6307\u5b9a\u7528\u6237\u81ea\u5df1\u7684\u5df2\u5b89\u88c5\u7684\u8f6f\u4ef6\uff0c\u5373\u53ef\u9009\u62e9\u81ea\u5df1\u7684\u7a0b\u5e8f\uff1b\u800cAC_ARG_ENABLE\u5219\u662f\u7c7b\u4f3c\u4e8e\u529f\u80fd\u5f00\u5173\u3002 15.3 \u9009\u62e9\u5305\u9009\u9879 \u00b6 AC_ARG_ENABLE (feature, help-string, [action-if-given], [action-if-not-given]) \u00b6 \u5982\u679c\u7528\u6237\u7ed9\u4e86configure\u9009\u9879 --enable-feature \u6216 --disable-feature \uff08--enable-feature=yes/no\uff09\uff0c\u6267\u884cshell\u547d\u4ee4 action-if-given \uff1b\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u9009\u9879\uff0c\u6267\u884c action-if-not-given \u3002 feature \u5e94\u8be5\u53ea\u7531\u5b57\u6bcd\u3001\u7834\u6298\u53f7\u3001\u52a0\u53f7\u3001\u70b9\u7ec4\u6210\u3002 \u9009\u9879\u7684\u53c2\u6570\u53ef\u4ee5\u83b7\u53d6\uff0c\u5176\u547d\u540d\u65b9\u5f0f\u4e3a with_feature \uff0c\u5176\u4e2d\u6240\u6709\u7684\u975e\u5b57\u6bcd\u7b26\u53f7\u90fd\u7528 _ \u4ee3\u66ff\u3002 help-string \u7c7b\u4f3c\u4e8e AC_ARG_WITH \uff1b\u4f60\u5e94\u8be5\u4f7f\u7528 AS_HELP_STRING \u683c\u5f0f\u5316 help-string \u3002 AC_ARG_ENABLE ( [ hooks ] , [ AS_HELP_STRING( [--enable-hooks ] , [ build hooks packages @<:@default=no@:>@ ] ) ] , , [ enable_hooks=\"no\" ] ) \u6548\u679c \uff1a ~ $ . / configure --help --enable-hooks build hooks packages [default=no] configure\u5bf9\u5e94\u7684\u8bed\u53e5 # Check whether --enable-hooks was given. if test \" ${ enable_hooks + set } \" = set; then : enableval= $enable_hooks ; else enable_hooks=\"no\" fi 15.4 \u8ba9\u5e2e\u52a9\u6587\u6863\u6f02\u4eae \u00b6 AS_HELP_STRING (left-hand-side, right-hand-side [indent-column = \u201826\u2019], [wrap-column = \u201879\u2019]) \u00b6 \u683c\u5f0f\u5316\u5e2e\u52a9\u6587\u6863\uff0c\u4f7f\u5176\u770b\u8d77\u6765\u8ddf\u5b98\u65b9\u7684\u4e00\u6837\u3002 AC_ARG_WITH ( [ foo ] , [ AS_HELP_STRING([--with-foo ] , [ use foo (default is no) ] ) ] , [ use_foo=$withval ] , [ use_foo=no ] ) Then the last few lines of \u2018 configure --help\u2019 appear like this: --enable and --with options recognized: --with-foo use foo (default is no) \u901a\u5e38 indent-column \u548c wrap-column \u4e0d\u5fc5\u6307\u5b9a\u3002","title":"15.Site\u914d\u7f6e"},{"location":"autoconf/15.Site%E9%85%8D%E7%BD%AE/#152","text":"","title":"15.2 \u4f7f\u7528\u5916\u90e8\u8f6f\u4ef6"},{"location":"autoconf/15.Site%E9%85%8D%E7%BD%AE/#ac_arg_with-package-help-string-action-if-given-action-if-not-given","text":"\u5982\u679c\u7528\u6237\u8fd0\u884cconfigure\u7684\u65f6\u5019\u7ed9\u4e86\u9009\u9879 --with-package \u6216 --without-package \uff0c\u8fd0\u884cshell\u547d\u4ee4 action-if-given \uff0c\u6ca1\u6709\u5219\u8fd0\u884c action-if-not-given \u3002 package \u5e94\u8be5\u53ea\u7531\u5b57\u6bcd\u3001\u7834\u6298\u53f7\u3001\u52a0\u53f7\u3001\u70b9\u7ec4\u6210\u3002 --with-package \u9ed8\u8ba4\u503c\u662f yes \uff0c\u53ef\u4f20\u53c2\u7136\u540e\u901a\u8fc7 ${withval} \u83b7\u53d6\u3002 --without-package \u7b49\u4e8e --with-package=no \uff0c\u4e0d\u53ef\u5e26\u53c2\u3002 \u9009\u9879\u7684\u53c2\u6570\u53ef\u4ee5\u901a\u8fc7shell\u53d8\u91cf ${withval} \u83b7\u53d6\uff0c\u5176\u503c\u7684\u547d\u540d\u4e3a with_package \uff0c\u5176\u4e2d\u6240\u6709\u7684\u975e\u5b57\u6bcd\u7b26\u53f7\u90fd\u7528 _ \u4ee3\u66ff\u3002 AC_ARG_WITH ( [ smbios-manufacturer ] , [ AS_HELP_STRING([--with-smbios-manufacturer=NAME ] , [ SMBIOS manufacturer name @<:@default=oVirt@:>@ ] ) ] , [ SMBIOS_MANUFACTURER=\"${withval}\" ] , [ SMBIOS_MANUFACTURER=\"oVirt\" ] ) AC_SUBST ( [ SMBIOS_MANUFACTURER ] ) # \u4e00\u5b9a\u8981\u6ce8\u518c\u4e00\u4e0b \uff0c \u624d\u80fd\u7ed9automake\u4f7f\u7528 configure\u5bf9\u5e94\u7684\u8bed\u53e5 # Check whether --with-smbios-manufacturer was given. if test \" ${ with_smbios_manufacturer + set } \" = set; then : withval= $with_smbios_manufacturer ; SMBIOS_MANUFACTURER=\" ${ withval } \" else SMBIOS_MANUFACTURER=\"oVirt\" fi \u4e0eAC_ARG_ENABLE\u7684\u533a\u522b\u5728\u4e8e\u6b64\u5b8f\u7528\u4e8e\u6307\u5b9a\u7528\u6237\u81ea\u5df1\u7684\u5df2\u5b89\u88c5\u7684\u8f6f\u4ef6\uff0c\u5373\u53ef\u9009\u62e9\u81ea\u5df1\u7684\u7a0b\u5e8f\uff1b\u800cAC_ARG_ENABLE\u5219\u662f\u7c7b\u4f3c\u4e8e\u529f\u80fd\u5f00\u5173\u3002","title":"AC_ARG_WITH (package, help-string, [action-if-given], [action-if-not-given])"},{"location":"autoconf/15.Site%E9%85%8D%E7%BD%AE/#153","text":"","title":"15.3 \u9009\u62e9\u5305\u9009\u9879"},{"location":"autoconf/15.Site%E9%85%8D%E7%BD%AE/#ac_arg_enable-feature-help-string-action-if-given-action-if-not-given","text":"\u5982\u679c\u7528\u6237\u7ed9\u4e86configure\u9009\u9879 --enable-feature \u6216 --disable-feature \uff08--enable-feature=yes/no\uff09\uff0c\u6267\u884cshell\u547d\u4ee4 action-if-given \uff1b\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u9009\u9879\uff0c\u6267\u884c action-if-not-given \u3002 feature \u5e94\u8be5\u53ea\u7531\u5b57\u6bcd\u3001\u7834\u6298\u53f7\u3001\u52a0\u53f7\u3001\u70b9\u7ec4\u6210\u3002 \u9009\u9879\u7684\u53c2\u6570\u53ef\u4ee5\u83b7\u53d6\uff0c\u5176\u547d\u540d\u65b9\u5f0f\u4e3a with_feature \uff0c\u5176\u4e2d\u6240\u6709\u7684\u975e\u5b57\u6bcd\u7b26\u53f7\u90fd\u7528 _ \u4ee3\u66ff\u3002 help-string \u7c7b\u4f3c\u4e8e AC_ARG_WITH \uff1b\u4f60\u5e94\u8be5\u4f7f\u7528 AS_HELP_STRING \u683c\u5f0f\u5316 help-string \u3002 AC_ARG_ENABLE ( [ hooks ] , [ AS_HELP_STRING( [--enable-hooks ] , [ build hooks packages @<:@default=no@:>@ ] ) ] , , [ enable_hooks=\"no\" ] ) \u6548\u679c \uff1a ~ $ . / configure --help --enable-hooks build hooks packages [default=no] configure\u5bf9\u5e94\u7684\u8bed\u53e5 # Check whether --enable-hooks was given. if test \" ${ enable_hooks + set } \" = set; then : enableval= $enable_hooks ; else enable_hooks=\"no\" fi","title":"AC_ARG_ENABLE (feature, help-string, [action-if-given], [action-if-not-given])"},{"location":"autoconf/15.Site%E9%85%8D%E7%BD%AE/#154","text":"","title":"15.4 \u8ba9\u5e2e\u52a9\u6587\u6863\u6f02\u4eae"},{"location":"autoconf/15.Site%E9%85%8D%E7%BD%AE/#as_help_string-left-hand-side-right-hand-side-indent-column-26-wrap-column-79","text":"\u683c\u5f0f\u5316\u5e2e\u52a9\u6587\u6863\uff0c\u4f7f\u5176\u770b\u8d77\u6765\u8ddf\u5b98\u65b9\u7684\u4e00\u6837\u3002 AC_ARG_WITH ( [ foo ] , [ AS_HELP_STRING([--with-foo ] , [ use foo (default is no) ] ) ] , [ use_foo=$withval ] , [ use_foo=no ] ) Then the last few lines of \u2018 configure --help\u2019 appear like this: --enable and --with options recognized: --with-foo use foo (default is no) \u901a\u5e38 indent-column \u548c wrap-column \u4e0d\u5fc5\u6307\u5b9a\u3002","title":"AS_HELP_STRING (left-hand-side, right-hand-side [indent-column = \u201826\u2019], [wrap-column = \u201879\u2019])"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/","text":"4.1 \u521d\u59cb\u5316 configure \u00b6 AC_INIT (package, version, [bug-report], [tarname], [url]) \u00b6 \u7b2c\u4e00\u4e2a\u8981\u6267\u884c\u7684\u5b8f\u3002\u8bbe\u7f6e\u7a0b\u5e8f\u540d\u3001\u7248\u672c\u53f7\u3001\u8054\u7cfb\u65b9\u5f0f...\u3002\u4ed6\u4eec\u90fd\u5e94\u8be5\u662f\u9759\u6001\u7684\u53c2\u6570\uff0c\u4e0d\u80fd\u662fshell\u53c2\u6570\u3001\u5f15\u7528\u6216\u8005\u65b0\u884c\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7m4\u8ba1\u7b97\u51fa\u6765\u3002 AC_INIT ( [ vdsm ] , [ m4_esyscmd([build-aux/pkg-version --version ] ) ] , [ vdsm-devel@lists.fedorahosted.org ] ) 4.2 \u89e3\u51b3Autoconf\u7684\u7248\u672c \u00b6 \u9009\u62e9\u6700\u4f4e\u7684Autoconf\u7684\u7248\u672c\u786e\u4fdd\u53ef\u4ee5\u6210\u529f\u7684\u7f16\u8bd1 configure.ac \u3002 AC_PREREQ (version) \u00b6 \u8981\u6c42Autoconf\u7684\u6700\u4f4e\u7248\u672c\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u5219\u62a5\u9519\u5e76\u9000\u51fa\u3002\u5fc5\u987b\u5728 AC_INIT \u4e4b\u524d\u5b9a\u4e49\u3002 AC_PREREQ([2.69]) 4.4 \u627e\u5230 configure \u7684\u8f93\u5165 \u00b6 AC_CONFIG_SRCDIR (unique-file-in-source-dir) \u00b6 unique-file-in-source-dir \u662f\u5305\u7684\u6e90\u7801\u76ee\u5f55\u4e0b\u7684\u67d0\u4e9b\u6587\u4ef6\u3002configure\u68c0\u67e5\u8fd9\u4e9b\u6587\u4ef6\u786e\u4fdd\u76ee\u5f55\u5305\u542b\u6e90\u7801\u3002 AC_CONFIG_AUX_DIR (dir) \u00b6 \u8f85\u52a9\u6784\u5efa\u5de5\u5177\uff08e.g., install-sh, config.sub, config.guess, Cygnus configure, Automake and Libtool scripts, etc.\uff09\u6240\u5728\u7684\u76ee\u5f55\u3002 dir \u53ef\u4ee5\u662f srcdir \u7684\u7edd\u5bf9\u6216\u76f8\u5bf9\u8def\u5f84\uff0c\u901a\u5e38\u547d\u540d\u4e3a build-aux \u3002 AC_CONFIG_AUX_DIR([build-aux]) AC_REQUIRE_AUX_FILE (file) \u00b6 \u58f0\u660e file \u5fc5\u987b\u5728\u4e0a\u8ff0\u5b9a\u4e49\u7684\u6587\u4ef6\u5939\u4e2d\u5fc5\u987b\u5b58\u5728\u3002 AC_REQUIRE_AUX_FILE([tap-driver.sh]) AC_CONFIG_MACRO_DIR (dir) \u00b6 \u6307\u5b9a dir \u4f5c\u4e3a\u989d\u5916\u7684Autoconf\u5b8f\u7684\u5b9a\u4f4d\u3002 note \uff1a\u5982\u679c\u5728Automake\u4e2d\u4f7f\u7528 aclocal \u751f\u6210 aclocal.m4 \u6587\u4ef6\uff0c\u5fc5\u987b\u5728\u9876\u7ea7\u7684Makefile.am\u6587\u4ef6\u4e2d\u8bbe\u7f6e ACLOCAL_AMFLAGS = -I dir \u3002 4.5 \u8f93\u51fa\u6587\u4ef6 \u00b6 AC_OUTPUT ([file]..., [extra-cmds], [init-cmds]) \u00b6 \u4e0d\u63a8\u8350\u4f7f\u7528\u8fd9\u4e2a\u5e9f\u5f03\u7684\u63a5\u53e3\uff0c\u7528\u4ee5\u4e0b\u4e09\u4e2a\u5b8f\u4ee3\u66ff\uff1a AC_CONFIG_FILES ( file ...) AC_CONFIG_COMMANDS ( [ default ] , extra - cmds , init - cmds ) AC_OUTPUT AC_OUTPUT \u00b6 \u751f\u6210config.status\u5e76\u542f\u52a8\u5b83\u3002configure.ac\u5e94\u8be5\u4ee5\u8c03\u7528\u6b64\u5b8f\u7ed3\u675f\u3002 config.status\u6267\u884c\u6240\u6709\u7684\u914d\u7f6e\u52a8\u4f5c\uff1a\u6240\u6709\u7684\u8f93\u51fa\u6587\u4ef6\u3001\u5934\u6587\u4ef6\u3001\u547d\u4ee4\u3001\u94fe\u63a5\u3001\u8981\u914d\u7f6e\u7684\u5b50\u76ee\u5f55 AC_PROG_MAKE_SET \u00b6 \u5982\u679cMake\u547d\u4ee4\u3001$MAKE\u88ab\u8bbe\u7f6e\u6216\u8005\u5176\u4ed6 make \uff0c\u9884\u5b9a\u4e49\u4e86 $(MAKE) \uff0c\u5b9a\u4e49\u8f93\u51fa\u53d8\u91cf SET_MAKE \u5c06\u662f\u7a7a\u503c\u3002\u5426\u5219\u5c06SET_MAKE\u5b9a\u4e49\u4e3a\u8bbe\u7f6e$(MAKE)\u7684\u5b8f\u5b9a\u4e49\u3002 4.6 \u6267\u884c\u914d\u7f6e\u52a8\u4f5c \u00b6 configure\u5b9e\u9645\u4e0a\u8fd8\u6709\u4e00\u4e2a\u9690\u85cf\u7684\u5b50\u6587\u4ef6config.status\u3002configure\u68c0\u67e5\u7cfb\u7edf\uff0cconfig.status\u57fa\u4e8e\u68c0\u67e5\u7684\u7ed3\u679c\u6267\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\u3002 4.7 \u521b\u5efa\u914d\u7f6e\u6587\u4ef6 \u00b6 AC_CONFIG_FILES (file..., [cmds], [init-cmds]) \u00b6 \u8ba9 AC_OUTPUT \u901a\u8fc7\u590d\u5236\u8f93\u5165\u6587\u4ef6\uff08\u9ed8\u8ba4\u662f file.in \u6587\u4ef6\uff09\u5e76\u4ee3\u66ff\u91cc\u9762\u7684\u53d8\u91cf\u7684\u503c\u6765\u521b\u5efa\u6bcf\u4e00\u4e2a file \u3002\u901a\u5e38\u7528\u4e8e\u751f\u6210Makefile\uff0c\u4f46\u4e5f\u53ef\u4ee5\u6307\u5b9a\u5176\u5b83\u6587\u4ef6\u3002 AC_CONFIG_FILES ( [ Makefile src/Makefile man/Makefile X/Imakefile ] ) AC_CONFIG_FILES ( [ autoconf ] , [ chmod +x autoconf ] ) \u5192\u53f7\u5206\u9694\u6307\u5b9a\u8f93\u5165\u6587\u4ef6\uff1a AC_CONFIG_FILES([Makefile:boiler/top.mk:boiler/bot.mk] [lib/Makefile:boiler/lib.mk]) 4.8 Makefile\u4e2d\u7684\u66ff\u6362 \u00b6 \u88ab\u66ff\u6362\u5230\u8f93\u51fa\u6587\u4ef6\u7684\u53d8\u91cf\u79f0\u4f5c output variables \u3002 4.8.1 \u9884\u7f6e\u8f93\u51fa\u53d8\u91cf \u00b6 CFLAGS - C\u7f16\u8bd1\u5668\u7684\u8c03\u8bd5\u548c\u4f18\u5316\u9009\u9879\u3002 builddir - \u7b49\u4e8e . \u3002 abs_builddir - builddir \u7684\u7edd\u5bf9\u540d\u79f0\u3002 top_builddir - \u5f53\u524d\u76ee\u5f55\u76f8\u5bf9\u4e8e\u9876\u7ea7\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84\u3002\u5728\u9876\u7ea7\u76ee\u5f55\u4e0e builddir \u76f8\u7b49\u3002 top_build_prefix - \u5f53\u524d\u76ee\u5f55\u76f8\u5bf9\u4e8e\u9876\u7ea7\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84\uff0c\u5e26\u6709 / \u5982\u679c\u4e0d\u4e3a\u7a7a\u3002\u5e2e\u52a9make\u5728\u9876\u7ea7\u6784\u5efa\u76ee\u5f55\u533a\u522b\u5bf9\u5f85 ./file \u548c file \u3002 abs_top_builddir - top_builddir \u7684\u7edd\u5bf9\u540d\u79f0\u3002 srcdir - \u5bf9\u4e8emakefile\u5305\u542b\u4e86\u6e90\u7801\u7684\u76ee\u5f55\u3002 abs_srcdir - srcdir \u7684\u7edd\u5bf9\u540d\u79f0\u3002 top_srcdir - \u5bf9\u4e8epackage\u5305\u542b\u4e86\u6e90\u7801\u7684\u9876\u7ea7\u76ee\u5f55\u3002\u5728\u9876\u7ea7\u76ee\u5f55\u7684\u7684configure.ac\u4e2d\u6ca1\u6709\u7528\u5904\uff0c\u662f\u7a7a\u503c\uff01\uff01\uff01\uff1b\u5728\u5b50\u76ee\u5f55\u7684configure.ac\u548cMakefile.am\u4e2d\u624d\u80fd\u53d1\u6325\u4f5c\u7528\u3002 abs_top_srcdir - \u5bf9\u4e8epackage\u5305\u542b\u4e86\u6e90\u7801\u7684\u9876\u7ea7\u76ee\u5f55\u7684\u7edd\u5bf9\u540d\u79f0\u3002 \u66f4\u591a\u8bf4\u660e\u8bf7\u53c2\u8003 Preset Output Variables \u3002 4.8.2 \u5b89\u88c5\u76ee\u5f55\u53d8\u91cf \u00b6 \u540e\u7f00 / \u88ab\u5220\u9664\uff0c\u4f8b\u5982 ${prefix}/lib \u3002 bindir - \u53ef\u6267\u884c\u6587\u4ef6\u7684\u5b89\u88c5\u76ee\u5f55\u3002 datadir - \u5b89\u88c5\u7279\u6b8a\u7684\u53ea\u8bfb\u3001\u67b6\u6784\u4f9d\u8d56\u7684\u6570\u636e\u6587\u4ef6\u76ee\u5f55\u3002 datarootdir - \u53ea\u8bfb\u67b6\u6784\u4f9d\u8d56\u6570\u636e\u6587\u4ef6\u7684\u6839\u76ee\u5f55\u3002\u901a\u5e38\u662f /usr/local/share \uff0c\u4f46\u662f\u5199\u4f5c $(prefix)/share (\u5982\u679c\u4f7f\u7528Autoconf\uff0c\u5199\u4f5c @datarootdir@ \uff0c\u5176\u4f59\u53d8\u91cf\u540c\u7406)\u3002 docdir - \u6587\u6863\u6587\u4ef6\u3002 exec_prefix - \u67b6\u6784\u4f9d\u8d56\u6587\u4ef6\u7684\u5b89\u88c5\u524d\u7f00\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0e prefix \u76f8\u540c\u3002 includedir - \u5b89\u88c5C\u7684\u5934\u6587\u4ef6 infodir - Info\u683c\u5f0f\u7684\u6587\u6863 libdir - \u5bf9\u8c61\u4ee3\u7801\u5e93\u6587\u4ef6 libexecdir - \u5176\u5b83\u7a0b\u5e8f\u8fd0\u884c\u7684\u53ef\u6267\u884c\u6587\u4ef6 mandir - man\u683c\u5f0f\u6587\u6863\u7684\u5b89\u88c5\u9876\u7ea7\u76ee\u5f55 prefix - \u6240\u6709\u6587\u4ef6\u7684\u5b89\u88c5\u524d\u7f00\u3002 sbindir - \u7cfb\u7edfadministrators\u8fd0\u884c\u7684\u53ef\u8fd0\u884c\u6587\u4ef6\u7684\u5b89\u88c5\u76ee\u5f55\u3002 \u66f4\u52a0\u8be6\u7ec6\u7684\u8bf4\u660e\u53c2\u8003 Variables for Installation Directories \u3002 4.9 \u914d\u7f6e\u5934\u6587\u4ef6 \u00b6 AC_CONFIG_HEADERS (header ..., [cmds], [init-cmds]) \u00b6 \u8ba9 AC_OUTPUT \u521b\u5efa\u4e00\u4e2a\u5934\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5217\u51fa\u4e00\u7cfb\u5217\u7684 #define \u58f0\u660e\uff1b\u8d4b\u503c DEFS=-DHAVE_CONFIG_H \u3002\u901a\u5e38\u5934\u6587\u4ef6 header \u7684\u540d\u5b57\u662f config.h \u3002 \u4e00\u822c\u8f93\u5165\u6e90\u662f header.in \uff0c\u53ef\u4ee5\u91c7\u7528\u5192\u53f7\u5206\u9694\u7b26\u6765\u6307\u5b9a\u8f93\u5165\u6765\u6e90\u3002 AC_CONFIG_HEADERS([config.h:config.hin]) 4.10 \u8fd0\u884c\u4efb\u610f\u914d\u7f6e\u547d\u4ee4 \u00b6 AC_CONFIG_COMMANDS (tag..., [cmds], [init-cmds]) \u00b6 config.status\u7ed3\u675f\u7684\u65f6\u5019\u6267\u884c\u989d\u5916\u7684\u547d\u4ee4\u3002 \u4e0b\u9762\u4e24\u4e2a\u7c7b\u4f3c\u7684\u5b8f\u662f\u7531configure\u6267\u884c\u7684\uff0c\u4e0d\u80fd\u4f7f\u7528config.status\u6765\u91cd\u65b0\u8fd0\u884c\u5b83\u4eec\u3002 AC_CONFIG_COMMANDS_PRE (cmds) \u00b6 \u521b\u5efaconfig.status\u4e4b\u524d\u6267\u884c\u3002 AC_CONFIG_COMMANDS_POST (cmds) \u00b6 \u521b\u5efaconfig.status\u4e4b\u540e\u6267\u884c\u3002","title":"4.\u521d\u59cb\u5316\u548c\u8f93\u51fa\u6587\u4ef6"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#41-configure","text":"","title":"4.1 \u521d\u59cb\u5316 configure"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_init-package-version-bug-report-tarname-url","text":"\u7b2c\u4e00\u4e2a\u8981\u6267\u884c\u7684\u5b8f\u3002\u8bbe\u7f6e\u7a0b\u5e8f\u540d\u3001\u7248\u672c\u53f7\u3001\u8054\u7cfb\u65b9\u5f0f...\u3002\u4ed6\u4eec\u90fd\u5e94\u8be5\u662f\u9759\u6001\u7684\u53c2\u6570\uff0c\u4e0d\u80fd\u662fshell\u53c2\u6570\u3001\u5f15\u7528\u6216\u8005\u65b0\u884c\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7m4\u8ba1\u7b97\u51fa\u6765\u3002 AC_INIT ( [ vdsm ] , [ m4_esyscmd([build-aux/pkg-version --version ] ) ] , [ vdsm-devel@lists.fedorahosted.org ] )","title":"AC_INIT (package, version, [bug-report], [tarname], [url])"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#42-autoconf","text":"\u9009\u62e9\u6700\u4f4e\u7684Autoconf\u7684\u7248\u672c\u786e\u4fdd\u53ef\u4ee5\u6210\u529f\u7684\u7f16\u8bd1 configure.ac \u3002","title":"4.2 \u89e3\u51b3Autoconf\u7684\u7248\u672c"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_prereq-version","text":"\u8981\u6c42Autoconf\u7684\u6700\u4f4e\u7248\u672c\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u5219\u62a5\u9519\u5e76\u9000\u51fa\u3002\u5fc5\u987b\u5728 AC_INIT \u4e4b\u524d\u5b9a\u4e49\u3002 AC_PREREQ([2.69])","title":"AC_PREREQ (version)"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#44-configure","text":"","title":"4.4 \u627e\u5230 configure \u7684\u8f93\u5165"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_config_srcdir-unique-file-in-source-dir","text":"unique-file-in-source-dir \u662f\u5305\u7684\u6e90\u7801\u76ee\u5f55\u4e0b\u7684\u67d0\u4e9b\u6587\u4ef6\u3002configure\u68c0\u67e5\u8fd9\u4e9b\u6587\u4ef6\u786e\u4fdd\u76ee\u5f55\u5305\u542b\u6e90\u7801\u3002","title":"AC_CONFIG_SRCDIR (unique-file-in-source-dir)"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_config_aux_dir-dir","text":"\u8f85\u52a9\u6784\u5efa\u5de5\u5177\uff08e.g., install-sh, config.sub, config.guess, Cygnus configure, Automake and Libtool scripts, etc.\uff09\u6240\u5728\u7684\u76ee\u5f55\u3002 dir \u53ef\u4ee5\u662f srcdir \u7684\u7edd\u5bf9\u6216\u76f8\u5bf9\u8def\u5f84\uff0c\u901a\u5e38\u547d\u540d\u4e3a build-aux \u3002 AC_CONFIG_AUX_DIR([build-aux])","title":"AC_CONFIG_AUX_DIR (dir)"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_require_aux_file-file","text":"\u58f0\u660e file \u5fc5\u987b\u5728\u4e0a\u8ff0\u5b9a\u4e49\u7684\u6587\u4ef6\u5939\u4e2d\u5fc5\u987b\u5b58\u5728\u3002 AC_REQUIRE_AUX_FILE([tap-driver.sh])","title":"AC_REQUIRE_AUX_FILE (file)"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_config_macro_dir-dir","text":"\u6307\u5b9a dir \u4f5c\u4e3a\u989d\u5916\u7684Autoconf\u5b8f\u7684\u5b9a\u4f4d\u3002 note \uff1a\u5982\u679c\u5728Automake\u4e2d\u4f7f\u7528 aclocal \u751f\u6210 aclocal.m4 \u6587\u4ef6\uff0c\u5fc5\u987b\u5728\u9876\u7ea7\u7684Makefile.am\u6587\u4ef6\u4e2d\u8bbe\u7f6e ACLOCAL_AMFLAGS = -I dir \u3002","title":"AC_CONFIG_MACRO_DIR (dir)"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#45","text":"","title":"4.5 \u8f93\u51fa\u6587\u4ef6"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_output-file-extra-cmds-init-cmds","text":"\u4e0d\u63a8\u8350\u4f7f\u7528\u8fd9\u4e2a\u5e9f\u5f03\u7684\u63a5\u53e3\uff0c\u7528\u4ee5\u4e0b\u4e09\u4e2a\u5b8f\u4ee3\u66ff\uff1a AC_CONFIG_FILES ( file ...) AC_CONFIG_COMMANDS ( [ default ] , extra - cmds , init - cmds ) AC_OUTPUT","title":"AC_OUTPUT ([file]..., [extra-cmds], [init-cmds])"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_output","text":"\u751f\u6210config.status\u5e76\u542f\u52a8\u5b83\u3002configure.ac\u5e94\u8be5\u4ee5\u8c03\u7528\u6b64\u5b8f\u7ed3\u675f\u3002 config.status\u6267\u884c\u6240\u6709\u7684\u914d\u7f6e\u52a8\u4f5c\uff1a\u6240\u6709\u7684\u8f93\u51fa\u6587\u4ef6\u3001\u5934\u6587\u4ef6\u3001\u547d\u4ee4\u3001\u94fe\u63a5\u3001\u8981\u914d\u7f6e\u7684\u5b50\u76ee\u5f55","title":"AC_OUTPUT"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_prog_make_set","text":"\u5982\u679cMake\u547d\u4ee4\u3001$MAKE\u88ab\u8bbe\u7f6e\u6216\u8005\u5176\u4ed6 make \uff0c\u9884\u5b9a\u4e49\u4e86 $(MAKE) \uff0c\u5b9a\u4e49\u8f93\u51fa\u53d8\u91cf SET_MAKE \u5c06\u662f\u7a7a\u503c\u3002\u5426\u5219\u5c06SET_MAKE\u5b9a\u4e49\u4e3a\u8bbe\u7f6e$(MAKE)\u7684\u5b8f\u5b9a\u4e49\u3002","title":"AC_PROG_MAKE_SET"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#46","text":"configure\u5b9e\u9645\u4e0a\u8fd8\u6709\u4e00\u4e2a\u9690\u85cf\u7684\u5b50\u6587\u4ef6config.status\u3002configure\u68c0\u67e5\u7cfb\u7edf\uff0cconfig.status\u57fa\u4e8e\u68c0\u67e5\u7684\u7ed3\u679c\u6267\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\u3002","title":"4.6 \u6267\u884c\u914d\u7f6e\u52a8\u4f5c"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#47","text":"","title":"4.7 \u521b\u5efa\u914d\u7f6e\u6587\u4ef6"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_config_files-file-cmds-init-cmds","text":"\u8ba9 AC_OUTPUT \u901a\u8fc7\u590d\u5236\u8f93\u5165\u6587\u4ef6\uff08\u9ed8\u8ba4\u662f file.in \u6587\u4ef6\uff09\u5e76\u4ee3\u66ff\u91cc\u9762\u7684\u53d8\u91cf\u7684\u503c\u6765\u521b\u5efa\u6bcf\u4e00\u4e2a file \u3002\u901a\u5e38\u7528\u4e8e\u751f\u6210Makefile\uff0c\u4f46\u4e5f\u53ef\u4ee5\u6307\u5b9a\u5176\u5b83\u6587\u4ef6\u3002 AC_CONFIG_FILES ( [ Makefile src/Makefile man/Makefile X/Imakefile ] ) AC_CONFIG_FILES ( [ autoconf ] , [ chmod +x autoconf ] ) \u5192\u53f7\u5206\u9694\u6307\u5b9a\u8f93\u5165\u6587\u4ef6\uff1a AC_CONFIG_FILES([Makefile:boiler/top.mk:boiler/bot.mk] [lib/Makefile:boiler/lib.mk])","title":"AC_CONFIG_FILES (file..., [cmds], [init-cmds])"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#48-makefile","text":"\u88ab\u66ff\u6362\u5230\u8f93\u51fa\u6587\u4ef6\u7684\u53d8\u91cf\u79f0\u4f5c output variables \u3002","title":"4.8 Makefile\u4e2d\u7684\u66ff\u6362"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#481","text":"CFLAGS - C\u7f16\u8bd1\u5668\u7684\u8c03\u8bd5\u548c\u4f18\u5316\u9009\u9879\u3002 builddir - \u7b49\u4e8e . \u3002 abs_builddir - builddir \u7684\u7edd\u5bf9\u540d\u79f0\u3002 top_builddir - \u5f53\u524d\u76ee\u5f55\u76f8\u5bf9\u4e8e\u9876\u7ea7\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84\u3002\u5728\u9876\u7ea7\u76ee\u5f55\u4e0e builddir \u76f8\u7b49\u3002 top_build_prefix - \u5f53\u524d\u76ee\u5f55\u76f8\u5bf9\u4e8e\u9876\u7ea7\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84\uff0c\u5e26\u6709 / \u5982\u679c\u4e0d\u4e3a\u7a7a\u3002\u5e2e\u52a9make\u5728\u9876\u7ea7\u6784\u5efa\u76ee\u5f55\u533a\u522b\u5bf9\u5f85 ./file \u548c file \u3002 abs_top_builddir - top_builddir \u7684\u7edd\u5bf9\u540d\u79f0\u3002 srcdir - \u5bf9\u4e8emakefile\u5305\u542b\u4e86\u6e90\u7801\u7684\u76ee\u5f55\u3002 abs_srcdir - srcdir \u7684\u7edd\u5bf9\u540d\u79f0\u3002 top_srcdir - \u5bf9\u4e8epackage\u5305\u542b\u4e86\u6e90\u7801\u7684\u9876\u7ea7\u76ee\u5f55\u3002\u5728\u9876\u7ea7\u76ee\u5f55\u7684\u7684configure.ac\u4e2d\u6ca1\u6709\u7528\u5904\uff0c\u662f\u7a7a\u503c\uff01\uff01\uff01\uff1b\u5728\u5b50\u76ee\u5f55\u7684configure.ac\u548cMakefile.am\u4e2d\u624d\u80fd\u53d1\u6325\u4f5c\u7528\u3002 abs_top_srcdir - \u5bf9\u4e8epackage\u5305\u542b\u4e86\u6e90\u7801\u7684\u9876\u7ea7\u76ee\u5f55\u7684\u7edd\u5bf9\u540d\u79f0\u3002 \u66f4\u591a\u8bf4\u660e\u8bf7\u53c2\u8003 Preset Output Variables \u3002","title":"4.8.1 \u9884\u7f6e\u8f93\u51fa\u53d8\u91cf"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#482","text":"\u540e\u7f00 / \u88ab\u5220\u9664\uff0c\u4f8b\u5982 ${prefix}/lib \u3002 bindir - \u53ef\u6267\u884c\u6587\u4ef6\u7684\u5b89\u88c5\u76ee\u5f55\u3002 datadir - \u5b89\u88c5\u7279\u6b8a\u7684\u53ea\u8bfb\u3001\u67b6\u6784\u4f9d\u8d56\u7684\u6570\u636e\u6587\u4ef6\u76ee\u5f55\u3002 datarootdir - \u53ea\u8bfb\u67b6\u6784\u4f9d\u8d56\u6570\u636e\u6587\u4ef6\u7684\u6839\u76ee\u5f55\u3002\u901a\u5e38\u662f /usr/local/share \uff0c\u4f46\u662f\u5199\u4f5c $(prefix)/share (\u5982\u679c\u4f7f\u7528Autoconf\uff0c\u5199\u4f5c @datarootdir@ \uff0c\u5176\u4f59\u53d8\u91cf\u540c\u7406)\u3002 docdir - \u6587\u6863\u6587\u4ef6\u3002 exec_prefix - \u67b6\u6784\u4f9d\u8d56\u6587\u4ef6\u7684\u5b89\u88c5\u524d\u7f00\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0e prefix \u76f8\u540c\u3002 includedir - \u5b89\u88c5C\u7684\u5934\u6587\u4ef6 infodir - Info\u683c\u5f0f\u7684\u6587\u6863 libdir - \u5bf9\u8c61\u4ee3\u7801\u5e93\u6587\u4ef6 libexecdir - \u5176\u5b83\u7a0b\u5e8f\u8fd0\u884c\u7684\u53ef\u6267\u884c\u6587\u4ef6 mandir - man\u683c\u5f0f\u6587\u6863\u7684\u5b89\u88c5\u9876\u7ea7\u76ee\u5f55 prefix - \u6240\u6709\u6587\u4ef6\u7684\u5b89\u88c5\u524d\u7f00\u3002 sbindir - \u7cfb\u7edfadministrators\u8fd0\u884c\u7684\u53ef\u8fd0\u884c\u6587\u4ef6\u7684\u5b89\u88c5\u76ee\u5f55\u3002 \u66f4\u52a0\u8be6\u7ec6\u7684\u8bf4\u660e\u53c2\u8003 Variables for Installation Directories \u3002","title":"4.8.2 \u5b89\u88c5\u76ee\u5f55\u53d8\u91cf"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#49","text":"","title":"4.9 \u914d\u7f6e\u5934\u6587\u4ef6"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_config_headers-header-cmds-init-cmds","text":"\u8ba9 AC_OUTPUT \u521b\u5efa\u4e00\u4e2a\u5934\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5217\u51fa\u4e00\u7cfb\u5217\u7684 #define \u58f0\u660e\uff1b\u8d4b\u503c DEFS=-DHAVE_CONFIG_H \u3002\u901a\u5e38\u5934\u6587\u4ef6 header \u7684\u540d\u5b57\u662f config.h \u3002 \u4e00\u822c\u8f93\u5165\u6e90\u662f header.in \uff0c\u53ef\u4ee5\u91c7\u7528\u5192\u53f7\u5206\u9694\u7b26\u6765\u6307\u5b9a\u8f93\u5165\u6765\u6e90\u3002 AC_CONFIG_HEADERS([config.h:config.hin])","title":"AC_CONFIG_HEADERS (header ..., [cmds], [init-cmds])"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#410","text":"","title":"4.10 \u8fd0\u884c\u4efb\u610f\u914d\u7f6e\u547d\u4ee4"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_config_commands-tag-cmds-init-cmds","text":"config.status\u7ed3\u675f\u7684\u65f6\u5019\u6267\u884c\u989d\u5916\u7684\u547d\u4ee4\u3002 \u4e0b\u9762\u4e24\u4e2a\u7c7b\u4f3c\u7684\u5b8f\u662f\u7531configure\u6267\u884c\u7684\uff0c\u4e0d\u80fd\u4f7f\u7528config.status\u6765\u91cd\u65b0\u8fd0\u884c\u5b83\u4eec\u3002","title":"AC_CONFIG_COMMANDS (tag..., [cmds], [init-cmds])"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_config_commands_pre-cmds","text":"\u521b\u5efaconfig.status\u4e4b\u524d\u6267\u884c\u3002","title":"AC_CONFIG_COMMANDS_PRE (cmds)"},{"location":"autoconf/4.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6/#ac_config_commands_post-cmds","text":"\u521b\u5efaconfig.status\u4e4b\u540e\u6267\u884c\u3002","title":"AC_CONFIG_COMMANDS_POST (cmds)"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/","text":"5.2 \u5907\u9009\u7a0b\u5e8f \u00b6 \u8fd9\u4e9b\u5b8f\u7528\u4e8e\u68c0\u67e5\u6307\u5b9a\u7a0b\u5e8f\u7684\u5b58\u5728\u6216\u8005\u884c\u4e3a\u3002\u7ecf\u5e38\u4ece\u51e0\u4e2a\u5907\u9009\u7a0b\u5e8f\u4e2d\u9009\u62e9\u4e00\u4e2a\u51fa\u6765\u3002 5.2.1 \u7279\u6b8a\u7a0b\u5e8f\u68c0\u67e5 \u00b6 AC_PROG_LN_S \u00b6 \u5982\u679c\u5f53\u524d\u6587\u4ef6\u7cfb\u7edf\u652f\u6301 ln -s \uff0c\u8bbe\u7f6e\u8f93\u51fa\u53d8\u91cf LN_S \u4e3a ln -s \uff1b\u5426\u5219\uff0c\u5982\u679c\u652f\u6301 ln \uff0c\u8bbe\u7f6e LN_S \u4e3a ln \uff0c\u5426\u5219\u8bbe\u7f6e\u4e3a cp -pR \u3002 AC_PROG_LN_S 5.2.2 \u901a\u7528\u7a0b\u5e8f\u548c\u6587\u4ef6\u68c0\u67e5 \u00b6 \u8fd9\u4e9b\u5b8f\u4e0d\u4f1a\u88ab\u7279\u5b9a\u7684\u6d4b\u8bd5\u5b8f\u6240\u8986\u76d6\u3002 \u5f3a\u70c8\u5efa\u8bae\u58f0\u660e variable \u4e3a precious variable \u3002 See AC_ARG_VAR AC_CHECK_PROG (variable, prog-to-check-for, value-if-found, [value-if-not-found], [path = \u2018$PATH\u2019], [reject]) \u00b6 \u68c0\u67e5 path \u4e2d\u662f\u5426\u5b58\u624d prog-to-check-for \u3002 variable =\u5b58\u5728 ? value-if-found : value-if-not-found \u3002\u603b\u662f\u5ffd\u89c6 reject \uff08\u4e00\u4e2a\u6587\u4ef6\u540d\u7684\u7edd\u5bf9\u8def\u5f84\uff09\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c variable = prog-to-check-for \u7684\u7edd\u5bf9\u8def\u5f84\u3002 \u8c03\u7528 AC_SUBST \u8d4b\u503c\u3002 \u6d4b\u8bd5\u7ed3\u679c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e variable \u6216\u8005 ac_cv_prog_variable \u7684\u503c\u6765\u8986\u76d6\u3002 AC_CHECK_PROGS (variable, progs-to-check-for, [value-if-not-found], [path = \u2018$PATH\u2019]) \u00b6 \u68c0\u67e5\u6bcf\u4e2a\u5728 progs-to-check-for \u4e2d\u7684\u7a0b\u5e8f\uff08\u4ee5\u7a7a\u683c\u5206\u9694\uff09\u5728 path \u4e2d\u662f\u5426\u5b58\u5728\u3002\u5982\u679c\u53d1\u73b0\u4e86\u4e00\u4e2a\uff0c\u8bbe\u7f6e variable \u7684\u503c\u4e3a\u8be5\u7a0b\u5e8f\u7684\u540d\u5b57\uff1b\u5426\u5219\u7ee7\u7eed\u67e5\u627e\u4e0b\u4e00\u4e2a\u3002\u5982\u679c\u90fd\u6ca1\u6709\u627e\u5230\uff0c\u8bbe\u503c\u4e3a value-if-not-found \uff1b\u5982\u679c\u8be5\u53c2\u6570\u6ca1\u6709\u6307\u5b9a\uff0c\u53d8\u91cf\u7684\u503c\u4e0d\u4f1a\u6539\u53d8\u3002 \u4f59\u4e0b\u7684\u8bf4\u660e\u540c\u4e0a\u3002 AC_CHECK_PROGS(FLEX,flex,none) AC_CHECK_TOOL (variable, prog-to-check-for, [value-if-not-found], [path = \u2018$PATH\u2019]) \u00b6 \u7c7b\u4f3c\u4e8e AC_CHECK_PROG \uff0c\u4f46\u662f\u9996\u5148\u67e5\u627e\u9009\u9879 --host \u6307\u5b9a\u524d\u7f00\u7684\u7a0b\u5e8f\uff0c\u4f7f\u7528 - \u8fde\u63a5\u3002 AC_CHECK_TOOL ( [ RANLIB ] , [ ranlib ] , [ : ] ) \u8fd0\u884c\u2018configure --build=x86_64-gnu --host=i386-gnu\u2019\uff1a\u9996\u5148\u67e5\u627ei386-gnu-ranlib\uff0c\u6ca1\u6709\u518d\u67e5\u627eranlib\uff0c\u5426\u5219\u5c31\u662f:\u3002 AC_CHECK_TOOLS (variable, progs-to-check-for, [value-if-not-found], [path = \u2018$PATH\u2019]) \u00b6 \u5148\u67e5\u627e AC_CANONICAL_HOST \u6307\u5b9a\u524d\u7f00\u7684\u7a0b\u5e8f\uff0c\u4f7f\u7528 - \u8fde\u63a5\u3002\u5982\u679c\u6ca1\u6709\u4e00\u4e2a\u88ab\u627e\u5230\uff0c\u90a3\u4e48\u53bb\u6389\u524d\u7f00\u7ee7\u7eed\u67e5\u627e tools \u3002\u4f59\u4e0b\u7684\u8bf4\u660e\u53c2\u8003 AC_CHECK_PROGS \u3002 AC_CHECK_TOOLS ( AR ,[ ar gar ], ar ) AC_PATH_PROG (variable, prog-to-check-for, [value-if-not-found], [path = \u2018$PATH\u2019]) \u00b6 \u68c0\u67e5\u547d\u4ee4\u662f\u5426\u5b89\u88c5\u3002\u7c7b\u4f3c\u4e8e AC_CHECK_PROG \uff0c\u68c0\u67e5 path \u4e2d\u662f\u5426\u5b58\u5728 prog-to-check-for \u3002\u533a\u522b\u5728\u4e8e\u603b\u662f\u8bbe\u7f6e variable = prog-to-check-for \u7684\u7edd\u5bf9\u8def\u5f84\u3002 \u8be5\u6d4b\u8bd5\u7ed3\u679c\u53ef\u4ee5\u901a\u8fc7\u5bf9 variable \u8d4b\u503c\u7684\u65b9\u5f0f\u6539\u53d8\u3002 \u6d4b\u8bd5\u7ed3\u679c\u88ab\u7f13\u5b58\u5728 ac_cv_path_variable \u53d8\u91cf\u4e2d\u3002 AC_PATH_PROG(LDCONFIG, ldconfig, true, [/sbin /usr/sbin $PATH]) AC_PATH_PROGS (variable, progs-to-check-for, [value-if-not-found], [path = \u2018$PATH\u2019]) \u00b6 \u8bf4\u660e\u53c2\u8003 AC_PATH_PROG \u3002\u6709\u4efb\u4f55\u4e00\u4e2a\u7a0b\u5e8f\u88ab\u627e\u5230\uff0c\u8d4b\u503c\u7ed9 variable \u3002 5.4 \u5e93\u6587\u4ef6 \u00b6 AC_CHECK_LIB (library, function, [action-if-found], [action-if-not-found], [other-libraries]) \u00b6 \u901a\u8fc7\u5c1d\u8bd5\u94fe\u63a5\u4e00\u4e2a\u8c03\u7528\u542b\u6709 library \u7684 function \u7684\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u6d4b\u8bd5 library \u662f\u5426\u53ef\u7528\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a action-if-found \uff0c\u9ed8\u8ba4\u7684\u64cd\u4f5c\u662f\u94fe\u63a5-l library \u5230 LIBS \u5e76\u4e14\u5b9a\u4e49'HAVE_LIB library '\uff08\u5168\u90e8\u5927\u5199\uff09\u3002 5.10 \u7f16\u8bd1\u5668\u548c\u6267\u884c\u5668 \u00b6 5.10.3 C\u7f16\u8bd1\u5668\u7279\u6027 \u00b6 AC_PROG_CC ([compiler-search-list]) \u00b6 \u6307\u5b9a\u4e00\u4e2aC\u7f16\u8bd1\u5668\uff0c\u5982\u679c CC \u6ca1\u6709\u5728\u73af\u5883\u4e2d\u8bbe\u7f6e\uff0c\u90a3\u4e48\u68c0\u67e5 gcc and cc \uff0c\u7136\u540e\u662f\u5176\u5b83\u7684C\u7f16\u8bd1\u5668\u3002\u8bbe\u7f6e\u627e\u5230\u7684\u7f16\u8bd1\u5668\u7ed9\u53d8\u91cf CC \u3002","title":"5.\u73b0\u6709\u6d4b\u8bd5"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#52","text":"\u8fd9\u4e9b\u5b8f\u7528\u4e8e\u68c0\u67e5\u6307\u5b9a\u7a0b\u5e8f\u7684\u5b58\u5728\u6216\u8005\u884c\u4e3a\u3002\u7ecf\u5e38\u4ece\u51e0\u4e2a\u5907\u9009\u7a0b\u5e8f\u4e2d\u9009\u62e9\u4e00\u4e2a\u51fa\u6765\u3002","title":"5.2 \u5907\u9009\u7a0b\u5e8f"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#521","text":"","title":"5.2.1 \u7279\u6b8a\u7a0b\u5e8f\u68c0\u67e5"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#ac_prog_ln_s","text":"\u5982\u679c\u5f53\u524d\u6587\u4ef6\u7cfb\u7edf\u652f\u6301 ln -s \uff0c\u8bbe\u7f6e\u8f93\u51fa\u53d8\u91cf LN_S \u4e3a ln -s \uff1b\u5426\u5219\uff0c\u5982\u679c\u652f\u6301 ln \uff0c\u8bbe\u7f6e LN_S \u4e3a ln \uff0c\u5426\u5219\u8bbe\u7f6e\u4e3a cp -pR \u3002 AC_PROG_LN_S","title":"AC_PROG_LN_S"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#522","text":"\u8fd9\u4e9b\u5b8f\u4e0d\u4f1a\u88ab\u7279\u5b9a\u7684\u6d4b\u8bd5\u5b8f\u6240\u8986\u76d6\u3002 \u5f3a\u70c8\u5efa\u8bae\u58f0\u660e variable \u4e3a precious variable \u3002 See AC_ARG_VAR","title":"5.2.2 \u901a\u7528\u7a0b\u5e8f\u548c\u6587\u4ef6\u68c0\u67e5"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#ac_check_prog-variable-prog-to-check-for-value-if-found-value-if-not-found-path-path-reject","text":"\u68c0\u67e5 path \u4e2d\u662f\u5426\u5b58\u624d prog-to-check-for \u3002 variable =\u5b58\u5728 ? value-if-found : value-if-not-found \u3002\u603b\u662f\u5ffd\u89c6 reject \uff08\u4e00\u4e2a\u6587\u4ef6\u540d\u7684\u7edd\u5bf9\u8def\u5f84\uff09\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c variable = prog-to-check-for \u7684\u7edd\u5bf9\u8def\u5f84\u3002 \u8c03\u7528 AC_SUBST \u8d4b\u503c\u3002 \u6d4b\u8bd5\u7ed3\u679c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e variable \u6216\u8005 ac_cv_prog_variable \u7684\u503c\u6765\u8986\u76d6\u3002","title":"AC_CHECK_PROG (variable, prog-to-check-for, value-if-found, [value-if-not-found], [path = \u2018$PATH\u2019], [reject])"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#ac_check_progs-variable-progs-to-check-for-value-if-not-found-path-path","text":"\u68c0\u67e5\u6bcf\u4e2a\u5728 progs-to-check-for \u4e2d\u7684\u7a0b\u5e8f\uff08\u4ee5\u7a7a\u683c\u5206\u9694\uff09\u5728 path \u4e2d\u662f\u5426\u5b58\u5728\u3002\u5982\u679c\u53d1\u73b0\u4e86\u4e00\u4e2a\uff0c\u8bbe\u7f6e variable \u7684\u503c\u4e3a\u8be5\u7a0b\u5e8f\u7684\u540d\u5b57\uff1b\u5426\u5219\u7ee7\u7eed\u67e5\u627e\u4e0b\u4e00\u4e2a\u3002\u5982\u679c\u90fd\u6ca1\u6709\u627e\u5230\uff0c\u8bbe\u503c\u4e3a value-if-not-found \uff1b\u5982\u679c\u8be5\u53c2\u6570\u6ca1\u6709\u6307\u5b9a\uff0c\u53d8\u91cf\u7684\u503c\u4e0d\u4f1a\u6539\u53d8\u3002 \u4f59\u4e0b\u7684\u8bf4\u660e\u540c\u4e0a\u3002 AC_CHECK_PROGS(FLEX,flex,none)","title":"AC_CHECK_PROGS (variable, progs-to-check-for, [value-if-not-found], [path = \u2018$PATH\u2019])"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#ac_check_tool-variable-prog-to-check-for-value-if-not-found-path-path","text":"\u7c7b\u4f3c\u4e8e AC_CHECK_PROG \uff0c\u4f46\u662f\u9996\u5148\u67e5\u627e\u9009\u9879 --host \u6307\u5b9a\u524d\u7f00\u7684\u7a0b\u5e8f\uff0c\u4f7f\u7528 - \u8fde\u63a5\u3002 AC_CHECK_TOOL ( [ RANLIB ] , [ ranlib ] , [ : ] ) \u8fd0\u884c\u2018configure --build=x86_64-gnu --host=i386-gnu\u2019\uff1a\u9996\u5148\u67e5\u627ei386-gnu-ranlib\uff0c\u6ca1\u6709\u518d\u67e5\u627eranlib\uff0c\u5426\u5219\u5c31\u662f:\u3002","title":"AC_CHECK_TOOL (variable, prog-to-check-for, [value-if-not-found], [path = \u2018$PATH\u2019])"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#ac_check_tools-variable-progs-to-check-for-value-if-not-found-path-path","text":"\u5148\u67e5\u627e AC_CANONICAL_HOST \u6307\u5b9a\u524d\u7f00\u7684\u7a0b\u5e8f\uff0c\u4f7f\u7528 - \u8fde\u63a5\u3002\u5982\u679c\u6ca1\u6709\u4e00\u4e2a\u88ab\u627e\u5230\uff0c\u90a3\u4e48\u53bb\u6389\u524d\u7f00\u7ee7\u7eed\u67e5\u627e tools \u3002\u4f59\u4e0b\u7684\u8bf4\u660e\u53c2\u8003 AC_CHECK_PROGS \u3002 AC_CHECK_TOOLS ( AR ,[ ar gar ], ar )","title":"AC_CHECK_TOOLS (variable, progs-to-check-for, [value-if-not-found], [path = \u2018$PATH\u2019])"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#ac_path_prog-variable-prog-to-check-for-value-if-not-found-path-path","text":"\u68c0\u67e5\u547d\u4ee4\u662f\u5426\u5b89\u88c5\u3002\u7c7b\u4f3c\u4e8e AC_CHECK_PROG \uff0c\u68c0\u67e5 path \u4e2d\u662f\u5426\u5b58\u5728 prog-to-check-for \u3002\u533a\u522b\u5728\u4e8e\u603b\u662f\u8bbe\u7f6e variable = prog-to-check-for \u7684\u7edd\u5bf9\u8def\u5f84\u3002 \u8be5\u6d4b\u8bd5\u7ed3\u679c\u53ef\u4ee5\u901a\u8fc7\u5bf9 variable \u8d4b\u503c\u7684\u65b9\u5f0f\u6539\u53d8\u3002 \u6d4b\u8bd5\u7ed3\u679c\u88ab\u7f13\u5b58\u5728 ac_cv_path_variable \u53d8\u91cf\u4e2d\u3002 AC_PATH_PROG(LDCONFIG, ldconfig, true, [/sbin /usr/sbin $PATH])","title":"AC_PATH_PROG (variable, prog-to-check-for, [value-if-not-found], [path = \u2018$PATH\u2019])"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#ac_path_progs-variable-progs-to-check-for-value-if-not-found-path-path","text":"\u8bf4\u660e\u53c2\u8003 AC_PATH_PROG \u3002\u6709\u4efb\u4f55\u4e00\u4e2a\u7a0b\u5e8f\u88ab\u627e\u5230\uff0c\u8d4b\u503c\u7ed9 variable \u3002","title":"AC_PATH_PROGS (variable, progs-to-check-for, [value-if-not-found], [path = \u2018$PATH\u2019])"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#54","text":"","title":"5.4 \u5e93\u6587\u4ef6"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#ac_check_lib-library-function-action-if-found-action-if-not-found-other-libraries","text":"\u901a\u8fc7\u5c1d\u8bd5\u94fe\u63a5\u4e00\u4e2a\u8c03\u7528\u542b\u6709 library \u7684 function \u7684\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u6d4b\u8bd5 library \u662f\u5426\u53ef\u7528\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a action-if-found \uff0c\u9ed8\u8ba4\u7684\u64cd\u4f5c\u662f\u94fe\u63a5-l library \u5230 LIBS \u5e76\u4e14\u5b9a\u4e49'HAVE_LIB library '\uff08\u5168\u90e8\u5927\u5199\uff09\u3002","title":"AC_CHECK_LIB (library, function, [action-if-found], [action-if-not-found], [other-libraries])"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#510","text":"","title":"5.10 \u7f16\u8bd1\u5668\u548c\u6267\u884c\u5668"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#5103-c","text":"","title":"5.10.3 C\u7f16\u8bd1\u5668\u7279\u6027"},{"location":"autoconf/5.%E7%8E%B0%E6%9C%89%E6%B5%8B%E8%AF%95/#ac_prog_cc-compiler-search-list","text":"\u6307\u5b9a\u4e00\u4e2aC\u7f16\u8bd1\u5668\uff0c\u5982\u679c CC \u6ca1\u6709\u5728\u73af\u5883\u4e2d\u8bbe\u7f6e\uff0c\u90a3\u4e48\u68c0\u67e5 gcc and cc \uff0c\u7136\u540e\u662f\u5176\u5b83\u7684C\u7f16\u8bd1\u5668\u3002\u8bbe\u7f6e\u627e\u5230\u7684\u7f16\u8bd1\u5668\u7ed9\u53d8\u91cf CC \u3002","title":"AC_PROG_CC ([compiler-search-list])"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/","text":"\u8fd9\u4e9b\u5b8f\u68c0\u67e5\u5f53\u524d\u8bed\u8a00\u7684\u7f16\u8bd1\u7cfb\u7edf\u7684\u8f93\u51fa\u3002\u4ed6\u4eec\u4e0d\u4f1a\u7f13\u5b58\u68c0\u67e5\u7ed3\u679c\uff0c\u4e5f\u4e0d\u4f1a\u6253\u5370\u4efb\u4f55\u4fe1\u606f\u3002\u5bf9\u4e8e\u7279\u5b9a\u529f\u80fd\u7684\u68c0\u67e5\u4f1a\u8c03\u7528\u8fd9\u4e9b\u5b8f\uff0c\u7136\u540e\u7f13\u5b58\u7ed3\u679c\u5e76\u6253\u5370\u4fe1\u606f\u3002 6.1 \u8bed\u8a00\u9009\u62e9 \u00b6 configure\u9ed8\u8ba4\u4e3aC\u8bed\u8a00\u68c0\u67e5\u7f16\u8bd1\u5668\u53ca\u5176\u7279\u6027\u3002 AC_LANG (language) \u00b6 \u2018C\u2019 Do compilation tests using CC and CPP and use extension .c for test programs. Use compilation flags: CPPFLAGS with CPP, and both CPPFLAGS and CFLAGS with CC. \u2018C++\u2019 Do compilation tests using CXX and CXXCPP and use extension .C for test programs. Use compilation flags: CPPFLAGS with CXXCPP, and both CPPFLAGS and CXXFLAGS with CXX. \u2018Fortran 77\u2019 Do compilation tests using F77 and use extension .f for test programs. Use compilation flags: FFLAGS. \u2018Fortran\u2019 Do compilation tests using FC and use extension .f (or whatever has been set by AC_FC_SRCEXT) for test programs. Use compilation flags: FCFLAGS. \u2018Erlang\u2019 Compile and execute tests using ERLC and ERL and use extension .erl for test Erlang modules. Use compilation flags: ERLCFLAGS. \u2018Objective C\u2019 Do compilation tests using OBJC and OBJCPP and use extension .m for test programs. Use compilation flags: CPPFLAGS with OBJCPP, and both CPPFLAGS and OBJCFLAGS with OBJC. \u2018Objective C++\u2019 Do compilation tests using OBJCXX and OBJCXXCPP and use extension .mm for test programs. Use compilation flags: CPPFLAGS with OBJCXXCPP, and both CPPFLAGS and OBJCXXFLAGS with OBJCXX. \u2018Go\u2019 Do compilation tests using GOC and use extension .go for test programs. Use compilation flags GOFLAGS. 6.2 \u7f16\u5199\u6d4b\u8bd5\u7a0b\u5e8f \u00b6 feed some program with some input, and most of the time, feed a compiler with some source file. 6.2.1 \u6d4b\u8bd5\u7a0b\u5e8f\u6307\u5bfc \u00b6 \u6d4b\u8bd5\u7a0b\u5e8f\u5fc5\u987b\u548c\u771f\u6b63\u7684\u7a0b\u5e8f\u4e00\u6837\u4e25\u683c\u3002 \u6d4b\u8bd5\u7a0b\u5e8f\u4e0d\u5e94\u8be5\u5199\u5230\u6807\u51c6\u8f93\u51fa\u3002\u5efa\u8bae\uff1a\u6d4b\u8bd5\u6210\u529f\u9000\u51fa\u72b6\u6001\u4e3a0\uff0c\u5426\u5219\u72b6\u6001\u4e3a1\uff0c\u6bb5\u9519\u8bef\u548c\u5176\u5b83\u7c7b\u4f3c\u9519\u8bef\u9000\u51fa\u72b6\u6001\u4e3a\u975e\u96f6\u503c\u3002 \u5982\u679c\u6d4b\u8bd5\u7a0b\u5e8f\u9700\u8981\u4f7f\u7528\u6216\u521b\u5efa\u6570\u636e\u6587\u4ef6\uff0c\u8ba9\u5b83\u7684\u540d\u5b57\u4ee5 conftest \u5f00\u5934\uff0c\u6bd4\u5982conftest.data\u3002\u6d4b\u8bd5\u7a0b\u5e8f\u8fd0\u884c\u5b8c\u6bd5\u540e\u6216\u8005\u4e2d\u65ad\u4e86\uff0cconfigure\u4f1a\u6e05\u7406\u8fd9\u4e9b\u6570\u636e\u6587\u4ef6\u3002 6.2.3 \u751f\u6210\u6e90 \u00b6 AC_LANG_CONFTEST (source) \u00b6 \u4fdd\u5b58 source \u6587\u672c\u5230\u5f53\u524d\u6d4b\u8bd5\u7684\u6e90\u6587\u4ef6\uff1aconftest. extension \uff0c extension \u53d6\u51b3\u4e8e\u5f53\u524d\u8bed\u8a00\u3002\u6e90\u6587\u4ef6\u4e5f\u5305\u62ec\u6240\u6709\u5230\u6b64\u4e3a\u6b62\u7684 AC_DEFINE \u7684\u6267\u884c\u7ed3\u679c\u3002 source \u4e5f\u53ef\u4ee5\u5305\u62ec\u5f15\u7528\u3002 AC_LANG_DEFINES_PROVIDED \u00b6 \u4e3a\u5f53\u524d\u8bed\u8a00\u9002\u914d\u5b8c\u6210\u7684 conftest.extension \u7684\u89c1\u8bc1\u5b8f\uff0c\u5305\u62ec\u6240\u6709\u5148\u524d\u7684 AC_DEFINE \u7684\u6267\u884c\u7ed3\u679c\u3002 AC_LANG_SOURCE (source) \u00b6 \u5c06\u76ee\u524d\u4e3a\u6b62\u6240\u6709\u6267\u884c\u5230 AC_DEFINE \u7684\u5b9a\u4e49\u6269\u5c55\u5230 source \u3002\u6b64\u5b8f\u5305\u542b\u4e86 AC_LANG_DEFINES_PROVIDED \u7684\u6269\u5c55\u3002 configure . ac : AC_INIT ( [ Hello ] , [ 1.0 ] , [ bug-hello@example.org ] , [] , [ http://www.example.org/ ] ) AC_DEFINE ( [ HELLO_WORLD ] , [ \"Hello, World\\n\" ] , [ Greetings string. ] ) AC_LANG ( [ C ] ) AC_LANG_CONFTEST ( [ AC_LANG_SOURCE([[const char hw[ ] = \"Hello, World\\n\" ; ]] ) ] ) gcc - E - dD conftest . c on a system with gcc installed , results in : # 1 \"conftest.c\" #define PACKAGE_NAME \"Hello\" #define PACKAGE_TARNAME \"hello\" #define PACKAGE_VERSION \"1.0\" #define PACKAGE_STRING \"Hello 1.0\" #define PACKAGE_BUGREPORT \"bug-hello@example.org\" #define PACKAGE_URL \"http://www.example.org/\" #define HELLO_WORLD \"Hello, World\\n\" const char hw [] = \"Hello, World\\n\" ; AC_LANG_PROGRAM (prologue, body) \u00b6 \u6269\u5c55\u4e3a\u5305\u542b prologue \u7684\u6e90\u6587\u4ef6\uff0c body \u4f5c\u4e3amain\u51fd\u6570\u7684\u65b9\u6cd5\u4f53\u3002\u4ee5\u4e3a\u4f7f\u7528\u5230\u4e86 AC_LANG_SOURCE \uff0c\u6240\u6709\u540e\u8005\u7684\u7279\u6027\u4e5f\u4f1a\u4f53\u73b0\u51fa\u6765\u3002 configure . ac : AC_INIT ( [ Hello ] , [ 1.0 ] , [ bug-hello@example.org ] , [] , [ http://www.example.org/ ] ) AC_DEFINE ( [ HELLO_WORLD ] , [ \"Hello, World\\n\" ] , [ Greetings string. ] ) AC_LANG_CONFTEST ( [ AC_LANG_PROGRAM([[const char hw[ ] = \"Hello, World\\n\" ; ]] , [ [fputs (hw, stdout); ] ] ) ] ) gcc - E - dD conftest . c on a system with gcc installed , results in : # 1 \"conftest.c\" #define PACKAGE_NAME \"Hello\" #define PACKAGE_TARNAME \"hello\" #define PACKAGE_VERSION \"1.0\" #define PACKAGE_STRING \"Hello 1.0\" #define PACKAGE_BUGREPORT \"bug-hello@example.org\" #define PACKAGE_URL \"http://www.example.org/\" #define HELLO_WORLD \"Hello, World\\n\" const char hw [] = \"Hello, World\\n\" ; int main () { fputs ( hw , stdout ); ; return 0 ; } 6.5 \u8fd0\u884c\u94fe\u63a5 \u00b6 \u4e3a\u4e86\u68c0\u67e5\u5e93\u3001\u51fd\u6570\u3001\u5168\u5c40\u53d8\u91cf\uff0cconfigure\u4f1a\u5c1d\u8bd5\u7f16\u8bd1\u548c\u94fe\u63a5\u4f7f\u7528\u5230\u7684\u7a0b\u5e8f\u3002 AC_LINK_IFELSE (input, [action-if-true], [action-if-false]) \u00b6 \u5728 input \u4e2d\u8fd0\u884c\u7f16\u8bd1\u5668\u53ca\u5176flags\u548c\u7684\u5f53\u524d\u8bed\u8a00\u7684\u8fde\u63a5\u5668\uff0c\u6210\u529f\u7684\u8bdd\u6267\u884cshell\u547d\u4ee4 action-if-true \uff0c\u5426\u5219\u6267\u884c action-if-false \u3002 AC_MSG_CHECKING ( [ whether $CC works ] ) AC_LINK_IFELSE ( [ AC_LANG_PROGRAM() ] , AC_MSG_RESULT ( [ yes ] ), [ AC_MSG_RESULT([no ] ) AC_MSG_ERROR ( [ Cannot build a 32-bit program, you need to install 32-bit development libraries. ] ) ] )","title":"6.\u7f16\u5199\u6d4b\u8bd5"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#61","text":"configure\u9ed8\u8ba4\u4e3aC\u8bed\u8a00\u68c0\u67e5\u7f16\u8bd1\u5668\u53ca\u5176\u7279\u6027\u3002","title":"6.1 \u8bed\u8a00\u9009\u62e9"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#ac_lang-language","text":"\u2018C\u2019 Do compilation tests using CC and CPP and use extension .c for test programs. Use compilation flags: CPPFLAGS with CPP, and both CPPFLAGS and CFLAGS with CC. \u2018C++\u2019 Do compilation tests using CXX and CXXCPP and use extension .C for test programs. Use compilation flags: CPPFLAGS with CXXCPP, and both CPPFLAGS and CXXFLAGS with CXX. \u2018Fortran 77\u2019 Do compilation tests using F77 and use extension .f for test programs. Use compilation flags: FFLAGS. \u2018Fortran\u2019 Do compilation tests using FC and use extension .f (or whatever has been set by AC_FC_SRCEXT) for test programs. Use compilation flags: FCFLAGS. \u2018Erlang\u2019 Compile and execute tests using ERLC and ERL and use extension .erl for test Erlang modules. Use compilation flags: ERLCFLAGS. \u2018Objective C\u2019 Do compilation tests using OBJC and OBJCPP and use extension .m for test programs. Use compilation flags: CPPFLAGS with OBJCPP, and both CPPFLAGS and OBJCFLAGS with OBJC. \u2018Objective C++\u2019 Do compilation tests using OBJCXX and OBJCXXCPP and use extension .mm for test programs. Use compilation flags: CPPFLAGS with OBJCXXCPP, and both CPPFLAGS and OBJCXXFLAGS with OBJCXX. \u2018Go\u2019 Do compilation tests using GOC and use extension .go for test programs. Use compilation flags GOFLAGS.","title":"AC_LANG (language)"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#62","text":"feed some program with some input, and most of the time, feed a compiler with some source file.","title":"6.2 \u7f16\u5199\u6d4b\u8bd5\u7a0b\u5e8f"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#621","text":"\u6d4b\u8bd5\u7a0b\u5e8f\u5fc5\u987b\u548c\u771f\u6b63\u7684\u7a0b\u5e8f\u4e00\u6837\u4e25\u683c\u3002 \u6d4b\u8bd5\u7a0b\u5e8f\u4e0d\u5e94\u8be5\u5199\u5230\u6807\u51c6\u8f93\u51fa\u3002\u5efa\u8bae\uff1a\u6d4b\u8bd5\u6210\u529f\u9000\u51fa\u72b6\u6001\u4e3a0\uff0c\u5426\u5219\u72b6\u6001\u4e3a1\uff0c\u6bb5\u9519\u8bef\u548c\u5176\u5b83\u7c7b\u4f3c\u9519\u8bef\u9000\u51fa\u72b6\u6001\u4e3a\u975e\u96f6\u503c\u3002 \u5982\u679c\u6d4b\u8bd5\u7a0b\u5e8f\u9700\u8981\u4f7f\u7528\u6216\u521b\u5efa\u6570\u636e\u6587\u4ef6\uff0c\u8ba9\u5b83\u7684\u540d\u5b57\u4ee5 conftest \u5f00\u5934\uff0c\u6bd4\u5982conftest.data\u3002\u6d4b\u8bd5\u7a0b\u5e8f\u8fd0\u884c\u5b8c\u6bd5\u540e\u6216\u8005\u4e2d\u65ad\u4e86\uff0cconfigure\u4f1a\u6e05\u7406\u8fd9\u4e9b\u6570\u636e\u6587\u4ef6\u3002","title":"6.2.1 \u6d4b\u8bd5\u7a0b\u5e8f\u6307\u5bfc"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#623","text":"","title":"6.2.3 \u751f\u6210\u6e90"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#ac_lang_conftest-source","text":"\u4fdd\u5b58 source \u6587\u672c\u5230\u5f53\u524d\u6d4b\u8bd5\u7684\u6e90\u6587\u4ef6\uff1aconftest. extension \uff0c extension \u53d6\u51b3\u4e8e\u5f53\u524d\u8bed\u8a00\u3002\u6e90\u6587\u4ef6\u4e5f\u5305\u62ec\u6240\u6709\u5230\u6b64\u4e3a\u6b62\u7684 AC_DEFINE \u7684\u6267\u884c\u7ed3\u679c\u3002 source \u4e5f\u53ef\u4ee5\u5305\u62ec\u5f15\u7528\u3002","title":"AC_LANG_CONFTEST (source)"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#ac_lang_defines_provided","text":"\u4e3a\u5f53\u524d\u8bed\u8a00\u9002\u914d\u5b8c\u6210\u7684 conftest.extension \u7684\u89c1\u8bc1\u5b8f\uff0c\u5305\u62ec\u6240\u6709\u5148\u524d\u7684 AC_DEFINE \u7684\u6267\u884c\u7ed3\u679c\u3002","title":"AC_LANG_DEFINES_PROVIDED"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#ac_lang_source-source","text":"\u5c06\u76ee\u524d\u4e3a\u6b62\u6240\u6709\u6267\u884c\u5230 AC_DEFINE \u7684\u5b9a\u4e49\u6269\u5c55\u5230 source \u3002\u6b64\u5b8f\u5305\u542b\u4e86 AC_LANG_DEFINES_PROVIDED \u7684\u6269\u5c55\u3002 configure . ac : AC_INIT ( [ Hello ] , [ 1.0 ] , [ bug-hello@example.org ] , [] , [ http://www.example.org/ ] ) AC_DEFINE ( [ HELLO_WORLD ] , [ \"Hello, World\\n\" ] , [ Greetings string. ] ) AC_LANG ( [ C ] ) AC_LANG_CONFTEST ( [ AC_LANG_SOURCE([[const char hw[ ] = \"Hello, World\\n\" ; ]] ) ] ) gcc - E - dD conftest . c on a system with gcc installed , results in : # 1 \"conftest.c\" #define PACKAGE_NAME \"Hello\" #define PACKAGE_TARNAME \"hello\" #define PACKAGE_VERSION \"1.0\" #define PACKAGE_STRING \"Hello 1.0\" #define PACKAGE_BUGREPORT \"bug-hello@example.org\" #define PACKAGE_URL \"http://www.example.org/\" #define HELLO_WORLD \"Hello, World\\n\" const char hw [] = \"Hello, World\\n\" ;","title":"AC_LANG_SOURCE (source)"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#ac_lang_program-prologue-body","text":"\u6269\u5c55\u4e3a\u5305\u542b prologue \u7684\u6e90\u6587\u4ef6\uff0c body \u4f5c\u4e3amain\u51fd\u6570\u7684\u65b9\u6cd5\u4f53\u3002\u4ee5\u4e3a\u4f7f\u7528\u5230\u4e86 AC_LANG_SOURCE \uff0c\u6240\u6709\u540e\u8005\u7684\u7279\u6027\u4e5f\u4f1a\u4f53\u73b0\u51fa\u6765\u3002 configure . ac : AC_INIT ( [ Hello ] , [ 1.0 ] , [ bug-hello@example.org ] , [] , [ http://www.example.org/ ] ) AC_DEFINE ( [ HELLO_WORLD ] , [ \"Hello, World\\n\" ] , [ Greetings string. ] ) AC_LANG_CONFTEST ( [ AC_LANG_PROGRAM([[const char hw[ ] = \"Hello, World\\n\" ; ]] , [ [fputs (hw, stdout); ] ] ) ] ) gcc - E - dD conftest . c on a system with gcc installed , results in : # 1 \"conftest.c\" #define PACKAGE_NAME \"Hello\" #define PACKAGE_TARNAME \"hello\" #define PACKAGE_VERSION \"1.0\" #define PACKAGE_STRING \"Hello 1.0\" #define PACKAGE_BUGREPORT \"bug-hello@example.org\" #define PACKAGE_URL \"http://www.example.org/\" #define HELLO_WORLD \"Hello, World\\n\" const char hw [] = \"Hello, World\\n\" ; int main () { fputs ( hw , stdout ); ; return 0 ; }","title":"AC_LANG_PROGRAM (prologue, body)"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#65","text":"\u4e3a\u4e86\u68c0\u67e5\u5e93\u3001\u51fd\u6570\u3001\u5168\u5c40\u53d8\u91cf\uff0cconfigure\u4f1a\u5c1d\u8bd5\u7f16\u8bd1\u548c\u94fe\u63a5\u4f7f\u7528\u5230\u7684\u7a0b\u5e8f\u3002","title":"6.5 \u8fd0\u884c\u94fe\u63a5"},{"location":"autoconf/6.%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95/#ac_link_ifelse-input-action-if-true-action-if-false","text":"\u5728 input \u4e2d\u8fd0\u884c\u7f16\u8bd1\u5668\u53ca\u5176flags\u548c\u7684\u5f53\u524d\u8bed\u8a00\u7684\u8fde\u63a5\u5668\uff0c\u6210\u529f\u7684\u8bdd\u6267\u884cshell\u547d\u4ee4 action-if-true \uff0c\u5426\u5219\u6267\u884c action-if-false \u3002 AC_MSG_CHECKING ( [ whether $CC works ] ) AC_LINK_IFELSE ( [ AC_LANG_PROGRAM() ] , AC_MSG_RESULT ( [ yes ] ), [ AC_MSG_RESULT([no ] ) AC_MSG_ERROR ( [ Cannot build a 32-bit program, you need to install 32-bit development libraries. ] ) ] )","title":"AC_LINK_IFELSE (input, [action-if-true], [action-if-false])"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/","text":"\u4e00\u65e6configure\u786e\u5b9a\u4e86\u54ea\u4e9b\u529f\u80fd\u5b58\u5728\uff0c\u5b83\u80fd\u505a\u4ec0\u4e48\u6765\u8bb0\u5f55\u4fe1\u606f\u5462\uff1f \u5b9a\u4e49\u4e00\u4e2aC\u5904\u7406\u5668\u6807\u8bc6 \u5728\u8f93\u51fa\u6587\u4ef6\u4e2d\u8bbe\u7f6e\u4e00\u4e2a\u53d8\u91cf \u5c06configure\u8fd0\u884c\u7684\u529f\u80fd\u7684\u7ed3\u679c\u4fdd\u5b58\u5728\u4e00\u4e2a\u7f13\u5b58\u6587\u4ef6\u4e2d \u6253\u5370\u4fe1\u606f\u8ba9\u7528\u6237\u77e5\u9053\u6d4b\u8bd5\u7ed3\u679c 7.1 \u5b9a\u4e49C\u5904\u7406\u5668\u6807\u8bc6 \u00b6 \u5bf9\u6709\u54cd\u5e94\u7684\u529f\u80fd\u6d4b\u8bd5\u7684\u666e\u901a\u505a\u6cd5\u5c31\u662f\u5b9a\u4e49\u4e00\u4e2aC\u5904\u7406\u5668\u6807\u8bc6\u6765\u8bf4\u660e\u6d4b\u8bd5\u7ed3\u679c\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c AC_OUPUT \u5c06\u8fd9\u4e9b\u5b8f\u5b9a\u4e49\u7684\u6807\u8bc6\u653e\u5728\u8f93\u51fa\u53d8\u91cf DEFS \u4e2d\u3002\u4f46\u662f\uff0c\u5982\u679c\u4f7f\u7528\u4e86 AC_CONFIG_HEADERS \uff0c\u5c06\u4f1a\u4ee3\u66ff\u521b\u5efa DEFS \u3002 AC_DEFINE (variable, value, [description]) \u00b6 AC_DEFINE (variable) \u00b6 \u901a\u8fc7\u5b9a\u4e49C\u5904\u7406\u5668\u7684\u5b8f\u6765\u5b9a\u4e49 variable \u4e3a value \uff0c\u53ef\u9009\u5730\u5e26\u4e0a\u62ec\u53f7\u53c2\u6570\u5217\u8868\u4ee5\u5904\u7406\u5e26\u53c2\u7684C\u5b8f\u3002\u5982\u679c\u5b8f\u7684\u53c2\u6570\u5217\u8868\u5b58\u5728\uff0c\u4f7f\u7528\u9017\u53f7\u5206\u9694\uff0c\u53ef\u80fd\u4f7f\u7528 ... \u7ed3\u675f\u3002 description \u53ea\u5728\u4f7f\u7528 AC_CONFIG_HEADERS \u65f6\u6709\u7528\uff0c\u4f5c\u4e3a\u6ce8\u91ca\u653e\u5728config.h.in\u4e2d\u3002 \u4f20\u53c2\u53ea\u6709 variable \u65f6\uff0c\u9ed8\u8ba4 value \u4e3a 1 \u3002 AC_DEFINE([PACKAGE_URL], [\"https : // www . winehq . org \"] , [ Define to the home page for this package .] AC_DEFINE_UNQUOTED (variable, value, [description]) \u00b6 AC_DEFINE_UNQUOTED (variable) \u00b6 \u7c7b\u4f3c\u4e8e AC_DEFINE \uff0c\u4f46\u662f\u53ef\u4ee5\u4f7f\u7528\uff1a\u5f15\u7528\uff08$\uff09\u3001\u8c03\u7528\uff08``\uff09\u3001\u53cd\u659c\u6760\uff08\\\uff09\u3002 AC_DEFINE_UNQUOTED ( [ GETGROUPS_T ] , [ $ac_cv_type_getgroups ] , [ getgroups return type. ] ) note \uff1a\u5728\u5176\u4ed6\u5b8f\u6216\u8005shell\u4ee3\u7801\u8c03\u7528\u8fd9\u4e24\u4e2a\u5b8f\u7684\u65f6\u5019\uff0c\u4e0d\u8981\u4f7f\u7528\u5206\u53f7\u6765\u5206\u5272 AC_DEFINE \u548c AC_DEFINE_UNQUOTED \u7684\u8bed\u53e5\uff0c\u4f7f\u7528\u7a7a\u683c\u6216\u8005\u6362\u884c\u3002 do this : AC_CHECK_HEADER ( [ elf.h ] , [ AC_DEFINE([SVR4 ] , [ 1 ] , [ System V Release 4 ] ) LIBS = \"-lelf $LIBS\" ] ) or this : AC_CHECK_HEADER ( [ elf.h ] , [ AC_DEFINE([SVR4 ] , [ 1 ] , [ System V Release 4 ] ) LIBS = \"-lelf $LIBS\" ] ) instead of this : AC_CHECK_HEADER ( [ elf.h ] , [ AC_DEFINE([SVR4 ] , [ 1 ] , [ System V Release 4 ] ); LIBS = \"-lelf $LIBS\" ] ) 7.2 \u8bbe\u7f6e\u8f93\u51fa\u53d8\u91cf \u00b6 \u9664\u4e86\u9884\u7f6e\u8f93\u51fa\u53d8\u91cf\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e24\u4e2a\u5b8f\u6765\u8bbe\u7f6e\u8f93\u51fa\u53d8\u91cf\u3002 AC_SUBST (variable, [value]) \u00b6 \u4eceshell\u53d8\u91cf\u521b\u5efa\u8f93\u51fa\u53d8\u91cf\u3002\u4f7f AC_OUTPUT \u66ff\u6362\u53d8\u91cf variable \u7684\u503c\u5230\u8f93\u51fa\u6587\u4ef6\u4e2d\uff08\u4e00\u822c\u662fMakefile\u6587\u4ef6\uff09\u3002\u610f\u601d\u5c31\u662f AC_OUTPUT \u4f7f\u7528shell\u53d8\u91cf variable \u7684\u503c\u66ff\u6362\u8f93\u5165\u6587\u4ef6\uff08Makefile.in\uff09\u7684 @variable@ \u5230\u8f93\u51fa\u6587\u4ef6\uff08Makefile\uff09\u3002\u5982\u679c\u503c\u662f\u65b0\u884c\uff0c\u8003\u8651\u4f7f\u7528 AM_SUBST_NOTMAKE \u9632\u6b62automake\u6dfb\u52a0 variable = @variable@ \u5230Makefile.in\u6587\u4ef6\u3002 AC_SUBST ( [ PACKAGE_RELEASE ] , [ m4_esyscmd([build-aux/pkg-version --release ] ) ] ) configure\u5bf9\u5e94\u7684\u8bed\u53e5 PACKAGE_RELEASE=44.gitb50346e AC_SUBST_FILE (variable) \u00b6 \u8ba9 AC_OUTPUT \u63d2\u5165\uff08\u6ca1\u6709\u66ff\u6362\uff09\u6587\u4ef6\uff08shell\u53d8\u91cf variable \uff09\u5185\u5bb9\u5230\u8f93\u51fa\u6587\u4ef6\u3002 configure . ac : AC_SUBST_FILE ( [ host_frag ] ) host_frag = $ srcdir / conf / sun4 . mh and then a Makefile . in could contain : @host_frag @ \u80fd\u591f\u5bf9\u8f93\u51fa\u7ed3\u679c\u9020\u6210\u5f71\u54cd\u7684\u73af\u5883\u53d8\u91cf\uff08\u6bd4\u5982CC\uff09\uff0c\u79f0\u4f5c precious variable \uff0c\u901a\u8fc7 AC_ARG_VAR \u58f0\u660e\u3002 AC_ARG_VAR (variable, description) \u00b6 \u58f0\u660e variable \u662f precious variable \uff0c\u5c06\u5b83\u7684\u63cf\u8ff0\u653e\u5165\u53d8\u91cf\u7684\u5e2e\u52a9\u6587\u6863\u90e8\u5206 ./configure --help \u3002 precious variable \u610f\u5473\u7740\uff1a \u901a\u8fc7 AC_SUBST \u66ff\u6362 variable configure\u8fd0\u884c\u7684\u65f6\u5019 variable \u7684\u503c\u88ab\u4fdd\u5b58\u5230\u7f13\u5b58\u4e2d\uff0c\u5305\u62ec\u6ca1\u6709\u901a\u8fc7\u547d\u4ee4\u884c\u800c\u662f\u901a\u8fc7\u73af\u5883\u6307\u5b9a\u7684\u60c5\u51b5\u3002 \u6ce8\u610f \uff1a\u4fdd\u5b58\u7684\u662f variable \u7684\u521d\u59cb\u5316\u7684\u503c\uff0c\u800c\u4e0d\u662f\u5728\u6267\u884cconfigure\u7684\u65f6\u5019\u627e\u5230\u7684\u503c\u3002 \u5728\u8fd0\u884c\u4e24\u6b21configure\u7684\u65f6\u5019\u6267\u884c\u4e00\u81f4\u6027\u68c0\u67e5\u3002 \u5728\u81ea\u52a8\u91cd\u65b0\u914d\u7f6e\u7684\u65f6\u5019\u4fdd\u7559\u53d8\u91cf\uff0c\u5c31\u597d\u50cf\u4f5c\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\u4f20\u5165\u4e00\u6837\u3002\u5305\u62ec\u6ca1\u6709\u4f7f\u7528\u7f13\u5b58\u7684\u60c5\u51b5\u3002 7.4 \u7f13\u5b58\u7ed3\u679c \u00b6 \u4e3a\u4e86\u907f\u514d\u5728\u591a\u4e2aconfigure\u811a\u672c\u4e2d\u91cd\u590d\u68c0\u67e5\u4e00\u4e2a\u529f\u80fd\u6216\u8005\u5728\u4e00\u4e2a\u811a\u672c\u4e2d\u91cd\u590d\u8fd0\u884c\uff0c\u53ef\u9009\u5730\u5c06\u6d4b\u8bd5\u7ed3\u679c\u4fdd\u5b58\u5230\u4e00\u4e2a cache file \u3002 AC_CACHE_VAL (cache-id, commands-to-set-it) \u00b6 \u786e\u4fdd cache-id \u6807\u8bc6\u7684\u68c0\u67e5\u7ed3\u679c\u53ef\u7528\u3002\u5982\u679c\u68c0\u67e5\u7ed3\u679c\u518d\u7f13\u5b58\u6587\u4ef6\u4e2d\u88ab\u8bfb\u53d6\u4e86\uff0c\u6253\u5370\u7ed3\u679c\u88ab\u8bfb\u53d6\u7684\u4fe1\u606f\uff1b\u5426\u5219\u6267\u884cshell\u547d\u4ee4 commands-to-set-it \u3002 AC_CACHE_CHECK (message, cache-id, commands-to-set-it) \u00b6 \u5bf9 AC_CACHE_VAL \u5c01\u88c5\uff0c\u5173\u5fc3\u6253\u5370\u4fe1\u606f\u3002\u5b83\u4e3a message \u8c03\u7528 AC_MSG_CHECKING \uff0c\u5e26\u53c2 cache-id\u3001commands \u8c03\u7528 AC_CACHE_VAL \uff0c\u5e26\u53c2 cache-id \u8c03\u7528 AC_MSG_RESULT \u3002 7.5 \u8f93\u51fa\u4fe1\u606f \u00b6 AC_MSG_CHECKING (feature-description) \u00b6 \u63d0\u793a\u7528\u6237configure\u6b63\u5728\u68c0\u67e5\u4e00\u4e2a\u7279\u5b9a\u7684\u529f\u80fd\u3002\u5fc5\u987b\u540e\u8ddf AC_MSG_RESULT \u6253\u5370\u68c0\u67e5\u7ed3\u679c\u548c\u6362\u884c\u3002 --quiet \u548c --silent \u9009\u9879\u4e0d\u4f1a\u6253\u5370\u3002 AC_MSG_CHECKING ( $ PYTHON_NAME module : $ 1 ) \"$THIS_MODULE_PYTHON\" - c \"import $1\" 2 >/ dev / null if test $? - eq 0 ; then AC_MSG_RESULT ( yes ) else AC_MSG_RESULT ( no ) AC_MSG_RESULT (result-description) \u00b6 \u63d0\u793a\u7528\u6237\u68c0\u67e5\u7684\u7ed3\u679c\uff0c result-description \u4e00\u822c\u662f \u2018yes\u2019, \u2018no\u2019, or a file name \u3002 AC_MSG_WARN (problem-description) \u00b6 \u53d1\u51fa\u8b66\u544a\uff0c\u6253\u5370\u4fe1\u606f\u5230\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002 AC_MSG_WARN([pyflakes not found]) AC_MSG_ERROR (error-description, [exit-status = \u2018$?/1\u2019]) \u00b6 \u63d0\u793a\u4e00\u4e2a\u9519\u8bef\uff0c\u7ec8\u6b62configure\u3002 $? \u662f\u9ed8\u8ba4\u7684\uff0c\u9664\u975e0\u53d8\u4e3a\u4e861\u3002 ???","title":"7.\u6d4b\u8bd5\u7ed3\u679c"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#71-c","text":"\u5bf9\u6709\u54cd\u5e94\u7684\u529f\u80fd\u6d4b\u8bd5\u7684\u666e\u901a\u505a\u6cd5\u5c31\u662f\u5b9a\u4e49\u4e00\u4e2aC\u5904\u7406\u5668\u6807\u8bc6\u6765\u8bf4\u660e\u6d4b\u8bd5\u7ed3\u679c\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c AC_OUPUT \u5c06\u8fd9\u4e9b\u5b8f\u5b9a\u4e49\u7684\u6807\u8bc6\u653e\u5728\u8f93\u51fa\u53d8\u91cf DEFS \u4e2d\u3002\u4f46\u662f\uff0c\u5982\u679c\u4f7f\u7528\u4e86 AC_CONFIG_HEADERS \uff0c\u5c06\u4f1a\u4ee3\u66ff\u521b\u5efa DEFS \u3002","title":"7.1 \u5b9a\u4e49C\u5904\u7406\u5668\u6807\u8bc6"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_define-variable-value-description","text":"","title":"AC_DEFINE (variable, value, [description])"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_define-variable","text":"\u901a\u8fc7\u5b9a\u4e49C\u5904\u7406\u5668\u7684\u5b8f\u6765\u5b9a\u4e49 variable \u4e3a value \uff0c\u53ef\u9009\u5730\u5e26\u4e0a\u62ec\u53f7\u53c2\u6570\u5217\u8868\u4ee5\u5904\u7406\u5e26\u53c2\u7684C\u5b8f\u3002\u5982\u679c\u5b8f\u7684\u53c2\u6570\u5217\u8868\u5b58\u5728\uff0c\u4f7f\u7528\u9017\u53f7\u5206\u9694\uff0c\u53ef\u80fd\u4f7f\u7528 ... \u7ed3\u675f\u3002 description \u53ea\u5728\u4f7f\u7528 AC_CONFIG_HEADERS \u65f6\u6709\u7528\uff0c\u4f5c\u4e3a\u6ce8\u91ca\u653e\u5728config.h.in\u4e2d\u3002 \u4f20\u53c2\u53ea\u6709 variable \u65f6\uff0c\u9ed8\u8ba4 value \u4e3a 1 \u3002 AC_DEFINE([PACKAGE_URL], [\"https : // www . winehq . org \"] , [ Define to the home page for this package .]","title":"AC_DEFINE (variable)"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_define_unquoted-variable-value-description","text":"","title":"AC_DEFINE_UNQUOTED (variable, value, [description])"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_define_unquoted-variable","text":"\u7c7b\u4f3c\u4e8e AC_DEFINE \uff0c\u4f46\u662f\u53ef\u4ee5\u4f7f\u7528\uff1a\u5f15\u7528\uff08$\uff09\u3001\u8c03\u7528\uff08``\uff09\u3001\u53cd\u659c\u6760\uff08\\\uff09\u3002 AC_DEFINE_UNQUOTED ( [ GETGROUPS_T ] , [ $ac_cv_type_getgroups ] , [ getgroups return type. ] ) note \uff1a\u5728\u5176\u4ed6\u5b8f\u6216\u8005shell\u4ee3\u7801\u8c03\u7528\u8fd9\u4e24\u4e2a\u5b8f\u7684\u65f6\u5019\uff0c\u4e0d\u8981\u4f7f\u7528\u5206\u53f7\u6765\u5206\u5272 AC_DEFINE \u548c AC_DEFINE_UNQUOTED \u7684\u8bed\u53e5\uff0c\u4f7f\u7528\u7a7a\u683c\u6216\u8005\u6362\u884c\u3002 do this : AC_CHECK_HEADER ( [ elf.h ] , [ AC_DEFINE([SVR4 ] , [ 1 ] , [ System V Release 4 ] ) LIBS = \"-lelf $LIBS\" ] ) or this : AC_CHECK_HEADER ( [ elf.h ] , [ AC_DEFINE([SVR4 ] , [ 1 ] , [ System V Release 4 ] ) LIBS = \"-lelf $LIBS\" ] ) instead of this : AC_CHECK_HEADER ( [ elf.h ] , [ AC_DEFINE([SVR4 ] , [ 1 ] , [ System V Release 4 ] ); LIBS = \"-lelf $LIBS\" ] )","title":"AC_DEFINE_UNQUOTED (variable)"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#72","text":"\u9664\u4e86\u9884\u7f6e\u8f93\u51fa\u53d8\u91cf\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e24\u4e2a\u5b8f\u6765\u8bbe\u7f6e\u8f93\u51fa\u53d8\u91cf\u3002","title":"7.2 \u8bbe\u7f6e\u8f93\u51fa\u53d8\u91cf"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_subst-variable-value","text":"\u4eceshell\u53d8\u91cf\u521b\u5efa\u8f93\u51fa\u53d8\u91cf\u3002\u4f7f AC_OUTPUT \u66ff\u6362\u53d8\u91cf variable \u7684\u503c\u5230\u8f93\u51fa\u6587\u4ef6\u4e2d\uff08\u4e00\u822c\u662fMakefile\u6587\u4ef6\uff09\u3002\u610f\u601d\u5c31\u662f AC_OUTPUT \u4f7f\u7528shell\u53d8\u91cf variable \u7684\u503c\u66ff\u6362\u8f93\u5165\u6587\u4ef6\uff08Makefile.in\uff09\u7684 @variable@ \u5230\u8f93\u51fa\u6587\u4ef6\uff08Makefile\uff09\u3002\u5982\u679c\u503c\u662f\u65b0\u884c\uff0c\u8003\u8651\u4f7f\u7528 AM_SUBST_NOTMAKE \u9632\u6b62automake\u6dfb\u52a0 variable = @variable@ \u5230Makefile.in\u6587\u4ef6\u3002 AC_SUBST ( [ PACKAGE_RELEASE ] , [ m4_esyscmd([build-aux/pkg-version --release ] ) ] ) configure\u5bf9\u5e94\u7684\u8bed\u53e5 PACKAGE_RELEASE=44.gitb50346e","title":"AC_SUBST (variable, [value])"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_subst_file-variable","text":"\u8ba9 AC_OUTPUT \u63d2\u5165\uff08\u6ca1\u6709\u66ff\u6362\uff09\u6587\u4ef6\uff08shell\u53d8\u91cf variable \uff09\u5185\u5bb9\u5230\u8f93\u51fa\u6587\u4ef6\u3002 configure . ac : AC_SUBST_FILE ( [ host_frag ] ) host_frag = $ srcdir / conf / sun4 . mh and then a Makefile . in could contain : @host_frag @ \u80fd\u591f\u5bf9\u8f93\u51fa\u7ed3\u679c\u9020\u6210\u5f71\u54cd\u7684\u73af\u5883\u53d8\u91cf\uff08\u6bd4\u5982CC\uff09\uff0c\u79f0\u4f5c precious variable \uff0c\u901a\u8fc7 AC_ARG_VAR \u58f0\u660e\u3002","title":"AC_SUBST_FILE (variable)"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_arg_var-variable-description","text":"\u58f0\u660e variable \u662f precious variable \uff0c\u5c06\u5b83\u7684\u63cf\u8ff0\u653e\u5165\u53d8\u91cf\u7684\u5e2e\u52a9\u6587\u6863\u90e8\u5206 ./configure --help \u3002 precious variable \u610f\u5473\u7740\uff1a \u901a\u8fc7 AC_SUBST \u66ff\u6362 variable configure\u8fd0\u884c\u7684\u65f6\u5019 variable \u7684\u503c\u88ab\u4fdd\u5b58\u5230\u7f13\u5b58\u4e2d\uff0c\u5305\u62ec\u6ca1\u6709\u901a\u8fc7\u547d\u4ee4\u884c\u800c\u662f\u901a\u8fc7\u73af\u5883\u6307\u5b9a\u7684\u60c5\u51b5\u3002 \u6ce8\u610f \uff1a\u4fdd\u5b58\u7684\u662f variable \u7684\u521d\u59cb\u5316\u7684\u503c\uff0c\u800c\u4e0d\u662f\u5728\u6267\u884cconfigure\u7684\u65f6\u5019\u627e\u5230\u7684\u503c\u3002 \u5728\u8fd0\u884c\u4e24\u6b21configure\u7684\u65f6\u5019\u6267\u884c\u4e00\u81f4\u6027\u68c0\u67e5\u3002 \u5728\u81ea\u52a8\u91cd\u65b0\u914d\u7f6e\u7684\u65f6\u5019\u4fdd\u7559\u53d8\u91cf\uff0c\u5c31\u597d\u50cf\u4f5c\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\u4f20\u5165\u4e00\u6837\u3002\u5305\u62ec\u6ca1\u6709\u4f7f\u7528\u7f13\u5b58\u7684\u60c5\u51b5\u3002","title":"AC_ARG_VAR (variable, description)"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#74","text":"\u4e3a\u4e86\u907f\u514d\u5728\u591a\u4e2aconfigure\u811a\u672c\u4e2d\u91cd\u590d\u68c0\u67e5\u4e00\u4e2a\u529f\u80fd\u6216\u8005\u5728\u4e00\u4e2a\u811a\u672c\u4e2d\u91cd\u590d\u8fd0\u884c\uff0c\u53ef\u9009\u5730\u5c06\u6d4b\u8bd5\u7ed3\u679c\u4fdd\u5b58\u5230\u4e00\u4e2a cache file \u3002","title":"7.4 \u7f13\u5b58\u7ed3\u679c"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_cache_val-cache-id-commands-to-set-it","text":"\u786e\u4fdd cache-id \u6807\u8bc6\u7684\u68c0\u67e5\u7ed3\u679c\u53ef\u7528\u3002\u5982\u679c\u68c0\u67e5\u7ed3\u679c\u518d\u7f13\u5b58\u6587\u4ef6\u4e2d\u88ab\u8bfb\u53d6\u4e86\uff0c\u6253\u5370\u7ed3\u679c\u88ab\u8bfb\u53d6\u7684\u4fe1\u606f\uff1b\u5426\u5219\u6267\u884cshell\u547d\u4ee4 commands-to-set-it \u3002","title":"AC_CACHE_VAL (cache-id, commands-to-set-it)"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_cache_check-message-cache-id-commands-to-set-it","text":"\u5bf9 AC_CACHE_VAL \u5c01\u88c5\uff0c\u5173\u5fc3\u6253\u5370\u4fe1\u606f\u3002\u5b83\u4e3a message \u8c03\u7528 AC_MSG_CHECKING \uff0c\u5e26\u53c2 cache-id\u3001commands \u8c03\u7528 AC_CACHE_VAL \uff0c\u5e26\u53c2 cache-id \u8c03\u7528 AC_MSG_RESULT \u3002","title":"AC_CACHE_CHECK (message, cache-id, commands-to-set-it)"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#75","text":"","title":"7.5 \u8f93\u51fa\u4fe1\u606f"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_msg_checking-feature-description","text":"\u63d0\u793a\u7528\u6237configure\u6b63\u5728\u68c0\u67e5\u4e00\u4e2a\u7279\u5b9a\u7684\u529f\u80fd\u3002\u5fc5\u987b\u540e\u8ddf AC_MSG_RESULT \u6253\u5370\u68c0\u67e5\u7ed3\u679c\u548c\u6362\u884c\u3002 --quiet \u548c --silent \u9009\u9879\u4e0d\u4f1a\u6253\u5370\u3002 AC_MSG_CHECKING ( $ PYTHON_NAME module : $ 1 ) \"$THIS_MODULE_PYTHON\" - c \"import $1\" 2 >/ dev / null if test $? - eq 0 ; then AC_MSG_RESULT ( yes ) else AC_MSG_RESULT ( no )","title":"AC_MSG_CHECKING (feature-description)"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_msg_result-result-description","text":"\u63d0\u793a\u7528\u6237\u68c0\u67e5\u7684\u7ed3\u679c\uff0c result-description \u4e00\u822c\u662f \u2018yes\u2019, \u2018no\u2019, or a file name \u3002","title":"AC_MSG_RESULT (result-description)"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_msg_warn-problem-description","text":"\u53d1\u51fa\u8b66\u544a\uff0c\u6253\u5370\u4fe1\u606f\u5230\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002 AC_MSG_WARN([pyflakes not found])","title":"AC_MSG_WARN (problem-description)"},{"location":"autoconf/7.%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C/#ac_msg_error-error-description-exit-status-1","text":"\u63d0\u793a\u4e00\u4e2a\u9519\u8bef\uff0c\u7ec8\u6b62configure\u3002 $? \u662f\u9ed8\u8ba4\u7684\uff0c\u9664\u975e0\u53d8\u4e3a\u4e861\u3002 ???","title":"AC_MSG_ERROR (error-description, [exit-status = \u2018$?/1\u2019])"},{"location":"autoconf/8.%E4%BD%BF%E7%94%A8M4%E7%BC%96%E7%A8%8B/","text":"Autoconf\u5728\u4e24\u4e2a\u5c42\u9762\u4e0a\u7f16\u5199\uff1a1\u3001M4sugar\uff0c\u63d0\u4f9b\u6bd4\u7eafM4\u7f16\u7a0b\u66f4\u52a0\u65b9\u4fbf\u7684\u5b8f\uff1b2\u3001M4sh\uff0c\u63d0\u4f9b\u4e13\u7528\u4e8e\u751f\u6210shell\u811a\u672c\u7684\u5b8f\u3002 8.1 M4 \u7684\u5f15\u7528 \u00b6 Autoconf\u7684\u4f7f\u7528\u8005\u53ef\u4ee5\u8df3\u8fc7\u8fd9\u4e00\u90e8\u5206\uff0c\u5b8f\u7f16\u5199\u8005\u5fc5\u987b\u9605\u8bfb\u3002 M4 Qutation \u3002 \u6bcf\u6b21\u5b8f\u5c55\u5f00\u65f6\uff0c\u90fd\u4f1a\u53bb\u9664\u4e00\u5c42\u5f15\u7528\u3002 8.1.3 \u5f15\u7528\u548c\u53c2\u6570 \u00b6 \u5728M4\u7684\u4e00\u4e2a\u5b8f\u5b9a\u4e49\u4e2d\uff0c\u9047\u5230\u4e86 $(\u20180\u2019...\u20189\u2019, \u2018#\u2019, \u2018@\u2019, or \u2018*\u2019) \uff0c\u4f1a\u6267\u884cM4\u7684\u53c2\u6570\u5c55\u5f00\u3002\u4e0d\u7ba1\u6709\u591a\u5c11\u5c42\u5d4c\u5957\u5f15\u7528\uff0c\u751a\u81f3\u662f\u6ce8\u91ca\u90fd\u4f1a\u6267\u884c\u3002 define ( [ none ] , [ $1 ] ) #\u4f1a\u5bfc\u81f4\u6269\u5c55 \u21d2 define ( [ one ] , [ [$1 ] ] ) #\u5f53\u4f5c\u6587\u672c\u5904\u7406 \u21d2 define ( [ two ] , [ [[$1 ] ]] ) #\u5f53\u4f5c [ \u6587\u672c ] \u5904\u7406 \u21d2 define ( [ comment ] , [ # $1 ] ) #\u6ce8\u91ca \u21d2 define ( [ active ] , [ ACTIVE ] ) \u21d2 none ( [ active ] ) \u21d2 ACTIVE one ( [ active ] ) \u21d2 active two ( [ active ] ) \u21d2 [ active ] comment ( [ active ] ) \u21d2# active \u60f3\u8981\u6253\u7834\u8fd9\u4e00\u89c4\u5219\u9700\u8981\u8fd9\u6837\u4f7f\u7528\uff1a define ( [ single ] , [ a single-quoted $[ ] 1 definition ] ) \u21d2 define ( [ double ] , [ [a double-quoted $ ][ 1 definition ] ] ) \u21d2 single \u21d2 a single - quoted $ 1 definition double \u21d2 a double - quoted $ 1 definition warning \uff1aM4\u6269\u5c55\u4e00\u4e2a\u5b8f\u4e4b\u540e\uff0c\u7ed3\u679c\u6587\u672c\u4f1a\u88ab\u7acb\u5373\u8fdb\u884c\u5b8f\u6269\u5c55\u548c\u5f15\u7528\u5220\u9664\u3002\u4f8b\uff1a car([int tab[10];]) \u21d2int tab10; car([[int tab[10];]]) \u21d2int tab[10]; \u7b2c\u4e00\u4e2a\u6269\u5c55\u7684\u7ed3\u679c\u662f int tab[10]; \uff0c\u4f46\u662f\u7ecf\u8fc7\u5f15\u7528\u5220\u9664\u4e4b\u540e\uff0c\u53bb\u9664\u4e86\u5f15\u7528\u7b26\u53f7\uff1b \u7b2c\u4e8c\u4e2a\u6269\u5c55\u7684\u7ed3\u679c\u662f [int tab[10];] \uff0c\u7ecf\u8fc7\u5f15\u7528\u5220\u9664\u4e4b\u540e\uff0c\u8fd8\u4f1a\u4fdd\u7559\u5185\u90e8\u7684\u5f15\u7528\u7b26\u53f7\u3002 8.1.6 \u7279\u6b8a\u5b57\u7b26\u66ff\u6362 \u00b6 \u7f16\u5199Autoconf\u5b8f\u7684\u65f6\u5019\u53ef\u80fd\u9700\u8981\u7279\u6b8a\u5b57\u7b26\uff0c\u4f46\u662f\u4f7f\u7528\u6807\u51c6\u7684\u5f15\u7528\u89c4\u5219\u4f1a\u5f88\u56f0\u96be\u3002 \u8fd8\u6709\uff0c\u5c11\u91cf\u7684M4sugar\u5185\u90e8\u4f7f\u7528\u4e86\u7279\u6b8a\u5b57\u7b26\uff0c\u5982\u679c\u5b8f\u53c2\u5305\u542b\u4e86 -=<{( or )}>=- \uff0c\u5b83\u4eec\u53ef\u80fd\u4e0d\u4f1a\u6b63\u5e38\u5de5\u4f5c\u3002 \u66ff\u6362\u89c4\u5219\uff1a @<:@ - [ @:>@ - ] @S|@ - $ @%:@ - # @{:@ - ( @:}@ - ) @&t@ - Expands to nothing AC_ARG_ENABLE( [ovirt-vmconsole], [AS_HELP_STRING( [--disable-ovirt-vmconsole], [disable ovirt-vmconsole integration @<:@default=no@:>@] )], , [enable_ovirt_vmconsole=\"yes\"] ) 8.2 \u4f7f\u7528 autom4te \u00b6 \u9664\u4e86Autoconf\u672c\u8eab\uff0cAutoconf\u5957\u4ef6\u5305\u62ecM4sugar, M4sh, and Autotest\uff0c\u5f88\u5927\u7a0b\u5ea6\u4e0a\u4f9d\u8d56M4\u3002 8.3 \u4f7f\u7528 M4 \u7684\u8bed\u6cd5 \u00b6 \u4fdd\u7559\u4e86 m4_ \u5f00\u5934\u7684\u5b8f\u547d\u540d\u7a7a\u95f4\u3002 8.3.1 \u91cd\u5b9a\u4e49M4\u5b8f \u00b6 \u9664\u4e86\u51e0\u4e2a\u4f8b\u5916\uff0c\u6240\u6709\u7684M4\u672c\u5730\u5b8f\u90fd\u88ab\u91cd\u547d\u540d\u4e3a m4_ \u5f00\u5934\u3002 \u4e0b\u9762\u8fd9\u4e9b\u5b8f\u6ca1\u6709\u6539\u53d8\uff1a m4_builtin m4_changecom m4_changequote m4_debugfile m4_debugmode m4_decr m4_define m4_divnum m4_errprint m4_esyscmd m4_eval m4_format m4_ifdef m4_incr m4_index m4_indir m4_len m4_pushdef m4_shift m4_substr m4_syscmd m4_sysval m4_traceoff m4_traceon m4_translit \u4e0b\u9762\u7684\u6709\u8f7b\u5fae\u7684\u4e0d\u540c\uff1a m4_include (file) \u00b6 m4_sinclude (file) \u00b6 \u8ddfm4\u5185\u7f6e\u7684\u5b8f\u7c7b\u4f3c\uff0c\u4f46\u662f\u4f1a\u5bf9\u591a\u6b21\u5f15\u5165\u6587\u4ef6\u53d1\u51fa\u8b66\u544a\u3002 m4_include([m4/ax_python_module.m4])","title":"8.\u4f7f\u7528M4\u7f16\u7a0b"},{"location":"autoconf/8.%E4%BD%BF%E7%94%A8M4%E7%BC%96%E7%A8%8B/#81-m4","text":"Autoconf\u7684\u4f7f\u7528\u8005\u53ef\u4ee5\u8df3\u8fc7\u8fd9\u4e00\u90e8\u5206\uff0c\u5b8f\u7f16\u5199\u8005\u5fc5\u987b\u9605\u8bfb\u3002 M4 Qutation \u3002 \u6bcf\u6b21\u5b8f\u5c55\u5f00\u65f6\uff0c\u90fd\u4f1a\u53bb\u9664\u4e00\u5c42\u5f15\u7528\u3002","title":"8.1 M4 \u7684\u5f15\u7528"},{"location":"autoconf/8.%E4%BD%BF%E7%94%A8M4%E7%BC%96%E7%A8%8B/#813","text":"\u5728M4\u7684\u4e00\u4e2a\u5b8f\u5b9a\u4e49\u4e2d\uff0c\u9047\u5230\u4e86 $(\u20180\u2019...\u20189\u2019, \u2018#\u2019, \u2018@\u2019, or \u2018*\u2019) \uff0c\u4f1a\u6267\u884cM4\u7684\u53c2\u6570\u5c55\u5f00\u3002\u4e0d\u7ba1\u6709\u591a\u5c11\u5c42\u5d4c\u5957\u5f15\u7528\uff0c\u751a\u81f3\u662f\u6ce8\u91ca\u90fd\u4f1a\u6267\u884c\u3002 define ( [ none ] , [ $1 ] ) #\u4f1a\u5bfc\u81f4\u6269\u5c55 \u21d2 define ( [ one ] , [ [$1 ] ] ) #\u5f53\u4f5c\u6587\u672c\u5904\u7406 \u21d2 define ( [ two ] , [ [[$1 ] ]] ) #\u5f53\u4f5c [ \u6587\u672c ] \u5904\u7406 \u21d2 define ( [ comment ] , [ # $1 ] ) #\u6ce8\u91ca \u21d2 define ( [ active ] , [ ACTIVE ] ) \u21d2 none ( [ active ] ) \u21d2 ACTIVE one ( [ active ] ) \u21d2 active two ( [ active ] ) \u21d2 [ active ] comment ( [ active ] ) \u21d2# active \u60f3\u8981\u6253\u7834\u8fd9\u4e00\u89c4\u5219\u9700\u8981\u8fd9\u6837\u4f7f\u7528\uff1a define ( [ single ] , [ a single-quoted $[ ] 1 definition ] ) \u21d2 define ( [ double ] , [ [a double-quoted $ ][ 1 definition ] ] ) \u21d2 single \u21d2 a single - quoted $ 1 definition double \u21d2 a double - quoted $ 1 definition warning \uff1aM4\u6269\u5c55\u4e00\u4e2a\u5b8f\u4e4b\u540e\uff0c\u7ed3\u679c\u6587\u672c\u4f1a\u88ab\u7acb\u5373\u8fdb\u884c\u5b8f\u6269\u5c55\u548c\u5f15\u7528\u5220\u9664\u3002\u4f8b\uff1a car([int tab[10];]) \u21d2int tab10; car([[int tab[10];]]) \u21d2int tab[10]; \u7b2c\u4e00\u4e2a\u6269\u5c55\u7684\u7ed3\u679c\u662f int tab[10]; \uff0c\u4f46\u662f\u7ecf\u8fc7\u5f15\u7528\u5220\u9664\u4e4b\u540e\uff0c\u53bb\u9664\u4e86\u5f15\u7528\u7b26\u53f7\uff1b \u7b2c\u4e8c\u4e2a\u6269\u5c55\u7684\u7ed3\u679c\u662f [int tab[10];] \uff0c\u7ecf\u8fc7\u5f15\u7528\u5220\u9664\u4e4b\u540e\uff0c\u8fd8\u4f1a\u4fdd\u7559\u5185\u90e8\u7684\u5f15\u7528\u7b26\u53f7\u3002","title":"8.1.3 \u5f15\u7528\u548c\u53c2\u6570"},{"location":"autoconf/8.%E4%BD%BF%E7%94%A8M4%E7%BC%96%E7%A8%8B/#816","text":"\u7f16\u5199Autoconf\u5b8f\u7684\u65f6\u5019\u53ef\u80fd\u9700\u8981\u7279\u6b8a\u5b57\u7b26\uff0c\u4f46\u662f\u4f7f\u7528\u6807\u51c6\u7684\u5f15\u7528\u89c4\u5219\u4f1a\u5f88\u56f0\u96be\u3002 \u8fd8\u6709\uff0c\u5c11\u91cf\u7684M4sugar\u5185\u90e8\u4f7f\u7528\u4e86\u7279\u6b8a\u5b57\u7b26\uff0c\u5982\u679c\u5b8f\u53c2\u5305\u542b\u4e86 -=<{( or )}>=- \uff0c\u5b83\u4eec\u53ef\u80fd\u4e0d\u4f1a\u6b63\u5e38\u5de5\u4f5c\u3002 \u66ff\u6362\u89c4\u5219\uff1a @<:@ - [ @:>@ - ] @S|@ - $ @%:@ - # @{:@ - ( @:}@ - ) @&t@ - Expands to nothing AC_ARG_ENABLE( [ovirt-vmconsole], [AS_HELP_STRING( [--disable-ovirt-vmconsole], [disable ovirt-vmconsole integration @<:@default=no@:>@] )], , [enable_ovirt_vmconsole=\"yes\"] )","title":"8.1.6 \u7279\u6b8a\u5b57\u7b26\u66ff\u6362"},{"location":"autoconf/8.%E4%BD%BF%E7%94%A8M4%E7%BC%96%E7%A8%8B/#82-autom4te","text":"\u9664\u4e86Autoconf\u672c\u8eab\uff0cAutoconf\u5957\u4ef6\u5305\u62ecM4sugar, M4sh, and Autotest\uff0c\u5f88\u5927\u7a0b\u5ea6\u4e0a\u4f9d\u8d56M4\u3002","title":"8.2 \u4f7f\u7528 autom4te"},{"location":"autoconf/8.%E4%BD%BF%E7%94%A8M4%E7%BC%96%E7%A8%8B/#83-m4","text":"\u4fdd\u7559\u4e86 m4_ \u5f00\u5934\u7684\u5b8f\u547d\u540d\u7a7a\u95f4\u3002","title":"8.3 \u4f7f\u7528 M4 \u7684\u8bed\u6cd5"},{"location":"autoconf/8.%E4%BD%BF%E7%94%A8M4%E7%BC%96%E7%A8%8B/#831-m4","text":"\u9664\u4e86\u51e0\u4e2a\u4f8b\u5916\uff0c\u6240\u6709\u7684M4\u672c\u5730\u5b8f\u90fd\u88ab\u91cd\u547d\u540d\u4e3a m4_ \u5f00\u5934\u3002 \u4e0b\u9762\u8fd9\u4e9b\u5b8f\u6ca1\u6709\u6539\u53d8\uff1a m4_builtin m4_changecom m4_changequote m4_debugfile m4_debugmode m4_decr m4_define m4_divnum m4_errprint m4_esyscmd m4_eval m4_format m4_ifdef m4_incr m4_index m4_indir m4_len m4_pushdef m4_shift m4_substr m4_syscmd m4_sysval m4_traceoff m4_traceon m4_translit \u4e0b\u9762\u7684\u6709\u8f7b\u5fae\u7684\u4e0d\u540c\uff1a","title":"8.3.1 \u91cd\u5b9a\u4e49M4\u5b8f"},{"location":"autoconf/8.%E4%BD%BF%E7%94%A8M4%E7%BC%96%E7%A8%8B/#m4_include-file","text":"","title":"m4_include (file)"},{"location":"autoconf/8.%E4%BD%BF%E7%94%A8M4%E7%BC%96%E7%A8%8B/#m4_sinclude-file","text":"\u8ddfm4\u5185\u7f6e\u7684\u5b8f\u7c7b\u4f3c\uff0c\u4f46\u662f\u4f1a\u5bf9\u591a\u6b21\u5f15\u5165\u6587\u4ef6\u53d1\u51fa\u8b66\u544a\u3002 m4_include([m4/ax_python_module.m4])","title":"m4_sinclude (file)"},{"location":"autoconf/9.%E4%BD%BF%E7%94%A8M4sh%E7%BC%96%E7%A8%8B/","text":"M4sh \uff0c\u79f0\u4f5c mash \uff0c\u76ee\u7684\u662f\u4ea7\u751f\u4fbf\u643a\u5f0f\u53ef\u79fb\u690d Bourne shell \u811a\u672c\u3002\u56e0\u4e3a\u4e0d\u540c\u7684shell\u7684\u8bed\u6cd5\u4e0d\u517c\u5bb9\uff0c\u6545\u521b\u9020\u6b64\u79cd\u5b8f\u6765\u89e3\u51b3\u3002 \u5176\u5b8f\u4ee5 AS_ \u5f00\u5934\u3002\u5728shell\u548c\u73af\u5883\u53d8\u91cf\u4e2d\u4fdd\u7559\u4e86\u53d8\u91cf\u547d\u540d\u7a7a\u95f4 as_ \uff0c\u8f93\u51fa\u6587\u4ef6\u4e2d\u662f _AS[A-Z] \u3002 9.1 \u666e\u901a\u7684shell\u7ed3\u6784 \u00b6 AS_IF (test1, [run-if-true1], ..., [run-if-false]) \u00b6 \u5982\u679c\u6ca1\u6709\u4e00\u4e2a\u6d4b\u8bd5\u662f\u6210\u529f\u7684\uff0c\u6267\u884c run-if-false \u3002 AS_IF ( [ test \"x$foo\" = xyes ] , [ HANDLE_FOO([yes ] ) ] , [ test \"x$foo\" != xno ] , [ HANDLE_FOO([maybe ] ) ] , [ echo foo not specified ] ) AS_TR_CPP (expression) \u00b6 \u5c06 expression \u8f6c\u4e3aC\u7684\u5b8f\u5b9a\u4e49 # This outputs \"#define HAVE_CHAR_P 1\". # Notice the m4 quoting around #, to prevent an m4 comment type=\"char *\" echo \"[#]define AS_TR_CPP([HAVE_$type]) 1\" 9.2 \u95f4\u63a5\u53d8\u91cf\u540d\u7684\u652f\u6301 \u00b6 AS_LITERAL_IF (expression, [if-literal], [if-not], [if-simple-ref = \u2018if-not\u2019]) \u00b6 AS_LITERAL_WORD_IF (expression, [if-literal], [if-not], [if-simple-ref = \u2018if-not\u2019]) \u00b6 \u82e5 expression \u5b9a\u4e49\u4e3ashell\u6587\u672c\uff0c\u8f93\u51fa if-literal \uff1b\u82e5 expression \u5305\u542b\u4e86shell\u5f15\u7528\u6216\u8005\u8c03\u7528\uff08\u4f8b\u5982$var\u6216 cd \uff09\uff0c\u8f93\u51fa if-not \u3002 expression \u4e3a\u6587\u672c\u7684\u65f6\u5019\uff0c AS_LITERAL_WORD_IF \u4e0d\u5141\u8bb8 expression \u542b\u6709\u7a7a\u683c\uff0c\u4f46\u662f AS_LITERAL_IF \u53ef\u4ee5\u3002 AS_VAR_APPEND (var, text) \u00b6 \u76f8\u5f53\u4e8e var += text \uff0c\u5373 var=${var}text \u3002 AS_VAR_IF (var, [word], [if-equal], [if-not-equal]) \u00b6 \u8f93\u51fashell\u7684\u6761\u4ef6\u8bed\u53e5\u3002 var == word \uff0c\u6267\u884c if-equal \uff1b\u5426\u5219\u6267\u884c if-not-equal \u3002 word \u5fc5\u987b\u662f\u5355\u4e2ashell\u5355\u8bcd\u3002","title":"9.\u4f7f\u7528M4sh\u7f16\u7a0b"},{"location":"autoconf/9.%E4%BD%BF%E7%94%A8M4sh%E7%BC%96%E7%A8%8B/#91-shell","text":"","title":"9.1 \u666e\u901a\u7684shell\u7ed3\u6784"},{"location":"autoconf/9.%E4%BD%BF%E7%94%A8M4sh%E7%BC%96%E7%A8%8B/#as_if-test1-run-if-true1-run-if-false","text":"\u5982\u679c\u6ca1\u6709\u4e00\u4e2a\u6d4b\u8bd5\u662f\u6210\u529f\u7684\uff0c\u6267\u884c run-if-false \u3002 AS_IF ( [ test \"x$foo\" = xyes ] , [ HANDLE_FOO([yes ] ) ] , [ test \"x$foo\" != xno ] , [ HANDLE_FOO([maybe ] ) ] , [ echo foo not specified ] )","title":"AS_IF (test1, [run-if-true1], ..., [run-if-false])"},{"location":"autoconf/9.%E4%BD%BF%E7%94%A8M4sh%E7%BC%96%E7%A8%8B/#as_tr_cpp-expression","text":"\u5c06 expression \u8f6c\u4e3aC\u7684\u5b8f\u5b9a\u4e49 # This outputs \"#define HAVE_CHAR_P 1\". # Notice the m4 quoting around #, to prevent an m4 comment type=\"char *\" echo \"[#]define AS_TR_CPP([HAVE_$type]) 1\"","title":"AS_TR_CPP (expression)"},{"location":"autoconf/9.%E4%BD%BF%E7%94%A8M4sh%E7%BC%96%E7%A8%8B/#92","text":"","title":"9.2 \u95f4\u63a5\u53d8\u91cf\u540d\u7684\u652f\u6301"},{"location":"autoconf/9.%E4%BD%BF%E7%94%A8M4sh%E7%BC%96%E7%A8%8B/#as_literal_if-expression-if-literal-if-not-if-simple-ref-if-not","text":"","title":"AS_LITERAL_IF (expression, [if-literal], [if-not], [if-simple-ref = \u2018if-not\u2019])"},{"location":"autoconf/9.%E4%BD%BF%E7%94%A8M4sh%E7%BC%96%E7%A8%8B/#as_literal_word_if-expression-if-literal-if-not-if-simple-ref-if-not","text":"\u82e5 expression \u5b9a\u4e49\u4e3ashell\u6587\u672c\uff0c\u8f93\u51fa if-literal \uff1b\u82e5 expression \u5305\u542b\u4e86shell\u5f15\u7528\u6216\u8005\u8c03\u7528\uff08\u4f8b\u5982$var\u6216 cd \uff09\uff0c\u8f93\u51fa if-not \u3002 expression \u4e3a\u6587\u672c\u7684\u65f6\u5019\uff0c AS_LITERAL_WORD_IF \u4e0d\u5141\u8bb8 expression \u542b\u6709\u7a7a\u683c\uff0c\u4f46\u662f AS_LITERAL_IF \u53ef\u4ee5\u3002","title":"AS_LITERAL_WORD_IF (expression, [if-literal], [if-not], [if-simple-ref = \u2018if-not\u2019])"},{"location":"autoconf/9.%E4%BD%BF%E7%94%A8M4sh%E7%BC%96%E7%A8%8B/#as_var_append-var-text","text":"\u76f8\u5f53\u4e8e var += text \uff0c\u5373 var=${var}text \u3002","title":"AS_VAR_APPEND (var, text)"},{"location":"autoconf/9.%E4%BD%BF%E7%94%A8M4sh%E7%BC%96%E7%A8%8B/#as_var_if-var-word-if-equal-if-not-equal","text":"\u8f93\u51fashell\u7684\u6761\u4ef6\u8bed\u53e5\u3002 var == word \uff0c\u6267\u884c if-equal \uff1b\u5426\u5219\u6267\u884c if-not-equal \u3002 word \u5fc5\u987b\u662f\u5355\u4e2ashell\u5355\u8bcd\u3002","title":"AS_VAR_IF (var, [word], [if-equal], [if-not-equal])"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/","text":"\u672c\u7cfb\u5217\u6587\u7ae0\u5747\u7ffb\u8bd1\u81eaAutoconf\u5b98\u65b9\u6587\u6863\uff1a Autoconf Manual Autoconf\u662f\u4e00\u4e2a\u7528\u4e8e\u751f\u6210shell\u811a\u672c\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u81ea\u52a8\u914d\u7f6e\u8f6f\u4ef6\u6e90\u4ee3\u7801\u4ee5\u9002\u5e94\u591a\u79cd\u7c7b\u4f3cPOSIX\u7684\u7cfb\u7edf\u3002\u4e3a\u4e86\u8ba9\u4f60\u7684\u8f6f\u4ef6\u5305\u5728\u6240\u6709\u7684\u4e0d\u540c\u7cfb\u7edf\u4e0a\u90fd\u53ef\u4ee5\u8fdb\u884c\u7f16\u8bd1\u3002 GNU \u6784\u5efa\u7cfb\u7edf \u00b6 Autoconf\u89e3\u51b3\u4e86\u7cfb\u7edf\u7279\u4f7f\u6784\u5efa\u548c\u8fd0\u884c\u65f6\u4fe1\u606f\u7684\u96be\u9898\uff0c\u4f46\u5728\u8f6f\u4ef6\u5f00\u53d1\u65f6\u8fd8\u6709\u66f4\u591a\u7684\u96be\u9898\uff0cGNU\u6784\u5efa\u7cfb\u7edf\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u5f00\u53d1\u8f6f\u4ef6\u800c\u5f00\u53d1\u7684\u4e00\u5957\u5b8c\u6574\u7684\u516c\u76ca\u4e8b\u4e1a\u3002 \u4e3b\u8981\u7ec4\u6210\u90e8\u5206\u6709 Autoconf \u3001 Automake \u548c Libtool \u3002 Automake \u00b6 \u4e3a\u4e86\u517c\u5bb9\u5404\u4e2a\u7cfb\u7edf\u7684make\u4f7f\u7528\u3002 \u4eceMakefile.am\u6587\u4ef6\u548cAutoconf\u4e00\u8d77\u751f\u6210Makefile.in\u6587\u4ef6\u3002 Gnulib \u00b6 \u8fd9\u662fGNU\u4ee3\u7801\u7684\u4e2d\u592e\u4ed3\u5e93\uff0c\u76ee\u7684\u662f\u5171\u4eab\u514d\u8d39\u7684\u8f6f\u4ef6\u5305\u3002\u5b83\u7684\u5171\u4eab\u662f\u6e90\u7801\u7ea7\u522b\u7684\uff0c\u53ea\u9700\u8981\u4ece\u4e0a\u9762\u76f4\u63a5\u62c9\u53d6\u5230\u81ea\u5df1\u7684\u6e90\u7801\u6811\u3002 Libtool \u00b6 \u751f\u4ea7\u52a8\u6001\u7684\u5171\u4eab\u5e93\u662f\u975e\u5e38\u56f0\u96be\u7684\u4e8b\u60c5\uff0c\u6bcf\u4e2a\u7cfb\u7edf\u90fd\u6709\u81ea\u5df1\u7684\u7f16\u8bd1\u5de5\u5177\u3001\u7f16\u8bd1\u6807\u5fd7\u3001etc.\u3002 Libtool\u4f1a\u5904\u7406\u6240\u6709\u7684\u5171\u4eab\u5e93\u8bf7\u6c42\u3002\u9700\u8981\u5171\u4eab\u5e93\u7684\u65f6\u5019\u4f1a\u81eaLibtool\u4f1a\u81ea\u52a8\u5730\u88ab\u4f7f\u7528\uff0c\u65e0\u9700\u77e5\u6653\u5176\u8bed\u6cd5\u89c4\u5219\u3002 \u5236\u4f5cconfigure\u811a\u672c \u00b6 \u4e0b\u9762\u7684\u56fe\u8868\u6f14\u793a\u4e86\u5982\u4f55\u751f\u6210\u53ef\u5728configure\u4e2d\u4f7f\u7528\u7684\u6587\u4ef6\uff1a \u540e\u7f00 * \u4ee3\u8868\u6267\u884c\u8fc7\u7a0b\uff0c[]\u4ee3\u8868\u53ef\u9009\u9879 \u53ea\u4f7f\u7528Autoconf your source files --> [ autoscan * ] --> [ configure . scan ] --> configure . ac configure . ac -- . | . ------> autoconf * -----> configure [ aclocal . m4 ] --+---+ | ` -----> [ autoheader * ] --> [ config . h . in ] [ acsite . m4 ] --- ' Makefile . in \u4f7f\u7528Automake\uff1a [ acinclude . m4 ] -- . | [ local macros ] --+--> aclocal * --> aclocal . m4 | configure . ac ---- ' configure . ac -- . +--> automake * --> Makefile . in Makefile . am --- ' \u914d\u7f6e\u4e00\u4e2a\u8f6f\u4ef6\u5305\u65f6\u5982\u4f55\u4f7f\u7528\u6587\u4ef6\uff1a . -------------> [ config . cache ] configure * ------------+-------------> config . log | [ config . h . in ] - . v . -> [ config . h ] - . +--> config . status * -+ +--> make * Makefile . in --- ' ` -> Makefile --- ' \u7f16\u5199configure.ac \u00b6 configure.ac \u5305\u542b\u4e86Autoconf\u7684\u5b8f\u8c03\u7528\uff0c\u7528\u4e8e\u6d4b\u8bd5\u7a0b\u5e8f\u5305\u9700\u8981\u7684\u6216\u53ef\u4ee5\u4f7f\u7528\u7684\u7cfb\u7edf\u529f\u80fd\u3002 Autoconf\u6709\u5bf9\u8bb8\u591a\u529f\u80fd\u8fdb\u884c\u68c0\u67e5\u7684\u5b8f \u5bf9\u4e8e\u5927\u90e8\u5206\u529f\u80fd\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u6a21\u677f\u5b8f\u8fdb\u884c\u5ba2\u6237\u7aef\u68c0\u67e5 \u5bf9\u4e8e\u4e00\u4e9b\u7279\u522b\u7684\u529f\u80fd\uff0c\u9700\u8981\u624b\u5199shell\u547d\u4ee4 autoscan\u53ef\u4ee5\u662f\u826f\u597d\u7684\u5f00\u7aef\u3002 shell\u811a\u672c\u7f16\u8bd1\u5668 \u00b6 autoconf\u662f\u4e3a\u4e86\u4ea7\u751f\u53ef\u79fb\u690d\u7684shell\u811a\u672c-- configure \u7684\u7f16\u8bd1\u5668\u3002 Autoconf\u8bed\u8a00 \u00b6 Autoconf-Language \u5f15\u7528\u7b26\u53f7\u662f [] \uff0c\u5f3a\u70c8\u5efa\u8bae\u5bf9\u6240\u6709\u5305\u542b \u5b8f\u540d\u3001\u9017\u53f7\u3001\u62ec\u53f7\u3001\u524d\u5bfc\u7a7a\u683c\u3001\u6362\u884c\u7b26 \u7684\u53c2\u6570\u90fd\u52a0\u4e0a\u5f15\u7528\u7b26\u53f7\u3002 \u53c2\u6570\u4e2d\u7684\u4efb\u4f55\u524d\u5bfc\u7a7a\u683c\u548c\u65b0\u7684\u884c\u90fd\u4f1a\u88ab\u5ffd\u89c6\uff0c\u9664\u975e\u88ab\u5f15\u7528\u3002 \u8be6\u7ec6\u5f15\u7528\u89c4\u5219 \u5f53\u5728\u5b8f\u53c2\u4e2d\u4f7f\u7528\u76f8\u540c\u7684\u6587\u672c\u65f6\uff0c\u5fc5\u987b\u6709\u4e00\u4e2a\u989d\u5916\u7684\u5f15\u7528\u7ea7\u522b\uff0c\u5e76\u4e14\u5bf9\u91cd\u590d\u7684\u90e8\u5206\u6216\u8005\u6574\u4f53\u8fdb\u884c\u53cc\u91cd\u7684\u7b26\u53f7\u5f15\u7528\u3002 \u5df2\u7ecf\u5728\u6587\u672c\u4e2d\u5f15\u7528\u4e86AC_DC \uff1a [ echo \"Hard rock was here! --AC_DC\" ] \u5b8f\u53c2\u4e2d\u5f15\u7528\u65f6 \uff1a AC_MSG_WARN ( [ [AC_DC ] stinks --Iron Maiden]) \u5f15\u7528\u5b8f\u7684\u9ec4\u91d1\u6cd5\u5219\u662f\u6bcf\u6269\u5c55\u4e00\u6b21\u5b8f\uff0c\u5c31\u53bb\u9664\u4e00\u6b21\u5f15\u7528\u3002 whenever you expect macro expansion, expect quote expansion; i.e., expect one level of quotes to be lost. \u63cf\u8ff0\u4e0d\u80fd\u88ab\u5f15\u7528\u4e24\u6b21\u3002 \u6ce8\u91ca\u4ee5 # \u5f00\u5934 note \uff1a\u5f15\u7528\u53d8\u91cf\uff1a\u5982\u679c\u662f\u5b8f\u8d4b\u503c\u7684\u53d8\u91cf\uff0c\u5219\u53ef\u76f4\u63a5 $xxx \uff0c\u5982\u679c\u662fshell\u53d8\u91cf\u5219\u9700\u8981 ${xxx} \u3002\u5982\u679c\u8d4b\u503c\u4e0e\u5f15\u7528\u90fd\u5728\u4e00\u6bb5shell\u811a\u672c\u91cc\u9762\uff0c\u90a3\u4e48\u53ef\u76f4\u63a5\u5f15\u7528 $xxx \u3002 \u6807\u51c6configure.ac\u5e03\u5c40 \u00b6 \u6309\u7167\u63a8\u8350\u987a\u5e8f\u6765\u8c03\u7528\u5b8f\uff1a AC_INIT(package, version, bug-report-address) information on the package checks for programs checks for libraries checks for header files checks for types checks for structures checks for compiler characteristics checks for library functions checks for system services AC_CONFIG_FILES([file...]) AC_OUTPUT \u4f7f\u7528autoscan\u63d2\u4ef6\u751f\u6210configure.ac \u00b6 autoscan\u68c0\u67e5\u5728\u76ee\u5f55\u4e0b\u7684\u6e90\u6587\u4ef6\u3002 \u751f\u6210configure.scan\u6587\u4ef6\u4e4b\u540e\u9700\u8981\u68c0\u67e5\u4fee\u6539\u624d\u80fd\u5c06\u5176\u91cd\u547d\u540d\u4e3aconfigure.ac \u4f7f\u7528ifnames\u5217\u51fa\u6761\u4ef6\u8bed\u53e5 \u00b6 ifnames\u6253\u5370\u6240\u6709\u7ed9\u5b9a\u7684C\u6e90\u6587\u4ef6\u4e2d\u7684 #if, #elif, #ifdef, or #ifndef \u51fa\u73b0\u5728\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u6807\u8bc6\u7b26\u6392\u5e8f\u5217\u8868 \u4f7f\u7528autoconf\u521b\u5efaconfigure \u00b6 \u65e0\u53c2\u8fd0\u884c autoconf \u4ececonfigure.ac\u521b\u5efaconfigure\u3002 autoconf processes configure.ac with the M4 macro processor, using the Autoconf macros. \u5982\u679c\u52a0\u4e86\u53c2\u6570\uff0c\u90a3\u4e48\u5b83\u4ece\u90a3\u4e2a\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5e76\u8f93\u51fa\u914d\u7f6e\u811a\u672c\u5230\u6807\u51c6\u8f93\u51fa\uff1b\u5982\u679c\u52a0\u4e86\u53c2\u6570-\uff0c\u5b83\u4ece\u6807\u51c6\u8f93\u8bfb\u53d6\u7136\u540e\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u3002 Autoconf\u5b8f\u88ab\u5b9a\u4e49\u5728\u591a\u4e2a\u6587\u4ef6\u91cc\u9762\u3002\u5148\u627e\u8ddf\u968fAutoconf\u4e00\u8d77\u53d1\u5e03\u7684\u6587\u4ef6\u4e2d\u7684\u5b8f\uff0c\u518d\u5728\u542b\u6709\u53d1\u5e03\u7684Autoconf\u5b8f\u6587\u4ef6\u7684\u6587\u4ef6\u5939\u4e2d\u627e\u53ef\u9009\u6587\u4ef6[acsite.m4]\u4e2d\u7684\u5b8f\uff0c\u7136\u540e\u5728\u5f53\u524d\u6587\u4ef6\u5939\u4e2d\u627e[aclocal.m4]\u7684\u5b8f\u3002\u540e\u5b9a\u4e49\u7684\u5b8f\u4f1a\u8986\u76d6\u4e4b\u524d\u5b9a\u4e49\u7684\u5b8f\u3002 \u5efa\u8bae\u4f7f\u7528--trace\u9009\u9879\u6765\u68c0\u67e5configure.ac\u6587\u4ef6\u3002 \u4f7f\u7528autoreconf\u66f4\u65b0configure\u811a\u672c \u00b6 autoreconf \u91cd\u590d\u8fd0\u884c autoconf, autoheader, aclocal, automake, libtoolize, and autopoint (when appropriate) \u5728\u7279\u6b8a\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u66f4\u65b0GNU\u6784\u5efa\u7cfb\u7edf\u3002\u9ed8\u8ba4\u53ea\u66f4\u65b0\u8001\u7684\u6587\u4ef6\u3002 \u4e0d\u4f1a\u4f20\u9012--autoconf-dir=dir \u6216 --localdir=dir\u3002","title":"\u7b80\u4ecb"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#gnu","text":"Autoconf\u89e3\u51b3\u4e86\u7cfb\u7edf\u7279\u4f7f\u6784\u5efa\u548c\u8fd0\u884c\u65f6\u4fe1\u606f\u7684\u96be\u9898\uff0c\u4f46\u5728\u8f6f\u4ef6\u5f00\u53d1\u65f6\u8fd8\u6709\u66f4\u591a\u7684\u96be\u9898\uff0cGNU\u6784\u5efa\u7cfb\u7edf\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u5f00\u53d1\u8f6f\u4ef6\u800c\u5f00\u53d1\u7684\u4e00\u5957\u5b8c\u6574\u7684\u516c\u76ca\u4e8b\u4e1a\u3002 \u4e3b\u8981\u7ec4\u6210\u90e8\u5206\u6709 Autoconf \u3001 Automake \u548c Libtool \u3002","title":"GNU \u6784\u5efa\u7cfb\u7edf"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#automake","text":"\u4e3a\u4e86\u517c\u5bb9\u5404\u4e2a\u7cfb\u7edf\u7684make\u4f7f\u7528\u3002 \u4eceMakefile.am\u6587\u4ef6\u548cAutoconf\u4e00\u8d77\u751f\u6210Makefile.in\u6587\u4ef6\u3002","title":"Automake"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#gnulib","text":"\u8fd9\u662fGNU\u4ee3\u7801\u7684\u4e2d\u592e\u4ed3\u5e93\uff0c\u76ee\u7684\u662f\u5171\u4eab\u514d\u8d39\u7684\u8f6f\u4ef6\u5305\u3002\u5b83\u7684\u5171\u4eab\u662f\u6e90\u7801\u7ea7\u522b\u7684\uff0c\u53ea\u9700\u8981\u4ece\u4e0a\u9762\u76f4\u63a5\u62c9\u53d6\u5230\u81ea\u5df1\u7684\u6e90\u7801\u6811\u3002","title":"Gnulib"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#libtool","text":"\u751f\u4ea7\u52a8\u6001\u7684\u5171\u4eab\u5e93\u662f\u975e\u5e38\u56f0\u96be\u7684\u4e8b\u60c5\uff0c\u6bcf\u4e2a\u7cfb\u7edf\u90fd\u6709\u81ea\u5df1\u7684\u7f16\u8bd1\u5de5\u5177\u3001\u7f16\u8bd1\u6807\u5fd7\u3001etc.\u3002 Libtool\u4f1a\u5904\u7406\u6240\u6709\u7684\u5171\u4eab\u5e93\u8bf7\u6c42\u3002\u9700\u8981\u5171\u4eab\u5e93\u7684\u65f6\u5019\u4f1a\u81eaLibtool\u4f1a\u81ea\u52a8\u5730\u88ab\u4f7f\u7528\uff0c\u65e0\u9700\u77e5\u6653\u5176\u8bed\u6cd5\u89c4\u5219\u3002","title":"Libtool"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#configure","text":"\u4e0b\u9762\u7684\u56fe\u8868\u6f14\u793a\u4e86\u5982\u4f55\u751f\u6210\u53ef\u5728configure\u4e2d\u4f7f\u7528\u7684\u6587\u4ef6\uff1a \u540e\u7f00 * \u4ee3\u8868\u6267\u884c\u8fc7\u7a0b\uff0c[]\u4ee3\u8868\u53ef\u9009\u9879 \u53ea\u4f7f\u7528Autoconf your source files --> [ autoscan * ] --> [ configure . scan ] --> configure . ac configure . ac -- . | . ------> autoconf * -----> configure [ aclocal . m4 ] --+---+ | ` -----> [ autoheader * ] --> [ config . h . in ] [ acsite . m4 ] --- ' Makefile . in \u4f7f\u7528Automake\uff1a [ acinclude . m4 ] -- . | [ local macros ] --+--> aclocal * --> aclocal . m4 | configure . ac ---- ' configure . ac -- . +--> automake * --> Makefile . in Makefile . am --- ' \u914d\u7f6e\u4e00\u4e2a\u8f6f\u4ef6\u5305\u65f6\u5982\u4f55\u4f7f\u7528\u6587\u4ef6\uff1a . -------------> [ config . cache ] configure * ------------+-------------> config . log | [ config . h . in ] - . v . -> [ config . h ] - . +--> config . status * -+ +--> make * Makefile . in --- ' ` -> Makefile --- '","title":"\u5236\u4f5cconfigure\u811a\u672c"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#configureac","text":"configure.ac \u5305\u542b\u4e86Autoconf\u7684\u5b8f\u8c03\u7528\uff0c\u7528\u4e8e\u6d4b\u8bd5\u7a0b\u5e8f\u5305\u9700\u8981\u7684\u6216\u53ef\u4ee5\u4f7f\u7528\u7684\u7cfb\u7edf\u529f\u80fd\u3002 Autoconf\u6709\u5bf9\u8bb8\u591a\u529f\u80fd\u8fdb\u884c\u68c0\u67e5\u7684\u5b8f \u5bf9\u4e8e\u5927\u90e8\u5206\u529f\u80fd\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u6a21\u677f\u5b8f\u8fdb\u884c\u5ba2\u6237\u7aef\u68c0\u67e5 \u5bf9\u4e8e\u4e00\u4e9b\u7279\u522b\u7684\u529f\u80fd\uff0c\u9700\u8981\u624b\u5199shell\u547d\u4ee4 autoscan\u53ef\u4ee5\u662f\u826f\u597d\u7684\u5f00\u7aef\u3002","title":"\u7f16\u5199configure.ac"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#shell","text":"autoconf\u662f\u4e3a\u4e86\u4ea7\u751f\u53ef\u79fb\u690d\u7684shell\u811a\u672c-- configure \u7684\u7f16\u8bd1\u5668\u3002","title":"shell\u811a\u672c\u7f16\u8bd1\u5668"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#autoconf","text":"Autoconf-Language \u5f15\u7528\u7b26\u53f7\u662f [] \uff0c\u5f3a\u70c8\u5efa\u8bae\u5bf9\u6240\u6709\u5305\u542b \u5b8f\u540d\u3001\u9017\u53f7\u3001\u62ec\u53f7\u3001\u524d\u5bfc\u7a7a\u683c\u3001\u6362\u884c\u7b26 \u7684\u53c2\u6570\u90fd\u52a0\u4e0a\u5f15\u7528\u7b26\u53f7\u3002 \u53c2\u6570\u4e2d\u7684\u4efb\u4f55\u524d\u5bfc\u7a7a\u683c\u548c\u65b0\u7684\u884c\u90fd\u4f1a\u88ab\u5ffd\u89c6\uff0c\u9664\u975e\u88ab\u5f15\u7528\u3002 \u8be6\u7ec6\u5f15\u7528\u89c4\u5219 \u5f53\u5728\u5b8f\u53c2\u4e2d\u4f7f\u7528\u76f8\u540c\u7684\u6587\u672c\u65f6\uff0c\u5fc5\u987b\u6709\u4e00\u4e2a\u989d\u5916\u7684\u5f15\u7528\u7ea7\u522b\uff0c\u5e76\u4e14\u5bf9\u91cd\u590d\u7684\u90e8\u5206\u6216\u8005\u6574\u4f53\u8fdb\u884c\u53cc\u91cd\u7684\u7b26\u53f7\u5f15\u7528\u3002 \u5df2\u7ecf\u5728\u6587\u672c\u4e2d\u5f15\u7528\u4e86AC_DC \uff1a [ echo \"Hard rock was here! --AC_DC\" ] \u5b8f\u53c2\u4e2d\u5f15\u7528\u65f6 \uff1a AC_MSG_WARN ( [ [AC_DC ] stinks --Iron Maiden]) \u5f15\u7528\u5b8f\u7684\u9ec4\u91d1\u6cd5\u5219\u662f\u6bcf\u6269\u5c55\u4e00\u6b21\u5b8f\uff0c\u5c31\u53bb\u9664\u4e00\u6b21\u5f15\u7528\u3002 whenever you expect macro expansion, expect quote expansion; i.e., expect one level of quotes to be lost. \u63cf\u8ff0\u4e0d\u80fd\u88ab\u5f15\u7528\u4e24\u6b21\u3002 \u6ce8\u91ca\u4ee5 # \u5f00\u5934 note \uff1a\u5f15\u7528\u53d8\u91cf\uff1a\u5982\u679c\u662f\u5b8f\u8d4b\u503c\u7684\u53d8\u91cf\uff0c\u5219\u53ef\u76f4\u63a5 $xxx \uff0c\u5982\u679c\u662fshell\u53d8\u91cf\u5219\u9700\u8981 ${xxx} \u3002\u5982\u679c\u8d4b\u503c\u4e0e\u5f15\u7528\u90fd\u5728\u4e00\u6bb5shell\u811a\u672c\u91cc\u9762\uff0c\u90a3\u4e48\u53ef\u76f4\u63a5\u5f15\u7528 $xxx \u3002","title":"Autoconf\u8bed\u8a00"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#configureac_1","text":"\u6309\u7167\u63a8\u8350\u987a\u5e8f\u6765\u8c03\u7528\u5b8f\uff1a AC_INIT(package, version, bug-report-address) information on the package checks for programs checks for libraries checks for header files checks for types checks for structures checks for compiler characteristics checks for library functions checks for system services AC_CONFIG_FILES([file...]) AC_OUTPUT","title":"\u6807\u51c6configure.ac\u5e03\u5c40"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#autoscanconfigureac","text":"autoscan\u68c0\u67e5\u5728\u76ee\u5f55\u4e0b\u7684\u6e90\u6587\u4ef6\u3002 \u751f\u6210configure.scan\u6587\u4ef6\u4e4b\u540e\u9700\u8981\u68c0\u67e5\u4fee\u6539\u624d\u80fd\u5c06\u5176\u91cd\u547d\u540d\u4e3aconfigure.ac","title":"\u4f7f\u7528autoscan\u63d2\u4ef6\u751f\u6210configure.ac"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#ifnames","text":"ifnames\u6253\u5370\u6240\u6709\u7ed9\u5b9a\u7684C\u6e90\u6587\u4ef6\u4e2d\u7684 #if, #elif, #ifdef, or #ifndef \u51fa\u73b0\u5728\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u6807\u8bc6\u7b26\u6392\u5e8f\u5217\u8868","title":"\u4f7f\u7528ifnames\u5217\u51fa\u6761\u4ef6\u8bed\u53e5"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#autoconfconfigure","text":"\u65e0\u53c2\u8fd0\u884c autoconf \u4ececonfigure.ac\u521b\u5efaconfigure\u3002 autoconf processes configure.ac with the M4 macro processor, using the Autoconf macros. \u5982\u679c\u52a0\u4e86\u53c2\u6570\uff0c\u90a3\u4e48\u5b83\u4ece\u90a3\u4e2a\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5e76\u8f93\u51fa\u914d\u7f6e\u811a\u672c\u5230\u6807\u51c6\u8f93\u51fa\uff1b\u5982\u679c\u52a0\u4e86\u53c2\u6570-\uff0c\u5b83\u4ece\u6807\u51c6\u8f93\u8bfb\u53d6\u7136\u540e\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u3002 Autoconf\u5b8f\u88ab\u5b9a\u4e49\u5728\u591a\u4e2a\u6587\u4ef6\u91cc\u9762\u3002\u5148\u627e\u8ddf\u968fAutoconf\u4e00\u8d77\u53d1\u5e03\u7684\u6587\u4ef6\u4e2d\u7684\u5b8f\uff0c\u518d\u5728\u542b\u6709\u53d1\u5e03\u7684Autoconf\u5b8f\u6587\u4ef6\u7684\u6587\u4ef6\u5939\u4e2d\u627e\u53ef\u9009\u6587\u4ef6[acsite.m4]\u4e2d\u7684\u5b8f\uff0c\u7136\u540e\u5728\u5f53\u524d\u6587\u4ef6\u5939\u4e2d\u627e[aclocal.m4]\u7684\u5b8f\u3002\u540e\u5b9a\u4e49\u7684\u5b8f\u4f1a\u8986\u76d6\u4e4b\u524d\u5b9a\u4e49\u7684\u5b8f\u3002 \u5efa\u8bae\u4f7f\u7528--trace\u9009\u9879\u6765\u68c0\u67e5configure.ac\u6587\u4ef6\u3002","title":"\u4f7f\u7528autoconf\u521b\u5efaconfigure"},{"location":"autoconf/%E7%AE%80%E4%BB%8B/#autoreconfconfigure","text":"autoreconf \u91cd\u590d\u8fd0\u884c autoconf, autoheader, aclocal, automake, libtoolize, and autopoint (when appropriate) \u5728\u7279\u6b8a\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u66f4\u65b0GNU\u6784\u5efa\u7cfb\u7edf\u3002\u9ed8\u8ba4\u53ea\u66f4\u65b0\u8001\u7684\u6587\u4ef6\u3002 \u4e0d\u4f1a\u4f20\u9012--autoconf-dir=dir \u6216 --localdir=dir\u3002","title":"\u4f7f\u7528autoreconf\u66f4\u65b0configure\u811a\u672c"},{"location":"autogen/%E7%AE%80%E4%BB%8B/","text":"\u4ecb\u7ecd \u00b6 \u751f\u6210\u7a0b\u5e8f\uff08\u542b\u6709\u5927\u91cf\u91cd\u590d\u6587\u672c\u4f46\u662f\u6709\u5f88\u591a\u66ff\u6362\u7684\u5730\u65b9\uff09\u6587\u4ef6\u7684\u5de5\u5177\u3002\u76ee\u6807\u662f\u7b80\u5316\u542b\u6709\u5927\u91cf\u91cd\u590d\u6587\u672c\u7684\u7a0b\u5e8f\u7684\u7ef4\u62a4\u3002 AutoGen\u7684\u76ee\u6807 \u00b6 \u5b9a\u4e49\u4e0e\u6a21\u677f\u5b8c\u5168\u5206\u79bb\u3002\u53ea\u9700\u8981\u6307\u5b9a\u5fc5\u9700\u7684\u63cf\u8ff0\u5176\u6a21\u677f\u5e94\u7528\u7684\u6570\u636e\u3002 \u5b9a\u4e49\u4e2d\u7684\u6bcf\u4e2a\u6570\u636e\u90fd\u88ab\u547d\u540d\u3002\u5b9a\u4e49\u53ef\u4ee5\u88ab\u91cd\u65b0\u6392\u5b9a\u3001\u589e\u5f3a\u3001\u53d8\u5f97\u8fc7\u65f6\uff0c\u65e0\u9700\u56de\u9000\u548c\u6e05\u7406\u5b9a\u4e49\u6587\u4ef6\u3002\u51cf\u5c11\u4e0d\u517c\u5bb9\u6027\u3002 \u6bcf\u4e2a\u5b9a\u4e49\u7684\u540d\u5b57\u90fd\u5b9a\u4e49\u4e86\u4e00\u4e2avalues\u6570\u7ec4\u3002\u8fd9\u4e9bvalues\u88ab\u7528\u4e8e\u63a7\u5236\u6a21\u677f\u5404\u90e8\u5206\u7684\u590d\u5236\u3002 \u6709\u547d\u540d\u7684\u5b9a\u4e49\u96c6\u5408\u3002\u4ed6\u4eec\u5f62\u6210\u5d4c\u5957\u7ed3\u6784\u3002\u5173\u8054\u7684values\u88ab\u6536\u96c6\u8d77\u6765\u5e76\u5173\u8054\u5230\u7ec4\u540d\u3002\u8fd9\u4e9b\u76f8\u5173\u7684\u6570\u636e\u5728\u4e00\u7ec4\u66ff\u6362\u4e2d\u5171\u540c\u4f7f\u7528\u3002 \u6a21\u677f\u5177\u6709\u7279\u6b8a\u6807\u8bb0\u6765\u6307\u793a\u9700\u8981\u66ff\u6362\u7684\u4f4d\u7f6e\u3002\u8fd9\u4e9b\u6807\u8bb0\u4e0d\u662f\u56fa\u5b9a\u7684\u5b57\u7b26\u4e32\u3002\u4ed6\u4eec\u5728\u6bcf\u4e2a\u6a21\u677f\u7684\u5f00\u5934\u6307\u5b9a\u3002\u6a21\u677f\u8bbe\u8ba1\u8005\u6700\u4e86\u89e3\u5176\u8bed\u6cd5\u7684\u5185\u5bb9\uff0c\u5e76\u907f\u514d\u6807\u8bb0\u51b2\u7a81\u3002 \u8fd9\u4e9b\u540c\u6837\u7684\u6807\u8bb0\u4e0e\u5c01\u95ed\u7684\u5173\u952e\u5b57\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u6307\u793a\u8981\u8df3\u8fc7\u7684\u53ca\u8981\u91cd\u590d\u7684\u6587\u672c\u90e8\u5206\u3002 \u63d0\u4f9b\u65b9\u6cd5\u63a7\u5236\u8f93\u51fa\u3002","title":"\u7b80\u4ecb"},{"location":"autogen/%E7%AE%80%E4%BB%8B/#_1","text":"\u751f\u6210\u7a0b\u5e8f\uff08\u542b\u6709\u5927\u91cf\u91cd\u590d\u6587\u672c\u4f46\u662f\u6709\u5f88\u591a\u66ff\u6362\u7684\u5730\u65b9\uff09\u6587\u4ef6\u7684\u5de5\u5177\u3002\u76ee\u6807\u662f\u7b80\u5316\u542b\u6709\u5927\u91cf\u91cd\u590d\u6587\u672c\u7684\u7a0b\u5e8f\u7684\u7ef4\u62a4\u3002","title":"\u4ecb\u7ecd"},{"location":"autogen/%E7%AE%80%E4%BB%8B/#autogen","text":"\u5b9a\u4e49\u4e0e\u6a21\u677f\u5b8c\u5168\u5206\u79bb\u3002\u53ea\u9700\u8981\u6307\u5b9a\u5fc5\u9700\u7684\u63cf\u8ff0\u5176\u6a21\u677f\u5e94\u7528\u7684\u6570\u636e\u3002 \u5b9a\u4e49\u4e2d\u7684\u6bcf\u4e2a\u6570\u636e\u90fd\u88ab\u547d\u540d\u3002\u5b9a\u4e49\u53ef\u4ee5\u88ab\u91cd\u65b0\u6392\u5b9a\u3001\u589e\u5f3a\u3001\u53d8\u5f97\u8fc7\u65f6\uff0c\u65e0\u9700\u56de\u9000\u548c\u6e05\u7406\u5b9a\u4e49\u6587\u4ef6\u3002\u51cf\u5c11\u4e0d\u517c\u5bb9\u6027\u3002 \u6bcf\u4e2a\u5b9a\u4e49\u7684\u540d\u5b57\u90fd\u5b9a\u4e49\u4e86\u4e00\u4e2avalues\u6570\u7ec4\u3002\u8fd9\u4e9bvalues\u88ab\u7528\u4e8e\u63a7\u5236\u6a21\u677f\u5404\u90e8\u5206\u7684\u590d\u5236\u3002 \u6709\u547d\u540d\u7684\u5b9a\u4e49\u96c6\u5408\u3002\u4ed6\u4eec\u5f62\u6210\u5d4c\u5957\u7ed3\u6784\u3002\u5173\u8054\u7684values\u88ab\u6536\u96c6\u8d77\u6765\u5e76\u5173\u8054\u5230\u7ec4\u540d\u3002\u8fd9\u4e9b\u76f8\u5173\u7684\u6570\u636e\u5728\u4e00\u7ec4\u66ff\u6362\u4e2d\u5171\u540c\u4f7f\u7528\u3002 \u6a21\u677f\u5177\u6709\u7279\u6b8a\u6807\u8bb0\u6765\u6307\u793a\u9700\u8981\u66ff\u6362\u7684\u4f4d\u7f6e\u3002\u8fd9\u4e9b\u6807\u8bb0\u4e0d\u662f\u56fa\u5b9a\u7684\u5b57\u7b26\u4e32\u3002\u4ed6\u4eec\u5728\u6bcf\u4e2a\u6a21\u677f\u7684\u5f00\u5934\u6307\u5b9a\u3002\u6a21\u677f\u8bbe\u8ba1\u8005\u6700\u4e86\u89e3\u5176\u8bed\u6cd5\u7684\u5185\u5bb9\uff0c\u5e76\u907f\u514d\u6807\u8bb0\u51b2\u7a81\u3002 \u8fd9\u4e9b\u540c\u6837\u7684\u6807\u8bb0\u4e0e\u5c01\u95ed\u7684\u5173\u952e\u5b57\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u6307\u793a\u8981\u8df3\u8fc7\u7684\u53ca\u8981\u91cd\u590d\u7684\u6587\u672c\u90e8\u5206\u3002 \u63d0\u4f9b\u65b9\u6cd5\u63a7\u5236\u8f93\u51fa\u3002","title":"AutoGen\u7684\u76ee\u6807"},{"location":"automake/10.%E5%85%B6%E5%AE%83GNU%E5%B7%A5%E5%85%B7/","text":"10.5 Python \u00b6 AM_PATH_PYTHON ([version], [action-if-found],[action-if-not-found]) \u00b6 \u5bfb\u627epython\u7ffb\u8bd1\u5668\uff0c\u4f1a\u8df3\u8fc7\u6bd4 version \u5c0f\u7684\u7ffb\u8bd1\u5668\u3002 action-if-not-found \u672a\u4f20\u5165\u4e14\u6ca1\u6709\u627e\u5230\u7ffb\u8bd1\u5668\uff0c\u90a3\u4e48\u9ed8\u8ba4\u7684\u52a8\u4f5c\u662f\u7ec8\u6b62configure\u3002\u8fd8\u4f1a\u521b\u5efa\u591a\u4e2a\u57fa\u4e8epython\u7684\u8f93\u51fa\u53d8\u91cf\u3002 AM_PATH_PYTHON([2.6])","title":"10.\u5176\u5b83GNU\u5de5\u5177"},{"location":"automake/10.%E5%85%B6%E5%AE%83GNU%E5%B7%A5%E5%85%B7/#105-python","text":"","title":"10.5 Python"},{"location":"automake/10.%E5%85%B6%E5%AE%83GNU%E5%B7%A5%E5%85%B7/#am_path_python-version-action-if-foundaction-if-not-found","text":"\u5bfb\u627epython\u7ffb\u8bd1\u5668\uff0c\u4f1a\u8df3\u8fc7\u6bd4 version \u5c0f\u7684\u7ffb\u8bd1\u5668\u3002 action-if-not-found \u672a\u4f20\u5165\u4e14\u6ca1\u6709\u627e\u5230\u7ffb\u8bd1\u5668\uff0c\u90a3\u4e48\u9ed8\u8ba4\u7684\u52a8\u4f5c\u662f\u7ec8\u6b62configure\u3002\u8fd8\u4f1a\u521b\u5efa\u591a\u4e2a\u57fa\u4e8epython\u7684\u8f93\u51fa\u53d8\u91cf\u3002 AM_PATH_PYTHON([2.6])","title":"AM_PATH_PYTHON ([version], [action-if-found],[action-if-not-found])"},{"location":"automake/12.%E5%AE%89%E8%A3%85/","text":"\u6587\u4ef6\u683c\u5f0f_\u6587\u4ef6\u7c7b\u578b\u3002\u540d\u5b57\u4e2d\u544a\u8bc9automake\u6784\u5efa\u7684\u662f\u4ec0\u4e48\u7684\u90e8\u5206\u88ab\u79f0\u505a primary \uff0c\u5373\u540e\u7f00\u3002\u4f8b\u5982\uff0c PROGRAMS \u638c\u63e1\u4e86\u5c06\u8981\u88ab\u7f16\u8bd1\u548c\u94fe\u63a5\u7684\u5217\u8868\u3002\u524d\u7f00\u8868\u793a\u5c06\u5b89\u88c5\u5230\u54ea\u4e2a\u6807\u51c6\u76ee\u5f55\u3002 \u76ee\u5f55\u540d\u540e\u7f00\uff1a\u2018PROGRAMS\u2019, \u2018LIBRARIES\u2019, \u2018LTLIBRARIES\u2019, \u2018LISP\u2019, \u2018PYTHON\u2019, \u2018JAVA\u2019, \u2018SCRIPTS\u2019, \u2018DATA\u2019, \u2018HEADERS\u2019, \u2018MANS\u2019, and \u2018TEXINFOS\u2019\u3002 \u5f53\u8fd0\u884c make install \u65f6\uff0c\u6240\u6709\u7684\u88ab\u5404\u79cdprimary\u547d\u540d\u7684\u6587\u4ef6\u90fd\u4f1a\u88ab\u81ea\u52a8\u5b89\u88c5\u5728\u5408\u9002\u7684\u4f4d\u7f6e\u3002 12.1 \u5b89\u88c5\u57fa\u7840 \u00b6 \u5728primary\u4e2d\u6307\u5b9a\u7684\u6587\u4ef6\u7684\u5b89\u88c5\u65b9\u5f0f\u662f\u590d\u5236\u6784\u5efa\u6587\u4ef6\u5230\u5408\u9002\u7684\u76ee\u5f55\u4e0b\u3002\u53ea\u4f7f\u7528\u6587\u4ef6\u540d\uff0c\u4e0d\u4f7f\u7528\u76ee\u5f55\u524d\u7f00\u3002 bin_PROGRAMS = hello subdir/goodbye hello\u4e0egoodbye\u90fd\u4f1a\u88ab\u5b89\u88c5\u5230 $(bindir) \u3002 \u53ef\u4ee5\u4f7f\u7528 no_base \u524d\u7f00\u53d6\u6d88\u8fd9\u4e00\u89c4\u5219\u3002 nobase_include_HEADERS = stdio.h sys/types.h types.h\u4f1a\u88ab\u5b89\u88c5\u5230 $(bindir)/sys \u4e0b\u9762\u3002 12.2 \u5b89\u88c5\u7684\u4e24\u4e2a\u9636\u6bb5 \u00b6 Automake\u901a\u5e38\u5206\u6210 install-data \u548c install-exec \u4e24\u4e2a\u89c4\u5219\u3002\u524d\u8005\u5b89\u88c5\u7684\u662f\u4e0e\u5e73\u53f0\u65e0\u5173\u7684\u6587\u4ef6\uff0c\u540e\u8005\u5b89\u88c5\u7684\u662f\u6587\u4ef6\u5219\u76f8\u53cd\u3002 \u5b89\u88c5\u7684\u6587\u4ef6\u89c4\u5219\uff1a install-data\uff1a\u5e26\u6709 \u2018data\u2019, \u2018info\u2019, \u2018man\u2019, \u2018include\u2019, \u2018oldinclude\u2019, \u2018pkgdata\u2019, or \u2018pkginclude\u2019 \u524d\u7f00\u7684\u6587\u4ef6\u5217\u8868 install-exec\uff1a\u5e26\u6709 \u2018bin\u2019, \u2018sbin\u2019, \u2018libexec\u2019, \u2018sysconf\u2019, \u2018localstate\u2019, \u2018lib\u2019, or \u2018pkglib\u2019 \u524d\u7f00\u7684\u6587\u4ef6\u5217\u8868 \u4efb\u4f55\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u6587\u4ef6\u5939\u3001\u5e26\u6709 exec \u524d\u7f00\u7684\u53d8\u91cf\uff08\u4f8b\u5982 myexecbin_PROGRAMS\uff09\uff0c\u88abinstall-exec\u5b89\u88c5\uff0c\u5176\u4f59\u6240\u6709\u7684\u81ea\u5b9a\u4e49\u524d\u7f00\u88abinstall-data\u5b89\u88c5\u3002 12.3 \u5b89\u88c5\u89c4\u5219\u7684\u6269\u5c55 \u00b6 \u4f7f\u7528 -local \u540e\u7f00\uff1ainstall-exec-local or install-data-local\u3002 \u4f7f\u7528 -hook \u540e\u7f00\uff1ainstall-exec-hook or install-data-hook\u3002 12.4 \u5b89\u88c5\u9636\u6bb5 \u00b6 Automake\u5728\u6240\u6709\u7684\u5b89\u88c5\u89c4\u5219\u4e2d\u652f\u6301 DESTDIR \u53d8\u91cf\u3002\u6bcf\u4e2a\u5bf9\u8c61\u548c\u8def\u5f84\u90fd\u4f1a\u88ab\u52a0\u4e0a DESTDIR \u524d\u7f00\u3002 mkdir /tmp/staging && make DESTDIR=/tmp/staging install \u6b64\u9879\u7279\u6027\u901a\u5e38\u88ab\u7528\u4e8e\u6784\u5efa\u5b89\u88c5\u955c\u50cf\u548c\u5b89\u88c5\u5305\u3002 12.5 \u7528\u6237\u7684\u5b89\u88c5\u89c4\u5219 \u00b6 \u652f\u6301\u7684\u89c4\u5219\uff1auninstall, installdirs, and install-strip\u3002 \u652f\u6301\u7684\u6269\u5c55\uff1auninstall-local and uninstall-hook\u3002","title":"12.\u5b89\u88c5"},{"location":"automake/12.%E5%AE%89%E8%A3%85/#121","text":"\u5728primary\u4e2d\u6307\u5b9a\u7684\u6587\u4ef6\u7684\u5b89\u88c5\u65b9\u5f0f\u662f\u590d\u5236\u6784\u5efa\u6587\u4ef6\u5230\u5408\u9002\u7684\u76ee\u5f55\u4e0b\u3002\u53ea\u4f7f\u7528\u6587\u4ef6\u540d\uff0c\u4e0d\u4f7f\u7528\u76ee\u5f55\u524d\u7f00\u3002 bin_PROGRAMS = hello subdir/goodbye hello\u4e0egoodbye\u90fd\u4f1a\u88ab\u5b89\u88c5\u5230 $(bindir) \u3002 \u53ef\u4ee5\u4f7f\u7528 no_base \u524d\u7f00\u53d6\u6d88\u8fd9\u4e00\u89c4\u5219\u3002 nobase_include_HEADERS = stdio.h sys/types.h types.h\u4f1a\u88ab\u5b89\u88c5\u5230 $(bindir)/sys \u4e0b\u9762\u3002","title":"12.1 \u5b89\u88c5\u57fa\u7840"},{"location":"automake/12.%E5%AE%89%E8%A3%85/#122","text":"Automake\u901a\u5e38\u5206\u6210 install-data \u548c install-exec \u4e24\u4e2a\u89c4\u5219\u3002\u524d\u8005\u5b89\u88c5\u7684\u662f\u4e0e\u5e73\u53f0\u65e0\u5173\u7684\u6587\u4ef6\uff0c\u540e\u8005\u5b89\u88c5\u7684\u662f\u6587\u4ef6\u5219\u76f8\u53cd\u3002 \u5b89\u88c5\u7684\u6587\u4ef6\u89c4\u5219\uff1a install-data\uff1a\u5e26\u6709 \u2018data\u2019, \u2018info\u2019, \u2018man\u2019, \u2018include\u2019, \u2018oldinclude\u2019, \u2018pkgdata\u2019, or \u2018pkginclude\u2019 \u524d\u7f00\u7684\u6587\u4ef6\u5217\u8868 install-exec\uff1a\u5e26\u6709 \u2018bin\u2019, \u2018sbin\u2019, \u2018libexec\u2019, \u2018sysconf\u2019, \u2018localstate\u2019, \u2018lib\u2019, or \u2018pkglib\u2019 \u524d\u7f00\u7684\u6587\u4ef6\u5217\u8868 \u4efb\u4f55\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u6587\u4ef6\u5939\u3001\u5e26\u6709 exec \u524d\u7f00\u7684\u53d8\u91cf\uff08\u4f8b\u5982 myexecbin_PROGRAMS\uff09\uff0c\u88abinstall-exec\u5b89\u88c5\uff0c\u5176\u4f59\u6240\u6709\u7684\u81ea\u5b9a\u4e49\u524d\u7f00\u88abinstall-data\u5b89\u88c5\u3002","title":"12.2 \u5b89\u88c5\u7684\u4e24\u4e2a\u9636\u6bb5"},{"location":"automake/12.%E5%AE%89%E8%A3%85/#123","text":"\u4f7f\u7528 -local \u540e\u7f00\uff1ainstall-exec-local or install-data-local\u3002 \u4f7f\u7528 -hook \u540e\u7f00\uff1ainstall-exec-hook or install-data-hook\u3002","title":"12.3 \u5b89\u88c5\u89c4\u5219\u7684\u6269\u5c55"},{"location":"automake/12.%E5%AE%89%E8%A3%85/#124","text":"Automake\u5728\u6240\u6709\u7684\u5b89\u88c5\u89c4\u5219\u4e2d\u652f\u6301 DESTDIR \u53d8\u91cf\u3002\u6bcf\u4e2a\u5bf9\u8c61\u548c\u8def\u5f84\u90fd\u4f1a\u88ab\u52a0\u4e0a DESTDIR \u524d\u7f00\u3002 mkdir /tmp/staging && make DESTDIR=/tmp/staging install \u6b64\u9879\u7279\u6027\u901a\u5e38\u88ab\u7528\u4e8e\u6784\u5efa\u5b89\u88c5\u955c\u50cf\u548c\u5b89\u88c5\u5305\u3002","title":"12.4 \u5b89\u88c5\u9636\u6bb5"},{"location":"automake/12.%E5%AE%89%E8%A3%85/#125","text":"\u652f\u6301\u7684\u89c4\u5219\uff1auninstall, installdirs, and install-strip\u3002 \u652f\u6301\u7684\u6269\u5c55\uff1auninstall-local and uninstall-hook\u3002","title":"12.5 \u7528\u6237\u7684\u5b89\u88c5\u89c4\u5219"},{"location":"automake/13.%E6%B8%85%E7%90%86/","text":"\u901a\u5e38Automake\u53ef\u4ee5\u81ea\u52a8\u786e\u5b9a\u6e05\u7406\u7684\u6587\u4ef6\u3002\u4e5f\u63d0\u4f9b\u4e86 MOSTLYCLEANFILES , CLEANFILES , DISTCLEANFILES , and MAINTAINERCLEANFILES \u53d8\u91cf\u6307\u5b9a\u989d\u5916\u7684\u9700\u8981\u6e05\u7406\u7684\u6587\u4ef6\u3002 \u6e05\u7406\u89c4\u5219\uff1a \u5982\u679cmake\u6784\u5efa\u4e86\u5b83\u5e76\u4e14\u662f\u901a\u5e38\u4f1a\u91cd\u65b0\u6784\u5efa\u7684\u6587\u4ef6\uff08\u6bd4\u5982.o\u6587\u4ef6\uff09\uff0c\u90a3\u4e48 mostclean \u5220\u9664\u5b83\u3002 \u5982\u679cmake\u6784\u5efa\u4e86\u5b83\uff0c\u90a3\u4e48 clean \u5220\u6389\u5b83\u3002 \u5982\u679c\u662fconfigure\u6784\u5efa\u4e86\u5b83\uff0c\u90a3\u4e48 distclean \u5220\u9664\u3002 \u5982\u679c\u662f\u7ef4\u62a4\u8005\u6784\u5efa\u7684\uff0c\u90a3\u4e48 maintainer-clean \u5220\u9664\u3002\u4e0d\u80fd\u6e05\u7406\u8fd0\u884c ./configure && make \u6240\u5fc5\u987b\u7684\u6587\u4ef6\u3002 \u53ef\u4ee5\u6269\u5c55\u3002\u53c2\u8003 \u89c4\u5219\u6269\u5c55 \u3002","title":"13.\u6e05\u7406"},{"location":"automake/14.%E5%8F%91%E5%B8%83/","text":"14.1 \u53d1\u5e03\u57fa\u7840 \u00b6 \u53ef\u4ee5\u53d1\u5e03\u591a\u79cd\u683c\u5f0f\u7684\u53d1\u5e03\u5305\uff0c\u4e0d\u53ea\u6709tar.gz\u3002 \u53d1\u5e03\u5305\u542b\u7684\u6587\u4ef6\uff1a \u6240\u6709\u7684\u6e90\u6587\u4ef6\uff0cMakefilea.am\u548cMakefile.in\u4e5f\u4f1a\u8fdb\u53bb Automake\u5185\u7f6e\u7684\u5e38\u7528\u6587\u4ef6\u5217\u8868\uff0c\u53ef\u4ee5\u901a\u8fc7 automake --help \u67e5\u770b \u4e00\u4e9b\u7279\u5b9a\u6761\u4ef6\u4e0b\u4ea7\u751f\u7684\u6587\u4ef6\uff08\u6bd4\u5982 AC_CONFIG_HEADERS([config.h]) \u4ea7\u51fa\u7684 config.h.top and config.h.bot \u6587\u4ef6\uff09 \u88abconfigure\u51c6\u5907\u7684\u6587\u4ef6 Makefile.am\u4e2d\u4f7f\u7528 include \u5217\u51fa\u7684\u6587\u4ef6\u3001configure.ac\u4e2d\u4f7f\u7528 m4_include \u5217\u51fa\u7684\u6587\u4ef6??? automake --add-missing \u5b89\u88c5\u7684\u5e2e\u52a9\u811a\u672c \u4e00\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u88ab\u89c4\u5219\u6240\u5305\u542b\uff0c\u53ef\u4ee5\u5728 EXTRA_DIST \u4e2d\u6307\u5b9a\u8fd9\u4e9b\u6587\u4ef6\uff08\u5939\uff09\u3002\u6307\u5b9a\u6587\u4ef6\u5939\u65f6\u53ef\u80fd\u4e0d\u4f1a\u60f3\u8981\u4f8b\u5982\u79c1\u6709\u6587\u4ef6\u5939.svn\u88ab\u5305\u542b\uff0c\u53ef\u4ee5\u4f7f\u7528\u7279\u6027 as-is \uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 disk-hook \u7279\u6027\u6765\u6539\u5584\u8fd9\u4e2a\u95ee\u9898\u3002see The dist Hook SUBDIRS \u4e5f\u4f1a\u9012\u5f52\u7684\u5305\u542b\u5b50\u76ee\u5f55\u3002\u53ef\u4ee5\u8bbe\u7f6e\u6761\u4ef6\uff0c see Conditionals \u3002\u5982\u679c\u9700\u8981\u6709\u6761\u4ef6\u7684\u6307\u5b9a\u4e00\u7cfb\u5217\u76ee\u5f55\uff0c\u53ef\u4ee5\u8bbe\u7f6e DIST_SUBDIRS \uff0c see Conditional Subdirectories \u3002 14.3 The dist Hook \u00b6 \u5728\u6253\u5305\u4e4b\u524d\u6539\u53d8\u3002\u5728\u53d1\u5e03\u6587\u4ef6\u5939\u88ab\u586b\u5145\u4e4b\u540e\u3001\u5b9e\u9645\u53d1\u5e03\u6863\u6848\u88ab\u521b\u5efa\u4e4b\u524d\u8fd0\u884c\u3002 EXTRA_DIST = doc dist-hook: rm -rf `find $(distdir)/doc -type d -name .svn` \u8be5\u89c4\u5219\u4e0d\u4f1a\u8ba4\u4e3a\u6587\u4ef6\u662f\u53ef\u5199\u7684\uff0c\u6240\u4ee5\u9700\u8981\u6539\u53d8\u6587\u4ef6\u5185\u5bb9\u65f6\uff0c\u6dfb\u52a0\u60f3\u5e94\u7684\u6743\u9650\u3002 (distdir) \u6307\u5411\u5f53\u524d\u6587\u4ef6\u5939\uff1b $(top_distdir) \u6307\u5411\u6839\u76ee\u5f55\u3002 Note \uff1awhen packages are nested using AC_CONFIG_SUBDIRS (see Subpackages), then \u2018$(distdir)\u2019 and \u2018$(top_distdir)\u2019 are relative to the package where \u2018make dist\u2019 was run, not to any sub-packages involved.","title":"14.\u53d1\u5e03"},{"location":"automake/14.%E5%8F%91%E5%B8%83/#141","text":"\u53ef\u4ee5\u53d1\u5e03\u591a\u79cd\u683c\u5f0f\u7684\u53d1\u5e03\u5305\uff0c\u4e0d\u53ea\u6709tar.gz\u3002 \u53d1\u5e03\u5305\u542b\u7684\u6587\u4ef6\uff1a \u6240\u6709\u7684\u6e90\u6587\u4ef6\uff0cMakefilea.am\u548cMakefile.in\u4e5f\u4f1a\u8fdb\u53bb Automake\u5185\u7f6e\u7684\u5e38\u7528\u6587\u4ef6\u5217\u8868\uff0c\u53ef\u4ee5\u901a\u8fc7 automake --help \u67e5\u770b \u4e00\u4e9b\u7279\u5b9a\u6761\u4ef6\u4e0b\u4ea7\u751f\u7684\u6587\u4ef6\uff08\u6bd4\u5982 AC_CONFIG_HEADERS([config.h]) \u4ea7\u51fa\u7684 config.h.top and config.h.bot \u6587\u4ef6\uff09 \u88abconfigure\u51c6\u5907\u7684\u6587\u4ef6 Makefile.am\u4e2d\u4f7f\u7528 include \u5217\u51fa\u7684\u6587\u4ef6\u3001configure.ac\u4e2d\u4f7f\u7528 m4_include \u5217\u51fa\u7684\u6587\u4ef6??? automake --add-missing \u5b89\u88c5\u7684\u5e2e\u52a9\u811a\u672c \u4e00\u4e9b\u6587\u4ef6\u4e0d\u4f1a\u88ab\u89c4\u5219\u6240\u5305\u542b\uff0c\u53ef\u4ee5\u5728 EXTRA_DIST \u4e2d\u6307\u5b9a\u8fd9\u4e9b\u6587\u4ef6\uff08\u5939\uff09\u3002\u6307\u5b9a\u6587\u4ef6\u5939\u65f6\u53ef\u80fd\u4e0d\u4f1a\u60f3\u8981\u4f8b\u5982\u79c1\u6709\u6587\u4ef6\u5939.svn\u88ab\u5305\u542b\uff0c\u53ef\u4ee5\u4f7f\u7528\u7279\u6027 as-is \uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 disk-hook \u7279\u6027\u6765\u6539\u5584\u8fd9\u4e2a\u95ee\u9898\u3002see The dist Hook SUBDIRS \u4e5f\u4f1a\u9012\u5f52\u7684\u5305\u542b\u5b50\u76ee\u5f55\u3002\u53ef\u4ee5\u8bbe\u7f6e\u6761\u4ef6\uff0c see Conditionals \u3002\u5982\u679c\u9700\u8981\u6709\u6761\u4ef6\u7684\u6307\u5b9a\u4e00\u7cfb\u5217\u76ee\u5f55\uff0c\u53ef\u4ee5\u8bbe\u7f6e DIST_SUBDIRS \uff0c see Conditional Subdirectories \u3002","title":"14.1 \u53d1\u5e03\u57fa\u7840"},{"location":"automake/14.%E5%8F%91%E5%B8%83/#143-the-dist-hook","text":"\u5728\u6253\u5305\u4e4b\u524d\u6539\u53d8\u3002\u5728\u53d1\u5e03\u6587\u4ef6\u5939\u88ab\u586b\u5145\u4e4b\u540e\u3001\u5b9e\u9645\u53d1\u5e03\u6863\u6848\u88ab\u521b\u5efa\u4e4b\u524d\u8fd0\u884c\u3002 EXTRA_DIST = doc dist-hook: rm -rf `find $(distdir)/doc -type d -name .svn` \u8be5\u89c4\u5219\u4e0d\u4f1a\u8ba4\u4e3a\u6587\u4ef6\u662f\u53ef\u5199\u7684\uff0c\u6240\u4ee5\u9700\u8981\u6539\u53d8\u6587\u4ef6\u5185\u5bb9\u65f6\uff0c\u6dfb\u52a0\u60f3\u5e94\u7684\u6743\u9650\u3002 (distdir) \u6307\u5411\u5f53\u524d\u6587\u4ef6\u5939\uff1b $(top_distdir) \u6307\u5411\u6839\u76ee\u5f55\u3002 Note \uff1awhen packages are nested using AC_CONFIG_SUBDIRS (see Subpackages), then \u2018$(distdir)\u2019 and \u2018$(top_distdir)\u2019 are relative to the package where \u2018make dist\u2019 was run, not to any sub-packages involved.","title":"14.3 The dist Hook"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/","text":"\u6d4b\u8bd5\u5957\u4ef6\u7531\u4e00\u7cfb\u5217\u7684\u6d4b\u8bd5\u7528\u4f8b\u7ec4\u6210\u3002 Automake\u53ef\u4ee5\u751f\u6210\u4ee3\u7801\u6765\u5904\u7406\u4e24\u79cd\u6d4b\u8bd5\u5957\u4ef6\u3002 \u57fa\u4e8e\u548c dejagnu \u6846\u67b6\u96c6\u6210\u3002 \u57fa\u4e8e\u901a\u7528\u6d4b\u8bd5\u811a\u672c\uff0c\u901a\u8fc7\u5b9a\u4e49\u7279\u6b8a\u53d8\u91cf TESTS \u6fc0\u6d3b\u3002\u597d\u50cf\u4e0d\u652f\u6301\u901a\u914d\u7b26\u3002 \u7b2c\u4e8c\u79cd\u5141\u8bb8\u5e76\u53d1\u6267\u884c\u6d4b\u8bd5\u811a\u672c\uff0c\u4f7f\u7528\u5df2\u6709\u7684\u6d4b\u8bd5\u534f\u8bae\uff08\u4f8b\u5982TAP\uff09\uff0c\u4ee5\u53ca\u81ea\u5b9a\u4e49\u6d4b\u8bd5\u9a71\u52a8\u7a0b\u5e8f\u548c\u6d4b\u8bd5\u8fd0\u884c\u7a0b\u5e8f\u3002 \u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7 make check \u8c03\u7528\u6d4b\u8bd5\u5957\u4ef6\u3002 \u4e00\u4e9b\u8bf4\u660e\uff1a \u8df3\u8fc7\u6d4b\u8bd5\uff08 skipped \uff09\uff1a\u6d4b\u8bd5\u6ca1\u6709\u610f\u4e49\uff0c\u6d4b\u8bd5\u6761\u4ef6\u4e0d\u6ee1\u8db3\u3002 \u786c\u9519\u8bef\uff08 hard error \uff09\uff1a\u6d4b\u8bd5\u573a\u666f\u4e0d\u5bf9\uff0c\u4e00\u4e9b\u610f\u5916\u60c5\u51b5\u3002 \u9884\u671f\u5931\u8d25 expected failure (xfail) \uff0c\u672a\u9884\u8ba1\u7684\u901a\u8fc7 unexpected pass (xpass) \u3002 15.2 \u7b80\u5355\u6d4b\u8bd5 \u00b6 15.2.1 \u57fa\u4e8e\u811a\u672c\u7684\u6d4b\u8bd5\u5957\u4ef6 \u00b6 \u5982\u679c TESTS \u53d8\u91cf\u88ab\u5b9a\u4e49\u4e86\uff0c\u5176\u503c\u662f\u6267\u884c\u6d4b\u8bd5\u7684\u7a0b\u5e8f\u6216\u811a\u672c\u5217\u8868\u3002 \u6d4b\u8bd5\u811a\u672c\u53ef\u4ee5\u5e76\u884c\u6216\u4e32\u884c\u6267\u884c\uff0c\u9ed8\u8ba4\u7684\u662f\u5e76\u884c\u6d4b\u8bd5\u5957\u4ef6\u3002 \u9ed8\u8ba4\u7684\u6d4b\u8bd5\u7ed3\u679c\u662f\u6d4b\u8bd5\u811a\u672c\u7684\u9000\u51fa\u7ed3\u679c\u3002 Automake\u4e5f\u652f\u6301\u66f4\u591a\u7684\u534f\u8bae\uff1astandard (see Using the TAP test protocol ) \u548c custom (see Custom Test Drivers )\u3002 note \uff1a\u4e0d\u80fd\u5728\u4e32\u884c\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u534f\u8bae\u3002 \u4e0d\u4f7f\u7528\u6d4b\u8bd5\u534f\u8bae\u7684\u65f6\u5019\uff0c\u6d4b\u8bd5\u811a\u672c\u7684\u9000\u51fa\u7801\u7684\u610f\u4e49\u5982\u4e0b\uff1a 0 - \u6210\u529f 77 - \u8df3\u8fc7\u8be5\u6d4b\u8bd5 99 - \u786c\u9519\u8bef \u5176\u5b83 - \u5931\u8d25 \u53ef\u4ee5\u4f7f\u7528 XFAIL_TESTS \u53d8\u91cf\u5217\u51fa xfail \u7684\u6d4b\u8bd5\uff0c\u5b83\u662f TESTS \u7684\u5b50\u96c6\u3002\u5b9a\u4e49 DISABLE_HARD_ERRORS \u53d8\u91cf\u4e3a\u975e\u7a7a\u503c\u6765\u9879\u666e\u901a\u7684\u9519\u8bef\u4e00\u6837\u5bf9\u5f85\u786c\u9519\u8bef\u3002 note \uff1a\u4f7f\u7528\u6d4b\u8bd5\u534f\u8bae\u7684\u65f6\u5019\uff0c\u8fd9\u4e24\u4e2a\u53d8\u91cf\u4e0d\u4f1a\u8d77\u4f5c\u7528\u3002 PASS : foo . sh PASS : zardoz . tap 1 - Daemon started PASS : zardoz . tap 2 - Daemon responding SKIP : zardoz . tap 3 - Daemon uses /proc # SKIP / proc is not mounted PASS : zardoz . tap 4 - Daemon stopped SKIP : bar . sh PASS : mu . tap 1 XFAIL : mu . tap 2 # TODO frobnication not yet implemented AM_COLOR_TESTS=always \uff0c\u5f69\u8272\u8f93\u51fa\u3002 AM_TESTS_ENVIRONMENT \u4e0e TESTS_ENVIRONMENT \u53d8\u91cf\u7528\u4e8e\u7ed9\u6d4b\u8bd5\u811a\u672c\u8fd0\u884c\u521d\u59cb\u5316\u4ee3\u7801\u548c\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002\u524d\u8005\u662f\u5f00\u53d1\u4eba\u5458\u4fdd\u7559\u7684\uff0c\u540e\u8005\u662f\u7528\u6237\u4fdd\u7559\u7684\uff08\u53ef\u6269\u5c55\u5e76\u4e14\u8986\u76d6\u524d\u8005\u7684\u8bbe\u7f6e\uff09\u3002\u975e\u7a7a\u7684 AM_TESTS_ENVIRONMENT \u5fc5\u987b\u4ee5\u5206\u53f7\u7ed3\u675f\uff0c\u4e14\u4e0d\u652f\u6301\u4e32\u884c\u6d4b\u8bd5\u3002 Automake\u4f1a\u4fdd\u8bc1\u6bcf\u4e2a\u5728 TEST \u4e2d\u5217\u51fa\u7684\u6587\u4ef6\u5728\u8fd0\u884c\u4e4b\u524d\u88ab\u6784\u5efa\u3002 \u5728 check_primary \u4e2d\u5217\u51fa\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u4e4b\u5728 make check \u7684\u65f6\u5019\u6784\u5efa\uff0c\u800c\u4e0d\u662f\u5728 make all \u671f\u95f4\u3002 15.2.2 \u4e32\u884c\u6d4b\u8bd5 \u00b6 \u5f3a\u70c8\u4e0d\u63a8\u8350\u4f7f\u7528\u3002 \u901a\u8fc7Automake\u9009\u9879 serial-tests \u5b9e\u73b0\u4e32\u884c\u6d4b\u8bd5 15.2.3 \u5e76\u884c\u6d4b\u8bd5 \u00b6 make -j \u6267\u884c\u5e76\u884c\u6d4b\u8bd5\u3002 make -j3 check \u6807\u51c6\u9519\u8bef\u4e0e\u6807\u51c6\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6bcf\u4e2a\u6d4b\u8bd5\u7684 .log \u6587\u4ef6\uff0c\u7ed3\u679c\u5728 .trs \u6587\u4ef6\u3002\u5931\u8d25\u7684\u6d4b\u8bd5\u6536\u96c6\u5728 test-suite.log \u6587\u4ef6\u4e2d\u3002 \u81ea\u5b9a\u4e49\u6d4b\u8bd5\u7a0b\u5e8f\uff1b\u6ca1\u6709\u6ce8\u518c\u7684\u6269\u5c55\u540d\u7684\u6d4b\u8bd5\uff0c\u4f1a\u4f7f\u7528\u53d8\u91cf LOG_COMPILER, AM_LOG_FLAGS, and LOG_FLAGS \uff1a TESTS = foo.pl bar.py baz TEST_EXTENSIONS = .pl .py PL_LOG_COMPILER = $(PERL) AM_PL_LOG_FLAGS = -w PY_LOG_COMPILER = $(PYTHON) AM_PY_LOG_FLAGS = -v LOG_COMPILER = ./wrapper-script AM_LOG_FLAGS = -d \u53ef\u4ee5\u4f7f\u7528 : \u6765\u4fdd\u8bc1\u6d4b\u8bd5\u7684\u4f9d\u8d56\u5173\u7cfb TESTS = foo-compile.test foo-execute.test foo-execute.log: foo-compile.log note \uff1a\u53ea\u4fdd\u8bc1\u987a\u5e8f\uff0c\u4e0d\u4fdd\u8bc1\u7ed3\u679c\u3002\u5373\u65e0\u8bbafoo-compile.test\u662f\u5426\u6210\u529f\uff0c\u90fd\u4f1a\u7ee7\u7eed\u6267\u884cfoo-execute.log\u3002 15.3 \u81ea\u5b9a\u4e49\u6d4b\u8bd5\u9a71\u52a8\u7a0b\u5e8f \u00b6 15.3.1 \u6982\u8ff0 \u00b6 \u81ea\u5b9a\u4e49\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u7684\u9884\u671f\u662f\uff1a\u6b63\u786e\u5730\u8fd0\u884c\u4f20\u9012\u7ed9\u5b83\u7684\u6d4b\u8bd5\u7a0b\u5e8f\uff08\u5305\u62ec\u547d\u4ee4\u884c\u4f20\u9012\u7ed9\u6d4b\u8bd5\u7a0b\u5e8f\u7684\u53c2\u6570\uff09\uff0c\u5206\u6790\u5b83\u4eec\u7684\u6267\u884c\u548c\u7ed3\u679c\uff0c\u521b\u5efa\u76f8\u5173\u7684 .log \u548c .trs \u6587\u4ef6\uff0c\u5728\u63a7\u5236\u53f0\u663e\u793a\u6d4b\u8bd5\u7ed3\u679c\u3002 \u5982\u4f55\u786e\u5b9a\u548c\u5206\u6790\u6d4b\u8bd5\u811a\u672c\u7ed3\u679c\u7684\u786e\u5207\u7ec6\u8282\u7531\u5404\u4e2a\u9a71\u52a8\u7a0b\u5e8f\u51b3\u5b9a\u3002 \u5373\u4f7f\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u6d4b\u8bd5\u9a71\u52a8\u7a0b\u5e8f\uff0c\u5e76\u884c\u6d4b\u8bd5\u7684\u5927\u90e8\u5206\u529f\u80fd\u4ecd\u7136\u8981\u5b9e\u73b0\uff1b\u5305\u62ec\u4ee5\u4e0b\u51e0\u70b9\uff1a \u5728 TESTS \u4e2d\u5b9a\u4e49\u6d4b\u8bd5\u811a\u672c\uff0c\u5e76\u5728\u8fd0\u884c\u65f6\u53ef\u901a\u8fc7 TESTS \u6216 TEST_LOGS \u8986\u76d6\u3002 \u901a\u8fc7\u4f7f\u7528make\u7684\u9009\u9879-j N \uff0c\u5e76\u53d1\u6267\u884c\u3002 \u6bcf\u4e2a\u6d4b\u8bd5\u7684 .log \u3001 .trs \u6587\u4ef6\uff0c\u8fd8\u6709\u6458\u8981\u7684 .log \u6587\u4ef6\u3002 recheck \u76ee\u6807\uff0c RECHECK_LOGS \u53d8\u91cf\uff0c\u6d4b\u8bd5\u61d2\u91cd\u65b0\u8fd0\u884c\u3002 \u6d4b\u8bd5\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u3002 \u5bf9 check_* \u53d8\u91cf\u7684\u652f\u6301\uff08check_PROGRAMS, check_LIBRARIES, ...\uff09\u3002 \u4f7f\u7528 VERBOSE \u73af\u5883\u53d8\u91cf\u83b7\u53d6\u6d4b\u8bd5\u5957\u4ef6\u5931\u8d25\u7684\u8be6\u7ec6\u8f93\u51fa\u3002 \u5b9a\u4e49 TESTS_ENVIRONMENT, AM_TESTS_ENVIRONMENT and AM_TESTS_FD_REDIRECT \u53d8\u91cf\u3002 \u901a\u7528\u5b9a\u4e49\u548c\u6269\u5c55\u5b9a\u4e49 LOG_COMPILER \u548c LOG_FLAGS \u53d8\u91cf\u3002 15.3.2 \u58f0\u660e\u9a71\u52a8 \u00b6 \u901a\u8fc7\u5b9a\u4e49make\u53d8\u91cf LOG_DRIVER \u6216 ext_LOG_DRIVER \uff08 ext \u5fc5\u987b\u5728 TEST_EXTENSIONS \u4e2d\u58f0\u660e\uff09\u6765\u58f0\u660e\u81ea\u5b9a\u4e49\u7684\u6d4b\u8bd5\u5957\u4ef6\u9a71\u52a8\u3002 \u5f00\u53d1\u8005\u4fdd\u7559\u53d8\u91cf AM_DRIVER_FLAGS \u548c\u7528\u6237\u4fdd\u7559\u53d8\u91cf LOG_DRIVER_FLAGS \u53ef\u88ab\u7528\u4e8e\u5b9a\u4e49 flags \uff0c\u4f1a\u88ab\u4f20\u7ed9\u6bcf\u4e2a LOG_DRIVER \u8c03\u7528\u3002\u7c7b\u4f3c\u7684\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5728 TEST_EXTENSIONS \u4e2d\u58f0\u660e\u7684\u6269\u5c55 ext \uff0c\u5728 AM_ext_LOG_DRIVER_FLAGS \u548c ext_LOG_DRIVER_FLAGS \u4e2d\u5217\u51fa\u7684 flags \u4f1a\u88ab\u4f20\u9012\u7ed9 ext_LOG_DRIVER \u3002 15.3.3 \u5b9a\u5236\u6d4b\u8bd5\u9a71\u52a8\u7684 API \u00b6 pass 15.4 TAP \u6d4b\u8bd5\u534f\u8bae \u00b6 15.4.1 \u4ecb\u7ecd \u00b6 TAP\uff0c the Test Anything Protocol\uff0c\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u57fa\u4e8e\u6587\u672c\u7684\u5728\u6d4b\u8bd5\u6a21\u5757\uff08\u6216\u7a0b\u5e8f\uff09\u4e0e\u6d4b\u8bd5\u5de5\u5177\u4e4b\u95f4\u7684\u63a5\u53e3\u3002 The tests (TAP producers) \u5411\u6807\u51c6\u8f93\u51fa\u4e2d\u4ee5\u4e00\u79cd\u7b80\u5355\u7684\u683c\u5f0f\u5199\u5165\u6d4b\u8bd5\u7ed3\u679c\uff1b a test harness (TAP consumer)\u4f1a\u89e3\u6790\u548c\u89e3\u91ca\u8fd9\u4e9b\u7ed3\u679c\uff0c\u6b63\u786e\u5730\u5448\u73b0\u7ed9\u7528\u6237\uff0c\u5e76\u4e14/\u6216\u8005\u4e3a\u7a0d\u540e\u7684\u5206\u6790\u6ce8\u518c\u7ed3\u679c\u3002 15.4.2 \u7ed3\u5408Automake\u6d4b\u8bd5\u5de5\u5177\u4f7f\u7528 \u00b6 \u76ee\u524dAutomake\u9644\u5e26\u7684TAP\u9a71\u52a8\u7a0b\u5e8f\u9700\u8981\u4e00\u4e9b\u624b\u52a8\u914d\u7f6e\u3002\u5fc5\u987b\u4eceAutomake\u7684\u53d1\u884c\u7248\u4e2d\u83b7\u53d6 tap-driver.sh \u811a\u672c\uff0c\u590d\u5236\u5230\u6e90\u7801\u76ee\u5f55\uff0c\u7136\u540e\u4f7f\u7528Automake\u652f\u6301\u7684\u7b2c\u4e09\u65b9\u6d4b\u8bd5\u9a71\u52a8\u6765\u6307\u5bfc\u5de5\u5177\u4fe9\u4f7f\u7528\u8be5\u811a\u672c\u548c AM_INIT_AUTOMAKE \u53d1\u73b0\u7684awk\u7a0b\u5e8f\u6765\u8fd0\u884c\u81ea\u5df1\u7684 TAP-producing \u6d4b\u8bd5\u3002 \u9664\u4e86\u901a\u7528\u7684Automake\u6d4b\u8bd5\u9a71\u52a8\u9009\u9879\uff0c tap-driver.sh \u8fd8\u652f\u6301\u4ee5\u4e0b\u9009\u9879\uff1a --ignore-exit \u5ffd\u89c6\u6d4b\u8bd5\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\uff1b\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u811a\u672c\u4ee5\u975e\u96f6\u72b6\u6001\u9000\u51fa\uff0c\u9a71\u52a8\u4f1a\u62a5\u544a\u4e00\u4e2a\u9519\u8bef\u3002 --comments \u6307\u793a\u6d4b\u8bd5\u9a71\u52a8\u7a0b\u5e8f\u5728\u6d4b\u8bd5\u5957\u4ef6\u7684\u8f93\u51fa\u4e5f\u663e\u793aTAP\u6ce8\u91ca\uff08\u5373\u4ee5 # \u5f00\u5934\u7684\u884c\uff09\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6ce8\u91ca\u53ea\u4f1a\u590d\u5236\u5230 .log \u6587\u4ef6\u3002 --no-comments --merge \u6307\u793a\u6d4b\u8bd5\u9a71\u52a8\u5408\u5e76\u6d4b\u8bd5\u811a\u672c\u7684\u6807\u51c6\u9519\u8bef\u5230\u4ed6\u4eec\u7684\u6807\u51c6\u8f93\u51fa\u3002\u5982\u679c\u4f60\u60f3\u4fdd\u8bc1\u6d4b\u8bd5\u811a\u672c\u4e2d\u7684\u6ce8\u91ca\u4e0e\u6d4b\u8bd5\u7ed3\u679c\u4e00\u8d77\u663e\u793a\uff0c\u8be5\u9009\u9879\u662f\u5fc5\u987b\u7684\u3002 --no-merge --diagnostic-string=STRING \u6539\u53d8\u6ce8\u91ca\u7684\u7b26\u53f7\uff1a # -> STRING \u3002\u975eTAP\u5b98\u65b9\u6807\u51c6\u3002","title":"15.\u6d4b\u8bd5\u5957\u4ef6\u7684\u652f\u6301"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#152","text":"","title":"15.2 \u7b80\u5355\u6d4b\u8bd5"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#1521","text":"\u5982\u679c TESTS \u53d8\u91cf\u88ab\u5b9a\u4e49\u4e86\uff0c\u5176\u503c\u662f\u6267\u884c\u6d4b\u8bd5\u7684\u7a0b\u5e8f\u6216\u811a\u672c\u5217\u8868\u3002 \u6d4b\u8bd5\u811a\u672c\u53ef\u4ee5\u5e76\u884c\u6216\u4e32\u884c\u6267\u884c\uff0c\u9ed8\u8ba4\u7684\u662f\u5e76\u884c\u6d4b\u8bd5\u5957\u4ef6\u3002 \u9ed8\u8ba4\u7684\u6d4b\u8bd5\u7ed3\u679c\u662f\u6d4b\u8bd5\u811a\u672c\u7684\u9000\u51fa\u7ed3\u679c\u3002 Automake\u4e5f\u652f\u6301\u66f4\u591a\u7684\u534f\u8bae\uff1astandard (see Using the TAP test protocol ) \u548c custom (see Custom Test Drivers )\u3002 note \uff1a\u4e0d\u80fd\u5728\u4e32\u884c\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u534f\u8bae\u3002 \u4e0d\u4f7f\u7528\u6d4b\u8bd5\u534f\u8bae\u7684\u65f6\u5019\uff0c\u6d4b\u8bd5\u811a\u672c\u7684\u9000\u51fa\u7801\u7684\u610f\u4e49\u5982\u4e0b\uff1a 0 - \u6210\u529f 77 - \u8df3\u8fc7\u8be5\u6d4b\u8bd5 99 - \u786c\u9519\u8bef \u5176\u5b83 - \u5931\u8d25 \u53ef\u4ee5\u4f7f\u7528 XFAIL_TESTS \u53d8\u91cf\u5217\u51fa xfail \u7684\u6d4b\u8bd5\uff0c\u5b83\u662f TESTS \u7684\u5b50\u96c6\u3002\u5b9a\u4e49 DISABLE_HARD_ERRORS \u53d8\u91cf\u4e3a\u975e\u7a7a\u503c\u6765\u9879\u666e\u901a\u7684\u9519\u8bef\u4e00\u6837\u5bf9\u5f85\u786c\u9519\u8bef\u3002 note \uff1a\u4f7f\u7528\u6d4b\u8bd5\u534f\u8bae\u7684\u65f6\u5019\uff0c\u8fd9\u4e24\u4e2a\u53d8\u91cf\u4e0d\u4f1a\u8d77\u4f5c\u7528\u3002 PASS : foo . sh PASS : zardoz . tap 1 - Daemon started PASS : zardoz . tap 2 - Daemon responding SKIP : zardoz . tap 3 - Daemon uses /proc # SKIP / proc is not mounted PASS : zardoz . tap 4 - Daemon stopped SKIP : bar . sh PASS : mu . tap 1 XFAIL : mu . tap 2 # TODO frobnication not yet implemented AM_COLOR_TESTS=always \uff0c\u5f69\u8272\u8f93\u51fa\u3002 AM_TESTS_ENVIRONMENT \u4e0e TESTS_ENVIRONMENT \u53d8\u91cf\u7528\u4e8e\u7ed9\u6d4b\u8bd5\u811a\u672c\u8fd0\u884c\u521d\u59cb\u5316\u4ee3\u7801\u548c\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002\u524d\u8005\u662f\u5f00\u53d1\u4eba\u5458\u4fdd\u7559\u7684\uff0c\u540e\u8005\u662f\u7528\u6237\u4fdd\u7559\u7684\uff08\u53ef\u6269\u5c55\u5e76\u4e14\u8986\u76d6\u524d\u8005\u7684\u8bbe\u7f6e\uff09\u3002\u975e\u7a7a\u7684 AM_TESTS_ENVIRONMENT \u5fc5\u987b\u4ee5\u5206\u53f7\u7ed3\u675f\uff0c\u4e14\u4e0d\u652f\u6301\u4e32\u884c\u6d4b\u8bd5\u3002 Automake\u4f1a\u4fdd\u8bc1\u6bcf\u4e2a\u5728 TEST \u4e2d\u5217\u51fa\u7684\u6587\u4ef6\u5728\u8fd0\u884c\u4e4b\u524d\u88ab\u6784\u5efa\u3002 \u5728 check_primary \u4e2d\u5217\u51fa\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u4e4b\u5728 make check \u7684\u65f6\u5019\u6784\u5efa\uff0c\u800c\u4e0d\u662f\u5728 make all \u671f\u95f4\u3002","title":"15.2.1 \u57fa\u4e8e\u811a\u672c\u7684\u6d4b\u8bd5\u5957\u4ef6"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#1522","text":"\u5f3a\u70c8\u4e0d\u63a8\u8350\u4f7f\u7528\u3002 \u901a\u8fc7Automake\u9009\u9879 serial-tests \u5b9e\u73b0\u4e32\u884c\u6d4b\u8bd5","title":"15.2.2 \u4e32\u884c\u6d4b\u8bd5"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#1523","text":"make -j \u6267\u884c\u5e76\u884c\u6d4b\u8bd5\u3002 make -j3 check \u6807\u51c6\u9519\u8bef\u4e0e\u6807\u51c6\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6bcf\u4e2a\u6d4b\u8bd5\u7684 .log \u6587\u4ef6\uff0c\u7ed3\u679c\u5728 .trs \u6587\u4ef6\u3002\u5931\u8d25\u7684\u6d4b\u8bd5\u6536\u96c6\u5728 test-suite.log \u6587\u4ef6\u4e2d\u3002 \u81ea\u5b9a\u4e49\u6d4b\u8bd5\u7a0b\u5e8f\uff1b\u6ca1\u6709\u6ce8\u518c\u7684\u6269\u5c55\u540d\u7684\u6d4b\u8bd5\uff0c\u4f1a\u4f7f\u7528\u53d8\u91cf LOG_COMPILER, AM_LOG_FLAGS, and LOG_FLAGS \uff1a TESTS = foo.pl bar.py baz TEST_EXTENSIONS = .pl .py PL_LOG_COMPILER = $(PERL) AM_PL_LOG_FLAGS = -w PY_LOG_COMPILER = $(PYTHON) AM_PY_LOG_FLAGS = -v LOG_COMPILER = ./wrapper-script AM_LOG_FLAGS = -d \u53ef\u4ee5\u4f7f\u7528 : \u6765\u4fdd\u8bc1\u6d4b\u8bd5\u7684\u4f9d\u8d56\u5173\u7cfb TESTS = foo-compile.test foo-execute.test foo-execute.log: foo-compile.log note \uff1a\u53ea\u4fdd\u8bc1\u987a\u5e8f\uff0c\u4e0d\u4fdd\u8bc1\u7ed3\u679c\u3002\u5373\u65e0\u8bbafoo-compile.test\u662f\u5426\u6210\u529f\uff0c\u90fd\u4f1a\u7ee7\u7eed\u6267\u884cfoo-execute.log\u3002","title":"15.2.3 \u5e76\u884c\u6d4b\u8bd5"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#153","text":"","title":"15.3 \u81ea\u5b9a\u4e49\u6d4b\u8bd5\u9a71\u52a8\u7a0b\u5e8f"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#1531","text":"\u81ea\u5b9a\u4e49\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u7684\u9884\u671f\u662f\uff1a\u6b63\u786e\u5730\u8fd0\u884c\u4f20\u9012\u7ed9\u5b83\u7684\u6d4b\u8bd5\u7a0b\u5e8f\uff08\u5305\u62ec\u547d\u4ee4\u884c\u4f20\u9012\u7ed9\u6d4b\u8bd5\u7a0b\u5e8f\u7684\u53c2\u6570\uff09\uff0c\u5206\u6790\u5b83\u4eec\u7684\u6267\u884c\u548c\u7ed3\u679c\uff0c\u521b\u5efa\u76f8\u5173\u7684 .log \u548c .trs \u6587\u4ef6\uff0c\u5728\u63a7\u5236\u53f0\u663e\u793a\u6d4b\u8bd5\u7ed3\u679c\u3002 \u5982\u4f55\u786e\u5b9a\u548c\u5206\u6790\u6d4b\u8bd5\u811a\u672c\u7ed3\u679c\u7684\u786e\u5207\u7ec6\u8282\u7531\u5404\u4e2a\u9a71\u52a8\u7a0b\u5e8f\u51b3\u5b9a\u3002 \u5373\u4f7f\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u6d4b\u8bd5\u9a71\u52a8\u7a0b\u5e8f\uff0c\u5e76\u884c\u6d4b\u8bd5\u7684\u5927\u90e8\u5206\u529f\u80fd\u4ecd\u7136\u8981\u5b9e\u73b0\uff1b\u5305\u62ec\u4ee5\u4e0b\u51e0\u70b9\uff1a \u5728 TESTS \u4e2d\u5b9a\u4e49\u6d4b\u8bd5\u811a\u672c\uff0c\u5e76\u5728\u8fd0\u884c\u65f6\u53ef\u901a\u8fc7 TESTS \u6216 TEST_LOGS \u8986\u76d6\u3002 \u901a\u8fc7\u4f7f\u7528make\u7684\u9009\u9879-j N \uff0c\u5e76\u53d1\u6267\u884c\u3002 \u6bcf\u4e2a\u6d4b\u8bd5\u7684 .log \u3001 .trs \u6587\u4ef6\uff0c\u8fd8\u6709\u6458\u8981\u7684 .log \u6587\u4ef6\u3002 recheck \u76ee\u6807\uff0c RECHECK_LOGS \u53d8\u91cf\uff0c\u6d4b\u8bd5\u61d2\u91cd\u65b0\u8fd0\u884c\u3002 \u6d4b\u8bd5\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u3002 \u5bf9 check_* \u53d8\u91cf\u7684\u652f\u6301\uff08check_PROGRAMS, check_LIBRARIES, ...\uff09\u3002 \u4f7f\u7528 VERBOSE \u73af\u5883\u53d8\u91cf\u83b7\u53d6\u6d4b\u8bd5\u5957\u4ef6\u5931\u8d25\u7684\u8be6\u7ec6\u8f93\u51fa\u3002 \u5b9a\u4e49 TESTS_ENVIRONMENT, AM_TESTS_ENVIRONMENT and AM_TESTS_FD_REDIRECT \u53d8\u91cf\u3002 \u901a\u7528\u5b9a\u4e49\u548c\u6269\u5c55\u5b9a\u4e49 LOG_COMPILER \u548c LOG_FLAGS \u53d8\u91cf\u3002","title":"15.3.1 \u6982\u8ff0"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#1532","text":"\u901a\u8fc7\u5b9a\u4e49make\u53d8\u91cf LOG_DRIVER \u6216 ext_LOG_DRIVER \uff08 ext \u5fc5\u987b\u5728 TEST_EXTENSIONS \u4e2d\u58f0\u660e\uff09\u6765\u58f0\u660e\u81ea\u5b9a\u4e49\u7684\u6d4b\u8bd5\u5957\u4ef6\u9a71\u52a8\u3002 \u5f00\u53d1\u8005\u4fdd\u7559\u53d8\u91cf AM_DRIVER_FLAGS \u548c\u7528\u6237\u4fdd\u7559\u53d8\u91cf LOG_DRIVER_FLAGS \u53ef\u88ab\u7528\u4e8e\u5b9a\u4e49 flags \uff0c\u4f1a\u88ab\u4f20\u7ed9\u6bcf\u4e2a LOG_DRIVER \u8c03\u7528\u3002\u7c7b\u4f3c\u7684\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5728 TEST_EXTENSIONS \u4e2d\u58f0\u660e\u7684\u6269\u5c55 ext \uff0c\u5728 AM_ext_LOG_DRIVER_FLAGS \u548c ext_LOG_DRIVER_FLAGS \u4e2d\u5217\u51fa\u7684 flags \u4f1a\u88ab\u4f20\u9012\u7ed9 ext_LOG_DRIVER \u3002","title":"15.3.2 \u58f0\u660e\u9a71\u52a8"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#1533-api","text":"pass","title":"15.3.3 \u5b9a\u5236\u6d4b\u8bd5\u9a71\u52a8\u7684 API"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#154-tap","text":"","title":"15.4 TAP \u6d4b\u8bd5\u534f\u8bae"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#1541","text":"TAP\uff0c the Test Anything Protocol\uff0c\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u57fa\u4e8e\u6587\u672c\u7684\u5728\u6d4b\u8bd5\u6a21\u5757\uff08\u6216\u7a0b\u5e8f\uff09\u4e0e\u6d4b\u8bd5\u5de5\u5177\u4e4b\u95f4\u7684\u63a5\u53e3\u3002 The tests (TAP producers) \u5411\u6807\u51c6\u8f93\u51fa\u4e2d\u4ee5\u4e00\u79cd\u7b80\u5355\u7684\u683c\u5f0f\u5199\u5165\u6d4b\u8bd5\u7ed3\u679c\uff1b a test harness (TAP consumer)\u4f1a\u89e3\u6790\u548c\u89e3\u91ca\u8fd9\u4e9b\u7ed3\u679c\uff0c\u6b63\u786e\u5730\u5448\u73b0\u7ed9\u7528\u6237\uff0c\u5e76\u4e14/\u6216\u8005\u4e3a\u7a0d\u540e\u7684\u5206\u6790\u6ce8\u518c\u7ed3\u679c\u3002","title":"15.4.1 \u4ecb\u7ecd"},{"location":"automake/15.%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E7%9A%84%E6%94%AF%E6%8C%81/#1542-automake","text":"\u76ee\u524dAutomake\u9644\u5e26\u7684TAP\u9a71\u52a8\u7a0b\u5e8f\u9700\u8981\u4e00\u4e9b\u624b\u52a8\u914d\u7f6e\u3002\u5fc5\u987b\u4eceAutomake\u7684\u53d1\u884c\u7248\u4e2d\u83b7\u53d6 tap-driver.sh \u811a\u672c\uff0c\u590d\u5236\u5230\u6e90\u7801\u76ee\u5f55\uff0c\u7136\u540e\u4f7f\u7528Automake\u652f\u6301\u7684\u7b2c\u4e09\u65b9\u6d4b\u8bd5\u9a71\u52a8\u6765\u6307\u5bfc\u5de5\u5177\u4fe9\u4f7f\u7528\u8be5\u811a\u672c\u548c AM_INIT_AUTOMAKE \u53d1\u73b0\u7684awk\u7a0b\u5e8f\u6765\u8fd0\u884c\u81ea\u5df1\u7684 TAP-producing \u6d4b\u8bd5\u3002 \u9664\u4e86\u901a\u7528\u7684Automake\u6d4b\u8bd5\u9a71\u52a8\u9009\u9879\uff0c tap-driver.sh \u8fd8\u652f\u6301\u4ee5\u4e0b\u9009\u9879\uff1a --ignore-exit \u5ffd\u89c6\u6d4b\u8bd5\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\uff1b\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u811a\u672c\u4ee5\u975e\u96f6\u72b6\u6001\u9000\u51fa\uff0c\u9a71\u52a8\u4f1a\u62a5\u544a\u4e00\u4e2a\u9519\u8bef\u3002 --comments \u6307\u793a\u6d4b\u8bd5\u9a71\u52a8\u7a0b\u5e8f\u5728\u6d4b\u8bd5\u5957\u4ef6\u7684\u8f93\u51fa\u4e5f\u663e\u793aTAP\u6ce8\u91ca\uff08\u5373\u4ee5 # \u5f00\u5934\u7684\u884c\uff09\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6ce8\u91ca\u53ea\u4f1a\u590d\u5236\u5230 .log \u6587\u4ef6\u3002 --no-comments --merge \u6307\u793a\u6d4b\u8bd5\u9a71\u52a8\u5408\u5e76\u6d4b\u8bd5\u811a\u672c\u7684\u6807\u51c6\u9519\u8bef\u5230\u4ed6\u4eec\u7684\u6807\u51c6\u8f93\u51fa\u3002\u5982\u679c\u4f60\u60f3\u4fdd\u8bc1\u6d4b\u8bd5\u811a\u672c\u4e2d\u7684\u6ce8\u91ca\u4e0e\u6d4b\u8bd5\u7ed3\u679c\u4e00\u8d77\u663e\u793a\uff0c\u8be5\u9009\u9879\u662f\u5fc5\u987b\u7684\u3002 --no-merge --diagnostic-string=STRING \u6539\u53d8\u6ce8\u91ca\u7684\u7b26\u53f7\uff1a # -> STRING \u3002\u975eTAP\u5b98\u65b9\u6807\u51c6\u3002","title":"15.4.2 \u7ed3\u5408Automake\u6d4b\u8bd5\u5de5\u5177\u4f7f\u7528"},{"location":"automake/18.%E8%A7%84%E5%88%99%E6%9D%82%E9%A1%B9/","text":"\u5904\u7406\u65b0\u7684\u6587\u4ef6\u6269\u5c55\uff08\u540e\u7f00\u89c4\u5219\uff09 \u00b6 \u5411Automake\u4ecb\u7ecd\u4e00\u79cd\u65b0\u7684\u9690\u542b\u89c4\u5219\u6765\u5904\u7406\u4e00\u79cd\u6587\u4ef6\u7c7b\u578b\u3002 1.\u6bd4\u5982\uff0c\u4f60\u6709\u4e00\u4e2a\u7f16\u8bd1\u5668\u53ef\u4ee5\u7f16\u8bd1.foo\u6587\u4ef6\u5230.o\u6587\u4ef6\u3002\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u540e\u7f00\u89c4\u5219\uff1a .foo.o: foocc - c - o $@ $ < \u7136\u540e\u5728 _SOURCE \u53d8\u91cf\u4e2d\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528.foo\u6587\u4ef6\uff1a bin_PROGRAMS = doit doit_SOURCES = doit.foo 2.\u53e6\u4e00\u79cd\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u5e2e\u52a9Automake\u8bc6\u522b\u4f60\u4e3a\u540e\u7f00\u89c4\u5219\u5b9a\u4e49\u7684\u6269\u5c55\u3002\u901a\u5e38\u662f\u4f60\u7684\u6269\u5c55\u4e0d\u662f\u4ee5 . \u5f00\u5934\u7684\u60c5\u51b5\u3002\u4f60\u9700\u8981\u5728\u5b9a\u4e49\u81ea\u5df1\u7684\u94f6\u884c\u89c4\u5219\u4e4b\u524d\uff0c\u5c06\u653e\u7f6e\u65b0\u540e\u7f00\u5217\u8868\u5230 SUFFIXES \u53d8\u91cf\u4e2d\u3002 SUFFIXES = .idl C.cpp .idlC.cpp: # whatever SUFFIXES \u7684\u884c\u4e3a\u5f88\u50cfmake\u4e2d\u7684 .SUFFIXES \u7279\u6b8a\u76ee\u6807\uff0c\u5e94\u8be5\u4f7f\u7528 SUFFIXES \u8ba9Automake\u4e3a .SUFFIXES \u751f\u6210\u540e\u7f00\u5217\u8868\u3002\u8be5\u53d8\u91cf\u4e2d\u7684\u540e\u7f00\u4f1a\u5728\u751f\u6210\u7684\u540e\u7f00\u5217\u8868\u7684\u5934\u90e8\uff0c\u5373\u4f1a\u8986\u76d6\u6389\u539f\u5148\u7684\u9690\u542b\u89c4\u5219\u3002","title":"18.\u89c4\u5219\u6742\u9879"},{"location":"automake/18.%E8%A7%84%E5%88%99%E6%9D%82%E9%A1%B9/#_1","text":"\u5411Automake\u4ecb\u7ecd\u4e00\u79cd\u65b0\u7684\u9690\u542b\u89c4\u5219\u6765\u5904\u7406\u4e00\u79cd\u6587\u4ef6\u7c7b\u578b\u3002 1.\u6bd4\u5982\uff0c\u4f60\u6709\u4e00\u4e2a\u7f16\u8bd1\u5668\u53ef\u4ee5\u7f16\u8bd1.foo\u6587\u4ef6\u5230.o\u6587\u4ef6\u3002\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u540e\u7f00\u89c4\u5219\uff1a .foo.o: foocc - c - o $@ $ < \u7136\u540e\u5728 _SOURCE \u53d8\u91cf\u4e2d\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528.foo\u6587\u4ef6\uff1a bin_PROGRAMS = doit doit_SOURCES = doit.foo 2.\u53e6\u4e00\u79cd\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u5e2e\u52a9Automake\u8bc6\u522b\u4f60\u4e3a\u540e\u7f00\u89c4\u5219\u5b9a\u4e49\u7684\u6269\u5c55\u3002\u901a\u5e38\u662f\u4f60\u7684\u6269\u5c55\u4e0d\u662f\u4ee5 . \u5f00\u5934\u7684\u60c5\u51b5\u3002\u4f60\u9700\u8981\u5728\u5b9a\u4e49\u81ea\u5df1\u7684\u94f6\u884c\u89c4\u5219\u4e4b\u524d\uff0c\u5c06\u653e\u7f6e\u65b0\u540e\u7f00\u5217\u8868\u5230 SUFFIXES \u53d8\u91cf\u4e2d\u3002 SUFFIXES = .idl C.cpp .idlC.cpp: # whatever SUFFIXES \u7684\u884c\u4e3a\u5f88\u50cfmake\u4e2d\u7684 .SUFFIXES \u7279\u6b8a\u76ee\u6807\uff0c\u5e94\u8be5\u4f7f\u7528 SUFFIXES \u8ba9Automake\u4e3a .SUFFIXES \u751f\u6210\u540e\u7f00\u5217\u8868\u3002\u8be5\u53d8\u91cf\u4e2d\u7684\u540e\u7f00\u4f1a\u5728\u751f\u6210\u7684\u540e\u7f00\u5217\u8868\u7684\u5934\u90e8\uff0c\u5373\u4f1a\u8986\u76d6\u6389\u539f\u5148\u7684\u9690\u542b\u89c4\u5219\u3002","title":"\u5904\u7406\u65b0\u7684\u6587\u4ef6\u6269\u5c55\uff08\u540e\u7f00\u89c4\u5219\uff09"},{"location":"automake/19.Include/","text":"Automake\u652f\u6301 include \u6307\u4ee4\uff0c\u53ef\u4ee5\u7528\u4e8e\u5728automake\u8fd0\u884c\u7684\u65f6\u5019\u5305\u62ec\u5176\u4ed6Makefile\u7247\u6bb5\u3002 include $(top_srcdir)/build-aux/Makefile.subs \u5728\u7247\u6bb5\u4e2d\uff0c\u7ed3\u6784\u4f53 %reldir% \u88ab\u66ff\u6362\u4e3a\u5bf9\u4e8e\u57fa\u672c\u7684Makefile.am\u7684\u76f8\u5bf9\u8def\u5f84\u3002\u76f8\u4f3c\u7684\uff0c %canon_reldir% \u4e5f\u4ece %reldir% \u4e2d\u88ab\u89c4\u8303\u5730\u66ff\u6362\u4e86\u3002 note \uff1a\u5982\u679c\u7247\u6bb5\u4e0eMakefile.am\u5728\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\uff0c\u90a3\u4e48\u4e0a\u8ff0\u7684\u7ed3\u6784\u4f53\u4f1a\u662f\u7a7a\u5b57\u7b26\u4e32","title":"19.Include"},{"location":"automake/20.%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/","text":"\u8fd9\u4e9b\u6761\u4ef6\u8bed\u53e5\u548cMake\u7684\u6761\u4ef6\u8bed\u53e5\u4e0d\u4e00\u6837\u3002Automake\u7684\u6761\u4ef6\u8bed\u53e5\u7684\u68c0\u67e5\u662f\u5728\u8fd0\u884cconfigure\u811a\u672c\u7684\u671f\u95f4\uff0c\u5f71\u54cd\u7684\u662f Makefile.in -> Makefile \u3002 \u6761\u4ef6\u8bed\u53e5\u7684\u4f7f\u7528 \u00b6 AM_CONDITIONAL (name, condition) \u00b6 \u5728\u4f7f\u7528\u6761\u4ef6\u8bed\u53e5\u4e4b\u524d\uff0c\u5fc5\u987b\u5728configure.ac\u7684\u6b64\u5b8f\u4e2d\u5b9a\u4e49\u3002 \u8be5\u5b8f\u7684\u4f5c\u7528\u5c31\u662f\u6267\u884c condition \uff0c\u5c06\u771f\u5047\u7ed3\u679c\u8fd4\u56de\u7ed9 name \u3002 name \u5fc5\u987b\u7531\u5b57\u6bcd\u5f00\u5934\u4e14\u53ea\u80fd\u7531\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210\uff0c\u5e76\u4e14\u4e0d\u80fd\u662fAutomake\u7684\u4fdd\u7559\u5b57\u3002 \u5f53configure\u8fd0\u884c\u7684\u65f6\u5019shell\u811a\u672c condition \u4f1a\u88ab\u6267\u884c\u3002 \u6ce8\u610f\u6bcf\u6b21\u8fd0\u884cconfigure\u7684\u65f6\u5019\u6bcf\u4e2a AM_CONDITIONAL \u90fd\u5fc5\u987b\u88ab\u8c03\u7528\uff0c\u5426\u5219\u4f1a\u6df7\u6dc6automake\u3002\u6b64\u5b8f\u4e2d\u5b9a\u4e49\u7684\u5224\u65ad\u8bed\u53e5\u53ef\u5728Makefile.am\u4e2d\u88ab\u8c03\u7528\u3002 AC_ARG_ENABLE ( [ debug ] , [ --enable-debug Turn on debugging ] , [ case \"${enableval}\" in yes) debug=true ;; no) debug=false ;; *) AC_MSG_ERROR([bad value ${enableval} for --enable-debug ] ) ;; esac ] , [ debug=false ] ) AM_CONDITIONAL ( [ DEBUG ] , [ test x$debug = xtrue ] ) \u7136\u540e\u4f60\u53ef\u4ee5\u5728Makefile.am\u4e2d\u8fd9\u6837\u4f7f\u7528\uff08make\u8bed\u6cd5\uff09\uff1a if DEBUG DBG = debug else DBG = endif noinst_PROGRAMS = $(DBG) \u4e3a\u4e86\u53ef\u4ee5\u83b7\u53d6\u5728configure.ac\u4e2d\u6b64\u5b8f\u6ce8\u518c\u7684\u6761\u4ef6\u8bed\u53e5\uff0c\u5e76\u4e14\u5141\u8bb8\u6761\u4ef6\u7684\u5b9a\u4e49 AC_CONFIG_FILES \uff0c AM_COND_IF \u53ef\u80fd\u4f1a\u88ab\u4f7f\u7528\uff1a AM_COND_IF (conditional, [if-true], [if-false]) \u00b6 \u5982\u679c\u4efb\u4e00\u5206\u652f\u5305\u542b AC_CONFIG_FILES \uff0c\u4f1a\u5bfc\u81f4automake\u4ec5\u9488\u5bf9\u76f8\u5e94\u7684\u6761\u4ef6\u8f93\u51fa\u76f8\u5e94\u6587\u4ef6\u7684\u89c4\u5219\u3002 AM_CONDITIONAL ( [ SHELL_WRAPPER ] , [ test \"x$with_wrapper\" = xtrue ] ) AM_COND_IF ( [ SHELL_WRAPPER ] , [ AC_CONFIG_FILES([wrapper:wrapper.in ] ) ] ) \u6761\u4ef6\u8bed\u53e5\u7684\u9650\u5236 \u00b6 \u6761\u4ef6\u8bed\u53e5\u5e94\u8be5\u5b8c\u6574\u7684\u5305\u62ec\u53d8\u91cf\u6216\u89c4\u5219\u7684\u5b9a\u4e49\u3002\u4f8b\u5982\uff0cAutomake\u65e0\u6cd5\u5904\u7406\u5728\u53d8\u91cf\u5b9a\u4e49\u4e2d\u7684\u4f7f\u7528\u6761\u4ef6\u8bed\u53e5\uff1a # This syntax is not understood by Automake AM_CPPFLAGS = \\ -DFEATURE_A \\ if WANT_DEBUG -DDEBUG \\ endif -DFEATURE_B","title":"20.\u6761\u4ef6\u8bed\u53e5"},{"location":"automake/20.%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/#_1","text":"","title":"\u6761\u4ef6\u8bed\u53e5\u7684\u4f7f\u7528"},{"location":"automake/20.%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/#am_conditional-name-condition","text":"\u5728\u4f7f\u7528\u6761\u4ef6\u8bed\u53e5\u4e4b\u524d\uff0c\u5fc5\u987b\u5728configure.ac\u7684\u6b64\u5b8f\u4e2d\u5b9a\u4e49\u3002 \u8be5\u5b8f\u7684\u4f5c\u7528\u5c31\u662f\u6267\u884c condition \uff0c\u5c06\u771f\u5047\u7ed3\u679c\u8fd4\u56de\u7ed9 name \u3002 name \u5fc5\u987b\u7531\u5b57\u6bcd\u5f00\u5934\u4e14\u53ea\u80fd\u7531\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210\uff0c\u5e76\u4e14\u4e0d\u80fd\u662fAutomake\u7684\u4fdd\u7559\u5b57\u3002 \u5f53configure\u8fd0\u884c\u7684\u65f6\u5019shell\u811a\u672c condition \u4f1a\u88ab\u6267\u884c\u3002 \u6ce8\u610f\u6bcf\u6b21\u8fd0\u884cconfigure\u7684\u65f6\u5019\u6bcf\u4e2a AM_CONDITIONAL \u90fd\u5fc5\u987b\u88ab\u8c03\u7528\uff0c\u5426\u5219\u4f1a\u6df7\u6dc6automake\u3002\u6b64\u5b8f\u4e2d\u5b9a\u4e49\u7684\u5224\u65ad\u8bed\u53e5\u53ef\u5728Makefile.am\u4e2d\u88ab\u8c03\u7528\u3002 AC_ARG_ENABLE ( [ debug ] , [ --enable-debug Turn on debugging ] , [ case \"${enableval}\" in yes) debug=true ;; no) debug=false ;; *) AC_MSG_ERROR([bad value ${enableval} for --enable-debug ] ) ;; esac ] , [ debug=false ] ) AM_CONDITIONAL ( [ DEBUG ] , [ test x$debug = xtrue ] ) \u7136\u540e\u4f60\u53ef\u4ee5\u5728Makefile.am\u4e2d\u8fd9\u6837\u4f7f\u7528\uff08make\u8bed\u6cd5\uff09\uff1a if DEBUG DBG = debug else DBG = endif noinst_PROGRAMS = $(DBG) \u4e3a\u4e86\u53ef\u4ee5\u83b7\u53d6\u5728configure.ac\u4e2d\u6b64\u5b8f\u6ce8\u518c\u7684\u6761\u4ef6\u8bed\u53e5\uff0c\u5e76\u4e14\u5141\u8bb8\u6761\u4ef6\u7684\u5b9a\u4e49 AC_CONFIG_FILES \uff0c AM_COND_IF \u53ef\u80fd\u4f1a\u88ab\u4f7f\u7528\uff1a","title":"AM_CONDITIONAL (name, condition)"},{"location":"automake/20.%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/#am_cond_if-conditional-if-true-if-false","text":"\u5982\u679c\u4efb\u4e00\u5206\u652f\u5305\u542b AC_CONFIG_FILES \uff0c\u4f1a\u5bfc\u81f4automake\u4ec5\u9488\u5bf9\u76f8\u5e94\u7684\u6761\u4ef6\u8f93\u51fa\u76f8\u5e94\u6587\u4ef6\u7684\u89c4\u5219\u3002 AM_CONDITIONAL ( [ SHELL_WRAPPER ] , [ test \"x$with_wrapper\" = xtrue ] ) AM_COND_IF ( [ SHELL_WRAPPER ] , [ AC_CONFIG_FILES([wrapper:wrapper.in ] ) ] )","title":"AM_COND_IF (conditional, [if-true], [if-false])"},{"location":"automake/20.%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/#_2","text":"\u6761\u4ef6\u8bed\u53e5\u5e94\u8be5\u5b8c\u6574\u7684\u5305\u62ec\u53d8\u91cf\u6216\u89c4\u5219\u7684\u5b9a\u4e49\u3002\u4f8b\u5982\uff0cAutomake\u65e0\u6cd5\u5904\u7406\u5728\u53d8\u91cf\u5b9a\u4e49\u4e2d\u7684\u4f7f\u7528\u6761\u4ef6\u8bed\u53e5\uff1a # This syntax is not understood by Automake AM_CPPFLAGS = \\ -DFEATURE_A \\ if WANT_DEBUG -DDEBUG \\ endif -DFEATURE_B","title":"\u6761\u4ef6\u8bed\u53e5\u7684\u9650\u5236"},{"location":"automake/23.Automake%E4%B8%8D%E8%83%BD%E6%BB%A1%E8%B6%B3%E4%BD%BF%E7%94%A8%E6%97%B6/","text":"\u6269\u5c55Automake\u89c4\u5219 \u00b6 Makefile.in\u6587\u4ef6\u4ece\u4e09\u4e2a\u6e90\uff08Makefile.am\u3001configure.ac\u4ee5\u53caautomake\u81ea\u8eab\uff09\u6784\u5efa\u3002\u9075\u5b88\u4ee5\u4e0b\u7ea6\u5b9a\uff1a \u7528\u6237\u5728Makefile.am\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\u7684\u4f18\u5148\u7ea7\u5927\u4e8e\u5728configure.ac\u4e2d\u4f7f\u7528 AC_SUBST \u5b9a\u4e49\u7684\u53d8\u91cf\uff0c AC_SUBST \u7684\u4f18\u5148\u7ea7\u5927\u4e8eautomake\u5b9a\u4e49\u7684\u53d8\u91cf\u3002 \u5bf9\u4e8e\u540c\u4e00\u4e2a\u76ee\u6807\uff0c\u7528\u6237\u5b9a\u4e49\u7684\u89c4\u5219\u7684\u4f18\u5148\u7ea7\u5927\u4e8e\u4efb\u4f55automake\u5b9a\u4e49\u7684\u89c4\u5219\u3002 \u8986\u76d6\u9ed8\u8ba4\u89c4\u5219 \u00b6 \u5f53\u4f60\u76f8\u8981\u8986\u76d6\u9ed8\u8ba4\u7684\u89c4\u5219\u65f6\uff0c\u9700\u8981\u91cd\u5199\u7684\u89c4\u5219\u7684\u76ee\u6807\u662f\uff1a all-recursive check-recursive cscopelist-recursive ctags-recursive dvi-recursive html-recursive info-recursive install-data-recursive install-dvi-recursive install-exec-recursive install-html-recursive install-info-recursive install-pdf-recursive install-ps-recursive install-recursive installcheck-recursive installdirs-recursive pdf-recursive ps-recursive tags-recursive uninstall-recursive \u6bd4\u5982\u76f8\u5e94\u8986\u76d6\u9ed8\u8ba4\u7684 make check \u89c4\u5219\uff0c\u9700\u8981\u8fd9\u6837\u91cd\u5199: check-recursive: @echo \"I'm not the default make check.\" warning \uff1a\u91cd\u5199\u4e4b\u540e\u5176\u76f8\u5e94\u7684\u540e\u7f00\u89c4\u5219\u4e5f\u4f1a\u5931\u6548\u3002\u6bd4\u5982check-local\u5c06\u4e0d\u518d\u6267\u884c\u3002 \u8865\u5145\u9ed8\u8ba4\u89c4\u5219\uff08\u65e0\u5e8f\uff09 \u00b6 \u53ef\u4ee5\u5728Makefile.am\u4e2d\u6307\u5b9a\u591a\u79cd\u76ee\u6807\u7684 -local \u7248\u672c\uff0cAutomake\u4f1a\u7528 -local \u76ee\u6807\u6765\u8865\u5145\u6807\u51c6\u7684\u76ee\u6807\u3002\u652f\u6301\u7684\u76ee\u6807\u6709\uff1a all, info, dvi, ps, pdf, html, check, install-data, install-dvi, install-exec, install-html, install-info, install-pdf, install-ps, uninstall, installdirs, installcheck and the various clean targets (mostlyclean, clean, distclean, and maintainer-clean) \u3002 clean-local : -rm -rf testSubDir note \uff1a\u5e26\u6709 -local \u7684\u76ee\u6807\u4e0d\u80fd\u786e\u5b9a\u5176\u6267\u884c\u987a\u5e8f\u3002 \u8865\u5145\u9ed8\u8ba4\u89c4\u5219\uff08\u6709\u5e8f\uff09 \u00b6 \u76f8\u53cd\u7684\uff0c\u4e00\u4e9b\u89c4\u5219\u6709\u8fd0\u884c\u53e6\u4e00\u4e2a\u89c4\u5219\u7684\u65b9\u6cd5\uff0c\u79f0\u4f5c hook \uff0c hook \u603b\u662f\u5728\u4e3b\u89c4\u5219\u6267\u884c\u5b8c\u6bd5\u540e\u6267\u884c\u3002 \u652f\u6301 -hook \u7684\u76ee\u6807\u6709\uff1a install-data, install-exec, uninstall, dist, distcheck \u3002 install-exec-hook : ln $( DESTDIR )$( bindir ) /program $( EXEEXT ) \\ $( DESTDIR )$( bindir ) /proglink $( EXEEXT ) \u7b2c\u4e09\u65b9MakefileS \u00b6 \u7b2c\u4e09\u65b9MakefileS\u5e94\u8be5\u652f\u6301\u7684\u89c4\u5219\u6709\uff1a all distdir install install-data install-exec uninstall install-dvi install-html install-info install-ps install-pdf installdirs check installcheck mostlyclean clean distclean maintainer-clean dvi pdf ps info html tags ctags \u3002 \u53ea\u5728 DIST_SUBDIRS \u4e2d\u5217\u51fa\u800c\u4e0d\u5728 SUBDIRS \u4e2d\u9700\u8981\u7684\u53ea\u6709\u4e09\u4e2a\u89c4\u5219\uff1a distclean, maintainer-clean, distdir \u3002","title":"23.Automake\u4e0d\u80fd\u6ee1\u8db3\u4f7f\u7528\u65f6"},{"location":"automake/23.Automake%E4%B8%8D%E8%83%BD%E6%BB%A1%E8%B6%B3%E4%BD%BF%E7%94%A8%E6%97%B6/#automake","text":"Makefile.in\u6587\u4ef6\u4ece\u4e09\u4e2a\u6e90\uff08Makefile.am\u3001configure.ac\u4ee5\u53caautomake\u81ea\u8eab\uff09\u6784\u5efa\u3002\u9075\u5b88\u4ee5\u4e0b\u7ea6\u5b9a\uff1a \u7528\u6237\u5728Makefile.am\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\u7684\u4f18\u5148\u7ea7\u5927\u4e8e\u5728configure.ac\u4e2d\u4f7f\u7528 AC_SUBST \u5b9a\u4e49\u7684\u53d8\u91cf\uff0c AC_SUBST \u7684\u4f18\u5148\u7ea7\u5927\u4e8eautomake\u5b9a\u4e49\u7684\u53d8\u91cf\u3002 \u5bf9\u4e8e\u540c\u4e00\u4e2a\u76ee\u6807\uff0c\u7528\u6237\u5b9a\u4e49\u7684\u89c4\u5219\u7684\u4f18\u5148\u7ea7\u5927\u4e8e\u4efb\u4f55automake\u5b9a\u4e49\u7684\u89c4\u5219\u3002","title":"\u6269\u5c55Automake\u89c4\u5219"},{"location":"automake/23.Automake%E4%B8%8D%E8%83%BD%E6%BB%A1%E8%B6%B3%E4%BD%BF%E7%94%A8%E6%97%B6/#_1","text":"\u5f53\u4f60\u76f8\u8981\u8986\u76d6\u9ed8\u8ba4\u7684\u89c4\u5219\u65f6\uff0c\u9700\u8981\u91cd\u5199\u7684\u89c4\u5219\u7684\u76ee\u6807\u662f\uff1a all-recursive check-recursive cscopelist-recursive ctags-recursive dvi-recursive html-recursive info-recursive install-data-recursive install-dvi-recursive install-exec-recursive install-html-recursive install-info-recursive install-pdf-recursive install-ps-recursive install-recursive installcheck-recursive installdirs-recursive pdf-recursive ps-recursive tags-recursive uninstall-recursive \u6bd4\u5982\u76f8\u5e94\u8986\u76d6\u9ed8\u8ba4\u7684 make check \u89c4\u5219\uff0c\u9700\u8981\u8fd9\u6837\u91cd\u5199: check-recursive: @echo \"I'm not the default make check.\" warning \uff1a\u91cd\u5199\u4e4b\u540e\u5176\u76f8\u5e94\u7684\u540e\u7f00\u89c4\u5219\u4e5f\u4f1a\u5931\u6548\u3002\u6bd4\u5982check-local\u5c06\u4e0d\u518d\u6267\u884c\u3002","title":"\u8986\u76d6\u9ed8\u8ba4\u89c4\u5219"},{"location":"automake/23.Automake%E4%B8%8D%E8%83%BD%E6%BB%A1%E8%B6%B3%E4%BD%BF%E7%94%A8%E6%97%B6/#_2","text":"\u53ef\u4ee5\u5728Makefile.am\u4e2d\u6307\u5b9a\u591a\u79cd\u76ee\u6807\u7684 -local \u7248\u672c\uff0cAutomake\u4f1a\u7528 -local \u76ee\u6807\u6765\u8865\u5145\u6807\u51c6\u7684\u76ee\u6807\u3002\u652f\u6301\u7684\u76ee\u6807\u6709\uff1a all, info, dvi, ps, pdf, html, check, install-data, install-dvi, install-exec, install-html, install-info, install-pdf, install-ps, uninstall, installdirs, installcheck and the various clean targets (mostlyclean, clean, distclean, and maintainer-clean) \u3002 clean-local : -rm -rf testSubDir note \uff1a\u5e26\u6709 -local \u7684\u76ee\u6807\u4e0d\u80fd\u786e\u5b9a\u5176\u6267\u884c\u987a\u5e8f\u3002","title":"\u8865\u5145\u9ed8\u8ba4\u89c4\u5219\uff08\u65e0\u5e8f\uff09"},{"location":"automake/23.Automake%E4%B8%8D%E8%83%BD%E6%BB%A1%E8%B6%B3%E4%BD%BF%E7%94%A8%E6%97%B6/#_3","text":"\u76f8\u53cd\u7684\uff0c\u4e00\u4e9b\u89c4\u5219\u6709\u8fd0\u884c\u53e6\u4e00\u4e2a\u89c4\u5219\u7684\u65b9\u6cd5\uff0c\u79f0\u4f5c hook \uff0c hook \u603b\u662f\u5728\u4e3b\u89c4\u5219\u6267\u884c\u5b8c\u6bd5\u540e\u6267\u884c\u3002 \u652f\u6301 -hook \u7684\u76ee\u6807\u6709\uff1a install-data, install-exec, uninstall, dist, distcheck \u3002 install-exec-hook : ln $( DESTDIR )$( bindir ) /program $( EXEEXT ) \\ $( DESTDIR )$( bindir ) /proglink $( EXEEXT )","title":"\u8865\u5145\u9ed8\u8ba4\u89c4\u5219\uff08\u6709\u5e8f\uff09"},{"location":"automake/23.Automake%E4%B8%8D%E8%83%BD%E6%BB%A1%E8%B6%B3%E4%BD%BF%E7%94%A8%E6%97%B6/#makefiles","text":"\u7b2c\u4e09\u65b9MakefileS\u5e94\u8be5\u652f\u6301\u7684\u89c4\u5219\u6709\uff1a all distdir install install-data install-exec uninstall install-dvi install-html install-info install-ps install-pdf installdirs check installcheck mostlyclean clean distclean maintainer-clean dvi pdf ps info html tags ctags \u3002 \u53ea\u5728 DIST_SUBDIRS \u4e2d\u5217\u51fa\u800c\u4e0d\u5728 SUBDIRS \u4e2d\u9700\u8981\u7684\u53ea\u6709\u4e09\u4e2a\u89c4\u5219\uff1a distclean, maintainer-clean, distdir \u3002","title":"\u7b2c\u4e09\u65b9MakefileS"},{"location":"automake/5.%E5%88%9B%E5%BB%BAMakefile.in/","text":"automake\u603b\u662f\u5728\u9879\u76ee\u7684\u6700\u9876\u5c42\u76ee\u5f55\u8fd0\u884c\uff0c\u8fd9\u662f\u5fc5\u987b\u7684\u56e0\u4e3aautomake\u5fc5\u987b\u626b\u63cfconfigure.ac\uff0c\u8fd8\u6709\u4e00\u4e2a\u539f\u56e0\u5c31\u662f\u4e00\u4e9bMakefile.in\u6587\u4ef6\u5728\u5b50\u76ee\u5f55\u4e2d\u3002 Automake\u4f1a\u8fd0\u884cautoconf\u6765\u626b\u63cfconfigure.ac\u548c\u4f9d\u8d56\uff0c\u6240\u4ee5autoconf\u5fc5\u987b\u5728PATH\u73af\u5883\u53d8\u91cf\u4e2d\u3002\u4f46\u662f\u5e76\u4e0d\u4f1a\u6784\u5efaconfigure\u811a\u672c\uff0c\u6240\u4ee5\u4ecd\u7136\u8981\u4f60\u81ea\u5df1\u8fd0\u884cautoconf\u3002 automake\u63a5\u53d7\u7684\u4e00\u4e9b\u9009\u9879\u3002","title":"5.\u521b\u5efaMakefile.in"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/","text":"6.1 \u914d\u7f6e\u8981\u6c42 \u00b6 \u552f\u4e00\u7684\u8981\u6c42\u5c31\u662f\u5728configure.ac\u6587\u4ef6\u4e2d\u52a0\u4e0a AM_INIT_AUTOMAKE \u5b8f\u3002 \u4e0b\u9762\u662f\u51e0\u4e2aAutomake\u8981\u6c42\u7684\u4f46\u662f\u4e0d\u4f1a\u88ab AM_INIT_AUTOMAKE \u8fd0\u884c\u7684\u5b8f AC_CONFIG_FILES AC_OUTPUT \u8fd9\u4e24\u4e2a\u7ecf\u5e38\u5728\u672b\u5c3e\u88ab\u8c03\u7528\uff0c\u6307\u660e\u4e86\u54ea\u4e9b\u6587\u4ef6\u4f1a\u88ab\u751f\u6210\u3002\u5982\u679c\u4ee5.am\u7ed3\u5c3e\u5219\u751f\u6210.in\u7ed3\u5c3e\u7684\u6587\u4ef6\u3002\u4e0d\u80fd\u8bc6\u522bshell\u53d8\u91cf\uff0c\u9700\u8981\u5728 AC_SUBST \u4e2d\u6ce8\u518c\uff0c\u5e76\u4e14\u4ee5 ${xxx} \u5f62\u5f0f\u5f15\u7528\u624d\u53ef\u8bc6\u522b\u3002 AC_SUBST ([ APIVERSION ] , \u2026 ) \u2026 AC_CONFIG_FILES ( [ tests/aclocal- ${ APIVERSION } :tests/aclocal.in ] , [ chmod +x tests/aclocal- ${ APIVERSION } ] , [ APIVERSION = $APIVERSION ]) AC_CONFIG_FILES ( [ tests/automake- ${ APIVERSION } :tests/automake.in ] , [ chmod +x tests/automake- ${ APIVERSION } ]) \u7b49\u7b49... 6.3 \u81ea\u52a8\u751f\u6210aclocal.m4 \u00b6 \u4e00\u4e9b\u5b8f\u5fc5\u987b\u88ab\u5b9a\u4e49\u5728aclocal.m4\u4e2d\uff0c\u5426\u5219autoconf\u4e0d\u4f1a\u627e\u5230\u4ed6\u4eec\u3002 aclocal\u53ef\u4ee5\u6839\u636econfigure.ac\u751f\u6210aclocal.m4\u3002\u9996\u5148aclocal\u626b\u63cf\u6240\u6709\u7684.m4\u6587\u4ef6\u641c\u96c6\u5b8f\u5b9a\u4e49\uff0c\u7136\u540e\u626b\u63cfconfigure.ac\uff0c\u6240\u6709\u5728\u7b2c\u4e00\u6b65\u627e\u5230\u7684\u5b8f\u53ca\u5176\u4f9d\u8d56\u7684\u5b8f\u90fd\u4f1a\u88ab\u653e\u5728aclocal.m4\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u672c\u5730\u6ca1\u6709\u627e\u5230\u5c31\u4f1a\u5728\u7cfb\u7edf\u5c42\u9762\u7684\u76ee\u5f55\u4e2d\u5bfb\u627e\u3002 \u901a\u5e38\u5b8f\u653e\u5230aclocal.m4\u4e2d\u662f\u901a\u8fc7\u590d\u5236\u6574\u4e2a\u6587\u4ef6\u5185\u5bb9\u6765\u5b8c\u6210\u7684\u3002\u4f46\u662f\u901a\u8fc7\u547d\u4ee4\u53c2\u6570 -I \u6765\u6307\u5b9a\u76f8\u5bf9\u8def\u5f84\u65f6\uff0c\u4f7f\u7528 m4_include \u4ee3\u66ff\u590d\u5236\u5b83\u5230aclocal.m4\u6587\u4ef6\u4e2d\uff1b\u6307\u5b9a\u7edd\u5bf9\u8def\u5f84\u65f6\u6216\u8005\u662f\u7cfb\u7edf\u5c42\u9762\u7684\u76ee\u5f55\u65f6\uff0c\u4f1a\u76f4\u63a5\u590d\u5236\u8fc7\u6765\u3002\u6545\u6700\u597d\u4f7f\u7528 -I `pwd`/reldir \u4ee3\u66ff -I reldir \u3002 acinclude.m4\u4e5f\u4f1a\u88ab\u6307\u5b9a\u653e\u5230aclocal.m4\u6587\u4ef6\u4e2d\uff0c\u5efa\u8bae\u4e0d\u8981\u5728\u65b0\u5305\u4e2d\u4f7f\u7528\u8be5\u6587\u4ef6\u3002 \u64cd\u4f5caclocal.m4\u65f6\uff0caclocal\u8fd0\u884c autom4te (see Using Autom4te in The Autoconf Manual) \u8ffd\u8e2a\u54ea\u4e9b\u5b8f\u88ab\u771f\u6b63\u7684\u4f7f\u7528\u4e86\u3002autom4e\u4e5f\u8981\u5b58\u5728\u4e8ePATH\u73af\u5883\u53d8\u91cf\u4e2d\u3002 6.3.1 aclocal\u63a5\u53d7\u7684\u4e00\u4e9b\u9009\u9879\u3002 \u00b6 \u6bd4\u8f83\u91cd\u8981\u7684\u4e24\u4e2a\u9009\u9879 -I dir Add the directory dir to the list of directories searched for .m4 files. --install Install system - wide third - party macros into the first directory specified with \u2018 - I dir \u2019 instead of copying them in the output file . Note that this will happen also if dir is an absolute path . When this option is used , and only when this option is used , aclocal will also honor \u2018 # serial number \u2019 lines that appear in macros : an M4 file is ignored if there exists another M4 file with the same basename and a greater serial number in the search path ( see Serials ). 6.3.2 \u5b8f\u641c\u7d22\u8def\u5f84 \u00b6 \u9ed8\u8ba4\u7684\u641c\u7d22\u8def\u5f84\u53ca\u987a\u5e8f: - acdir-APIVERSION APIVERSION\u53d6\u51b3\u4e8eAutomake\u7684\u7248\u672c - acdir \u6b64\u76ee\u5f55\u9002\u7528\u4e8e\u7b2c\u4e09\u65b9.m4\u6587\u4ef6\uff0cautomake\u6784\u5efa\u65f6\u88ab\u914d\u7f6e\u3002\u901a\u5e38\u88ab\u914d\u7f6e\u4e3a${prefix}/share/aclocal/ \u4fee\u6539\u641c\u7d20\u8def\u5f84\u65b9\u5f0f\u4e00\uff1a -I dir1 -I dir2 \u628a\u4f1adir\u52a0\u5230\u9ed8\u8ba4\u7684\u524d\u9762\uff1a dir1 -> dir2 -> \u9ed8\u8ba4\u8def\u5f84 \u4fee\u6539\u641c\u7d20\u8def\u5f84\u65b9\u5f0f\u4e8c\uff1a dirlist \u4fee\u6539\u641c\u7d20\u8def\u5f84\u65b9\u5f0f\u4e09\uff1a ACLOCAL_PATH 6.3.3 \u7f16\u5199\u81ea\u5df1\u7684aclocal\u5b8f \u00b6 \u8fd9\u4e2a\u6280\u672f\u53ef\u4ee5\u88ab\u7528\u4e8e\u60f3\u8981\u652f\u6301\u81ea\u5df1\u7684Autoconf\u5b8f\u88ab\u5176\u5b83\u7a0b\u5e8f\u4f7f\u7528\u7684\u5e93\uff08This can be used by libraries that want to supply their own Autoconf macros for use by other programs\uff09\u3002\u6bd4\u5982\uff0cgettext\u5e93\u652f\u6301AM_GNU_GETTEXT\u5b8f\u88ab\u7528\u4e8e\u4efb\u4f55\u4f7f\u7528gettext\u7684\u5305\u3002\u5e93\u5b89\u88c5\u4e4b\u540e\uff0c\u5176\u5b8f\u4e5f\u88ab\u5b89\u88c5\uff0c\u8fd9\u6837aclocal\u5c31\u80fd\u627e\u5230\u5b83\u3002 A macro file\u2019s name should end in .m4. Such files should be installed in $(datadir)/aclocal. This is as simple as writing: aclocaldir = $(datadir)/aclocal aclocal_DATA = mymacro.m4 myothermacro.m4 \u5b8f\u6587\u4ef6\u5e94\u8be5\u7531\u4e00\u7cfb\u5217\u7684 quoted AC_DEFUN (see Macro Definitions in The Autoconf Manual)\u7ec4\u6210\u3002 6.3.4 \u5904\u7406\u672c\u5730\u5b8f \u00b6 Autoconf\u63d0\u4f9b\u7684\u529f\u80fd\u6d4b\u8bd5\u4e0d\u80fd\u6ee1\u8db3\u6240\u6709\u7684\u9700\u6c42\u3002\u4eba\u4eec\u9700\u8981\u7528\u81ea\u5df1\u7684\u5b8f\u6216\u8005\u7b2c\u4e09\u65b9\u5b8f\u8865\u5145\u73b0\u6709\u7684\u6d4b\u8bd5\u3002\u6709\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\uff1a \u5728acinclude.m4\u4e2d\u5217\u51fa\u4f60\u6240\u6709\u7684\u5b8f \uff08\u63a8\u8350\u65b9\u6cd5\uff09\u5c06\u6bcf\u4e2a\u5b8f\u5199\u5230\u81ea\u5df1\u7684\u6587\u4ef6\u4e2d\u7136\u540e\u653e\u5230\u4e00\u4e2a\u76ee\u5f55\u4e2d\uff08\u901a\u5e38\u662fm4\uff09\uff0c\u7136\u540e\u5728configure.ac\u4e2d\u6dfb\u52a0\u53d8\u91cf\uff1a AC_CONFIG_MACRO_DIRS([m4]) \u3002\u7b2c\u4e09\u65b9\u7684\u5b8f\u6587\u4ef6\u6700\u597d\u4e5f\u653e\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u3002 aclocal\u63d0\u4f9b\u4e86 --install \u9009\u9879\u6765\u590d\u5236\u7cfb\u7edf\u5c42\u9762\u7684\u5b8f\u5230\u4f60\u672c\u5730\u7684\u5b8f\u76ee\u5f55\uff0c\u5e2e\u52a9\u4f60\u89e3\u51b3\u4e0a\u9762\u7684\u95ee\u9898\u3002\u672c\u5730\u7684\u5b8f\u6bd4\u7cfb\u7edf\u5c42\u9762\u7684\u5b8f\u6709\u4f18\u5148\u6743\u3002\u63a8\u8350\u5728\u6bcf\u6b21\u8fd0\u884caclocal\u65f6\u4f7f\u7528 --install \u9009\u9879\u3002 6.3.5 \u7f16\u53f7 \u00b6 \u4e3a\u4e86\u533a\u5206\u4e00\u4e2a\u5b8f\u7684\u7248\u672c\u3002 \u4f4d\u4e8eM4\u6587\u4ef6\u7684\u5b8f\u5b9a\u4e49\u7684\u524d\u9762\u3002 # \u5fc5\u987b\u662f\u6b64\u884c\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\uff0c\u5141\u8bb8\u5728version\u4e4b\u540e\u6dfb\u52a0\u5176\u4ed6\u5b57\u7b26 #serial version garbage \u4f7f\u7528\u4e86alcohol\u7684--install\u9009\u9879\u7684\u8bdd\uff0caclocal\u4f1a\u9009\u62e9\u542b\u6709#serial\u7684\u6216\u8005\u7f16\u53f7\u6bd4\u8f83\u65b0\u7684\u90a3\u4e2a\u6587\u4ef6\u3002\u6b64\u7f16\u53f7\u5bf9\u5e94\u7684\u662f\u6574\u4e2a\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u5355\u4e00\u7684\u4e00\u4e2a\u5b8f\u3002 6.3.6 aclocal\u7684\u672a\u6765 \u00b6 aclocal\u53ef\u80fd\u4f1a\u6d88\u5931\u3002\u56e0\u4e3a\u5904\u7406M4\u7684\u5b8f\u662fAutoconf\u7684\u4efb\u52a1\u3002 \u6c38\u8fdc\u4e0d\u8981\u81ea\u5df1\u8c03\u7528aclocal\uff0c\u8ba9\u5b83\u5904\u4e8eautoreconf\u548cAutomake\u7684\u6784\u5efa\u89c4\u5219\u7684\u63a7\u5236\u4e0b\u3002 \u5f88\u591a\u5305\u542b\u6709bootstrap\u6216\u8005autogen.sh\u811a\u672c\uff0c\u5b9e\u9645\u4e0a\u4ed6\u4eec\u53ea\u662f\u5b89\u7167\u6b63\u786e\u7684\u987a\u5e8f\u8c03\u7528\u547d\u4ee4\uff08aclocal, libtoolize, gettextize or autopoint, autoconf, autoheader, and automake\uff09\uff0c\u8fd9\u4e9b\u5de5\u4f5cautoreconf\u5c31\u53ef\u4ee5\u505a\u5230\u3002 6.4 Automake\u63d0\u4f9b\u7684Autoconf\u5b8f \u00b6 \u2022 Public Macros: Macros that you can use. \u2022 Obsolete Macros: Macros that will soon be removed. \u2022 Private Macros: Macros that you should not use. \u516c\u5171\u5b8f \u00b6 AM_INIT_AUTOMAKE ([options]) \u00b6 \u4f7f\u7528\u7a7a\u683c\u5206\u9694\u7684automake\u9009\u9879\u3002 AM_INIT_AUTOMAKE([-Wno-portability])","title":"6.\u626b\u63cfconfigure.ac\uff0c\u4f7f\u7528aclocal"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#61","text":"\u552f\u4e00\u7684\u8981\u6c42\u5c31\u662f\u5728configure.ac\u6587\u4ef6\u4e2d\u52a0\u4e0a AM_INIT_AUTOMAKE \u5b8f\u3002 \u4e0b\u9762\u662f\u51e0\u4e2aAutomake\u8981\u6c42\u7684\u4f46\u662f\u4e0d\u4f1a\u88ab AM_INIT_AUTOMAKE \u8fd0\u884c\u7684\u5b8f AC_CONFIG_FILES AC_OUTPUT \u8fd9\u4e24\u4e2a\u7ecf\u5e38\u5728\u672b\u5c3e\u88ab\u8c03\u7528\uff0c\u6307\u660e\u4e86\u54ea\u4e9b\u6587\u4ef6\u4f1a\u88ab\u751f\u6210\u3002\u5982\u679c\u4ee5.am\u7ed3\u5c3e\u5219\u751f\u6210.in\u7ed3\u5c3e\u7684\u6587\u4ef6\u3002\u4e0d\u80fd\u8bc6\u522bshell\u53d8\u91cf\uff0c\u9700\u8981\u5728 AC_SUBST \u4e2d\u6ce8\u518c\uff0c\u5e76\u4e14\u4ee5 ${xxx} \u5f62\u5f0f\u5f15\u7528\u624d\u53ef\u8bc6\u522b\u3002 AC_SUBST ([ APIVERSION ] , \u2026 ) \u2026 AC_CONFIG_FILES ( [ tests/aclocal- ${ APIVERSION } :tests/aclocal.in ] , [ chmod +x tests/aclocal- ${ APIVERSION } ] , [ APIVERSION = $APIVERSION ]) AC_CONFIG_FILES ( [ tests/automake- ${ APIVERSION } :tests/automake.in ] , [ chmod +x tests/automake- ${ APIVERSION } ]) \u7b49\u7b49...","title":"6.1 \u914d\u7f6e\u8981\u6c42"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#63-aclocalm4","text":"\u4e00\u4e9b\u5b8f\u5fc5\u987b\u88ab\u5b9a\u4e49\u5728aclocal.m4\u4e2d\uff0c\u5426\u5219autoconf\u4e0d\u4f1a\u627e\u5230\u4ed6\u4eec\u3002 aclocal\u53ef\u4ee5\u6839\u636econfigure.ac\u751f\u6210aclocal.m4\u3002\u9996\u5148aclocal\u626b\u63cf\u6240\u6709\u7684.m4\u6587\u4ef6\u641c\u96c6\u5b8f\u5b9a\u4e49\uff0c\u7136\u540e\u626b\u63cfconfigure.ac\uff0c\u6240\u6709\u5728\u7b2c\u4e00\u6b65\u627e\u5230\u7684\u5b8f\u53ca\u5176\u4f9d\u8d56\u7684\u5b8f\u90fd\u4f1a\u88ab\u653e\u5728aclocal.m4\u6587\u4ef6\u4e2d\u3002\u5982\u679c\u672c\u5730\u6ca1\u6709\u627e\u5230\u5c31\u4f1a\u5728\u7cfb\u7edf\u5c42\u9762\u7684\u76ee\u5f55\u4e2d\u5bfb\u627e\u3002 \u901a\u5e38\u5b8f\u653e\u5230aclocal.m4\u4e2d\u662f\u901a\u8fc7\u590d\u5236\u6574\u4e2a\u6587\u4ef6\u5185\u5bb9\u6765\u5b8c\u6210\u7684\u3002\u4f46\u662f\u901a\u8fc7\u547d\u4ee4\u53c2\u6570 -I \u6765\u6307\u5b9a\u76f8\u5bf9\u8def\u5f84\u65f6\uff0c\u4f7f\u7528 m4_include \u4ee3\u66ff\u590d\u5236\u5b83\u5230aclocal.m4\u6587\u4ef6\u4e2d\uff1b\u6307\u5b9a\u7edd\u5bf9\u8def\u5f84\u65f6\u6216\u8005\u662f\u7cfb\u7edf\u5c42\u9762\u7684\u76ee\u5f55\u65f6\uff0c\u4f1a\u76f4\u63a5\u590d\u5236\u8fc7\u6765\u3002\u6545\u6700\u597d\u4f7f\u7528 -I `pwd`/reldir \u4ee3\u66ff -I reldir \u3002 acinclude.m4\u4e5f\u4f1a\u88ab\u6307\u5b9a\u653e\u5230aclocal.m4\u6587\u4ef6\u4e2d\uff0c\u5efa\u8bae\u4e0d\u8981\u5728\u65b0\u5305\u4e2d\u4f7f\u7528\u8be5\u6587\u4ef6\u3002 \u64cd\u4f5caclocal.m4\u65f6\uff0caclocal\u8fd0\u884c autom4te (see Using Autom4te in The Autoconf Manual) \u8ffd\u8e2a\u54ea\u4e9b\u5b8f\u88ab\u771f\u6b63\u7684\u4f7f\u7528\u4e86\u3002autom4e\u4e5f\u8981\u5b58\u5728\u4e8ePATH\u73af\u5883\u53d8\u91cf\u4e2d\u3002","title":"6.3 \u81ea\u52a8\u751f\u6210aclocal.m4"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#631-aclocal","text":"\u6bd4\u8f83\u91cd\u8981\u7684\u4e24\u4e2a\u9009\u9879 -I dir Add the directory dir to the list of directories searched for .m4 files. --install Install system - wide third - party macros into the first directory specified with \u2018 - I dir \u2019 instead of copying them in the output file . Note that this will happen also if dir is an absolute path . When this option is used , and only when this option is used , aclocal will also honor \u2018 # serial number \u2019 lines that appear in macros : an M4 file is ignored if there exists another M4 file with the same basename and a greater serial number in the search path ( see Serials ).","title":"6.3.1 aclocal\u63a5\u53d7\u7684\u4e00\u4e9b\u9009\u9879\u3002"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#632","text":"\u9ed8\u8ba4\u7684\u641c\u7d22\u8def\u5f84\u53ca\u987a\u5e8f: - acdir-APIVERSION APIVERSION\u53d6\u51b3\u4e8eAutomake\u7684\u7248\u672c - acdir \u6b64\u76ee\u5f55\u9002\u7528\u4e8e\u7b2c\u4e09\u65b9.m4\u6587\u4ef6\uff0cautomake\u6784\u5efa\u65f6\u88ab\u914d\u7f6e\u3002\u901a\u5e38\u88ab\u914d\u7f6e\u4e3a${prefix}/share/aclocal/ \u4fee\u6539\u641c\u7d20\u8def\u5f84\u65b9\u5f0f\u4e00\uff1a -I dir1 -I dir2 \u628a\u4f1adir\u52a0\u5230\u9ed8\u8ba4\u7684\u524d\u9762\uff1a dir1 -> dir2 -> \u9ed8\u8ba4\u8def\u5f84 \u4fee\u6539\u641c\u7d20\u8def\u5f84\u65b9\u5f0f\u4e8c\uff1a dirlist \u4fee\u6539\u641c\u7d20\u8def\u5f84\u65b9\u5f0f\u4e09\uff1a ACLOCAL_PATH","title":"6.3.2 \u5b8f\u641c\u7d22\u8def\u5f84"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#633-aclocal","text":"\u8fd9\u4e2a\u6280\u672f\u53ef\u4ee5\u88ab\u7528\u4e8e\u60f3\u8981\u652f\u6301\u81ea\u5df1\u7684Autoconf\u5b8f\u88ab\u5176\u5b83\u7a0b\u5e8f\u4f7f\u7528\u7684\u5e93\uff08This can be used by libraries that want to supply their own Autoconf macros for use by other programs\uff09\u3002\u6bd4\u5982\uff0cgettext\u5e93\u652f\u6301AM_GNU_GETTEXT\u5b8f\u88ab\u7528\u4e8e\u4efb\u4f55\u4f7f\u7528gettext\u7684\u5305\u3002\u5e93\u5b89\u88c5\u4e4b\u540e\uff0c\u5176\u5b8f\u4e5f\u88ab\u5b89\u88c5\uff0c\u8fd9\u6837aclocal\u5c31\u80fd\u627e\u5230\u5b83\u3002 A macro file\u2019s name should end in .m4. Such files should be installed in $(datadir)/aclocal. This is as simple as writing: aclocaldir = $(datadir)/aclocal aclocal_DATA = mymacro.m4 myothermacro.m4 \u5b8f\u6587\u4ef6\u5e94\u8be5\u7531\u4e00\u7cfb\u5217\u7684 quoted AC_DEFUN (see Macro Definitions in The Autoconf Manual)\u7ec4\u6210\u3002","title":"6.3.3 \u7f16\u5199\u81ea\u5df1\u7684aclocal\u5b8f"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#634","text":"Autoconf\u63d0\u4f9b\u7684\u529f\u80fd\u6d4b\u8bd5\u4e0d\u80fd\u6ee1\u8db3\u6240\u6709\u7684\u9700\u6c42\u3002\u4eba\u4eec\u9700\u8981\u7528\u81ea\u5df1\u7684\u5b8f\u6216\u8005\u7b2c\u4e09\u65b9\u5b8f\u8865\u5145\u73b0\u6709\u7684\u6d4b\u8bd5\u3002\u6709\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\uff1a \u5728acinclude.m4\u4e2d\u5217\u51fa\u4f60\u6240\u6709\u7684\u5b8f \uff08\u63a8\u8350\u65b9\u6cd5\uff09\u5c06\u6bcf\u4e2a\u5b8f\u5199\u5230\u81ea\u5df1\u7684\u6587\u4ef6\u4e2d\u7136\u540e\u653e\u5230\u4e00\u4e2a\u76ee\u5f55\u4e2d\uff08\u901a\u5e38\u662fm4\uff09\uff0c\u7136\u540e\u5728configure.ac\u4e2d\u6dfb\u52a0\u53d8\u91cf\uff1a AC_CONFIG_MACRO_DIRS([m4]) \u3002\u7b2c\u4e09\u65b9\u7684\u5b8f\u6587\u4ef6\u6700\u597d\u4e5f\u653e\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u3002 aclocal\u63d0\u4f9b\u4e86 --install \u9009\u9879\u6765\u590d\u5236\u7cfb\u7edf\u5c42\u9762\u7684\u5b8f\u5230\u4f60\u672c\u5730\u7684\u5b8f\u76ee\u5f55\uff0c\u5e2e\u52a9\u4f60\u89e3\u51b3\u4e0a\u9762\u7684\u95ee\u9898\u3002\u672c\u5730\u7684\u5b8f\u6bd4\u7cfb\u7edf\u5c42\u9762\u7684\u5b8f\u6709\u4f18\u5148\u6743\u3002\u63a8\u8350\u5728\u6bcf\u6b21\u8fd0\u884caclocal\u65f6\u4f7f\u7528 --install \u9009\u9879\u3002","title":"6.3.4 \u5904\u7406\u672c\u5730\u5b8f"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#635","text":"\u4e3a\u4e86\u533a\u5206\u4e00\u4e2a\u5b8f\u7684\u7248\u672c\u3002 \u4f4d\u4e8eM4\u6587\u4ef6\u7684\u5b8f\u5b9a\u4e49\u7684\u524d\u9762\u3002 # \u5fc5\u987b\u662f\u6b64\u884c\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\uff0c\u5141\u8bb8\u5728version\u4e4b\u540e\u6dfb\u52a0\u5176\u4ed6\u5b57\u7b26 #serial version garbage \u4f7f\u7528\u4e86alcohol\u7684--install\u9009\u9879\u7684\u8bdd\uff0caclocal\u4f1a\u9009\u62e9\u542b\u6709#serial\u7684\u6216\u8005\u7f16\u53f7\u6bd4\u8f83\u65b0\u7684\u90a3\u4e2a\u6587\u4ef6\u3002\u6b64\u7f16\u53f7\u5bf9\u5e94\u7684\u662f\u6574\u4e2a\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u5355\u4e00\u7684\u4e00\u4e2a\u5b8f\u3002","title":"6.3.5 \u7f16\u53f7"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#636-aclocal","text":"aclocal\u53ef\u80fd\u4f1a\u6d88\u5931\u3002\u56e0\u4e3a\u5904\u7406M4\u7684\u5b8f\u662fAutoconf\u7684\u4efb\u52a1\u3002 \u6c38\u8fdc\u4e0d\u8981\u81ea\u5df1\u8c03\u7528aclocal\uff0c\u8ba9\u5b83\u5904\u4e8eautoreconf\u548cAutomake\u7684\u6784\u5efa\u89c4\u5219\u7684\u63a7\u5236\u4e0b\u3002 \u5f88\u591a\u5305\u542b\u6709bootstrap\u6216\u8005autogen.sh\u811a\u672c\uff0c\u5b9e\u9645\u4e0a\u4ed6\u4eec\u53ea\u662f\u5b89\u7167\u6b63\u786e\u7684\u987a\u5e8f\u8c03\u7528\u547d\u4ee4\uff08aclocal, libtoolize, gettextize or autopoint, autoconf, autoheader, and automake\uff09\uff0c\u8fd9\u4e9b\u5de5\u4f5cautoreconf\u5c31\u53ef\u4ee5\u505a\u5230\u3002","title":"6.3.6 aclocal\u7684\u672a\u6765"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#64-automakeautoconf","text":"\u2022 Public Macros: Macros that you can use. \u2022 Obsolete Macros: Macros that will soon be removed. \u2022 Private Macros: Macros that you should not use.","title":"6.4 Automake\u63d0\u4f9b\u7684Autoconf\u5b8f"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#_1","text":"","title":"\u516c\u5171\u5b8f"},{"location":"automake/6.%E6%89%AB%E6%8F%8Fconfigure.ac%EF%BC%8C%E4%BD%BF%E7%94%A8aclocal/#am_init_automake-options","text":"\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u7684automake\u9009\u9879\u3002 AM_INIT_AUTOMAKE([-Wno-portability])","title":"AM_INIT_AUTOMAKE ([options])"},{"location":"automake/7.%E6%96%87%E4%BB%B6%E5%A4%B9/","text":"7.1 \u9012\u5f52\u5b50\u6587\u4ef6\u5939 \u00b6 \u9876\u5c42\u7684Makefile.am\u5fc5\u987b\u544a\u8bc9Automake\u54ea\u4e9b\u5b50\u6587\u4ef6\u5939\u5c06\u88ab\u6784\u5efa\u3002\u901a\u8fc7 SUBDIRS \u53d8\u91cf\u5b9e\u73b0\u3002 \u5f53\u4f60\u5728\u9876\u7ea7\u76ee\u5f55\u6267\u884cmake\u547d\u4ee4\u7684\u65f6\u5019\uff0c\u5728\u6240\u6709\u7684\u5b50\u6587\u4ef6\u5939\u4e2d\u4e5f\u4f1a\u6267\u884c\uff0c\u81ea\u5b9a\u4e49\u7684\u89c4\u5219\u9664\u5916\u3002 note \uff1a\u8fd9\u4e9b\u5b50\u6587\u4ef6\u5939\u4e2d\u4e0d\u8981\u6c42\u542b\u6709Makefile.am\u6587\u4ef6\uff0c\u53ea\u8981\u6c42\u542b\u6709Makefile\u6587\u4ef6\uff08after configure\uff09\u3002 \u9ed8\u8ba4\u5b50\u6587\u4ef6\u5939\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e4b\u524d\u6784\u5efa\uff0c\u53ef\u4ee5\u5728\u4efb\u4f55\u4f4d\u7f6e\u6dfb\u52a0 . \u6765\u6539\u53d8\u8fd9\u4e00\u987a\u5e8f\u3002 SUBDIRS = lib src . tests \u603b\u662f\u628a\u6d4b\u8bd5\u7684\u653e\u5728\u6700\u540e\u3002 7.2 \u6761\u4ef6\u5b50\u6587\u4ef6\u5939 \u00b6 7.2.1 SUBDIRS vs DIST_SUBDIRS \u00b6 SUBDIRS \u5305\u542b\u4e86\u5f53\u524d\u76ee\u5f55\u4e0b\u5fc5\u987b\u6784\u5efa\u7684\u5b50\u76ee\u5f55\u3002\u9700\u8981\u624b\u52a8\u5b9a\u4e49\u3002 DIST_SUBDIRS \u7528\u4e8e\u9700\u8981\u5728\u6240\u6709\u7684\u76ee\u5f55\u4e0b\u9012\u5f52\u7684\u89c4\u5219\u3002 \u2018make maintainer-clean\u2019, \u2018make distclean\u2019 and \u2018make dist\u2019\u89c4\u5219\u4f7f\u7528 DIST_SUBDIRS \uff0c\u5176\u5b83\u89c4\u5219\u4f7f\u7528 SUBDIRS \u3002 \u5982\u679c\u4f7f\u7528Automake\u7684conditionals\u5b9a\u4e49 SUBDIRS \uff0cAutomake\u4f1a\u81ea\u52a8\u5b9a\u4e49 DIST_SUBDIRS \uff1b\u5982\u679c SUBDIRS \u5305\u542b\u4e86 AC_SUBST \u53d8\u91cf\uff0c DIST_SUBDIRS \u9700\u8981\u624b\u52a8\u5b9a\u4e49\u3002 7.2.2 \u4f7f\u7528 AM_CONDITIONAL \u5b9a\u4e49\u5b50\u76ee\u5f55 \u00b6 \u4e3e\u4f8b\uff1a configure AM_CONDITIONAL ( [ COND_OPT ] , [ test \"$want_opt\" = yes ] ) AC_CONFIG_FILES ( [ Makefile src/Makefile opt/Makefile ] ) Makefil . am if COND_OPT MAYBE_OPT = opt endif SUBDIRS = src $ ( MAYBE_OPT ) \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cAutomake\u4f1a\u81ea\u52a8\u5b9a\u4e49 DIST_SUBDIRS = src opt \uff0c\u56e0\u4e3a\u77e5\u9053\u5728\u7279\u5b9a\u7684\u6761\u4ef6\u4e0b MAYBE_OPT \u4f1a\u542b\u6709 opt \u3002 7.2.3 \u4f7f\u7528 AC_SUBST \u5b9a\u4e49\u5b50\u76ee\u5f55 \u00b6 \u4e3e\u4f8b\uff1a configure if test \"$want_opt\" = yes ; then MAYBE_OPT = opt else MAYBE_OPT = fi AC_SUBST ( [ MAYBE_OPT ] ) AC_CONFIG_FILES ( [ Makefile src/Makefile opt/Makefile ] ) Makefil . am SUBDIRS = src $ ( MAYBE_OPT ) DIST_SUBDIRS = src opt Automake\u4e0d\u80fd\u731c\u6d4b MAYBE_OPT \u7684\u503c\u662f\u4ec0\u4e48\uff0c\u9700\u8981\u624b\u52a8\u5b9a\u4e49 DIST_SUBDIRS \u3002 7.4 \u5d4c\u5957\u5305 \u00b6 \u5d4c\u5957\u7684\u5305\u76ee\u5f55\u5e94\u8be5\u4e5f\u5728 SUBDIRS \u4e2d\u5217\u51fa\u3002\u5b50\u5305\u7684Makefile\u5e94\u8be5\u7531\u81ea\u5df1\u7684configure\u811a\u672c\u751f\u6210\uff0c\u800c\u4e0d\u662f\u7236\u5305\u7684configure\u3002\u901a\u8fc7\u4f7f\u7528 AC_CONFIG_SUBDIRS \u8fbe\u5230\u8fd9\u4e00\u76ee\u7684\u3002 arm \u2019 s configure . ac : AC_INIT ( [ arm ] , [ 1.0 ] ) AC_CONFIG_AUX_DIR ( [ . ] ) AM_INIT_AUTOMAKE AC_PROG_CC AC_CONFIG_FILES ( [ Makefile ] ) # Call hand 's ./configure script recursively. AC_CONFIG_SUBDIRS([hand]) AC_OUTPUT arm\u2019s Makefile.am: # Build the library in the hand subdirectory first. SUBDIRS = hand # Include hand' s header when compiling this directory . AM_CPPFLAGS = - I $ ( srcdir ) / hand bin_PROGRAMS = arm arm_SOURCES = arm . c # link with the hand library . arm_LDADD = hand / libhand . a","title":"7.\u6587\u4ef6\u5939"},{"location":"automake/7.%E6%96%87%E4%BB%B6%E5%A4%B9/#71","text":"\u9876\u5c42\u7684Makefile.am\u5fc5\u987b\u544a\u8bc9Automake\u54ea\u4e9b\u5b50\u6587\u4ef6\u5939\u5c06\u88ab\u6784\u5efa\u3002\u901a\u8fc7 SUBDIRS \u53d8\u91cf\u5b9e\u73b0\u3002 \u5f53\u4f60\u5728\u9876\u7ea7\u76ee\u5f55\u6267\u884cmake\u547d\u4ee4\u7684\u65f6\u5019\uff0c\u5728\u6240\u6709\u7684\u5b50\u6587\u4ef6\u5939\u4e2d\u4e5f\u4f1a\u6267\u884c\uff0c\u81ea\u5b9a\u4e49\u7684\u89c4\u5219\u9664\u5916\u3002 note \uff1a\u8fd9\u4e9b\u5b50\u6587\u4ef6\u5939\u4e2d\u4e0d\u8981\u6c42\u542b\u6709Makefile.am\u6587\u4ef6\uff0c\u53ea\u8981\u6c42\u542b\u6709Makefile\u6587\u4ef6\uff08after configure\uff09\u3002 \u9ed8\u8ba4\u5b50\u6587\u4ef6\u5939\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e4b\u524d\u6784\u5efa\uff0c\u53ef\u4ee5\u5728\u4efb\u4f55\u4f4d\u7f6e\u6dfb\u52a0 . \u6765\u6539\u53d8\u8fd9\u4e00\u987a\u5e8f\u3002 SUBDIRS = lib src . tests \u603b\u662f\u628a\u6d4b\u8bd5\u7684\u653e\u5728\u6700\u540e\u3002","title":"7.1 \u9012\u5f52\u5b50\u6587\u4ef6\u5939"},{"location":"automake/7.%E6%96%87%E4%BB%B6%E5%A4%B9/#72","text":"","title":"7.2 \u6761\u4ef6\u5b50\u6587\u4ef6\u5939"},{"location":"automake/7.%E6%96%87%E4%BB%B6%E5%A4%B9/#721-subdirs-vs-dist_subdirs","text":"SUBDIRS \u5305\u542b\u4e86\u5f53\u524d\u76ee\u5f55\u4e0b\u5fc5\u987b\u6784\u5efa\u7684\u5b50\u76ee\u5f55\u3002\u9700\u8981\u624b\u52a8\u5b9a\u4e49\u3002 DIST_SUBDIRS \u7528\u4e8e\u9700\u8981\u5728\u6240\u6709\u7684\u76ee\u5f55\u4e0b\u9012\u5f52\u7684\u89c4\u5219\u3002 \u2018make maintainer-clean\u2019, \u2018make distclean\u2019 and \u2018make dist\u2019\u89c4\u5219\u4f7f\u7528 DIST_SUBDIRS \uff0c\u5176\u5b83\u89c4\u5219\u4f7f\u7528 SUBDIRS \u3002 \u5982\u679c\u4f7f\u7528Automake\u7684conditionals\u5b9a\u4e49 SUBDIRS \uff0cAutomake\u4f1a\u81ea\u52a8\u5b9a\u4e49 DIST_SUBDIRS \uff1b\u5982\u679c SUBDIRS \u5305\u542b\u4e86 AC_SUBST \u53d8\u91cf\uff0c DIST_SUBDIRS \u9700\u8981\u624b\u52a8\u5b9a\u4e49\u3002","title":"7.2.1 SUBDIRS vs DIST_SUBDIRS"},{"location":"automake/7.%E6%96%87%E4%BB%B6%E5%A4%B9/#722-am_conditional","text":"\u4e3e\u4f8b\uff1a configure AM_CONDITIONAL ( [ COND_OPT ] , [ test \"$want_opt\" = yes ] ) AC_CONFIG_FILES ( [ Makefile src/Makefile opt/Makefile ] ) Makefil . am if COND_OPT MAYBE_OPT = opt endif SUBDIRS = src $ ( MAYBE_OPT ) \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cAutomake\u4f1a\u81ea\u52a8\u5b9a\u4e49 DIST_SUBDIRS = src opt \uff0c\u56e0\u4e3a\u77e5\u9053\u5728\u7279\u5b9a\u7684\u6761\u4ef6\u4e0b MAYBE_OPT \u4f1a\u542b\u6709 opt \u3002","title":"7.2.2 \u4f7f\u7528AM_CONDITIONAL\u5b9a\u4e49\u5b50\u76ee\u5f55"},{"location":"automake/7.%E6%96%87%E4%BB%B6%E5%A4%B9/#723-ac_subst","text":"\u4e3e\u4f8b\uff1a configure if test \"$want_opt\" = yes ; then MAYBE_OPT = opt else MAYBE_OPT = fi AC_SUBST ( [ MAYBE_OPT ] ) AC_CONFIG_FILES ( [ Makefile src/Makefile opt/Makefile ] ) Makefil . am SUBDIRS = src $ ( MAYBE_OPT ) DIST_SUBDIRS = src opt Automake\u4e0d\u80fd\u731c\u6d4b MAYBE_OPT \u7684\u503c\u662f\u4ec0\u4e48\uff0c\u9700\u8981\u624b\u52a8\u5b9a\u4e49 DIST_SUBDIRS \u3002","title":"7.2.3 \u4f7f\u7528AC_SUBST\u5b9a\u4e49\u5b50\u76ee\u5f55"},{"location":"automake/7.%E6%96%87%E4%BB%B6%E5%A4%B9/#74","text":"\u5d4c\u5957\u7684\u5305\u76ee\u5f55\u5e94\u8be5\u4e5f\u5728 SUBDIRS \u4e2d\u5217\u51fa\u3002\u5b50\u5305\u7684Makefile\u5e94\u8be5\u7531\u81ea\u5df1\u7684configure\u811a\u672c\u751f\u6210\uff0c\u800c\u4e0d\u662f\u7236\u5305\u7684configure\u3002\u901a\u8fc7\u4f7f\u7528 AC_CONFIG_SUBDIRS \u8fbe\u5230\u8fd9\u4e00\u76ee\u7684\u3002 arm \u2019 s configure . ac : AC_INIT ( [ arm ] , [ 1.0 ] ) AC_CONFIG_AUX_DIR ( [ . ] ) AM_INIT_AUTOMAKE AC_PROG_CC AC_CONFIG_FILES ( [ Makefile ] ) # Call hand 's ./configure script recursively. AC_CONFIG_SUBDIRS([hand]) AC_OUTPUT arm\u2019s Makefile.am: # Build the library in the hand subdirectory first. SUBDIRS = hand # Include hand' s header when compiling this directory . AM_CPPFLAGS = - I $ ( srcdir ) / hand bin_PROGRAMS = arm arm_SOURCES = arm . c # link with the hand library . arm_LDADD = hand / libhand . a","title":"7.4 \u5d4c\u5957\u5305"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/","text":"8.1 \u6784\u5efa\u4e00\u4e2a\u7a0b\u5e8f \u00b6 \u4e3a\u4e86\u6784\u5efa\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u9700\u8981\u544a\u77e5Automake\u54ea\u4e9b\u6e90\u662f\u5b83\u7684\u4e00\u90e8\u5206\uff0c\u548c\u5b83\u5e94\u8be5\u94fe\u63a5\u54ea\u4e9b\u5e93\u3002 8.1.1 \u5b9a\u4e49\u7a0b\u5e8f\u6e90 \u00b6 \u5728\u4e00\u4e2a\u5305\u542b\u4e86\u8981\u88ab\u6784\u5efa\u8fdb\u7a0b\u5e8f\u7684\u8d44\u6e90\uff08\u975e\u5e93\u6216\u811a\u672c\uff09\u7684\u6587\u4ef6\u5939\uff0c\u4f7f\u7528 PROGRAMS \u3002 \u7a0b\u5e8f\u53ef\u4ee5\u88ab\u5b89\u88c5\u5230 bindir, sbindir, libexecdir, pkglibexecdir \uff0c\u6216\u8005\u6839\u672c\u4e0d\u5b89\u88c5(noinst_)\uff0c\u6216\u8005\u53ea\u5728 make check \u7684\u65f6\u5019\u6784\u5efa\uff08check_\uff09\u3002 bin_PROGRAMS = hello \u4e0e\u6bcf\u4e2a\u7a0b\u5e8f\u76f8\u5173\u8054\u7684\u662f\u4ee5\u7a0b\u5e8f\u547d\u540d\u7684\u51e0\u4e2a\u8f85\u52a9\u53d8\u91cf\u3002\u8fd9\u4e9b\u53d8\u91cf\u662f\u53ef\u9009\u7684\uff0c\u5e76\u4e14\u6709\u5408\u7406\u7684\u9ed8\u8ba4\u503c\u3002\u4e0b\u9762\u4ee5hello\u4e3a\u4f8b\u505a\u51fa\u8bf4\u660e\u3002 hello_SOURCES \u7528\u4e8e\u6307\u5b9a\u54ea\u4e9b\u6e90\u6587\u4ef6\u88ab\u6784\u5efa\u8fdb\u5165\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff1a hello_SOURCES = hello.c version.c getopt.c getopt1.c getopt.h system.h \u6539\u53d8\u91cf\u7684\u9ed8\u8ba4\u53d8\u91cf\u662f\u5355\u4e2a\u6587\u4ef6 hello.c \u3002 \u4e00\u4e2a\u6587\u4ef6\u5939\u53ef\u4ee5\u6784\u5efa\u591a\u4e2a\u7a0b\u5e8f\u3002\u591a\u4e2a\u7a0b\u5e8f\u4e5f\u53ef\u4ee5\u5171\u4eab\u4e00\u4e2a\u5355\u4e2a\u7684\u6e90\u6587\u4ef6\u3002 8.1.2 \u94fe\u63a5\u7a0b\u5e8f \u00b6 \u5982\u679c\u4f60\u60f3\u94fe\u63a5\u6ca1\u6709\u88abconfigure\u53d1\u73b0\u7684\u5e93\uff0c\u4f7f\u7528 LDADD \u53d8\u91cf\uff0c\u94fe\u63a5\u6807\u5fd7\u5219\u4f7f\u7528 AM_LDFLAGS \u53d8\u91cf\u3002 \u6709\u65f6\uff0c\u591a\u4e2a\u7a0b\u5e8f\u5728\u4e00\u4e2a\u76ee\u5f55\u4e0b\u6784\u5efa\uff0c\u4f46\u662f\u94fe\u63a5\u9700\u6c42\u4e0d\u540c\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528 prog _LDADD \u53d8\u91cf\u6765\u8986\u76d6 LDADD \u3002 \u4f8b\u5982\uff0ccpio\u3001pax\u3001mt \u4e0e\u5e93\u6587\u4ef6 libcpio.a \u94fe\u63a5\uff0c\u4f46\u662f\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u8fd8\u6709\u53e6\u4e00\u4e2a\u7a0b\u5e8f rmt \u88ab\u6784\u5efa\uff0c\u5b83\u4e0d\u9700\u8981\u8fd9\u4e2a\u5e93\u6587\u4ef6\u3002\u5e76\u4e14\uff0cmt \u548c rmt \u53ea\u4f1a\u5728\u7279\u5b9a\u67b6\u6784\u4e0b\u88ab\u6784\u5efa\u3002\u4e0b\u9762\u662f cpio \u7684src/Makefile.am \u6587\u4ef6\u7684\u5199\u6cd5\uff1a bin_PROGRAMS = cpio pax $( MT ) libexec_PROGRAMS = $( RMT ) EXTRA_PROGRAMS = mt rmt LDADD = ../lib/libcpio.a $( INTLLIBS ) rmt_LDADD = cpio_SOURCES = \u2026 pax_SOURCES = \u2026 mt_SOURCES = \u2026 rmt_SOURCES = \u2026 \u4f7f\u7528\u53d8\u91cf prog _LDFLAGS \u4f20\u9012\u94fe\u63a5\u6807\u5fd7\u3002 8.1.3 \u6e90\u6587\u4ef6\u7684\u6761\u4ef6\u7f16\u8bd1 \u00b6 \u4f60\u4e0d\u80fd\u653e\u7f6e\u4e00\u4e2a\u914d\u7f6e\u66ff\u6362\uff08e.g., \u2018@FOO@\u2019 or \u2018$(FOO)\u2019 where FOO is defined via AC_SUBST\uff09\u5230 _SOURCES \u53d8\u91cf\u4e2d\u3002 \u4f46\u662f\u6709\u4e24\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u8fbe\u5230\u540c\u6837\u7684\u76ee\u7684\uff1a1\u3001\u5728 _LDADD \u4e2d\u4f7f\u7528\u914d\u7f6e\u66ff\u6362\uff1b2\u3001\u4f7f\u7528Automake\u7684\u6761\u4ef6\u8bed\u53e5\u3002 1.\u4f7f\u7528 _LDADD \u00b6 Automake\u5fc5\u987b\u77e5\u9053\u6240\u6709\u7684\u53ef\u80fd\u7528\u5230\u7684\u6e90\u6587\u4ef6\u3002\u4efb\u4f55\u6761\u4ef6\u6784\u5efa\u7684\u6587\u4ef6\u90fd\u5e94\u653e\u5230\u5408\u9002\u7684 EXTRA_ \u53d8\u91cf\u4e2d\u3002 \u4f8b\u5982\uff0c\u76f8\u8981 hello-linux.c \u6216 hello-generic.c \u6709\u6761\u4ef6\u5730\u6784\u5efa\u5230 hello \u4e2d\uff1a Makefile . am \uff1a bin_PROGRAMS = hello hello_SOURCES = hello - common . c EXTRA_hello_SOURCES = hello - linux . c hello - generic . c hello_LDADD = $ ( HELLO_SYSTEM ) hello_DEPENDENCIES = $ ( HELLO_SYSTEM ) configure . ac \uff1a case $ host in * linux * ) HELLO_SYSTEM = 'hello-linux.$(OBJEXT)' ;; * ) HELLO_SYSTEM = 'hello-generic.$(OBJEXT)' ;; esac AC_SUBST ( [ HELLO_SYSTEM ] ) hello_DEPENDENCIES and hello_LDADD\u4fdd\u8bc1\u4e86\u6784\u5efa\u548c\u94fe\u63a5\u3002 2.\u4f7f\u7528Automake\u7684\u6761\u4ef6\u8bed\u53e5 \u00b6 \u8fd9\u79cd\u65b9\u5f0f\u66f4\u7b80\u5355\u3002\u8fd8\u662f\u4e0a\u8ff0\u7684\u4f8b\u5b50\uff1a Makefile . am \uff1a bin_PROGRAMS = hello hello_SOURCES = hello - common . c if LINUX hello_SOURCES += hello - linux . c else hello_SOURCES += hello - generic . c endif configure . ac \uff1a AM_CONDITIONAL ( [ LINUX ] , [ case $host in *linux*) HELLO_SYSTEM='hello-linux.$(OBJEXT)' ;; *) HELLO_SYSTEM='hello-generic.$(OBJEXT)' ;; esac ] ) \u4f60\u4e0d\u9700\u8981\u5b9a\u4e49 EXTRA_ \u53d8\u91cf\u3002 8.1.3 \u7a0b\u5e8f\u7684\u6761\u4ef6\u7f16\u8bd1 \u00b6 _PROGRAMS \u540c\u6837\u53ef\u4ee5\u4f7f\u7528 \u66ff\u6362\u6216\u6761\u4ef6\u8bed\u53e5 \u6765\u5b9e\u73b0\u76ee\u7684\u3002 1.\u4f7f\u7528configure\u6765\u66ff\u6362 \u00b6 bin_PROGRAMS = cpio pax $(MT) libexec_PROGRAMS = $(RMT) EXTRA_PROGRAMS = mt rmt note \uff1aAs explained in EXEEXT , Automake will rewrite bin_PROGRAMS, libexec_PROGRAMS, and EXTRA_PROGRAMS, appending \u2018$(EXEEXT)\u2019 to each binary. \u4f46\u662f\u5982\u679c\u4f7f\u7528\u4e86\u53d8\u91cf\u66ff\u6362\uff0c\u5219\u4e0d\u4f1a\u6269\u5c55\u540e\u7f00\u3002 2.\u4f7f\u7528\u6761\u4ef6\u8bed\u53e5 \u00b6 bin_PROGRAMS = cpio pax if WANT_MT bin_PROGRAMS += mt endif if WANT_RMT libexec_PROGRAMS = rmt endif \u8fd9\u79cd\u65b9\u5f0f\u4e0d\u5fc5\u62c5\u5fc3 \u2018$(EXEEXT)\u2019 or EXTRA_PROGRAMS\u3002 8.4 \u7a0b\u5e8f\u4e0e\u5e93 \u7684\u53d8\u91cf \u00b6 \u6709\u4e00\u7ec4\u53d8\u91cf\u548c\u6bcf\u4e2a\u7a0b\u5e8f\u76f8\u5173\uff0c\u53ef\u7528\u4e8e\u4fee\u6539\u7a0b\u5e8f\u7684\u6784\u5efa\u65b9\u5f0f\u3002\u5e93\u4e5f\u7c7b\u4f3c\u3002\u5b83\u4eec\u7684\u540d\u5b57\u5457\u7528\u4e8e\u547d\u540d\u8fd9\u4e9b\u53d8\u91cf\u7684\u57fa\u7840\u3002 \u4e0b\u9762\uff0c\u6211\u4f7f\u7528\u540d\u5b57 maude \u4ee3\u8868\u7a0b\u5e8f\u6216\u8005\u5e93\u6765\u8bf4\u660e\u8fd9\u4e9b\u53d8\u91cf\u3002 maude_SOURCES EXTRA_maude_SOURCES maude_LDADD maude_LDFLAGS maude_DEPENDENCIES EXTRA_maude_DEPENDENCIES 8.5 \u9ed8\u8ba4\u7684 _SOURCES \u00b6 _SOURCES variables are used to specify source files of programs ( see A Program ), libraries ( see A Library ), and Libtool libraries ( see A Shared Library ). \u8be5\u53d8\u91cf\u6ca1\u6709\u88ab\u6307\u5b9a\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u503c\u662f\u5355\u4e2a\u7684\u540c\u540d C\u6587\u4ef6 \uff0c\u5e26\u6709\u4efb\u4f55\u88ab AM_DEFAULT_SOURCE_EXT \u66ff\u6362\u7684\u540e\u7f00\uff0c\u9ed8\u8ba4\u7684\u540e\u7f00\u662f .c \u3002 check_PROGRAMS = test1 test2 test3 AM_DEFAULT_SOURCE_EXT = .cpp 8.20 \u53ef\u6267\u884c\u6269\u5c55\u7684\u652f\u6301 \u00b6 \u5728\u4e00\u4e9b\u5e73\u53f0\uff0c\u6bd4\u5982windows\uff0c\u53ef\u6267\u884c\u7a0b\u5e8f\u4f1a\u88ab\u6269\u5c55\u6210\u542b\u6709.exe\u7684\u7a0b\u5e8f\u3002 Automake\u652f\u6301\u5927\u90e8\u5206\u8fd9\u79cd\u8f6c\u6362\u3002 One thing you must be aware of is that, internally, Automake rewrites something like this: bin_PROGRAMS = liver to this: bin_PROGRAMS = liver$(EXEEXT) TESTS and XFAIL_TESTS \u4e5f\u4f1a\u88ab\u91cd\u5199\u5982\u679c\u5728\u540c\u4e00\u4e2aMakefile\u4e2d\u4ed6\u4eec\u5305\u542b\u4e86\u5df2\u7ecf\u88ab\u58f0\u660e\u4e3a\u7a0b\u5e8f\u7684\u6587\u4ef6\u540d\u3002 \u4f46\u662f\uff0c\u8fd9\u4e2a\u6280\u672f\u4e0d\u80fd\u5e94\u7528\u4e8econfigure\u53d8\u91cf\u66ff\u6362\u3002\u8fd9\u610f\u5473\u7740\u5982\u679c\u4f60\u4f7f\u7528\u4e86\u6761\u4ef6\u6784\u5efa\uff0c\u90a3\u4e48\u4f60\u5fc5\u987b\u81ea\u5df1\u5728configure.ac\u4e2d\u6dfb\u52a0 $(EXEEXT) \u6269\u5c55\u5176\u540e\u7f00\u3002 no-exeext \u9009\u9879\u53ef\u4ee5\u5173\u95ed\u8fd9\u4e2a\u7279\u6027\uff0c\u5b83\u4f1a\u8986\u76d6 foo$(EXEEXT) \u89c4\u5219\u3002","title":"8.\u6784\u5efa\u7a0b\u5e8f\u548c\u5e93"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#81","text":"\u4e3a\u4e86\u6784\u5efa\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u9700\u8981\u544a\u77e5Automake\u54ea\u4e9b\u6e90\u662f\u5b83\u7684\u4e00\u90e8\u5206\uff0c\u548c\u5b83\u5e94\u8be5\u94fe\u63a5\u54ea\u4e9b\u5e93\u3002","title":"8.1 \u6784\u5efa\u4e00\u4e2a\u7a0b\u5e8f"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#811","text":"\u5728\u4e00\u4e2a\u5305\u542b\u4e86\u8981\u88ab\u6784\u5efa\u8fdb\u7a0b\u5e8f\u7684\u8d44\u6e90\uff08\u975e\u5e93\u6216\u811a\u672c\uff09\u7684\u6587\u4ef6\u5939\uff0c\u4f7f\u7528 PROGRAMS \u3002 \u7a0b\u5e8f\u53ef\u4ee5\u88ab\u5b89\u88c5\u5230 bindir, sbindir, libexecdir, pkglibexecdir \uff0c\u6216\u8005\u6839\u672c\u4e0d\u5b89\u88c5(noinst_)\uff0c\u6216\u8005\u53ea\u5728 make check \u7684\u65f6\u5019\u6784\u5efa\uff08check_\uff09\u3002 bin_PROGRAMS = hello \u4e0e\u6bcf\u4e2a\u7a0b\u5e8f\u76f8\u5173\u8054\u7684\u662f\u4ee5\u7a0b\u5e8f\u547d\u540d\u7684\u51e0\u4e2a\u8f85\u52a9\u53d8\u91cf\u3002\u8fd9\u4e9b\u53d8\u91cf\u662f\u53ef\u9009\u7684\uff0c\u5e76\u4e14\u6709\u5408\u7406\u7684\u9ed8\u8ba4\u503c\u3002\u4e0b\u9762\u4ee5hello\u4e3a\u4f8b\u505a\u51fa\u8bf4\u660e\u3002 hello_SOURCES \u7528\u4e8e\u6307\u5b9a\u54ea\u4e9b\u6e90\u6587\u4ef6\u88ab\u6784\u5efa\u8fdb\u5165\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff1a hello_SOURCES = hello.c version.c getopt.c getopt1.c getopt.h system.h \u6539\u53d8\u91cf\u7684\u9ed8\u8ba4\u53d8\u91cf\u662f\u5355\u4e2a\u6587\u4ef6 hello.c \u3002 \u4e00\u4e2a\u6587\u4ef6\u5939\u53ef\u4ee5\u6784\u5efa\u591a\u4e2a\u7a0b\u5e8f\u3002\u591a\u4e2a\u7a0b\u5e8f\u4e5f\u53ef\u4ee5\u5171\u4eab\u4e00\u4e2a\u5355\u4e2a\u7684\u6e90\u6587\u4ef6\u3002","title":"8.1.1 \u5b9a\u4e49\u7a0b\u5e8f\u6e90"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#812","text":"\u5982\u679c\u4f60\u60f3\u94fe\u63a5\u6ca1\u6709\u88abconfigure\u53d1\u73b0\u7684\u5e93\uff0c\u4f7f\u7528 LDADD \u53d8\u91cf\uff0c\u94fe\u63a5\u6807\u5fd7\u5219\u4f7f\u7528 AM_LDFLAGS \u53d8\u91cf\u3002 \u6709\u65f6\uff0c\u591a\u4e2a\u7a0b\u5e8f\u5728\u4e00\u4e2a\u76ee\u5f55\u4e0b\u6784\u5efa\uff0c\u4f46\u662f\u94fe\u63a5\u9700\u6c42\u4e0d\u540c\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528 prog _LDADD \u53d8\u91cf\u6765\u8986\u76d6 LDADD \u3002 \u4f8b\u5982\uff0ccpio\u3001pax\u3001mt \u4e0e\u5e93\u6587\u4ef6 libcpio.a \u94fe\u63a5\uff0c\u4f46\u662f\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u8fd8\u6709\u53e6\u4e00\u4e2a\u7a0b\u5e8f rmt \u88ab\u6784\u5efa\uff0c\u5b83\u4e0d\u9700\u8981\u8fd9\u4e2a\u5e93\u6587\u4ef6\u3002\u5e76\u4e14\uff0cmt \u548c rmt \u53ea\u4f1a\u5728\u7279\u5b9a\u67b6\u6784\u4e0b\u88ab\u6784\u5efa\u3002\u4e0b\u9762\u662f cpio \u7684src/Makefile.am \u6587\u4ef6\u7684\u5199\u6cd5\uff1a bin_PROGRAMS = cpio pax $( MT ) libexec_PROGRAMS = $( RMT ) EXTRA_PROGRAMS = mt rmt LDADD = ../lib/libcpio.a $( INTLLIBS ) rmt_LDADD = cpio_SOURCES = \u2026 pax_SOURCES = \u2026 mt_SOURCES = \u2026 rmt_SOURCES = \u2026 \u4f7f\u7528\u53d8\u91cf prog _LDFLAGS \u4f20\u9012\u94fe\u63a5\u6807\u5fd7\u3002","title":"8.1.2 \u94fe\u63a5\u7a0b\u5e8f"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#813","text":"\u4f60\u4e0d\u80fd\u653e\u7f6e\u4e00\u4e2a\u914d\u7f6e\u66ff\u6362\uff08e.g., \u2018@FOO@\u2019 or \u2018$(FOO)\u2019 where FOO is defined via AC_SUBST\uff09\u5230 _SOURCES \u53d8\u91cf\u4e2d\u3002 \u4f46\u662f\u6709\u4e24\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u8fbe\u5230\u540c\u6837\u7684\u76ee\u7684\uff1a1\u3001\u5728 _LDADD \u4e2d\u4f7f\u7528\u914d\u7f6e\u66ff\u6362\uff1b2\u3001\u4f7f\u7528Automake\u7684\u6761\u4ef6\u8bed\u53e5\u3002","title":"8.1.3 \u6e90\u6587\u4ef6\u7684\u6761\u4ef6\u7f16\u8bd1"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#1_ldadd","text":"Automake\u5fc5\u987b\u77e5\u9053\u6240\u6709\u7684\u53ef\u80fd\u7528\u5230\u7684\u6e90\u6587\u4ef6\u3002\u4efb\u4f55\u6761\u4ef6\u6784\u5efa\u7684\u6587\u4ef6\u90fd\u5e94\u653e\u5230\u5408\u9002\u7684 EXTRA_ \u53d8\u91cf\u4e2d\u3002 \u4f8b\u5982\uff0c\u76f8\u8981 hello-linux.c \u6216 hello-generic.c \u6709\u6761\u4ef6\u5730\u6784\u5efa\u5230 hello \u4e2d\uff1a Makefile . am \uff1a bin_PROGRAMS = hello hello_SOURCES = hello - common . c EXTRA_hello_SOURCES = hello - linux . c hello - generic . c hello_LDADD = $ ( HELLO_SYSTEM ) hello_DEPENDENCIES = $ ( HELLO_SYSTEM ) configure . ac \uff1a case $ host in * linux * ) HELLO_SYSTEM = 'hello-linux.$(OBJEXT)' ;; * ) HELLO_SYSTEM = 'hello-generic.$(OBJEXT)' ;; esac AC_SUBST ( [ HELLO_SYSTEM ] ) hello_DEPENDENCIES and hello_LDADD\u4fdd\u8bc1\u4e86\u6784\u5efa\u548c\u94fe\u63a5\u3002","title":"1.\u4f7f\u7528_LDADD"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#2automake","text":"\u8fd9\u79cd\u65b9\u5f0f\u66f4\u7b80\u5355\u3002\u8fd8\u662f\u4e0a\u8ff0\u7684\u4f8b\u5b50\uff1a Makefile . am \uff1a bin_PROGRAMS = hello hello_SOURCES = hello - common . c if LINUX hello_SOURCES += hello - linux . c else hello_SOURCES += hello - generic . c endif configure . ac \uff1a AM_CONDITIONAL ( [ LINUX ] , [ case $host in *linux*) HELLO_SYSTEM='hello-linux.$(OBJEXT)' ;; *) HELLO_SYSTEM='hello-generic.$(OBJEXT)' ;; esac ] ) \u4f60\u4e0d\u9700\u8981\u5b9a\u4e49 EXTRA_ \u53d8\u91cf\u3002","title":"2.\u4f7f\u7528Automake\u7684\u6761\u4ef6\u8bed\u53e5"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#813_1","text":"_PROGRAMS \u540c\u6837\u53ef\u4ee5\u4f7f\u7528 \u66ff\u6362\u6216\u6761\u4ef6\u8bed\u53e5 \u6765\u5b9e\u73b0\u76ee\u7684\u3002","title":"8.1.3 \u7a0b\u5e8f\u7684\u6761\u4ef6\u7f16\u8bd1"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#1configure","text":"bin_PROGRAMS = cpio pax $(MT) libexec_PROGRAMS = $(RMT) EXTRA_PROGRAMS = mt rmt note \uff1aAs explained in EXEEXT , Automake will rewrite bin_PROGRAMS, libexec_PROGRAMS, and EXTRA_PROGRAMS, appending \u2018$(EXEEXT)\u2019 to each binary. \u4f46\u662f\u5982\u679c\u4f7f\u7528\u4e86\u53d8\u91cf\u66ff\u6362\uff0c\u5219\u4e0d\u4f1a\u6269\u5c55\u540e\u7f00\u3002","title":"1.\u4f7f\u7528configure\u6765\u66ff\u6362"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#2","text":"bin_PROGRAMS = cpio pax if WANT_MT bin_PROGRAMS += mt endif if WANT_RMT libexec_PROGRAMS = rmt endif \u8fd9\u79cd\u65b9\u5f0f\u4e0d\u5fc5\u62c5\u5fc3 \u2018$(EXEEXT)\u2019 or EXTRA_PROGRAMS\u3002","title":"2.\u4f7f\u7528\u6761\u4ef6\u8bed\u53e5"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#84","text":"\u6709\u4e00\u7ec4\u53d8\u91cf\u548c\u6bcf\u4e2a\u7a0b\u5e8f\u76f8\u5173\uff0c\u53ef\u7528\u4e8e\u4fee\u6539\u7a0b\u5e8f\u7684\u6784\u5efa\u65b9\u5f0f\u3002\u5e93\u4e5f\u7c7b\u4f3c\u3002\u5b83\u4eec\u7684\u540d\u5b57\u5457\u7528\u4e8e\u547d\u540d\u8fd9\u4e9b\u53d8\u91cf\u7684\u57fa\u7840\u3002 \u4e0b\u9762\uff0c\u6211\u4f7f\u7528\u540d\u5b57 maude \u4ee3\u8868\u7a0b\u5e8f\u6216\u8005\u5e93\u6765\u8bf4\u660e\u8fd9\u4e9b\u53d8\u91cf\u3002 maude_SOURCES EXTRA_maude_SOURCES maude_LDADD maude_LDFLAGS maude_DEPENDENCIES EXTRA_maude_DEPENDENCIES","title":"8.4 \u7a0b\u5e8f\u4e0e\u5e93 \u7684\u53d8\u91cf"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#85-_sources","text":"_SOURCES variables are used to specify source files of programs ( see A Program ), libraries ( see A Library ), and Libtool libraries ( see A Shared Library ). \u8be5\u53d8\u91cf\u6ca1\u6709\u88ab\u6307\u5b9a\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u503c\u662f\u5355\u4e2a\u7684\u540c\u540d C\u6587\u4ef6 \uff0c\u5e26\u6709\u4efb\u4f55\u88ab AM_DEFAULT_SOURCE_EXT \u66ff\u6362\u7684\u540e\u7f00\uff0c\u9ed8\u8ba4\u7684\u540e\u7f00\u662f .c \u3002 check_PROGRAMS = test1 test2 test3 AM_DEFAULT_SOURCE_EXT = .cpp","title":"8.5 \u9ed8\u8ba4\u7684 _SOURCES"},{"location":"automake/8.%E6%9E%84%E5%BB%BA%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BA%93/#820","text":"\u5728\u4e00\u4e9b\u5e73\u53f0\uff0c\u6bd4\u5982windows\uff0c\u53ef\u6267\u884c\u7a0b\u5e8f\u4f1a\u88ab\u6269\u5c55\u6210\u542b\u6709.exe\u7684\u7a0b\u5e8f\u3002 Automake\u652f\u6301\u5927\u90e8\u5206\u8fd9\u79cd\u8f6c\u6362\u3002 One thing you must be aware of is that, internally, Automake rewrites something like this: bin_PROGRAMS = liver to this: bin_PROGRAMS = liver$(EXEEXT) TESTS and XFAIL_TESTS \u4e5f\u4f1a\u88ab\u91cd\u5199\u5982\u679c\u5728\u540c\u4e00\u4e2aMakefile\u4e2d\u4ed6\u4eec\u5305\u542b\u4e86\u5df2\u7ecf\u88ab\u58f0\u660e\u4e3a\u7a0b\u5e8f\u7684\u6587\u4ef6\u540d\u3002 \u4f46\u662f\uff0c\u8fd9\u4e2a\u6280\u672f\u4e0d\u80fd\u5e94\u7528\u4e8econfigure\u53d8\u91cf\u66ff\u6362\u3002\u8fd9\u610f\u5473\u7740\u5982\u679c\u4f60\u4f7f\u7528\u4e86\u6761\u4ef6\u6784\u5efa\uff0c\u90a3\u4e48\u4f60\u5fc5\u987b\u81ea\u5df1\u5728configure.ac\u4e2d\u6dfb\u52a0 $(EXEEXT) \u6269\u5c55\u5176\u540e\u7f00\u3002 no-exeext \u9009\u9879\u53ef\u4ee5\u5173\u95ed\u8fd9\u4e2a\u7279\u6027\uff0c\u5b83\u4f1a\u8986\u76d6 foo$(EXEEXT) \u89c4\u5219\u3002","title":"8.20 \u53ef\u6267\u884c\u6269\u5c55\u7684\u652f\u6301"},{"location":"automake/9.%E5%85%B6%E5%AE%83%E6%B4%BE%E7%94%9F%E5%AF%B9%E8%B1%A1/","text":"Automake\u8fd8\u652f\u6301\u5904\u7406 C\u7a0b\u5e8f\u4ee5\u5916 \u7684\u6d3e\u751f\u5bf9\u8c61\u3002 9.1 \u53ef\u6267\u884c\u811a\u672c \u00b6 \u5b8c\u5168\u53ef\u4ee5\u5b9a\u4e49\u548c\u5b89\u88c5\u811a\u672c\u7c7b\u578b\u7684\u7a0b\u5e8f\u3002\u4f7f\u7528 _SCRIPTS primary\u3002 \u811a\u672c\u9ed8\u8ba4\u662f\u4e0d\u53d1\u5e03\u7684\uff0c\u53ef\u4ee5\u4f7f\u7528 dist_ \u6765\u6539\u53d8\u3002 # Install my_script in $(bindir) and distribute it. dist_bin_SCRIPTS = my_script \u811a\u672c\u53ef\u4ee5\u5b89\u88c5\u5230 bindir, sbindir, libexecdir, pkglibexecdir, pkgdatadir \u3002 \u65e0\u9700\u5b89\u88c5\u7684\u811a\u672c\u5217\u5728 noinst_SCRIPTS \uff0c\u5728\u4ed6\u4eec\u4e2d\uff0c\u53ea\u88ab make check \u9700\u8981\u7684\u5217\u5728 check_SCRIPTS \u3002 9.2 \u5934\u6587\u4ef6 \u00b6 \u5fc5\u987b\u88ab\u5b89\u88c5\u7684\u5934\u6587\u4ef6\u901a\u8fc7 _HEADERS \u53d8\u91cf\u5b9e\u73b0\u3002\u53ef\u4ee5\u88ab\u5b89\u88c5\u5230 includedir, oldincludedir, pkgincludedir \u6216\u8005\u4efb\u4f55\u81ea\u5b9a\u4e49\u7684\u76ee\u5f55\u3002\u4f8b\u5982\uff1a include_HEADERS = foo.h bar/bar.h \u5c06\u5b89\u88c5\u4e24\u4e2a\u6587\u4ef6 $(includedir)/foo.h and $(includedir)/bar.h\u3002 \u6240\u6709\u7684\u5934\u6587\u4ef6\u5fc5\u987b\u88ab\u5217\u5728 _SOURCES \u6216 _HEADERS \u4e2d\u3002 \u4e00\u5b9a\u4e0d\u80fd\u53d1\u5e03\u7684\u5934\u6587\u4ef6\u5199\u5728 nodist_include_HEADERS or nodist_prog_SOURCES \u4e2d\u3002 9.3 \u67b6\u6784\u65e0\u5173\u6570\u636e\u6587\u4ef6 \u00b6 Automake\u652f\u6301\u6742\u6570\u636e\u6587\u4ef6\u7684\u5b89\u88c5\uff0c\u4f7f\u7528 _DATA \u53d8\u91cf\u3002 \u53ef\u4ee5\u88ab\u5b89\u88c5\u5230\u7684\u6587\u4ef6\u5939\uff1a datadir, sysconfdir, sharedstatedir, localstatedir, or pkgdatadir \u3002 dist_pkgdata_DATA = clean-kr.am clean.am \u2026 9.4 \u6784\u5efa\u6e90\u6587\u4ef6 \u00b6 \u81ea\u52a8\u4f9d\u8d56\u8ffd\u8e2a\u4f9d\u8d56\u4e8e\u7f16\u8bd1\uff0c\u6240\u4ee5\u53ea\u6709\u5728\u7b2c\u4e00\u6b21\u7f16\u8bd1\u7684\u65f6\u5019\u624d\u80fd\u77e5\u9053\u5176\u4f9d\u8d56\u5173\u7cfb\u3002 \u5b58\u5728\u7684\u95ee\u9898\uff1a\u5982\u679c\u9700\u8981\u6784\u5efa\u53ef\u6267\u884c\u7a0b\u5e8ffoo\uff0c\u4f46\u662f\u5374\u6ca1\u6709foo.h\uff0c\u6bd4\u5982foo.h\u662f\u5176\u5b83\u89c4\u5219\u7684\u5bf9\u8c61\u5e76\u4e14\u8be5\u89c4\u5219\u6ca1\u6709\u6267\u884c\uff0c\u90a3\u4e48\u4f1a\u6784\u5efa\u5931\u8d25\u3002 \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\uff0c\u53ef\u4f7f\u7528 BUILT_SOURCES \u53d8\u91cf\u3002\u5728\u8be5\u53d8\u91cf\u4e2d\u5217\u51fa\u7684\u6e90\u6587\u4ef6\u662f\u5728 make all or make check (or even make install) \u65f6\u5728\u5176\u4ed6\u76ee\u6807\u88ab\u6267\u884c\u4e4b\u524d\u521b\u5efa\u7684\u3002 1.\u4f7f\u7528 BUILT_SOURCES \u00b6 \u6240\u4ee5\uff0c\u53ef\u4ee5\u4f7f\u7528 BUILT_SOURCES = foo.h \u6765\u786e\u4fdd make all or make check \u7684\u65f6\u5019\uff0c\u8be5\u6587\u4ef6\u5728\u5176\u4ed6\u76ee\u6807\u4e4b\u524d\u88ab\u6784\u5efa\u3002 2.\u624b\u52a8\u7f16\u5199\u4f9d\u8d56 \u00b6 \u5982\u679c\u4f60\u5728\u4e0a\u8ff0\u4e09\u4e2amake\u547d\u4ee4\u4e4b\u524d\u6267\u884c\u4e86\u5176\u4ed6\u7684 make foo \u547d\u4ee4\uff0c\u90a3\u4e48\u4f1a\u62a5\u9519\u3002\uff1f\uff1f\uff1f\u4e0d\u4f1a\u62a5\u9519\u554a \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u66ff\u4ee3 BUILT_SOURCES \u7684\u5199\u6cd5\u662f foo.$(OBJEXT): bindir.h 3.\u4ece configure \u6784\u5efa \u5934\u6587\u4ef6 \u00b6 \u53ef\u4ee5\u5728config.h\u4e2d\u5b9a\u4e49\u5934\u6587\u4ef6\u7684\u5b8f\uff08 see Defining Directories \uff09\uff0c\u6216\u8005\u4f7f\u7528 AC_CONFIG_FILES ( see Configuration Actions )\u9a71\u52a8 bindir.h.in \u6587\u4ef6\u3002 \u5982\u6b64\u4e00\u6765\uff0cMakefile.am\u5c31\u80fd\u5199\u5730\u5f88\u7b80\u77ed\uff1a bin_PROGRAMS = foo foo_SOURCES = foo.c \u4f46\u662f\u603b\u4f1a\u6709\u4e0d\u80fd\u4ececonfigure\u6784\u5efa\u6e90\u6587\u4ef6\u7684\u60c5\u51b5\u3002 4.\u6784\u5efa .c \u6587\u4ef6\uff0c\u800c\u4e0d\u662f .h \u6587\u4ef6 \u00b6 noinst_PROGRAMS = foo foo_SOURCES = foo.c bindir.h nodist_foo_SOURCES = bindir.c CLEANFILES = bindir.c bindir.c: Makefile echo 'const char bindir[] = \"$(bindir)\";' >$@","title":"9.\u5176\u5b83\u6d3e\u751f\u5bf9\u8c61"},{"location":"automake/9.%E5%85%B6%E5%AE%83%E6%B4%BE%E7%94%9F%E5%AF%B9%E8%B1%A1/#91","text":"\u5b8c\u5168\u53ef\u4ee5\u5b9a\u4e49\u548c\u5b89\u88c5\u811a\u672c\u7c7b\u578b\u7684\u7a0b\u5e8f\u3002\u4f7f\u7528 _SCRIPTS primary\u3002 \u811a\u672c\u9ed8\u8ba4\u662f\u4e0d\u53d1\u5e03\u7684\uff0c\u53ef\u4ee5\u4f7f\u7528 dist_ \u6765\u6539\u53d8\u3002 # Install my_script in $(bindir) and distribute it. dist_bin_SCRIPTS = my_script \u811a\u672c\u53ef\u4ee5\u5b89\u88c5\u5230 bindir, sbindir, libexecdir, pkglibexecdir, pkgdatadir \u3002 \u65e0\u9700\u5b89\u88c5\u7684\u811a\u672c\u5217\u5728 noinst_SCRIPTS \uff0c\u5728\u4ed6\u4eec\u4e2d\uff0c\u53ea\u88ab make check \u9700\u8981\u7684\u5217\u5728 check_SCRIPTS \u3002","title":"9.1 \u53ef\u6267\u884c\u811a\u672c"},{"location":"automake/9.%E5%85%B6%E5%AE%83%E6%B4%BE%E7%94%9F%E5%AF%B9%E8%B1%A1/#92","text":"\u5fc5\u987b\u88ab\u5b89\u88c5\u7684\u5934\u6587\u4ef6\u901a\u8fc7 _HEADERS \u53d8\u91cf\u5b9e\u73b0\u3002\u53ef\u4ee5\u88ab\u5b89\u88c5\u5230 includedir, oldincludedir, pkgincludedir \u6216\u8005\u4efb\u4f55\u81ea\u5b9a\u4e49\u7684\u76ee\u5f55\u3002\u4f8b\u5982\uff1a include_HEADERS = foo.h bar/bar.h \u5c06\u5b89\u88c5\u4e24\u4e2a\u6587\u4ef6 $(includedir)/foo.h and $(includedir)/bar.h\u3002 \u6240\u6709\u7684\u5934\u6587\u4ef6\u5fc5\u987b\u88ab\u5217\u5728 _SOURCES \u6216 _HEADERS \u4e2d\u3002 \u4e00\u5b9a\u4e0d\u80fd\u53d1\u5e03\u7684\u5934\u6587\u4ef6\u5199\u5728 nodist_include_HEADERS or nodist_prog_SOURCES \u4e2d\u3002","title":"9.2 \u5934\u6587\u4ef6"},{"location":"automake/9.%E5%85%B6%E5%AE%83%E6%B4%BE%E7%94%9F%E5%AF%B9%E8%B1%A1/#93","text":"Automake\u652f\u6301\u6742\u6570\u636e\u6587\u4ef6\u7684\u5b89\u88c5\uff0c\u4f7f\u7528 _DATA \u53d8\u91cf\u3002 \u53ef\u4ee5\u88ab\u5b89\u88c5\u5230\u7684\u6587\u4ef6\u5939\uff1a datadir, sysconfdir, sharedstatedir, localstatedir, or pkgdatadir \u3002 dist_pkgdata_DATA = clean-kr.am clean.am \u2026","title":"9.3 \u67b6\u6784\u65e0\u5173\u6570\u636e\u6587\u4ef6"},{"location":"automake/9.%E5%85%B6%E5%AE%83%E6%B4%BE%E7%94%9F%E5%AF%B9%E8%B1%A1/#94","text":"\u81ea\u52a8\u4f9d\u8d56\u8ffd\u8e2a\u4f9d\u8d56\u4e8e\u7f16\u8bd1\uff0c\u6240\u4ee5\u53ea\u6709\u5728\u7b2c\u4e00\u6b21\u7f16\u8bd1\u7684\u65f6\u5019\u624d\u80fd\u77e5\u9053\u5176\u4f9d\u8d56\u5173\u7cfb\u3002 \u5b58\u5728\u7684\u95ee\u9898\uff1a\u5982\u679c\u9700\u8981\u6784\u5efa\u53ef\u6267\u884c\u7a0b\u5e8ffoo\uff0c\u4f46\u662f\u5374\u6ca1\u6709foo.h\uff0c\u6bd4\u5982foo.h\u662f\u5176\u5b83\u89c4\u5219\u7684\u5bf9\u8c61\u5e76\u4e14\u8be5\u89c4\u5219\u6ca1\u6709\u6267\u884c\uff0c\u90a3\u4e48\u4f1a\u6784\u5efa\u5931\u8d25\u3002 \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\uff0c\u53ef\u4f7f\u7528 BUILT_SOURCES \u53d8\u91cf\u3002\u5728\u8be5\u53d8\u91cf\u4e2d\u5217\u51fa\u7684\u6e90\u6587\u4ef6\u662f\u5728 make all or make check (or even make install) \u65f6\u5728\u5176\u4ed6\u76ee\u6807\u88ab\u6267\u884c\u4e4b\u524d\u521b\u5efa\u7684\u3002","title":"9.4 \u6784\u5efa\u6e90\u6587\u4ef6"},{"location":"automake/9.%E5%85%B6%E5%AE%83%E6%B4%BE%E7%94%9F%E5%AF%B9%E8%B1%A1/#1-built_sources","text":"\u6240\u4ee5\uff0c\u53ef\u4ee5\u4f7f\u7528 BUILT_SOURCES = foo.h \u6765\u786e\u4fdd make all or make check \u7684\u65f6\u5019\uff0c\u8be5\u6587\u4ef6\u5728\u5176\u4ed6\u76ee\u6807\u4e4b\u524d\u88ab\u6784\u5efa\u3002","title":"1.\u4f7f\u7528 BUILT_SOURCES"},{"location":"automake/9.%E5%85%B6%E5%AE%83%E6%B4%BE%E7%94%9F%E5%AF%B9%E8%B1%A1/#2","text":"\u5982\u679c\u4f60\u5728\u4e0a\u8ff0\u4e09\u4e2amake\u547d\u4ee4\u4e4b\u524d\u6267\u884c\u4e86\u5176\u4ed6\u7684 make foo \u547d\u4ee4\uff0c\u90a3\u4e48\u4f1a\u62a5\u9519\u3002\uff1f\uff1f\uff1f\u4e0d\u4f1a\u62a5\u9519\u554a \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u66ff\u4ee3 BUILT_SOURCES \u7684\u5199\u6cd5\u662f foo.$(OBJEXT): bindir.h","title":"2.\u624b\u52a8\u7f16\u5199\u4f9d\u8d56"},{"location":"automake/9.%E5%85%B6%E5%AE%83%E6%B4%BE%E7%94%9F%E5%AF%B9%E8%B1%A1/#3-configure","text":"\u53ef\u4ee5\u5728config.h\u4e2d\u5b9a\u4e49\u5934\u6587\u4ef6\u7684\u5b8f\uff08 see Defining Directories \uff09\uff0c\u6216\u8005\u4f7f\u7528 AC_CONFIG_FILES ( see Configuration Actions )\u9a71\u52a8 bindir.h.in \u6587\u4ef6\u3002 \u5982\u6b64\u4e00\u6765\uff0cMakefile.am\u5c31\u80fd\u5199\u5730\u5f88\u7b80\u77ed\uff1a bin_PROGRAMS = foo foo_SOURCES = foo.c \u4f46\u662f\u603b\u4f1a\u6709\u4e0d\u80fd\u4ececonfigure\u6784\u5efa\u6e90\u6587\u4ef6\u7684\u60c5\u51b5\u3002","title":"3.\u4ece configure \u6784\u5efa \u5934\u6587\u4ef6"},{"location":"automake/9.%E5%85%B6%E5%AE%83%E6%B4%BE%E7%94%9F%E5%AF%B9%E8%B1%A1/#4-c-h","text":"noinst_PROGRAMS = foo foo_SOURCES = foo.c bindir.h nodist_foo_SOURCES = bindir.c CLEANFILES = bindir.c bindir.c: Makefile echo 'const char bindir[] = \"$(bindir)\";' >$@","title":"4.\u6784\u5efa .c \u6587\u4ef6\uff0c\u800c\u4e0d\u662f .h \u6587\u4ef6"},{"location":"automake/%E7%AE%80%E4%BB%8B/","text":"Automake\u4ecb\u7ecd \u00b6 Automake\u662f\u4eceMakefile.am(\u5b9a\u4e49\u4e00\u7cfb\u5217make\u53d8\u91cf\u7684\u6587\u4ef6)\u81ea\u52a8\u751f\u6210Makefile.in\u6587\u4ef6\u7684\u5de5\u5177\u3002\u751f\u6210\u7684Makefile.in\u7b26\u5408GNU Makefile \u6807\u51c6\u3002 \u56e0\u4e3a\u4e0d\u540c\u7684\u5e73\u53f0\u9700\u8981\u4fee\u6539Makefile\uff0c\u6240\u4ee5\u7f16\u5199 configure \u811a\u672c\u81ea\u52a8\u4fee\u6539Makefile\uff0c\u518d\u6267\u884c ./configure && make && make install \u547d\u4ee4\u5b89\u88c5\u5305\uff0c\u5f62\u6210\u4e86GNU\u6784\u5efa\u7cfb\u7edf\u3002 Autotools\u4ecb\u7ecd \u00b6 Autotools \u662f\u4e3a\u5305\u521b\u5efaGNU\u6784\u5efa\u7cfb\u7edf\u7684\u5de5\u5177\uff1b Autoconf \u4e3b\u8981\u5173\u6ce8 configure \uff1b Automake \u4e3b\u8981\u5173\u6ce8 Makefile \u3002 \u5f53\u5b89\u88c5\u4e00\u4e2a\u7a0b\u5e8f\u65f6\uff0c\u5b89\u88c5\u6b65\u9aa4\u6709\u4ee5\u4e0b\u51e0\u6b65\uff1a tar -zxf xxx.tar.gz cd xxx ./configure #\u68c0\u67e5\u8981\u6c42\u7684\u73af\u5883\uff0c\u751f\u6210\u5305\u62ecMakefile\uff08s\uff09\u5728\u5185\u7684\u591a\u4e2a\u6587\u4ef6 make #\u6784\u5efa\u6240\u6709\u7684\u6587\u4ef6\u7ed3\u6784\uff0c\u751f\u6210\u6587\u4ef6 make check #\u6e90\u7801\u68c0\u67e5 su #\u5207\u6362\u5230root\u7528\u6237 make install #\u590d\u5236\u6e90\u7801\u6587\u4ef6\u5230\u76ee\u7684\u76ee\u5f55 make installcheck #\u5b89\u88c5\u540e\u68c0\u67e5 note \uff1a make uninstall \u9700\u8981\u5728\u6784\u5efa\u6811\u4e0b\u8fd0\u884c make clean \u5220\u9664make\u751f\u6210\u7684\u6587\u4ef6 make distclean \u989d\u5916\u5220\u9664 ./configure\u751f\u6210\u7684\u6587\u4ef6 make dist \u4ece\u6e90\u7801\u91cd\u65b0\u521b\u5efaxxx.tar.gz \u6709\u4e00\u4e9b\u53ef\u914d\u7f6e\u53d8\u91cf\uff0c\u53ef\u4ee5\u901a\u8fc7 ./configure --help \u67e5\u770b\u5b8c\u6574\u7248 \u5982\u679c\u60f3\u914d\u7f6e\u7cfb\u7edf\u9ed8\u8ba4\u53d8\u91cf\uff0c\u53ef\u4ee5\u4fee\u6539 /usr/local/share/config.site \u6587\u4ef6\u4e2d\u6307\u5b9a 2.2.3 \u6807\u51c6\u76ee\u5f55\u53d8\u91cf \u00b6 Directory variable Default value prefix /usr/local exec_prefix ${ prefix } bindir ${ exec_prefix } /bin libdir ${ exec_prefix } /lib \u2026 includedir ${ prefix } /include datarootdir ${ prefix } /share datadir ${ datarootdir } mandir ${ datarootdir } /man infodir ${ datarootdir } /info docdir ${ datarootdir } /doc/ ${ PACKAGE } \u901a\u8fc7 ./configure --help \u67e5\u770b\u5b8c\u6574\u7248\u3002 \u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u6539\u53d8\u8fd9\u4e9b\u76ee\u5f55\uff1a ./configure --prefix ~/usr \u3002 2.2.6 \u5e76\u884c\u6784\u5efa\u6811\uff08VPATH \u6784\u5efa\uff09 \u00b6 \u5bf9\u6bd4\u6e90\u7801\u6811\u4e0e\u6784\u5efa\u6811 \u00b6 \u6e90\u7801\u6811 \uff1a\u5305\u542b\u4e86configure\u6587\u4ef6\u7684\u6240\u6709\u6e90\u6587\u4ef6 \u6784\u5efa\u6811 \uff1a\u5728\u6e90\u7801\u6811\u7684\u57fa\u7840\u4e0a\uff0c\u5305\u542b\u4e0a\u8fd0\u884cconfigure\u4e4b\u540e\u6d3e\u751f\u51fa\u6765\u7684\u6587\u4ef6\u3002\u901a\u5e38\u76ee\u5f55\u7ed3\u6784\u4e0e\u6e90\u7801\u6811\u4e00\u81f4\uff0c\u5b50\u76ee\u5f55\u662f\u88ab\u6784\u5efa\u7cfb\u7edf\u81ea\u52a8\u521b\u5efa\u51fa\u6765\u7684 \u865a\u62df\u8def\u5f84\u6784\u5efa \u00b6 \u53ef\u4ee5\u5728\u89e3\u538b\u5b8c\u538b\u7f29\u5305\u4e4b\u540e\u5728\u4efb\u610f\u4f4d\u7f6e\u65b0\u5efa\u4e00\u4e2abuild\u5b50\u6587\u4ef6\u5939\u5e76\u5728\u8be5\u6587\u4ef6\u5939\u4e0b\u6267\u884c\u540e\u7eed\u6b65\u9aa4\uff0c\u6240\u6709\u7684\u6d3e\u751f\u6587\u4ef6\u4f1a\u5b58\u653e\u5728build\u76ee\u5f55\u4e0b\uff0c\u8fd9\u6837\u7684\u6784\u5efa\u53eb\u505a parallel build \u6216\u8005 VPATH builds \u3002 \u865a\u62df\u8def\u5f84\u6784\u5efa\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a\u5b50\u6587\u4ef6\u5939\u8fdb\u884c\u6784\u5efa\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u53c2\u6570\u6784\u5efa\u540c\u4e00\u4efd\u6e90\u7801\u3002 \u4e00\u4e9b\u7279\u6027 \u00b6 2.2.8 \u4ea4\u53c9\u7f16\u8bd1 \u00b6 \u5728\u6307\u5b9a\u7684\u6784\u5efa\u5e73\u53f0\u4e0a\u7f16\u8bd1\u53ef\u4ee5\u5728\u8fd0\u884c\u5e73\u53f0\u4e0a\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6 ./configure --build\u6307\u5b9a\u6784\u5efa\u5e73\u53f0\uff0c--host\u6307\u5b9a\u8fd0\u884c\u5e73\u53f0 notes \uff1a\u5982\u679c\u9700\u8981\u6784\u5efa\u7684\u5305\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u4ea4\u53c9\u7f16\u8bd1\u5668\uff0c\u9700\u8981\u4f7f\u7528--target\u53c2\u6570\u6307\u5b9a\u67b6\u6784 2.2.9 \u91cd\u547d\u540d\u7a0b\u5e8f \u00b6 \u53ef\u4ee5\u5728\u6267\u884cconfigure\u7684\u65f6\u5019\u5bf9\u5b89\u88c5\u7684\u7a0b\u5e8f\u91cd\u547d\u540d\uff0c\u6bd4\u5982\u5b89\u88c5 tar \u53d8\u4e3a gtar \u4ee5\u4e0b\u4e09\u4e2a\u53c2\u6570\u53ef\u4ee5\u6ee1\u8db3\u8be5\u9700\u6c42\uff1a --program-prefix #\u7ed9\u7a0b\u5e8f\u540d\u5b57\u6dfb\u52a0\u524d\u7f00 --program-suffix #\u7ed9\u7a0b\u5e8f\u540d\u5b57\u6dfb\u52a0\u540e\u7f00 --program-transform-name #\u91cd\u547d\u540d\u7a0b\u5e8f eg. ./configure --program-prefix tea 2.2.10 \u6307\u5b9a\u76ee\u7684\u6587\u4ef6\u5939\u6784\u5efa\u4e8c\u8fdb\u5236\u6587\u4ef6 \u00b6 make DESTDIR = $HOME /inst install \u6b64\u4e3e\u4f1a\u5c06\u7a0b\u5e8f\u5b89\u88c5\u5728 ~/inst \u6587\u4ef6\u5939\u4e0b\uff0c\u6587\u4ef6\u5939\u4e0b\u5305\u542b\u4e86\u7a0b\u5e8f\u7684\u5b89\u88c5\u7ed3\u6784 \u5b89\u88c5\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a \u6253\u5305\uff1a cd ~/inst find . -type f -print > ../files.lst tar zcvf ~/amhello-1.0-i686.tar.gz ` cat ../files.lst ` \u5982\u6b64\u4e00\u6765\uff0c\u76f4\u63a5\u89e3\u538b\u8fd9\u4e2a\u538b\u7f29\u5305\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u5b8c\u6210amhello\u7684\u5b89\u88c5\u3002 2.2.11 \u51c6\u5907\u53d1\u5e03 \u00b6 \u4f7f\u7528 make distcheck \u6765\u4fdd\u8bc1\u5305\u62e5\u6709\u6240\u9700\u8981\u7684\u6784\u5efa\u6b65\u9aa4\u5e76\u4e14\u4e0d\u4f1a\u62a5\u9519 \u5c1d\u8bd5\u5b8c\u6574\u7684\u6253\u5305\u3001\u89e3\u5305\u3001\u8fd0\u884cmake\u3001make check\u3001make install\u3001make installcheck\u3001make dist \u6d4b\u8bd5\u53ea\u8bfb\u6e90\u7801\u6811\u7684 VPATH Builds \u4fdd\u8bc1make clean\u3001make distclean\u3001make uninstall\u4e0d\u4f1a\u9057\u6f0f\u4efb\u4f55\u6587\u4ef6 \u68c0\u67e5 DESTDIR \u5b89\u88c5\u5de5\u4f5c \u751f\u6210\u6784\u5efa\u7cfb\u7edf \u00b6 autoreconfig \u662f\u4e00\u4e2a\u6309\u7167\u6b63\u786e\u6267\u884cautoconf\u3001automake\u548c\u4e00\u5806\u5176\u5b83\u547d\u4ee4\u7684\u811a\u672c\uff0c\u7528\u4e8e\u751f\u6210\u6784\u5efa\u7cfb\u7edf\u3002 \u7f16\u5199configure.ac\u3001Makefile.am\u3001main.c\u3001README\u6587\u4ef6\uff0c\u6267\u884c autoreconfig --install \u5b9e\u4f8b\u5316\u4e00\u4e2a\u6784\u5efa\u7cfb\u7edf autoconf\u8d1f\u8d23\u4ececonfigure.ac\u751f\u6210configure\u6587\u4ef6 automake\u8d1f\u8d23\u4eceMakefile.am\u548cconfigure.ac\u751f\u6210Makefile.in\u6587\u4ef6 note \uff1a\u53ea\u6709\u6784\u5efa\u7cfb\u7edf\u6ca1\u6709\u65f6\u624d\u6267\u884c autoreconfig \uff0c\u5982\u679c\u4fee\u6539\u4e86 configure.ac \u6216\u8005 Makefile.am \uff0c\u6267\u884cmake\u65f6\u4f1a\u81ea\u52a8\u91cd\u65b0\u751f\u6210\u76f8\u5173\u6587\u4ef6\u3002 configure.ac \u7684\u8bed\u6cd5\u53c2\u8003Autoconf\u624b\u518c\u3002 2.4 \u5c0f\u7a0b\u5e8f\u6587\u4ef6\u89e3\u8bfb \u00b6 \u5728 /usr/share/doc/automake-1.13.4 \u76ee\u5f55\u4e0b\uff0c\u4f1a\u6709\u4e00\u4e2aamhello\u7684\u8f6f\u4ef6\u5305\uff0c\u4ee5\u5b83\u4f5c\u4e3a\u4f8b\u5b50\u8bb2\u89e3\uff1a amhello-1.0 \u251c\u2500\u2500 aclocal.m4 \u251c\u2500\u2500 config.h.in \u251c\u2500\u2500 configure \u251c\u2500\u2500 configure.ac \u251c\u2500\u2500 depcomp \u251c\u2500\u2500 install-sh \u251c\u2500\u2500 Makefile.am \u251c\u2500\u2500 Makefile.in \u251c\u2500\u2500 missing \u251c\u2500\u2500 README \u2514\u2500\u2500 src \u251c\u2500\u2500 main.c \u251c\u2500\u2500 Makefile.am \u2514\u2500\u2500 Makefile.in configure.ac \u00b6 AC_INIT ( [ amhello ] , [ 1.0 ] , [ bug-automake@gnu.org ] ) AM_INIT_AUTOMAKE ( [ -Wall -Werror foreign ] ) AC_PROG_CC AC_CONFIG_HEADERS ( [ config.h ] ) AC_CONFIG_FILES ( [ Makefile src/Makefile ] ) AC_OUTPUT AC_ \u5f00\u5934\u7684\u662fautocofig\u7684\u5b8f\uff1b AM_ \u5f00\u5934\u7684\u662fautomake\u7684\u5b8f\u3002 AC_INIT \u5b9a\u4e49\u4e86\u5305\u540d\u3001\u7248\u672c\u3001\u8054\u7cfb\u5730\u5740 AM_INIT_AUTOMAKE \u62ec\u53f7\u4e2d\u7684\u662fautomake\u7684\u9009\u9879\u3002-Wall -Werror \u610f\u5473\u7740\u5173\u95ed\u8b66\u544a\u5e76\u4f5c\u4e3a\u9519\u8bef\u8fdb\u884c\u62a5\u544a\uff1bforeign \u4e0d\u8981\u9075\u5b88GNU\u7684\u89c4\u5219\uff0cGNU\u5305\u603b\u662f\u8fd8\u5e94\u8be5\u6709\u5176\u4ed6\u7684\u6587\u4ef6 AC_PROG_CC \u4f7fconfigure\u811a\u672c\u641c\u7d22C\u7f16\u8bd1\u5668\u7136\u540e\u7528\u5176\u540d\u5b57\u5b9a\u4e49\u53d8\u91cfCC\uff0csrc/Makefile.in\u6587\u4ef6\u9700\u8981\u4f7f\u7528CC\u53d8\u91cf\u6765\u6784\u5efahello AC_CONFIG_HEADERS \u4f7fconfigure\u811a\u672c\u521b\u5efaconfig.h\u6587\u4ef6\u6536\u96c6\u5728configure.ac\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u5b8f AC_CONFIG_FILES \u58f0\u660e\u4e86configure\u6587\u4ef6\u5e94\u8be5\u4ece*.in\u6a21\u677f\u521b\u5efa\u7684\u6587\u4ef6\u5217\u8868\uff0c\u5426\u5219\u4e0d\u4f1a\u4f7f\u7528Makefile.am\u6587\u4ef6 AC_OUTPUT \u662f\u4e00\u4e2a\u5173\u95ed\u547d\u4ee4\uff0c\u662f\u771f\u6b63\u7684\u8d1f\u8d23\u751f\u6210\u6587\u4ef6\uff08\u5728AC_CONFIG_HEADERS\u548cAC_CONFIG_FILES\u4e2d\u6ce8\u518c\u7684\uff09\u7684\u811a\u672c\u90e8\u5206 src/Makefile.am \u00b6 bin_PROGRAMS = hello hello_SOURCES = main.c \u4e0eMakefile\u7684\u8bed\u6cd5\u4e00\u6837\u3002automake\u9a71\u52a8\u8be5\u6587\u4ef6\u65f6\u4f1a\u5c06\u6574\u4e2a\u5185\u5bb9\u590d\u5236\u5230 Makefile.in \u6587\u4ef6\uff0c\u4f46\u662f\u4f1a\u901a\u8fc7\u6784\u5efa\u89c4\u5219\u548c\u5176\u4ed6\u53d8\u91cf\u5bf9\u7279\u5b9a\u7684\u53d8\u91cf\u5b9a\u4e49\u505a\u51fa\u53cd\u5e94\u3002\u901a\u5e38\u8be5\u6587\u4ef6\u53ea\u5305\u542b\u4e0a\u8ff0\u7684\u53d8\u91cf\u5b9a\u4e49\u5217\u8868\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u53d8\u91cf\u548c\u89c4\u5219\uff0c\u53ea\u662fautomake\u4ec5\u4ec5\u4f20\u9012\u4ed6\u4eec\uff0c\u4e0d\u5bf9\u5176\u8fdb\u884c\u5904\u7406\u3002 bin\u8868\u660e\u4e86\u5b89\u88c5\u4f4d\u7f6e \u4ee5 _PROGRAMS \u7ed3\u5c3e\u7684\u7279\u6b8a\u53d8\u91cf\u6307\u5b9a\u4e86Makefile\u5e94\u8be5\u6784\u5efa\u7684\u6587\u4ef6\u7c7b\u578b\u3002Automake\u5c06\u8fd9\u4e9b\u53d8\u91cf\u79f0\u4e4b\u4e3a primary \uff0c\u5176\u4ed6\u7684primary\u4f8b\u5982 _SCRIPTS\uff0c _DATA\uff0c _LIBRARIES \u7b49\u7b49\uff0c\u5bf9\u5e94\u4e0d\u540c\u7684\u6587\u4ef6\u7c7b\u578b\u3002 bin \u610f\u5473\u7740\u7a0b\u5e8f\u5e94\u8be5\u88ab\u5b89\u88c5\u5230 ${exec_prefix}/bin \u6587\u4ef6\u5939\u4e0b hello_SOURCES \u8be5\u58f0\u660e\u7684\u526f\u4f5c\u7528\u662f\u5f53\u6267\u884c make dist \u65f6main.c\u4f1a\u6210\u4e3atar\u5305\u7684\u4e00\u90e8\u5206 \u56e0\u4e3a\u7a0b\u5e8f\u9700\u8981\u4ece\u6e90\u6587\u4ef6\u6784\u5efa\uff0c\u6240\u4ee5\u6bcf\u4e2a\u7a0b\u5e8f\u5728\u4e00\u4e2a _PROGRAMS \u53d8\u91cf\u4e2d\u5217\u51fa\u4e86 prog \uff0cautomake\u4f1a\u5bfb\u627e\u53e6\u4e00\u4e2a\u540d\u4e3a prog_SOURCES \u7684\u53d8\u91cf\u5217\u51fa\u5176\u6240\u6709\u7684\u6e90\u6587\u4ef6\u3002\u6240\u6709\u7684\u6e90\u6587\u4ef6\u4f1a\u88ab\u4e00\u8d77\u7f16\u8bd1\u548c\u94fe\u63a5\u3002 Makefil.am \u00b6 SUBDIRS = src dist_doc_DATA = README SUBDIRS \u5217\u51fa\u6240\u6709\u7684\u5728\u9a71\u52a8\u5f53\u524d\u76ee\u5f55\u4e4b\u524dmake\u9700\u8981\u9012\u5f52\u8fdb\u5165\u7684\u6587\u4ef6\u5939\uff0cmake install\u4e5f\u4f1a\u5148\u5b89\u88c5src/hello\uff0c\u518d\u5b89\u88c5README dist_doc_DATA _DATA primary \u5217\u51fa\u7684\u6587\u4ef6\u5217\u8868\u4e0d\u4f1a\u81ea\u52a8\u5730\u6210\u4e3atar\u5305\u7684\u4e00\u90e8\u5206\uff0c\u6240\u4ee5\u52a0\u4e0a\u4e86dist\u524d\u7f00\u6765\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\u3002\u552f\u4e00\u91cd\u8981\u7684\u5f71\u54cd\u662f\u6b64\u884c\u5728 make install \u7684\u65f6\u5019\u4f1a\u5b89\u88c5README\u3002 note \uff1a\u6587\u4ef6\u4e2d\u6ca1\u6709\u6d89\u53ca\u5230\u5b89\u88c5\u8def\u5f84\uff0c\u8bf7\u53c2\u8003autocong\u624b\u518c\u4e2d\u7684 Defining Directories \u3002 3. \u57fa\u672c\u7406\u5ff5 \u00b6 3.1 \u4e00\u822c\u64cd\u4f5c \u00b6 Automake\u8bfb\u53d6Makefile.am\u751f\u6210Makefile.in\u6587\u4ef6\u3002\u67d0\u4e9b\u5728Makefile.am\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\u548c\u89c4\u5219\u6307\u5bfcAutomake\u751f\u6210\u66f4\u52a0\u4e13\u7528\u7684\u4ee3\u7801\u3002 \u5927\u90e8\u5206GNU make\u6269\u5c55\u4e0d\u80fd\u88abAutomake\u6240\u8bc6\u522b\u3002 \u5b9a\u4e49\u5728Makefile.am\u6216\u8005configure.ac\u4e2d\u7684\u53d8\u91cf\u4f1a\u8986\u76d6automake\u7684\u9ed8\u8ba4\u53d8\u91cf\u3002 automake\u5728\u68c0\u67e5\u53d8\u91cf\u5b9a\u4e49\u7684\u65f6\u5019\u4f1a\u9012\u5f52\u68c0\u67e5\u6240\u6709\u5f15\u7528\u7684\u53d8\u91cf \u6ce8\u91ca\u4ee5 ## \u5f00\u5934 3.2 \u4e25\u683c\u7a0b\u5ea6 \u00b6 \u867d\u7136Automake\u65e8\u5728\u4f9bGNU\u5305\u7ef4\u62a4\u4e2d\u4f7f\u7528\uff0c\u4f46\u662f\u5e76\u4e0d\u60f3\u9075\u5b88\u5176\u5168\u90e8\u7684\u89c4\u5b9a\u3002 \u6709\u4ee5\u4e0b\u4e09\u4e2a\u7b49\u7ea7\uff1a foreign - \u53ea\u68c0\u67e5\u6b63\u786e\u64cd\u4f5c\u6240\u5fc5\u987b\u7684\u4e1c\u897f\u3002 gnu - \u4f1a\u5c3d\u53ef\u80fd\u591a\u7684\u6ee1\u8db3GNU\u6807\u51c6\u3002\u9ed8\u8ba4\u9009\u9879 gnits - \u4f1a\u68c0\u67e5\u8fd8\u672a\u6210\u6587\u7684GNU\u6807\u51c6\uff0c\u6bd4GNU\u6807\u51c6\u66f4\u7ec6\u3002\u901a\u5e38\u4e0d\u4f1a\u4f7f\u7528\u8be5\u9009\u9879 3.3 \u547d\u540d\u683c\u5f0f \u00b6 Automake\u53d8\u91cf\u9075\u5b88 uniform naming scheme \uff0c\u4f7f\u4f55\u65f6\u7a0b\u5e8f\u88ab\u6784\u5efa\u548c\u5982\u4f55\u88ab\u5b89\u88c5\u53d8\u5f97\u5f88\u5bb9\u6613\u3002 \u4e00\u5957\u4e0d\u540c\u7684\u540d\u5b57\u7528\u6765\u51b3\u5b9a\u6784\u5efa\u5bf9\u8c61\u5e94\u8be5\u88ab\u5b89\u88c5\u5230\u54ea\u91cc\u3002\u8fd9\u4e9b\u540d\u5b57\u662fprimary\u7684\u524d\u7f00\uff0c\u5b9a\u4e49\u4e86\u54ea\u4e2a\u6807\u51c6\u6587\u4ef6\u5939\u662f\u5b89\u88c5\u76ee\u5f55\u3002\u6807\u51c6\u7684\u6587\u4ef6\u5939\u540d\u5b57\u53c2\u8003 Directory Variables in The GNU Coding Standards \u6bcf\u4e2aprimary\u90fd\u6709\u4e00\u4e2a\u989d\u5916\u7684\u4ee5 EXTRA_ \u4f5c\u4e3a\u524d\u7f00\u7684\u53d8\u91cf\u540d\u3002\u5b83\u7528\u4e8e\u5217\u51fa\u53ef\u80fd\u4f1a\u6216\u4e0d\u4f1a\u88ab\u6784\u5efa\u7684\u5bf9\u8c61\uff0c\u53d6\u51b3\u4e8econfigure\u3002 \u53ef\u4ee5\u81ea\u5b9a\u4e49\u76ee\u5f55\uff0c\u4efb\u4f55\u5728Makefile.am\u4e2d\u4ee5 dir \u7ed3\u5c3e\u7684\u81ea\u5b9a\u4e49\u53d8\u91cf\u90fd\u53ef\u4ee5\u7528\u4f5c primary \u7684\u5408\u6cd5\u524d\u7f00\uff1a xmldir = $( datadir ) /xml xml_DATA = file.xml \u4e0d\u662f\u5728\u6bcf\u4e2a\u6587\u4ef6\u5939\u7684\u6bcf\u4e2a\u5bf9\u8c61\u7684\u6bcf\u4e2a\u90e8\u5206\u90fd\u4f1a\u88ab\u5b89\u88c5\u3002Automake\u4f1a\u6807\u8bb0\u8fd9\u4e9b\u9519\u8bef\u3002\u8fd8\u4f1a\u68c0\u67e5\u76ee\u5f55\u540d\u7684\u62fc\u5199\u9519\u8bef\u3002 noinst_ \u524d\u7f00\u8868\u793a\u53d8\u91cf\u53ea\u6784\u5efa\u4e0d\u5b89\u88c5\u3002 check_ \u8868\u660e\u53d8\u91cf\u4e0d\u80fd\u88ab\u6784\u5efa\u76f4\u5230 make check \u547d\u4ee4\u8fd0\u884c\u3002\u4e5f\u4e0d\u53ef\u5b89\u88c5\u3002 \u6240\u6709\u7684\u53d8\u91cf\u540d\u671f\u671b \u5b57\u6bcd\u3001\u6570\u5b57\u3001@\u3001\u5176\u5b83\u7b26\u53f7\u53d8\u4e3a\u4e0b\u5212\u7ebf\uff0c\u6bd4\u5982libmum++.a\uff0c\u6d3e\u751f\u53d8\u91cf\u4f1a\u662flibmum___a_SOURCES \u8d85\u7ea7\u524d\u7f00\uff1a dist #\u6307\u660e\u54ea\u4e9b\u6587\u4ef6\u5e94\u8be5\u88ab\u53d1\u5e03 nodist nobase #\u7981\u6b62\u53bb\u6389\u8def\u5f84\u524d\u7f00\u7684\u89c4\u5219\uff0c\u4e3e\u4f8b\uff1a nobase_dist_include_HEADERS = \\ jupiter / jupiter_interface . h \u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8be5\u5934\u6587\u4ef6\u4f1a\u88ab\u5b89\u88c5\u5230 /usr(/local)/include/jupiter_interface.h \uff0c\u52a0\u4e86 nobase \u524d\u7f00\u4e4b\u540e\uff0c\u4f1a\u53d8\u4e3a /usr(/local)/include/jupiter/jupiter_interface.h \u3002 nobase_ \u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u5199\u6cd5\u4ee3\u66ff: nobase_dist_pkgdata_HEADERS = jupiter / jupiter . ogg jupiterdir = $ ( pkgdatadir ) / jupiter dist_jupiter_DATA = jupiter / jupiter . ogg EXTRA_DIST\u53d8\u91cf\u5e94\u8be5\u88ab\u52a0\u5230\u53d1\u5e03\u5305\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u3002 3.4 \u547d\u4ee4\u957f\u5ea6\u9650\u5236 \u00b6 \u4f8b\u5982 data_DATA = file1 \u2026 fileN fileN+1 \u2026 file2N \u53ef\u4ee5\u5199\u6210 data_DATA = file1 \u2026 fileN data2dir = $( datadir ) data2_DATA = fileN+1 \u2026 file2N 3.6 \u7528\u6237\u4fdd\u7559\u53d8\u91cf \u00b6 \u4e00\u4e9b\u4fdd\u7559\u53d8\u91cf\u4e3a\u6784\u5efa\u5305\u7684\u7528\u6237\u4f7f\u7528\uff0c\u8ba9\u4ed6\u4eec\u7684\u5de5\u4f5c\u66f4\u8f7b\u677e\u3002\u4f46\u662f\u8fd9\u4e9b\u53d8\u91cf\u4e0d\u80fd\u51fa\u73b0\u5728\u8981\u6c42\u6b63\u786e\u7f16\u8bd1\u7684\u5305\u4e2d\u3002 Automake\u5f15\u5165\u4e86\u7279\u6b8a\u7684\u9634\u5f71\u4fbf\u91cf\u4e3a\u7528\u6237\u6807\u8bb0\u53d8\u91cf\u3002\u6dfb\u52a0\u524d\u7f00 AM_ \u5230\u7528\u6237\u53d8\u91cf\u540d\u5c31\u662f\u9634\u5f71\u53d8\u91cf\u3002 4. \u4e00\u4e9b\u793a\u4f8b\u5305 \u00b6 \u4f7f\u7528\u4e0d\u540c\u7684\u7f16\u8bd1\u53c2\u6570\u4ece\u4e00\u4e2a\u6587\u4ef6\u6784\u5efa\u4e24\u4e2a\u9879\u76ee\u3002\u901a\u8fc7\u8bbe\u5b9a\u4e0d\u540c\u7684\u53d8\u91cf\u540d\u53ca\u5176\u6807\u5fd7\u6307\u5411\u540c\u4e00\u4e2a\u6587\u4ef6\u4fe9\u8fbe\u5230\u6548\u679c bin_PROGRAMS = true false false_SOURCES = false_LDADD = false.o true.o: true.c $( COMPILE ) -DEXIT_CODE = 0 -c true.c false.o: true.c $( COMPILE ) -DEXIT_CODE = 1 -o false.o -c true.c true_SOURCES\u6ca1\u6709\u5199\uff0cAutomake\u4f1a\u9ed8\u8ba4\u6709\u4e00\u4e2atrue.c\u6587\u4ef6\u548c\u9ed8\u8ba4\u7684\u89c4\u5219\u6765\u7f16\u8bd1true.o\u3001\u94fe\u63a5true\u3002 see Default _SOURCES bin_PROGRAMS = false true false_SOURCES = true.c false_CPPFLAGS = -DEXIT_CODE = 1 true_SOURCES = true.c true_CPPFLAGS = -DEXIT_CODE = 0 \u8be5\u79cd\u5199\u6cd5\u4f1a\u751f\u6210 false-true.o and true-true.o","title":"\u7b80\u4ecb"},{"location":"automake/%E7%AE%80%E4%BB%8B/#automake","text":"Automake\u662f\u4eceMakefile.am(\u5b9a\u4e49\u4e00\u7cfb\u5217make\u53d8\u91cf\u7684\u6587\u4ef6)\u81ea\u52a8\u751f\u6210Makefile.in\u6587\u4ef6\u7684\u5de5\u5177\u3002\u751f\u6210\u7684Makefile.in\u7b26\u5408GNU Makefile \u6807\u51c6\u3002 \u56e0\u4e3a\u4e0d\u540c\u7684\u5e73\u53f0\u9700\u8981\u4fee\u6539Makefile\uff0c\u6240\u4ee5\u7f16\u5199 configure \u811a\u672c\u81ea\u52a8\u4fee\u6539Makefile\uff0c\u518d\u6267\u884c ./configure && make && make install \u547d\u4ee4\u5b89\u88c5\u5305\uff0c\u5f62\u6210\u4e86GNU\u6784\u5efa\u7cfb\u7edf\u3002","title":"Automake\u4ecb\u7ecd"},{"location":"automake/%E7%AE%80%E4%BB%8B/#autotools","text":"Autotools \u662f\u4e3a\u5305\u521b\u5efaGNU\u6784\u5efa\u7cfb\u7edf\u7684\u5de5\u5177\uff1b Autoconf \u4e3b\u8981\u5173\u6ce8 configure \uff1b Automake \u4e3b\u8981\u5173\u6ce8 Makefile \u3002 \u5f53\u5b89\u88c5\u4e00\u4e2a\u7a0b\u5e8f\u65f6\uff0c\u5b89\u88c5\u6b65\u9aa4\u6709\u4ee5\u4e0b\u51e0\u6b65\uff1a tar -zxf xxx.tar.gz cd xxx ./configure #\u68c0\u67e5\u8981\u6c42\u7684\u73af\u5883\uff0c\u751f\u6210\u5305\u62ecMakefile\uff08s\uff09\u5728\u5185\u7684\u591a\u4e2a\u6587\u4ef6 make #\u6784\u5efa\u6240\u6709\u7684\u6587\u4ef6\u7ed3\u6784\uff0c\u751f\u6210\u6587\u4ef6 make check #\u6e90\u7801\u68c0\u67e5 su #\u5207\u6362\u5230root\u7528\u6237 make install #\u590d\u5236\u6e90\u7801\u6587\u4ef6\u5230\u76ee\u7684\u76ee\u5f55 make installcheck #\u5b89\u88c5\u540e\u68c0\u67e5 note \uff1a make uninstall \u9700\u8981\u5728\u6784\u5efa\u6811\u4e0b\u8fd0\u884c make clean \u5220\u9664make\u751f\u6210\u7684\u6587\u4ef6 make distclean \u989d\u5916\u5220\u9664 ./configure\u751f\u6210\u7684\u6587\u4ef6 make dist \u4ece\u6e90\u7801\u91cd\u65b0\u521b\u5efaxxx.tar.gz \u6709\u4e00\u4e9b\u53ef\u914d\u7f6e\u53d8\u91cf\uff0c\u53ef\u4ee5\u901a\u8fc7 ./configure --help \u67e5\u770b\u5b8c\u6574\u7248 \u5982\u679c\u60f3\u914d\u7f6e\u7cfb\u7edf\u9ed8\u8ba4\u53d8\u91cf\uff0c\u53ef\u4ee5\u4fee\u6539 /usr/local/share/config.site \u6587\u4ef6\u4e2d\u6307\u5b9a","title":"Autotools\u4ecb\u7ecd"},{"location":"automake/%E7%AE%80%E4%BB%8B/#223","text":"Directory variable Default value prefix /usr/local exec_prefix ${ prefix } bindir ${ exec_prefix } /bin libdir ${ exec_prefix } /lib \u2026 includedir ${ prefix } /include datarootdir ${ prefix } /share datadir ${ datarootdir } mandir ${ datarootdir } /man infodir ${ datarootdir } /info docdir ${ datarootdir } /doc/ ${ PACKAGE } \u901a\u8fc7 ./configure --help \u67e5\u770b\u5b8c\u6574\u7248\u3002 \u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u6539\u53d8\u8fd9\u4e9b\u76ee\u5f55\uff1a ./configure --prefix ~/usr \u3002","title":"2.2.3 \u6807\u51c6\u76ee\u5f55\u53d8\u91cf"},{"location":"automake/%E7%AE%80%E4%BB%8B/#226-vpath","text":"","title":"2.2.6 \u5e76\u884c\u6784\u5efa\u6811\uff08VPATH \u6784\u5efa\uff09"},{"location":"automake/%E7%AE%80%E4%BB%8B/#_1","text":"\u6e90\u7801\u6811 \uff1a\u5305\u542b\u4e86configure\u6587\u4ef6\u7684\u6240\u6709\u6e90\u6587\u4ef6 \u6784\u5efa\u6811 \uff1a\u5728\u6e90\u7801\u6811\u7684\u57fa\u7840\u4e0a\uff0c\u5305\u542b\u4e0a\u8fd0\u884cconfigure\u4e4b\u540e\u6d3e\u751f\u51fa\u6765\u7684\u6587\u4ef6\u3002\u901a\u5e38\u76ee\u5f55\u7ed3\u6784\u4e0e\u6e90\u7801\u6811\u4e00\u81f4\uff0c\u5b50\u76ee\u5f55\u662f\u88ab\u6784\u5efa\u7cfb\u7edf\u81ea\u52a8\u521b\u5efa\u51fa\u6765\u7684","title":"\u5bf9\u6bd4\u6e90\u7801\u6811\u4e0e\u6784\u5efa\u6811"},{"location":"automake/%E7%AE%80%E4%BB%8B/#_2","text":"\u53ef\u4ee5\u5728\u89e3\u538b\u5b8c\u538b\u7f29\u5305\u4e4b\u540e\u5728\u4efb\u610f\u4f4d\u7f6e\u65b0\u5efa\u4e00\u4e2abuild\u5b50\u6587\u4ef6\u5939\u5e76\u5728\u8be5\u6587\u4ef6\u5939\u4e0b\u6267\u884c\u540e\u7eed\u6b65\u9aa4\uff0c\u6240\u6709\u7684\u6d3e\u751f\u6587\u4ef6\u4f1a\u5b58\u653e\u5728build\u76ee\u5f55\u4e0b\uff0c\u8fd9\u6837\u7684\u6784\u5efa\u53eb\u505a parallel build \u6216\u8005 VPATH builds \u3002 \u865a\u62df\u8def\u5f84\u6784\u5efa\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a\u5b50\u6587\u4ef6\u5939\u8fdb\u884c\u6784\u5efa\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u53c2\u6570\u6784\u5efa\u540c\u4e00\u4efd\u6e90\u7801\u3002","title":"\u865a\u62df\u8def\u5f84\u6784\u5efa"},{"location":"automake/%E7%AE%80%E4%BB%8B/#_3","text":"","title":"\u4e00\u4e9b\u7279\u6027"},{"location":"automake/%E7%AE%80%E4%BB%8B/#228","text":"\u5728\u6307\u5b9a\u7684\u6784\u5efa\u5e73\u53f0\u4e0a\u7f16\u8bd1\u53ef\u4ee5\u5728\u8fd0\u884c\u5e73\u53f0\u4e0a\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6 ./configure --build\u6307\u5b9a\u6784\u5efa\u5e73\u53f0\uff0c--host\u6307\u5b9a\u8fd0\u884c\u5e73\u53f0 notes \uff1a\u5982\u679c\u9700\u8981\u6784\u5efa\u7684\u5305\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u4ea4\u53c9\u7f16\u8bd1\u5668\uff0c\u9700\u8981\u4f7f\u7528--target\u53c2\u6570\u6307\u5b9a\u67b6\u6784","title":"2.2.8 \u4ea4\u53c9\u7f16\u8bd1"},{"location":"automake/%E7%AE%80%E4%BB%8B/#229","text":"\u53ef\u4ee5\u5728\u6267\u884cconfigure\u7684\u65f6\u5019\u5bf9\u5b89\u88c5\u7684\u7a0b\u5e8f\u91cd\u547d\u540d\uff0c\u6bd4\u5982\u5b89\u88c5 tar \u53d8\u4e3a gtar \u4ee5\u4e0b\u4e09\u4e2a\u53c2\u6570\u53ef\u4ee5\u6ee1\u8db3\u8be5\u9700\u6c42\uff1a --program-prefix #\u7ed9\u7a0b\u5e8f\u540d\u5b57\u6dfb\u52a0\u524d\u7f00 --program-suffix #\u7ed9\u7a0b\u5e8f\u540d\u5b57\u6dfb\u52a0\u540e\u7f00 --program-transform-name #\u91cd\u547d\u540d\u7a0b\u5e8f eg. ./configure --program-prefix tea","title":"2.2.9 \u91cd\u547d\u540d\u7a0b\u5e8f"},{"location":"automake/%E7%AE%80%E4%BB%8B/#2210","text":"make DESTDIR = $HOME /inst install \u6b64\u4e3e\u4f1a\u5c06\u7a0b\u5e8f\u5b89\u88c5\u5728 ~/inst \u6587\u4ef6\u5939\u4e0b\uff0c\u6587\u4ef6\u5939\u4e0b\u5305\u542b\u4e86\u7a0b\u5e8f\u7684\u5b89\u88c5\u7ed3\u6784 \u5b89\u88c5\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a \u6253\u5305\uff1a cd ~/inst find . -type f -print > ../files.lst tar zcvf ~/amhello-1.0-i686.tar.gz ` cat ../files.lst ` \u5982\u6b64\u4e00\u6765\uff0c\u76f4\u63a5\u89e3\u538b\u8fd9\u4e2a\u538b\u7f29\u5305\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u5b8c\u6210amhello\u7684\u5b89\u88c5\u3002","title":"2.2.10 \u6307\u5b9a\u76ee\u7684\u6587\u4ef6\u5939\u6784\u5efa\u4e8c\u8fdb\u5236\u6587\u4ef6"},{"location":"automake/%E7%AE%80%E4%BB%8B/#2211","text":"\u4f7f\u7528 make distcheck \u6765\u4fdd\u8bc1\u5305\u62e5\u6709\u6240\u9700\u8981\u7684\u6784\u5efa\u6b65\u9aa4\u5e76\u4e14\u4e0d\u4f1a\u62a5\u9519 \u5c1d\u8bd5\u5b8c\u6574\u7684\u6253\u5305\u3001\u89e3\u5305\u3001\u8fd0\u884cmake\u3001make check\u3001make install\u3001make installcheck\u3001make dist \u6d4b\u8bd5\u53ea\u8bfb\u6e90\u7801\u6811\u7684 VPATH Builds \u4fdd\u8bc1make clean\u3001make distclean\u3001make uninstall\u4e0d\u4f1a\u9057\u6f0f\u4efb\u4f55\u6587\u4ef6 \u68c0\u67e5 DESTDIR \u5b89\u88c5\u5de5\u4f5c","title":"2.2.11 \u51c6\u5907\u53d1\u5e03"},{"location":"automake/%E7%AE%80%E4%BB%8B/#_4","text":"autoreconfig \u662f\u4e00\u4e2a\u6309\u7167\u6b63\u786e\u6267\u884cautoconf\u3001automake\u548c\u4e00\u5806\u5176\u5b83\u547d\u4ee4\u7684\u811a\u672c\uff0c\u7528\u4e8e\u751f\u6210\u6784\u5efa\u7cfb\u7edf\u3002 \u7f16\u5199configure.ac\u3001Makefile.am\u3001main.c\u3001README\u6587\u4ef6\uff0c\u6267\u884c autoreconfig --install \u5b9e\u4f8b\u5316\u4e00\u4e2a\u6784\u5efa\u7cfb\u7edf autoconf\u8d1f\u8d23\u4ececonfigure.ac\u751f\u6210configure\u6587\u4ef6 automake\u8d1f\u8d23\u4eceMakefile.am\u548cconfigure.ac\u751f\u6210Makefile.in\u6587\u4ef6 note \uff1a\u53ea\u6709\u6784\u5efa\u7cfb\u7edf\u6ca1\u6709\u65f6\u624d\u6267\u884c autoreconfig \uff0c\u5982\u679c\u4fee\u6539\u4e86 configure.ac \u6216\u8005 Makefile.am \uff0c\u6267\u884cmake\u65f6\u4f1a\u81ea\u52a8\u91cd\u65b0\u751f\u6210\u76f8\u5173\u6587\u4ef6\u3002 configure.ac \u7684\u8bed\u6cd5\u53c2\u8003Autoconf\u624b\u518c\u3002","title":"\u751f\u6210\u6784\u5efa\u7cfb\u7edf"},{"location":"automake/%E7%AE%80%E4%BB%8B/#24","text":"\u5728 /usr/share/doc/automake-1.13.4 \u76ee\u5f55\u4e0b\uff0c\u4f1a\u6709\u4e00\u4e2aamhello\u7684\u8f6f\u4ef6\u5305\uff0c\u4ee5\u5b83\u4f5c\u4e3a\u4f8b\u5b50\u8bb2\u89e3\uff1a amhello-1.0 \u251c\u2500\u2500 aclocal.m4 \u251c\u2500\u2500 config.h.in \u251c\u2500\u2500 configure \u251c\u2500\u2500 configure.ac \u251c\u2500\u2500 depcomp \u251c\u2500\u2500 install-sh \u251c\u2500\u2500 Makefile.am \u251c\u2500\u2500 Makefile.in \u251c\u2500\u2500 missing \u251c\u2500\u2500 README \u2514\u2500\u2500 src \u251c\u2500\u2500 main.c \u251c\u2500\u2500 Makefile.am \u2514\u2500\u2500 Makefile.in","title":"2.4 \u5c0f\u7a0b\u5e8f\u6587\u4ef6\u89e3\u8bfb"},{"location":"automake/%E7%AE%80%E4%BB%8B/#configureac","text":"AC_INIT ( [ amhello ] , [ 1.0 ] , [ bug-automake@gnu.org ] ) AM_INIT_AUTOMAKE ( [ -Wall -Werror foreign ] ) AC_PROG_CC AC_CONFIG_HEADERS ( [ config.h ] ) AC_CONFIG_FILES ( [ Makefile src/Makefile ] ) AC_OUTPUT AC_ \u5f00\u5934\u7684\u662fautocofig\u7684\u5b8f\uff1b AM_ \u5f00\u5934\u7684\u662fautomake\u7684\u5b8f\u3002 AC_INIT \u5b9a\u4e49\u4e86\u5305\u540d\u3001\u7248\u672c\u3001\u8054\u7cfb\u5730\u5740 AM_INIT_AUTOMAKE \u62ec\u53f7\u4e2d\u7684\u662fautomake\u7684\u9009\u9879\u3002-Wall -Werror \u610f\u5473\u7740\u5173\u95ed\u8b66\u544a\u5e76\u4f5c\u4e3a\u9519\u8bef\u8fdb\u884c\u62a5\u544a\uff1bforeign \u4e0d\u8981\u9075\u5b88GNU\u7684\u89c4\u5219\uff0cGNU\u5305\u603b\u662f\u8fd8\u5e94\u8be5\u6709\u5176\u4ed6\u7684\u6587\u4ef6 AC_PROG_CC \u4f7fconfigure\u811a\u672c\u641c\u7d22C\u7f16\u8bd1\u5668\u7136\u540e\u7528\u5176\u540d\u5b57\u5b9a\u4e49\u53d8\u91cfCC\uff0csrc/Makefile.in\u6587\u4ef6\u9700\u8981\u4f7f\u7528CC\u53d8\u91cf\u6765\u6784\u5efahello AC_CONFIG_HEADERS \u4f7fconfigure\u811a\u672c\u521b\u5efaconfig.h\u6587\u4ef6\u6536\u96c6\u5728configure.ac\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u5b8f AC_CONFIG_FILES \u58f0\u660e\u4e86configure\u6587\u4ef6\u5e94\u8be5\u4ece*.in\u6a21\u677f\u521b\u5efa\u7684\u6587\u4ef6\u5217\u8868\uff0c\u5426\u5219\u4e0d\u4f1a\u4f7f\u7528Makefile.am\u6587\u4ef6 AC_OUTPUT \u662f\u4e00\u4e2a\u5173\u95ed\u547d\u4ee4\uff0c\u662f\u771f\u6b63\u7684\u8d1f\u8d23\u751f\u6210\u6587\u4ef6\uff08\u5728AC_CONFIG_HEADERS\u548cAC_CONFIG_FILES\u4e2d\u6ce8\u518c\u7684\uff09\u7684\u811a\u672c\u90e8\u5206","title":"configure.ac"},{"location":"automake/%E7%AE%80%E4%BB%8B/#srcmakefileam","text":"bin_PROGRAMS = hello hello_SOURCES = main.c \u4e0eMakefile\u7684\u8bed\u6cd5\u4e00\u6837\u3002automake\u9a71\u52a8\u8be5\u6587\u4ef6\u65f6\u4f1a\u5c06\u6574\u4e2a\u5185\u5bb9\u590d\u5236\u5230 Makefile.in \u6587\u4ef6\uff0c\u4f46\u662f\u4f1a\u901a\u8fc7\u6784\u5efa\u89c4\u5219\u548c\u5176\u4ed6\u53d8\u91cf\u5bf9\u7279\u5b9a\u7684\u53d8\u91cf\u5b9a\u4e49\u505a\u51fa\u53cd\u5e94\u3002\u901a\u5e38\u8be5\u6587\u4ef6\u53ea\u5305\u542b\u4e0a\u8ff0\u7684\u53d8\u91cf\u5b9a\u4e49\u5217\u8868\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u53d8\u91cf\u548c\u89c4\u5219\uff0c\u53ea\u662fautomake\u4ec5\u4ec5\u4f20\u9012\u4ed6\u4eec\uff0c\u4e0d\u5bf9\u5176\u8fdb\u884c\u5904\u7406\u3002 bin\u8868\u660e\u4e86\u5b89\u88c5\u4f4d\u7f6e \u4ee5 _PROGRAMS \u7ed3\u5c3e\u7684\u7279\u6b8a\u53d8\u91cf\u6307\u5b9a\u4e86Makefile\u5e94\u8be5\u6784\u5efa\u7684\u6587\u4ef6\u7c7b\u578b\u3002Automake\u5c06\u8fd9\u4e9b\u53d8\u91cf\u79f0\u4e4b\u4e3a primary \uff0c\u5176\u4ed6\u7684primary\u4f8b\u5982 _SCRIPTS\uff0c _DATA\uff0c _LIBRARIES \u7b49\u7b49\uff0c\u5bf9\u5e94\u4e0d\u540c\u7684\u6587\u4ef6\u7c7b\u578b\u3002 bin \u610f\u5473\u7740\u7a0b\u5e8f\u5e94\u8be5\u88ab\u5b89\u88c5\u5230 ${exec_prefix}/bin \u6587\u4ef6\u5939\u4e0b hello_SOURCES \u8be5\u58f0\u660e\u7684\u526f\u4f5c\u7528\u662f\u5f53\u6267\u884c make dist \u65f6main.c\u4f1a\u6210\u4e3atar\u5305\u7684\u4e00\u90e8\u5206 \u56e0\u4e3a\u7a0b\u5e8f\u9700\u8981\u4ece\u6e90\u6587\u4ef6\u6784\u5efa\uff0c\u6240\u4ee5\u6bcf\u4e2a\u7a0b\u5e8f\u5728\u4e00\u4e2a _PROGRAMS \u53d8\u91cf\u4e2d\u5217\u51fa\u4e86 prog \uff0cautomake\u4f1a\u5bfb\u627e\u53e6\u4e00\u4e2a\u540d\u4e3a prog_SOURCES \u7684\u53d8\u91cf\u5217\u51fa\u5176\u6240\u6709\u7684\u6e90\u6587\u4ef6\u3002\u6240\u6709\u7684\u6e90\u6587\u4ef6\u4f1a\u88ab\u4e00\u8d77\u7f16\u8bd1\u548c\u94fe\u63a5\u3002","title":"src/Makefile.am"},{"location":"automake/%E7%AE%80%E4%BB%8B/#makefilam","text":"SUBDIRS = src dist_doc_DATA = README SUBDIRS \u5217\u51fa\u6240\u6709\u7684\u5728\u9a71\u52a8\u5f53\u524d\u76ee\u5f55\u4e4b\u524dmake\u9700\u8981\u9012\u5f52\u8fdb\u5165\u7684\u6587\u4ef6\u5939\uff0cmake install\u4e5f\u4f1a\u5148\u5b89\u88c5src/hello\uff0c\u518d\u5b89\u88c5README dist_doc_DATA _DATA primary \u5217\u51fa\u7684\u6587\u4ef6\u5217\u8868\u4e0d\u4f1a\u81ea\u52a8\u5730\u6210\u4e3atar\u5305\u7684\u4e00\u90e8\u5206\uff0c\u6240\u4ee5\u52a0\u4e0a\u4e86dist\u524d\u7f00\u6765\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\u3002\u552f\u4e00\u91cd\u8981\u7684\u5f71\u54cd\u662f\u6b64\u884c\u5728 make install \u7684\u65f6\u5019\u4f1a\u5b89\u88c5README\u3002 note \uff1a\u6587\u4ef6\u4e2d\u6ca1\u6709\u6d89\u53ca\u5230\u5b89\u88c5\u8def\u5f84\uff0c\u8bf7\u53c2\u8003autocong\u624b\u518c\u4e2d\u7684 Defining Directories \u3002","title":"Makefil.am"},{"location":"automake/%E7%AE%80%E4%BB%8B/#3","text":"","title":"3. \u57fa\u672c\u7406\u5ff5"},{"location":"automake/%E7%AE%80%E4%BB%8B/#31","text":"Automake\u8bfb\u53d6Makefile.am\u751f\u6210Makefile.in\u6587\u4ef6\u3002\u67d0\u4e9b\u5728Makefile.am\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\u548c\u89c4\u5219\u6307\u5bfcAutomake\u751f\u6210\u66f4\u52a0\u4e13\u7528\u7684\u4ee3\u7801\u3002 \u5927\u90e8\u5206GNU make\u6269\u5c55\u4e0d\u80fd\u88abAutomake\u6240\u8bc6\u522b\u3002 \u5b9a\u4e49\u5728Makefile.am\u6216\u8005configure.ac\u4e2d\u7684\u53d8\u91cf\u4f1a\u8986\u76d6automake\u7684\u9ed8\u8ba4\u53d8\u91cf\u3002 automake\u5728\u68c0\u67e5\u53d8\u91cf\u5b9a\u4e49\u7684\u65f6\u5019\u4f1a\u9012\u5f52\u68c0\u67e5\u6240\u6709\u5f15\u7528\u7684\u53d8\u91cf \u6ce8\u91ca\u4ee5 ## \u5f00\u5934","title":"3.1 \u4e00\u822c\u64cd\u4f5c"},{"location":"automake/%E7%AE%80%E4%BB%8B/#32","text":"\u867d\u7136Automake\u65e8\u5728\u4f9bGNU\u5305\u7ef4\u62a4\u4e2d\u4f7f\u7528\uff0c\u4f46\u662f\u5e76\u4e0d\u60f3\u9075\u5b88\u5176\u5168\u90e8\u7684\u89c4\u5b9a\u3002 \u6709\u4ee5\u4e0b\u4e09\u4e2a\u7b49\u7ea7\uff1a foreign - \u53ea\u68c0\u67e5\u6b63\u786e\u64cd\u4f5c\u6240\u5fc5\u987b\u7684\u4e1c\u897f\u3002 gnu - \u4f1a\u5c3d\u53ef\u80fd\u591a\u7684\u6ee1\u8db3GNU\u6807\u51c6\u3002\u9ed8\u8ba4\u9009\u9879 gnits - \u4f1a\u68c0\u67e5\u8fd8\u672a\u6210\u6587\u7684GNU\u6807\u51c6\uff0c\u6bd4GNU\u6807\u51c6\u66f4\u7ec6\u3002\u901a\u5e38\u4e0d\u4f1a\u4f7f\u7528\u8be5\u9009\u9879","title":"3.2 \u4e25\u683c\u7a0b\u5ea6"},{"location":"automake/%E7%AE%80%E4%BB%8B/#33","text":"Automake\u53d8\u91cf\u9075\u5b88 uniform naming scheme \uff0c\u4f7f\u4f55\u65f6\u7a0b\u5e8f\u88ab\u6784\u5efa\u548c\u5982\u4f55\u88ab\u5b89\u88c5\u53d8\u5f97\u5f88\u5bb9\u6613\u3002 \u4e00\u5957\u4e0d\u540c\u7684\u540d\u5b57\u7528\u6765\u51b3\u5b9a\u6784\u5efa\u5bf9\u8c61\u5e94\u8be5\u88ab\u5b89\u88c5\u5230\u54ea\u91cc\u3002\u8fd9\u4e9b\u540d\u5b57\u662fprimary\u7684\u524d\u7f00\uff0c\u5b9a\u4e49\u4e86\u54ea\u4e2a\u6807\u51c6\u6587\u4ef6\u5939\u662f\u5b89\u88c5\u76ee\u5f55\u3002\u6807\u51c6\u7684\u6587\u4ef6\u5939\u540d\u5b57\u53c2\u8003 Directory Variables in The GNU Coding Standards \u6bcf\u4e2aprimary\u90fd\u6709\u4e00\u4e2a\u989d\u5916\u7684\u4ee5 EXTRA_ \u4f5c\u4e3a\u524d\u7f00\u7684\u53d8\u91cf\u540d\u3002\u5b83\u7528\u4e8e\u5217\u51fa\u53ef\u80fd\u4f1a\u6216\u4e0d\u4f1a\u88ab\u6784\u5efa\u7684\u5bf9\u8c61\uff0c\u53d6\u51b3\u4e8econfigure\u3002 \u53ef\u4ee5\u81ea\u5b9a\u4e49\u76ee\u5f55\uff0c\u4efb\u4f55\u5728Makefile.am\u4e2d\u4ee5 dir \u7ed3\u5c3e\u7684\u81ea\u5b9a\u4e49\u53d8\u91cf\u90fd\u53ef\u4ee5\u7528\u4f5c primary \u7684\u5408\u6cd5\u524d\u7f00\uff1a xmldir = $( datadir ) /xml xml_DATA = file.xml \u4e0d\u662f\u5728\u6bcf\u4e2a\u6587\u4ef6\u5939\u7684\u6bcf\u4e2a\u5bf9\u8c61\u7684\u6bcf\u4e2a\u90e8\u5206\u90fd\u4f1a\u88ab\u5b89\u88c5\u3002Automake\u4f1a\u6807\u8bb0\u8fd9\u4e9b\u9519\u8bef\u3002\u8fd8\u4f1a\u68c0\u67e5\u76ee\u5f55\u540d\u7684\u62fc\u5199\u9519\u8bef\u3002 noinst_ \u524d\u7f00\u8868\u793a\u53d8\u91cf\u53ea\u6784\u5efa\u4e0d\u5b89\u88c5\u3002 check_ \u8868\u660e\u53d8\u91cf\u4e0d\u80fd\u88ab\u6784\u5efa\u76f4\u5230 make check \u547d\u4ee4\u8fd0\u884c\u3002\u4e5f\u4e0d\u53ef\u5b89\u88c5\u3002 \u6240\u6709\u7684\u53d8\u91cf\u540d\u671f\u671b \u5b57\u6bcd\u3001\u6570\u5b57\u3001@\u3001\u5176\u5b83\u7b26\u53f7\u53d8\u4e3a\u4e0b\u5212\u7ebf\uff0c\u6bd4\u5982libmum++.a\uff0c\u6d3e\u751f\u53d8\u91cf\u4f1a\u662flibmum___a_SOURCES \u8d85\u7ea7\u524d\u7f00\uff1a dist #\u6307\u660e\u54ea\u4e9b\u6587\u4ef6\u5e94\u8be5\u88ab\u53d1\u5e03 nodist nobase #\u7981\u6b62\u53bb\u6389\u8def\u5f84\u524d\u7f00\u7684\u89c4\u5219\uff0c\u4e3e\u4f8b\uff1a nobase_dist_include_HEADERS = \\ jupiter / jupiter_interface . h \u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8be5\u5934\u6587\u4ef6\u4f1a\u88ab\u5b89\u88c5\u5230 /usr(/local)/include/jupiter_interface.h \uff0c\u52a0\u4e86 nobase \u524d\u7f00\u4e4b\u540e\uff0c\u4f1a\u53d8\u4e3a /usr(/local)/include/jupiter/jupiter_interface.h \u3002 nobase_ \u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u5199\u6cd5\u4ee3\u66ff: nobase_dist_pkgdata_HEADERS = jupiter / jupiter . ogg jupiterdir = $ ( pkgdatadir ) / jupiter dist_jupiter_DATA = jupiter / jupiter . ogg EXTRA_DIST\u53d8\u91cf\u5e94\u8be5\u88ab\u52a0\u5230\u53d1\u5e03\u5305\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u3002","title":"3.3 \u547d\u540d\u683c\u5f0f"},{"location":"automake/%E7%AE%80%E4%BB%8B/#34","text":"\u4f8b\u5982 data_DATA = file1 \u2026 fileN fileN+1 \u2026 file2N \u53ef\u4ee5\u5199\u6210 data_DATA = file1 \u2026 fileN data2dir = $( datadir ) data2_DATA = fileN+1 \u2026 file2N","title":"3.4 \u547d\u4ee4\u957f\u5ea6\u9650\u5236"},{"location":"automake/%E7%AE%80%E4%BB%8B/#36","text":"\u4e00\u4e9b\u4fdd\u7559\u53d8\u91cf\u4e3a\u6784\u5efa\u5305\u7684\u7528\u6237\u4f7f\u7528\uff0c\u8ba9\u4ed6\u4eec\u7684\u5de5\u4f5c\u66f4\u8f7b\u677e\u3002\u4f46\u662f\u8fd9\u4e9b\u53d8\u91cf\u4e0d\u80fd\u51fa\u73b0\u5728\u8981\u6c42\u6b63\u786e\u7f16\u8bd1\u7684\u5305\u4e2d\u3002 Automake\u5f15\u5165\u4e86\u7279\u6b8a\u7684\u9634\u5f71\u4fbf\u91cf\u4e3a\u7528\u6237\u6807\u8bb0\u53d8\u91cf\u3002\u6dfb\u52a0\u524d\u7f00 AM_ \u5230\u7528\u6237\u53d8\u91cf\u540d\u5c31\u662f\u9634\u5f71\u53d8\u91cf\u3002","title":"3.6 \u7528\u6237\u4fdd\u7559\u53d8\u91cf"},{"location":"automake/%E7%AE%80%E4%BB%8B/#4","text":"\u4f7f\u7528\u4e0d\u540c\u7684\u7f16\u8bd1\u53c2\u6570\u4ece\u4e00\u4e2a\u6587\u4ef6\u6784\u5efa\u4e24\u4e2a\u9879\u76ee\u3002\u901a\u8fc7\u8bbe\u5b9a\u4e0d\u540c\u7684\u53d8\u91cf\u540d\u53ca\u5176\u6807\u5fd7\u6307\u5411\u540c\u4e00\u4e2a\u6587\u4ef6\u4fe9\u8fbe\u5230\u6548\u679c bin_PROGRAMS = true false false_SOURCES = false_LDADD = false.o true.o: true.c $( COMPILE ) -DEXIT_CODE = 0 -c true.c false.o: true.c $( COMPILE ) -DEXIT_CODE = 1 -o false.o -c true.c true_SOURCES\u6ca1\u6709\u5199\uff0cAutomake\u4f1a\u9ed8\u8ba4\u6709\u4e00\u4e2atrue.c\u6587\u4ef6\u548c\u9ed8\u8ba4\u7684\u89c4\u5219\u6765\u7f16\u8bd1true.o\u3001\u94fe\u63a5true\u3002 see Default _SOURCES bin_PROGRAMS = false true false_SOURCES = true.c false_CPPFLAGS = -DEXIT_CODE = 1 true_SOURCES = true.c true_CPPFLAGS = -DEXIT_CODE = 0 \u8be5\u79cd\u5199\u6cd5\u4f1a\u751f\u6210 false-true.o and true-true.o","title":"4. \u4e00\u4e9b\u793a\u4f8b\u5305"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/","text":"3.2 shell\u547d\u4ee4 \u00b6 3.2.4 \u590d\u5408\u547d\u4ee4 \u00b6 3.2.4.1 \u5faa\u73af\u7ed3\u6784 \u00b6 note \uff1a\u4e0d\u8bba ; \u51fa\u73b0\u5728\u547d\u4ee4\u8bed\u6cd5\u7684\u4f55\u5904\uff0c\u90fd\u53ef\u80fd\u4f1a\u88ab\u4e00\u884c\u6216\u591a\u884c\u4ee3\u66ff\u3002 - until - while - for for name [ [in [words \u2026] ] ; ] do commands; done \u5c55\u5f00 words \uff0c\u5e76\u5bf9\u7ed3\u679c\u4e2d\u7684\u6bcf\u4e2a\u6210\u5458\u6267\u884c\u4e00\u6b21\u547d\u4ee4\u3002\u5982\u679c in words \u6ca1\u6709\u586b\u5199\uff0c\u4e3a\u6bcf\u4e2a\u4f4d\u7f6e\u53c2\u6570\u6267\u884c\u4e00\u6b21\u547d\u4ee4\uff0c\u5c31\u50cf $@ \u88ab\u6307\u5b9a\u4e86 see Special Parameters \u3002 \u53e6\u5916\u4e00\u79cd\u683c\u5f0f\uff1a??? for (( expr1 ; expr2 ; expr3 )) ; do commands ; done 3.2.4.2 \u6761\u4ef6\u7ed3\u6784 \u00b6 if if test-commands; then consequent-commands; [elif more-test-commands; then more-consequents;] [else alternate-consequents;] fi case case word in [ [(] pattern [| pattern]\u2026) command-list ;;]\u2026 esac \u6267\u884c pattern \u5339\u914d\u5230 word \u7684\u547d\u4ee4\u7ec4\u3002 patterns \u4e0e\u76f8\u5173\u7684 command-list \u4e00\u8d77\u88ab\u79f0\u4f5c clause \u3002 \u6bcf\u4e2aclause\u5fc5\u987b\u4ee5\u4e09\u79cd\u7b26\u53f7\u7ed3\u675f\uff1a ;; , ;& , ;;& \u3002\u4f8b\uff1a echo -n \"Enter the name of an animal: \" read ANIMAL echo -n \"The $ANIMAL has \" case $ANIMAL in horse | dog | cat ) echo -n \"four\" ;; man | kangaroo ) echo -n \"two\" ;; * ) echo -n \"an unknown number of\" ;; esac echo \" legs.\" \u5982\u679c\u4f7f\u7528 ;; \u7ed3\u675f\uff0c\u90a3\u4e48\u5339\u914d\u5230\u7b2c\u4e00\u4e2aclause\u540e\u5373\u505c\u6b62\uff0c\u4e0d\u4f1a\u5411\u540e\u7ee7\u7eed\u5339\u914d\u3002\u4f7f\u7528 ;\uff1b& \u53ef\u8fbe\u5230\u76f8\u53cd\u7684\u6548\u679c\u3002\u4f7f\u7528 ;& \u5219\u4f1a\u5bfc\u81f4\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u4e2aclause\u3002\u5982\u679c\u6ca1\u6709\u5339\u914d\u5219\u8fd4\u56de0\uff0c\u5426\u5219\u8fd4\u56de\u6267\u884c\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u3002 - select - ((...)) - [[...]] 3.2.4.3 \u7ec4\u547d\u4ee4 \u00b6 Bash\u63d0\u4f9b\u4e86\u4e24\u79cd\u65b9\u5f0f\u6765\u5c06\u4e00\u7ec4\u547d\u4ee4\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u6765\u6267\u884c\u3002\u5f53\u547d\u4ee4\u88ab\u7ec4\u6240\u5305\u62ec\u65f6\uff0c\u91cd\u5b9a\u5411\u53ef\u80fd\u4f1a\u5e94\u7528\u5230\u6574\u4e2a\u547d\u4ee4\u5217\u8868\u4e2d\u3002 ()\uff1a (list) \uff0c\u4ee5\u5c0f\u62ec\u53f7\u7684\u65b9\u5f0f\u5305\u56f4\u547d\u4ee4\u4f1a\u521b\u5efa\u4e00\u4e2a\u5b50shell\u73af\u5883\uff0c\u6bcf\u4e2a\u547d\u4ee4\u4f1a\u5728\u5b50shell\u4e2d\u6267\u884c\u3002 {}\uff1a {list} \uff0c\u4ee5\u82b1\u62ec\u53f7\u7684\u65b9\u5f0f\u5305\u56f4\u547d\u4ee4\u4f1a\u5728\u5f53\u524dshell\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c list \u3002 list \u4e2d\u7684\u547d\u4ee4\u9700\u8981\u4ee5\u6362\u884c\u6216\u8005\u5206\u53f7\u9694\u5f00\u3002 3.3 shell \u51fd\u6570 \u00b6 \u8bed\u6cd5\uff1a name () compound-command [ redirections ] or function name [()] compound-command [ redirections ] \u51fd\u6570\u4f53 compound-command \uff0c\u53c2\u89c1 Compound Commands \u4f8b\uff1a as_fn_append () { eval $ [ 1 ]= \\$ $ [ 1 ] \\$ [ 2 ] ; } 3.4 \u00b6 3.4.2 \u7279\u6b8a\u53c2\u6570 \u00b6 \u4e0d\u5141\u8bb8\u8d4b\u503c\u3002\u4f7f\u7528 $ \u5f15\u7528\u3002 *\uff1a\u4ece\u7b2c\u4e00\u4e2a\u5f00\u59cb\u5c55\u5f00\u6210\u4f4d\u7f6e\u53c2\u6570\u3002 @\uff1a\u4ece\u7b2c\u4e00\u4e2a\u5f00\u59cb\u5c55\u5f00\u6210\u4f4d\u7f6e\u53c2\u6570\u3002 #\uff1a\u53c2\u6570\u6570\u91cf\u3002 ?\uff1a\u6700\u8fd1\u7684\u7ba1\u9053\u6267\u884c\u7684\u9000\u51fa\u72b6\u6001\u3002 -\uff1a\u8c03\u7528\u65f6\u6307\u5b9a\u7684\u5f53\u524d\u9009\u9879\u6807\u5fd7\u3002 $\uff1ashell\u8fdb\u7a0bID\u3002\u5728\u4e00\u4e2a () \u5b50shell\u4e2d\uff0c\u6269\u5c55\u4e3a\u8c03\u7528shell\uff0c\u800c\u4e0d\u662f\u5b50shell\u3002 !\uff1a\u6700\u8fd1\u522b\u653e\u5728\u540e\u53f0\u8fd0\u884c\u7684job\u7684ID\uff0c\u4e0d\u8bba\u662f\u5f02\u6b65\u547d\u4ee4\u6216\u8005\u4f7f\u7528\u7684 bg \u3002 0\uff1ashell\u7684\u540d\u5b57\u6216\u8005shell\u811a\u672c\u7684\u540d\u5b57\u3002 _\uff1a\u5728shell\u5f00\u59cb\u7684\u65f6\u5019\uff0c\u88ab\u8bbe\u7f6e\u4e3a\u7edd\u5bf9\u8def\u5f84\u7528\u4e8e\uff1a\u5f53\u88ab\u4f20\u9012\u7ed9\u73af\u5883\u6216\u8005\u53c2\u6570\u5217\u8868\u4e2d\u65f6\uff0c\u8c03\u7528\u6b63\u5728\u88ab\u6267\u884c\u7684shell\u6216shell\u811a\u672c\u3002 3.5 shell\u6269\u5c55 \u00b6 3.5.2 shell\u53c2\u6570\u6269\u5c55 \u00b6 \u7279\u6b8a\u60c5\u51b5\uff1a\u5982\u679c parameter \u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f ! \uff0c\u90a3\u4e48\u5b83\u4e0d\u662f nameref \uff0c\u800c\u662f\u53d8\u91cf\u7ea7\u522b\u7684\u6307\u4ee4\u3002\u8be5\u53d8\u91cf\u7684\u503c\u7531\u5176\u4f59\u53c2\u6570\u7ec4\u6210\u3002\u79f0\u4f5c indirect expansion \u3002 parameter\uff1a\u53d8\u91cf\u540d\u3002 * \u4e0e @ \u4f1a\u4f5c\u7528\u5230\u6bcf\u4e2a\u6210\u5458\u4e0a\u9762\u3002\u6b63\u5219\u8868\u8fbe\u5f0f\u53c2\u8003 see Filename Expansion \u3002 \u5305\u62ec\u5192\u53f7\u5219\u4f1a\u6d4b\u8bd5\u53c2\u6570\u7684\u5b58\u5728\u4e14\u503c\u975e\u7a7a\uff0c\u7701\u7565\u5192\u53f7\u53ea\u6d4b\u8bd5\u53c2\u6570\u662f\u5426\u5b58\u5728\u3002 ${parameter:-word} - \u5982\u679c parameter \u672a\u8bbe\u7f6e\u6216\u4e3anull\uff0c\u66ff\u6362 word \u7684\u6269\u5c55\u3002\u5426\u5219\u66ff\u6362\u53c2\u6570\u7684\u503c\u3002 ${parameter:=word} - \u5982\u679c parameter \u672a\u8bbe\u7f6e\u6216\u4e3anull\uff0c word \u7684\u6269\u5c55\u88ab\u5206\u914d\u7ed9\u53c2\u6570\u3002\u7136\u540e parameter \u7684\u503c\u88ab\u66ff\u6362\u3002\u4f4d\u7f6e\u53c2\u6570\u4e0e\u7279\u6b8a\u53c2\u6570\u4e0d\u80fd\u4f7f\u7528\u8fd9\u79cd\u5f62\u5f0f\u3002 ${parameter:?word} - \u5982\u679c parameter \u672a\u8bbe\u7f6e\u6216\u4e3anull\uff0c word \u7684\u6269\u5c55\uff08\u6216\u8005\u662f word \u4e0d\u5b58\u5728\u53d1\u51fa\u7684\u4fe1\u606f\uff09\u88ab\u5199\u5165\u6807\u51c6\u9519\u8bef\u548cshell\u4e2d\uff0c\u5982\u679c\u4e0d\u662f\u4ea4\u4e92\u5f0f\u7684shell\uff0c\u5219\u9000\u51fa\u3002\u5426\u5219\u66ff\u6362\u53c2\u6570\u7684\u503c\u3002 ${parameter:+word} - \u5982\u679c parameter \u672a\u8bbe\u7f6e\u6216\u4e3anull\uff0c\u6ca1\u6709\u4e1c\u897f\u88ab\u66ff\u6362\u3002\u5426\u5219 word \u7684\u6269\u5c55\u88ab\u66ff\u6362\u3002 ${ with_fontconfig :- no } ${#parameter} - parameter \u7684\u957f\u5ea6\u3002\u5982\u679c\u662f\u6570\u7ec4\uff1a\u4e0b\u6807\u4e3a\u6570\u5b57\u65f6\uff0c\u957f\u5ea6\u4e3a1\uff1b\u4e0b\u6807\u662f * or @ \u65f6\uff0c\u957f\u5ea6\u662f\u5143\u7d20\u7684\u6570\u91cf\u3002 ${parameter#word} word \u662f\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u5339\u914d\u7684\u662f parameter \u7684\u5934\u90e8\uff0c\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\u4ece parameter \u4e2d\u5220\u9664\u3002\u6700\u77ed\u5339\u914d\u89c4\u5219\u3002 ${parameter##word} - \u6700\u957f\u5339\u914d\u89c4\u5219\u3002 ${parameter%word} - \u5339\u914d\u7684\u662f parameter \u7684\u5c3e\u90e8\uff0c\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\u4ece parameter \u4e2d\u5220\u9664\u3002\u6700\u77ed\u5339\u914d\u89c4\u5219\u3002 ${parameter%%word} - \u6700\u957f\u5339\u914d\u89c4\u5219\u3002 ${parameter/pattern/string} - \u5c06 pattern \u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\u7528 string \u4ee3\u66ff\u3002\u6700\u957f\u5339\u914d\u89c4\u5219\u3002 \u5982\u679c pattern \u4ee5 / \u5f00\u59cb\uff0c\u6240\u6709\u7684\u5339\u914d\u90fd\u4f1a\u88ab\u66ff\u6362\uff1b\u6b63\u5e38\u60c5\u51b5\u4e0b\u53ea\u6709\u7b2c\u4e00\u4e2a\u4f1a\u88ab\u66ff\u6362\u3002 \u4ee5 # \u5f00\u59cb\uff0c\u5339\u914d\u5934\u90e8 \u4ee5 % \u5f00\u59cb\uff0c\u5339\u914d\u5c3e\u90e8 \u5982\u679c string \u662f\u7a7a\u7684\uff0c\u5339\u914d\u5230\u7684\u4f1a\u88ab\u5220\u6389 [ root@dev home ] # echo ${str} abcdefgaabdd [ root@dev home ] # echo ${str/a/ss} ssbcdefgaabdd [ root@dev home ] # echo ${str//a/ss} ssbcdefgssssbdd [ root@dev home ] # echo ${str//a/} bcdefgbdd ${parameter^pattern} - \u5339\u914d\u5b57\u6bcd\u5b57\u7b26\uff0c pattern \u5e94\u8be5\u53ea\u5339\u914d\u4e00\u4e2a\u5b57\u7b26\u3002\u5982\u679c pattern \u4e3a\u7a7a\uff0c\u5339\u914d\u6240\u6709\u7684\u5b57\u7b26\u3002\u5c0f\u5199\u8f6c\u5927\u5199\uff0c\u5339\u914d\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002 ${parameter^^pattern} - \u5339\u914d\u6240\u6709\u7684\u5b57\u7b26\u3002 ${parameter,pattern} - \u5927\u5199\u8f6c\u5c0f\u5199\uff0c\u5339\u914d\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002 ${parameter,,pattern} - \u5339\u914d\u6240\u6709\u7684\u5b57\u7b26\u3002 [ root@dev home ] # echo ${str} abcdefgaabdd [ root@dev home ] # echo ${str^a} Abcdefgaabdd [ root@dev home ] # echo ${str^^} ABCDEFGAABDD 3.5.8 \u6587\u4ef6\u540d\u6269\u5c55 \u00b6 3.5.8.1 \u6b63\u5219\u5339\u914d \u00b6 \u53cd\u659c\u6760\u7528\u4e8e\u8f6c\u4e49\u4e0b\u9762\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u6765\u4f7f\u4ed6\u4eec\u53d8\u6210\u5b57\u9762\u4e0a\u7684\u610f\u601d\u3002 * - \u5339\u914d\u4efb\u4f55\u5b57\u7b26\u4e32\uff0c\u5305\u62ec\u7a7a\u4e32\u3002shell\u9009\u9879 globstar \u53ef\u7528\u65f6\uff0c * \u5728\u4e00\u4e2a\u6587\u4ef6\u540d\u6269\u5c55\u5185\u5bb9\u4e2d\u4f7f\u7528\uff0c ** \u4f5c\u4e3a\u4e00\u4e2a\u5355\u4e00\u7684\u6b63\u5219\u4f1a\u5339\u914d\u6240\u6709\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u53ca\u5176\u5b50\u6587\u4ef6\u5939\u3002\u5982\u679c\u540e\u8ddf / \uff0c ** \u53ea\u5339\u914d\u6587\u4ef6\u5939\u548c\u5b50\u6587\u4ef6\u5939\u3002 ? - \u5339\u914d\u4efb\u4f55\u5355\u4e2a\u5b57\u7b26\u3002 [...] - \u5339\u914d\u4efb\u4f55\u5c01\u88c5\u7684\u5b57\u7b26\u4e32\u3002\u4ee5 ! \u6216 ^ \u5f00\u5934\u65f6\uff0c\u8868\u793a\u4e0d\u5339\u914d\u3002 - \u8868\u793a\u8303\u56f4\u8868\u8fbe\u5f0f\u3002 ?(pattern-list) - 0\u6b21\u62161\u6b21\u5339\u914d\u3002 *(pattern-list) - 0\u6b21\u6216\u591a\u6b21\u5339\u914d\u3002 +(pattern-list) - 1\u6b21\u6216\u591a\u6b21\u5339\u914d\u3002 @(pattern-list) - 1\u6b21\u5339\u914d\u3002 !(pattern-list) - \u4e0d\u5339\u914d\u3002","title":"3.\u57fa\u672cshell\u529f\u80fd"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#32-shell","text":"","title":"3.2 shell\u547d\u4ee4"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#324","text":"","title":"3.2.4 \u590d\u5408\u547d\u4ee4"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#3241","text":"note \uff1a\u4e0d\u8bba ; \u51fa\u73b0\u5728\u547d\u4ee4\u8bed\u6cd5\u7684\u4f55\u5904\uff0c\u90fd\u53ef\u80fd\u4f1a\u88ab\u4e00\u884c\u6216\u591a\u884c\u4ee3\u66ff\u3002 - until - while - for for name [ [in [words \u2026] ] ; ] do commands; done \u5c55\u5f00 words \uff0c\u5e76\u5bf9\u7ed3\u679c\u4e2d\u7684\u6bcf\u4e2a\u6210\u5458\u6267\u884c\u4e00\u6b21\u547d\u4ee4\u3002\u5982\u679c in words \u6ca1\u6709\u586b\u5199\uff0c\u4e3a\u6bcf\u4e2a\u4f4d\u7f6e\u53c2\u6570\u6267\u884c\u4e00\u6b21\u547d\u4ee4\uff0c\u5c31\u50cf $@ \u88ab\u6307\u5b9a\u4e86 see Special Parameters \u3002 \u53e6\u5916\u4e00\u79cd\u683c\u5f0f\uff1a??? for (( expr1 ; expr2 ; expr3 )) ; do commands ; done","title":"3.2.4.1 \u5faa\u73af\u7ed3\u6784"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#3242","text":"if if test-commands; then consequent-commands; [elif more-test-commands; then more-consequents;] [else alternate-consequents;] fi case case word in [ [(] pattern [| pattern]\u2026) command-list ;;]\u2026 esac \u6267\u884c pattern \u5339\u914d\u5230 word \u7684\u547d\u4ee4\u7ec4\u3002 patterns \u4e0e\u76f8\u5173\u7684 command-list \u4e00\u8d77\u88ab\u79f0\u4f5c clause \u3002 \u6bcf\u4e2aclause\u5fc5\u987b\u4ee5\u4e09\u79cd\u7b26\u53f7\u7ed3\u675f\uff1a ;; , ;& , ;;& \u3002\u4f8b\uff1a echo -n \"Enter the name of an animal: \" read ANIMAL echo -n \"The $ANIMAL has \" case $ANIMAL in horse | dog | cat ) echo -n \"four\" ;; man | kangaroo ) echo -n \"two\" ;; * ) echo -n \"an unknown number of\" ;; esac echo \" legs.\" \u5982\u679c\u4f7f\u7528 ;; \u7ed3\u675f\uff0c\u90a3\u4e48\u5339\u914d\u5230\u7b2c\u4e00\u4e2aclause\u540e\u5373\u505c\u6b62\uff0c\u4e0d\u4f1a\u5411\u540e\u7ee7\u7eed\u5339\u914d\u3002\u4f7f\u7528 ;\uff1b& \u53ef\u8fbe\u5230\u76f8\u53cd\u7684\u6548\u679c\u3002\u4f7f\u7528 ;& \u5219\u4f1a\u5bfc\u81f4\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u4e2aclause\u3002\u5982\u679c\u6ca1\u6709\u5339\u914d\u5219\u8fd4\u56de0\uff0c\u5426\u5219\u8fd4\u56de\u6267\u884c\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u3002 - select - ((...)) - [[...]]","title":"3.2.4.2 \u6761\u4ef6\u7ed3\u6784"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#3243","text":"Bash\u63d0\u4f9b\u4e86\u4e24\u79cd\u65b9\u5f0f\u6765\u5c06\u4e00\u7ec4\u547d\u4ee4\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u6765\u6267\u884c\u3002\u5f53\u547d\u4ee4\u88ab\u7ec4\u6240\u5305\u62ec\u65f6\uff0c\u91cd\u5b9a\u5411\u53ef\u80fd\u4f1a\u5e94\u7528\u5230\u6574\u4e2a\u547d\u4ee4\u5217\u8868\u4e2d\u3002 ()\uff1a (list) \uff0c\u4ee5\u5c0f\u62ec\u53f7\u7684\u65b9\u5f0f\u5305\u56f4\u547d\u4ee4\u4f1a\u521b\u5efa\u4e00\u4e2a\u5b50shell\u73af\u5883\uff0c\u6bcf\u4e2a\u547d\u4ee4\u4f1a\u5728\u5b50shell\u4e2d\u6267\u884c\u3002 {}\uff1a {list} \uff0c\u4ee5\u82b1\u62ec\u53f7\u7684\u65b9\u5f0f\u5305\u56f4\u547d\u4ee4\u4f1a\u5728\u5f53\u524dshell\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c list \u3002 list \u4e2d\u7684\u547d\u4ee4\u9700\u8981\u4ee5\u6362\u884c\u6216\u8005\u5206\u53f7\u9694\u5f00\u3002","title":"3.2.4.3 \u7ec4\u547d\u4ee4"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#33-shell","text":"\u8bed\u6cd5\uff1a name () compound-command [ redirections ] or function name [()] compound-command [ redirections ] \u51fd\u6570\u4f53 compound-command \uff0c\u53c2\u89c1 Compound Commands \u4f8b\uff1a as_fn_append () { eval $ [ 1 ]= \\$ $ [ 1 ] \\$ [ 2 ] ; }","title":"3.3 shell \u51fd\u6570"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#34","text":"","title":"3.4"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#342","text":"\u4e0d\u5141\u8bb8\u8d4b\u503c\u3002\u4f7f\u7528 $ \u5f15\u7528\u3002 *\uff1a\u4ece\u7b2c\u4e00\u4e2a\u5f00\u59cb\u5c55\u5f00\u6210\u4f4d\u7f6e\u53c2\u6570\u3002 @\uff1a\u4ece\u7b2c\u4e00\u4e2a\u5f00\u59cb\u5c55\u5f00\u6210\u4f4d\u7f6e\u53c2\u6570\u3002 #\uff1a\u53c2\u6570\u6570\u91cf\u3002 ?\uff1a\u6700\u8fd1\u7684\u7ba1\u9053\u6267\u884c\u7684\u9000\u51fa\u72b6\u6001\u3002 -\uff1a\u8c03\u7528\u65f6\u6307\u5b9a\u7684\u5f53\u524d\u9009\u9879\u6807\u5fd7\u3002 $\uff1ashell\u8fdb\u7a0bID\u3002\u5728\u4e00\u4e2a () \u5b50shell\u4e2d\uff0c\u6269\u5c55\u4e3a\u8c03\u7528shell\uff0c\u800c\u4e0d\u662f\u5b50shell\u3002 !\uff1a\u6700\u8fd1\u522b\u653e\u5728\u540e\u53f0\u8fd0\u884c\u7684job\u7684ID\uff0c\u4e0d\u8bba\u662f\u5f02\u6b65\u547d\u4ee4\u6216\u8005\u4f7f\u7528\u7684 bg \u3002 0\uff1ashell\u7684\u540d\u5b57\u6216\u8005shell\u811a\u672c\u7684\u540d\u5b57\u3002 _\uff1a\u5728shell\u5f00\u59cb\u7684\u65f6\u5019\uff0c\u88ab\u8bbe\u7f6e\u4e3a\u7edd\u5bf9\u8def\u5f84\u7528\u4e8e\uff1a\u5f53\u88ab\u4f20\u9012\u7ed9\u73af\u5883\u6216\u8005\u53c2\u6570\u5217\u8868\u4e2d\u65f6\uff0c\u8c03\u7528\u6b63\u5728\u88ab\u6267\u884c\u7684shell\u6216shell\u811a\u672c\u3002","title":"3.4.2 \u7279\u6b8a\u53c2\u6570"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#35-shell","text":"","title":"3.5 shell\u6269\u5c55"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#352-shell","text":"\u7279\u6b8a\u60c5\u51b5\uff1a\u5982\u679c parameter \u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f ! \uff0c\u90a3\u4e48\u5b83\u4e0d\u662f nameref \uff0c\u800c\u662f\u53d8\u91cf\u7ea7\u522b\u7684\u6307\u4ee4\u3002\u8be5\u53d8\u91cf\u7684\u503c\u7531\u5176\u4f59\u53c2\u6570\u7ec4\u6210\u3002\u79f0\u4f5c indirect expansion \u3002 parameter\uff1a\u53d8\u91cf\u540d\u3002 * \u4e0e @ \u4f1a\u4f5c\u7528\u5230\u6bcf\u4e2a\u6210\u5458\u4e0a\u9762\u3002\u6b63\u5219\u8868\u8fbe\u5f0f\u53c2\u8003 see Filename Expansion \u3002 \u5305\u62ec\u5192\u53f7\u5219\u4f1a\u6d4b\u8bd5\u53c2\u6570\u7684\u5b58\u5728\u4e14\u503c\u975e\u7a7a\uff0c\u7701\u7565\u5192\u53f7\u53ea\u6d4b\u8bd5\u53c2\u6570\u662f\u5426\u5b58\u5728\u3002 ${parameter:-word} - \u5982\u679c parameter \u672a\u8bbe\u7f6e\u6216\u4e3anull\uff0c\u66ff\u6362 word \u7684\u6269\u5c55\u3002\u5426\u5219\u66ff\u6362\u53c2\u6570\u7684\u503c\u3002 ${parameter:=word} - \u5982\u679c parameter \u672a\u8bbe\u7f6e\u6216\u4e3anull\uff0c word \u7684\u6269\u5c55\u88ab\u5206\u914d\u7ed9\u53c2\u6570\u3002\u7136\u540e parameter \u7684\u503c\u88ab\u66ff\u6362\u3002\u4f4d\u7f6e\u53c2\u6570\u4e0e\u7279\u6b8a\u53c2\u6570\u4e0d\u80fd\u4f7f\u7528\u8fd9\u79cd\u5f62\u5f0f\u3002 ${parameter:?word} - \u5982\u679c parameter \u672a\u8bbe\u7f6e\u6216\u4e3anull\uff0c word \u7684\u6269\u5c55\uff08\u6216\u8005\u662f word \u4e0d\u5b58\u5728\u53d1\u51fa\u7684\u4fe1\u606f\uff09\u88ab\u5199\u5165\u6807\u51c6\u9519\u8bef\u548cshell\u4e2d\uff0c\u5982\u679c\u4e0d\u662f\u4ea4\u4e92\u5f0f\u7684shell\uff0c\u5219\u9000\u51fa\u3002\u5426\u5219\u66ff\u6362\u53c2\u6570\u7684\u503c\u3002 ${parameter:+word} - \u5982\u679c parameter \u672a\u8bbe\u7f6e\u6216\u4e3anull\uff0c\u6ca1\u6709\u4e1c\u897f\u88ab\u66ff\u6362\u3002\u5426\u5219 word \u7684\u6269\u5c55\u88ab\u66ff\u6362\u3002 ${ with_fontconfig :- no } ${#parameter} - parameter \u7684\u957f\u5ea6\u3002\u5982\u679c\u662f\u6570\u7ec4\uff1a\u4e0b\u6807\u4e3a\u6570\u5b57\u65f6\uff0c\u957f\u5ea6\u4e3a1\uff1b\u4e0b\u6807\u662f * or @ \u65f6\uff0c\u957f\u5ea6\u662f\u5143\u7d20\u7684\u6570\u91cf\u3002 ${parameter#word} word \u662f\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u5339\u914d\u7684\u662f parameter \u7684\u5934\u90e8\uff0c\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\u4ece parameter \u4e2d\u5220\u9664\u3002\u6700\u77ed\u5339\u914d\u89c4\u5219\u3002 ${parameter##word} - \u6700\u957f\u5339\u914d\u89c4\u5219\u3002 ${parameter%word} - \u5339\u914d\u7684\u662f parameter \u7684\u5c3e\u90e8\uff0c\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\u4ece parameter \u4e2d\u5220\u9664\u3002\u6700\u77ed\u5339\u914d\u89c4\u5219\u3002 ${parameter%%word} - \u6700\u957f\u5339\u914d\u89c4\u5219\u3002 ${parameter/pattern/string} - \u5c06 pattern \u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\u7528 string \u4ee3\u66ff\u3002\u6700\u957f\u5339\u914d\u89c4\u5219\u3002 \u5982\u679c pattern \u4ee5 / \u5f00\u59cb\uff0c\u6240\u6709\u7684\u5339\u914d\u90fd\u4f1a\u88ab\u66ff\u6362\uff1b\u6b63\u5e38\u60c5\u51b5\u4e0b\u53ea\u6709\u7b2c\u4e00\u4e2a\u4f1a\u88ab\u66ff\u6362\u3002 \u4ee5 # \u5f00\u59cb\uff0c\u5339\u914d\u5934\u90e8 \u4ee5 % \u5f00\u59cb\uff0c\u5339\u914d\u5c3e\u90e8 \u5982\u679c string \u662f\u7a7a\u7684\uff0c\u5339\u914d\u5230\u7684\u4f1a\u88ab\u5220\u6389 [ root@dev home ] # echo ${str} abcdefgaabdd [ root@dev home ] # echo ${str/a/ss} ssbcdefgaabdd [ root@dev home ] # echo ${str//a/ss} ssbcdefgssssbdd [ root@dev home ] # echo ${str//a/} bcdefgbdd ${parameter^pattern} - \u5339\u914d\u5b57\u6bcd\u5b57\u7b26\uff0c pattern \u5e94\u8be5\u53ea\u5339\u914d\u4e00\u4e2a\u5b57\u7b26\u3002\u5982\u679c pattern \u4e3a\u7a7a\uff0c\u5339\u914d\u6240\u6709\u7684\u5b57\u7b26\u3002\u5c0f\u5199\u8f6c\u5927\u5199\uff0c\u5339\u914d\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002 ${parameter^^pattern} - \u5339\u914d\u6240\u6709\u7684\u5b57\u7b26\u3002 ${parameter,pattern} - \u5927\u5199\u8f6c\u5c0f\u5199\uff0c\u5339\u914d\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002 ${parameter,,pattern} - \u5339\u914d\u6240\u6709\u7684\u5b57\u7b26\u3002 [ root@dev home ] # echo ${str} abcdefgaabdd [ root@dev home ] # echo ${str^a} Abcdefgaabdd [ root@dev home ] # echo ${str^^} ABCDEFGAABDD","title":"3.5.2 shell\u53c2\u6570\u6269\u5c55"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#358","text":"","title":"3.5.8 \u6587\u4ef6\u540d\u6269\u5c55"},{"location":"bash/3.%E5%9F%BA%E6%9C%ACshell%E5%8A%9F%E8%83%BD/#3581","text":"\u53cd\u659c\u6760\u7528\u4e8e\u8f6c\u4e49\u4e0b\u9762\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u6765\u4f7f\u4ed6\u4eec\u53d8\u6210\u5b57\u9762\u4e0a\u7684\u610f\u601d\u3002 * - \u5339\u914d\u4efb\u4f55\u5b57\u7b26\u4e32\uff0c\u5305\u62ec\u7a7a\u4e32\u3002shell\u9009\u9879 globstar \u53ef\u7528\u65f6\uff0c * \u5728\u4e00\u4e2a\u6587\u4ef6\u540d\u6269\u5c55\u5185\u5bb9\u4e2d\u4f7f\u7528\uff0c ** \u4f5c\u4e3a\u4e00\u4e2a\u5355\u4e00\u7684\u6b63\u5219\u4f1a\u5339\u914d\u6240\u6709\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u53ca\u5176\u5b50\u6587\u4ef6\u5939\u3002\u5982\u679c\u540e\u8ddf / \uff0c ** \u53ea\u5339\u914d\u6587\u4ef6\u5939\u548c\u5b50\u6587\u4ef6\u5939\u3002 ? - \u5339\u914d\u4efb\u4f55\u5355\u4e2a\u5b57\u7b26\u3002 [...] - \u5339\u914d\u4efb\u4f55\u5c01\u88c5\u7684\u5b57\u7b26\u4e32\u3002\u4ee5 ! \u6216 ^ \u5f00\u5934\u65f6\uff0c\u8868\u793a\u4e0d\u5339\u914d\u3002 - \u8868\u793a\u8303\u56f4\u8868\u8fbe\u5f0f\u3002 ?(pattern-list) - 0\u6b21\u62161\u6b21\u5339\u914d\u3002 *(pattern-list) - 0\u6b21\u6216\u591a\u6b21\u5339\u914d\u3002 +(pattern-list) - 1\u6b21\u6216\u591a\u6b21\u5339\u914d\u3002 @(pattern-list) - 1\u6b21\u5339\u914d\u3002 !(pattern-list) - \u4e0d\u5339\u914d\u3002","title":"3.5.8.1 \u6b63\u5219\u5339\u914d"},{"location":"bash/4.shell%E5%86%85%E7%BD%AE%E5%91%BD%E4%BB%A4/","text":"4.1 Bourne Shell \u00b6 : [arguments] - \u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u9664\u4e86\u6269\u5c55 arguments \u548c\u91cd\u5b9a\u5411\u3002\u8fd4\u56de\u72b6\u6001\u662f0\u3002 . filename [arguments] - \u5728\u5f53\u524d\u7684shell\u73af\u5883\u8bfb\u53d6\u548c\u6267\u884c filename \u4e2d\u7684\u547d\u4ee4 eval [arguments] - \u53c2\u6570\u8fde\u63a5\u5230\u4e00\u8d77\u6210\u4e3a\u4e00\u4e2a\u547d\u4ee4\uff0c\u7136\u540e\u8bfb\u53d6\u548c\u6267\u884c\uff0c\u9000\u51fa\u72b6\u6001\u662feval\u7684\u9000\u51fa\u72b6\u6001\u3002 exec [-cl] [-a name] [command [arguments]] - \u5982\u679c\u63d0\u4f9b\u4e86 command \uff0c\u4f1a\u4ee3\u66ff\u5f53\u524d\u7684shell\uff0c\u4e0d\u4f1a\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a command \uff0c\u53ef\u80fd\u4f1a\u7528\u5230\u91cd\u5b9a\u5411\u6765\u5f71\u54cd\u5f53\u524d\u7684shell\u73af\u5883\u3002 if [ $ # - gt 0 ]; then exec 0 < $ 1 ; # \u5c06\u6587\u4ef6\u7ed1\u5b9a\u5230\u6807\u51c6\u8f93\u5165\uff08 0 - \u6807\u51c6\u8f93\u5165 1 - \u6807\u51c6\u8f93\u51fa 2 - \u6807\u51c6\u9519\u8bef\uff09\uff0c\u9ed8\u8ba4\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u8f93\u5165\u7684\u6587\u4ef6\uff1b fi while read line do echo $ line ; done <& 0 ; # \u4ece\u6807\u51c6\u8f93\u5165\u8bfb\u53d6\u6570\u636e exec 0 <&- # \u91cd\u65b0\u7ed1\u5b9a\u6807\u51c6\u8f93\u5165\u5230\u547d\u4ee4\u884c export [-fn] [-p] [name[=value]] - \u6807\u8bb0\u6bcf\u4e2a name \u4f20\u9012\u7ed9\u5b50\u7ebf\u7a0b\u3002","title":"4.shell\u5185\u7f6e\u547d\u4ee4"},{"location":"bash/4.shell%E5%86%85%E7%BD%AE%E5%91%BD%E4%BB%A4/#41-bourne-shell","text":": [arguments] - \u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u9664\u4e86\u6269\u5c55 arguments \u548c\u91cd\u5b9a\u5411\u3002\u8fd4\u56de\u72b6\u6001\u662f0\u3002 . filename [arguments] - \u5728\u5f53\u524d\u7684shell\u73af\u5883\u8bfb\u53d6\u548c\u6267\u884c filename \u4e2d\u7684\u547d\u4ee4 eval [arguments] - \u53c2\u6570\u8fde\u63a5\u5230\u4e00\u8d77\u6210\u4e3a\u4e00\u4e2a\u547d\u4ee4\uff0c\u7136\u540e\u8bfb\u53d6\u548c\u6267\u884c\uff0c\u9000\u51fa\u72b6\u6001\u662feval\u7684\u9000\u51fa\u72b6\u6001\u3002 exec [-cl] [-a name] [command [arguments]] - \u5982\u679c\u63d0\u4f9b\u4e86 command \uff0c\u4f1a\u4ee3\u66ff\u5f53\u524d\u7684shell\uff0c\u4e0d\u4f1a\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a command \uff0c\u53ef\u80fd\u4f1a\u7528\u5230\u91cd\u5b9a\u5411\u6765\u5f71\u54cd\u5f53\u524d\u7684shell\u73af\u5883\u3002 if [ $ # - gt 0 ]; then exec 0 < $ 1 ; # \u5c06\u6587\u4ef6\u7ed1\u5b9a\u5230\u6807\u51c6\u8f93\u5165\uff08 0 - \u6807\u51c6\u8f93\u5165 1 - \u6807\u51c6\u8f93\u51fa 2 - \u6807\u51c6\u9519\u8bef\uff09\uff0c\u9ed8\u8ba4\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u8f93\u5165\u7684\u6587\u4ef6\uff1b fi while read line do echo $ line ; done <& 0 ; # \u4ece\u6807\u51c6\u8f93\u5165\u8bfb\u53d6\u6570\u636e exec 0 <&- # \u91cd\u65b0\u7ed1\u5b9a\u6807\u51c6\u8f93\u5165\u5230\u547d\u4ee4\u884c export [-fn] [-p] [name[=value]] - \u6807\u8bb0\u6bcf\u4e2a name \u4f20\u9012\u7ed9\u5b50\u7ebf\u7a0b\u3002","title":"4.1 Bourne Shell"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/","text":"1. \u6280\u672f\u6982\u8ff0 1.1 \u5173\u952e\u7ec4\u4ef6 1.1.1 Delivery Controller 1.1.2 Database 1.1.3 Virtual Delivery Agent (VDA) 1.1.4 Citrix StoreFront 1.1.5 Citrix Workspace app 1.1.6 Citrix Studio 1.1.7 Citrix Director 1.1.8 Citrix License Server 1.1.9 Hypervisor or cloud service 1.2 \u9644\u52a0\u7ec4\u4ef6 1.2.1 Citrix Provisioning 1.2.2 Citrix Gateway 1.2.3 Citrix SD-WAN 1.3 \u5178\u578b\u90e8\u7f72\u7684\u5de5\u4f5c\u539f\u7406 1.4 \u5982\u4f55\u5904\u7406\u7528\u6237\u8fde\u63a5 1.5 \u6570\u636e\u8bbf\u95ee\u7684\u5de5\u4f5c\u539f\u7406 1.6 \u63d0\u4f9b\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f 1.6.1 Machine catalogs 1.6.2 Delivery Groups 1.6.3 Application Groups 2. Active Directory \u5b98\u65b9\u6587\u6863 1. \u6280\u672f\u6982\u8ff0 \u00b6 Citrix Virtual Apps and Desktops \u662f\u865a\u62df\u5316\u89e3\u51b3\u65b9\u6848\uff0c\u53ef\u4ee5\u4e3aIT\u63d0\u4f9b\u5bf9\u865a\u62df\u673a\uff0c\u5e94\u7528\u7a0b\u5e8f\uff0c\u8bb8\u53ef\u548c\u5b89\u5168\u6027\u7684\u63a7\u5236\uff0c\u540c\u65f6\u4e3a\u4efb\u4f55\u8bbe\u5907\u63d0\u4f9b\u4efb\u4f55\u8bbf\u95ee\u6743\u9650\u3002 \u7ec8\u7aef\u7528\u6237\u72ec\u7acb\u4e8e\u8bbe\u5907\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u754c\u9762\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\u3002 \u7ba1\u7406\u5458\u53ef\u4ee5\u7ba1\u7406\u7f51\u7edc\u5e76\u63a7\u5236\u6240\u9009\u8bbe\u5907\u6216\u6240\u6709\u8bbe\u5907\u7684\u8bbf\u95ee\u3002 \u7ba1\u7406\u5458\u53ef\u4ee5\u4ece\u5355\u4e2a\u6570\u636e\u4e2d\u5fc3\u7ba1\u7406\u6574\u4e2a\u7f51\u7edc\u3002 Citrix Virtual Apps and Desktops\u5171\u4eab\u79f0\u4e3a FlexCast Management Architecture (FMA) \u7684\u7edf\u4e00\u4f53\u7cfb\u7ed3\u6784\u3002 1.1 \u5173\u952e\u7ec4\u4ef6 \u00b6 1.1.1 Delivery Controller \u00b6 Delivery Controller \u662f\u7ad9\u70b9\u7684\u4e2d\u5fc3\u7ba1\u7406\u7ec4\u4ef6\u3002 \u5982\u679c\u90e8\u7f72\u5305\u62ec\u865a\u62df\u673a\u7ba1\u7406\u7a0b\u5e8f\u6216\u4e91\u670d\u52a1\uff0c\u5219Controller\u670d\u52a1\u4e0e\u5176\u8fdb\u884c\u901a\u4fe1\u4ee5\u5206\u53d1\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\uff0c\u9a8c\u8bc1\u548c\u7ba1\u7406\u7528\u6237\u8bbf\u95ee\uff0c\u4ee3\u7406\u7528\u6237\u4e0e\u5176\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u4f18\u5316\u4f7f\u7528\u8fde\u63a5\u4ee5\u53ca\u5bf9\u8fd9\u4e9b\u8fde\u63a5\u8fdb\u884c\u8d1f\u8f7d\u5e73\u8861\u3002 Controller\u7ba1\u7406\u684c\u9762\u7684\u72b6\u6001\uff0c\u6839\u636e\u9700\u6c42\u548c\u7ba1\u7406\u914d\u7f6e\u542f\u52a8\u548c\u505c\u6b62\u5b83\u4eec\u3002 1.1.2 Database \u00b6 \u6bcf\u4e2a\u7ad9\u70b9\u81f3\u5c11\u9700\u8981\u4e00\u4e2a Microsoft SQL Server \u6570\u636e\u5e93\u6765\u5b58\u50a8\u914d\u7f6e\u548c\u4f1a\u8bdd\u4fe1\u606f\u3002\u6b64\u6570\u636e\u5e93\u5b58\u50a8\u7531\u7ec4\u6210Controller\u7684\u670d\u52a1\u6536\u96c6\u548c\u7ba1\u7406\u7684\u6570\u636e\u3002 \u8be5\u7ad9\u70b9\u8fd8\u4f7f\u7528\u914d\u7f6e\u65e5\u5fd7\u8bb0\u5f55\u6570\u636e\u5e93\u548c\u76d1\u63a7\u6570\u636e\u5e93\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e9b\u6570\u636e\u5e93\u5b89\u88c5\u5728\u4e0e\u7ad9\u70b9\u6570\u636e\u5e93\u76f8\u540c\u7684\u4f4d\u7f6e\u3002 1.1.3 Virtual Delivery Agent (VDA) \u00b6 VDA \u5b89\u88c5\u5728\u7ad9\u70b9\u4e2d\u53ef\u4f9b\u7528\u6237\u4f7f\u7528\u7684\u6bcf\u53f0\u7269\u7406\u673a\u6216\u865a\u62df\u673a\u4e0a\u3002\u8fd9\u4e9b\u673a\u5668\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u6216\u684c\u9762\u3002VDA\u4f7f\u673a\u5668\u80fd\u591f\u5411Controller\u6ce8\u518c\uff0c\u4ece\u800c\u4f7f\u673a\u5668\u53ca\u5176\u6258\u7ba1\u7684\u8d44\u6e90\u53ef\u4f9b\u7528\u6237\u4f7f\u7528\u3002VDA\u5efa\u7acb\u548c\u7ba1\u7406\u673a\u5668\u4e0e\u7528\u6237\u8bbe\u5907\u4e4b\u95f4\u7684\u8fde\u63a5\u3002 \u201cVDA\u201d\u4e00\u8bcd\u901a\u5e38\u7528\u4e8e\u8868\u793a\u4ee3\u7406\u4ee5\u53ca\u5b89\u88c5\u5b83\u7684\u673a\u5668\u3002 \u652f\u6301Windows\u670d\u52a1\u5668\u548c\u684c\u9762\u7248\u3001Linux\u3002 1.1.4 Citrix StoreFront \u00b6 StoreFront \u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5e76\u7ba1\u7406\u7528\u6237\u8bbf\u95ee\u7684\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f\u7684\u5b58\u50a8\u3002\u5b83\u53ef\u4ee5\u6258\u7ba1\u60a8\u7684\u4f01\u4e1a\u5e94\u7528\u7a0b\u5e8f\u5546\u5e97\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u81ea\u52a9\u8bbf\u95ee\u60a8\u53ef\u4ee5\u4f7f\u7528\u7684\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f\u3002 1.1.5 Citrix Workspace app \u00b6 Citrix Workspace app \u5b89\u88c5\u5728\u7528\u6237\u8bbe\u5907\u548c\u5176\u4ed6\u7aef\u70b9\uff08\u4f8b\u5982\u865a\u62df\u684c\u9762\uff09\u4e0a\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u5bf9\u6587\u6863\u3001\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\u7684\u5feb\u901f\u3001\u5b89\u5168\u3001\u81ea\u52a9\u5f0f\u670d\u52a1\u7684\u8bbf\u95ee\u3002 1.1.6 Citrix Studio \u00b6 Studio \u662f\u7ba1\u7406\u63a7\u5236\u53f0\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u914d\u7f6e\u548c\u7ba1\u7406 Citrix Virtual Apps and Desktops \u90e8\u7f72\u3002 Studio\u63d0\u4f9b\u5411\u5bfc\u6765\u6307\u5bfc\u5b8c\u6210\u73af\u5883\u8bbe\u7f6e\uff0c\u521b\u5efa\u6258\u7ba1\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u4ee5\u53ca\u4e3a\u7528\u6237\u5206\u914d\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528Studio\u4e3a\u7ad9\u70b9\u5206\u914d\u548c\u8ddf\u8e2aCitrix\u8bb8\u53ef\u8bc1\u3002 1.1.7 Citrix Director \u00b6 Director \u662f\u4e00\u4e2a\u57fa\u4e8eWeb\u7684\u5de5\u5177\uff0c\u4f7fIT\u652f\u6301\u548c\u5e2e\u52a9\u53f0\u56e2\u961f\u80fd\u591f\u76d1\u63a7\u73af\u5883\uff0c\u5728\u95ee\u9898\u53d8\u5f97\u5bf9\u7cfb\u7edf\u81f3\u5173\u91cd\u8981\u4e4b\u524d\u89e3\u51b3\u95ee\u9898\uff0c\u5e76\u4e3a\u6700\u7ec8\u7528\u6237\u6267\u884c\u652f\u6301\u4efb\u52a1\u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2aDirector\u90e8\u7f72\u6765\u8fde\u63a5\u548c\u76d1\u63a7\u591a\u4e2a Citrix Virtual Apps or Citrix Virtual Desktops Sites \u3002 \u5c55\u793a\u4e0b\u5217\u5185\u5bb9\uff1a \u6765\u81eaController\u4e2d Broker Service \u7684\u5b9e\u65f6\u4f1a\u8bdd\u6570\u636e\uff0c\u5176\u4e2d\u5305\u62ecBroker Service\u4eceVDA\u4e2d\u7684 Broker Agent \u83b7\u53d6\u7684\u6570\u636e\u3002 Controller\u4e2d Monitor Service \u7684\u5386\u53f2\u7ad9\u70b9\u6570\u636e\u3002 1.1.8 Citrix License Server \u00b6 License Server \u7ba1\u7406Citrix\u4ea7\u54c1\u8bb8\u53ef\u8bc1\u3002 \u5b83\u4e0eController\u901a\u4fe1\u4ee5\u7ba1\u7406\u6bcf\u4e2a\u7528\u6237\u4f1a\u8bdd\u7684\u8bb8\u53ef\uff0c\u5e76\u4e0eStudio\u901a\u4fe1\u5206\u914d\u8bb8\u53ef\u8bc1\u6587\u4ef6\u3002 1.1.9 Hypervisor or cloud service \u00b6 hypervisor or cloud service \u6258\u7ba1\u7ad9\u70b9\u4e2d\u7684\u865a\u62df\u673a\u3002\u8fd9\u4e9b\u53ef\u4ee5\u662f\u7528\u4e8e\u6258\u7ba1 \u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762 \u7684VMs\uff0c\u4e5f\u53ef\u4ee5\u662f\u7528\u4e8e\u6258\u7ba1 Citrix Virtual Apps and Desktops \u7ec4\u4ef6\u7684VMs\u3002 Citrix Virtual Apps and Desktops \u652f\u6301\u591a\u79cd hypervisors and cloud services \u3002 \u867d\u7136\u8bb8\u591a\u90e8\u7f72\u9700\u8981\u7ba1\u7406\u7a0b\u5e8f\uff0c\u4f46\u60a8\u4e0d\u9700\u8981\u63d0\u4f9b\u8fdc\u7a0bPC\u8bbf\u95ee\u3002\u4f7f\u7528 Provisioning Services\uff08PVS\uff09 \u914d\u7f6eVM\u65f6\uff0c\u4e5f\u4e0d\u9700\u8981\u865a\u62df\u673a\u76d1\u63a7\u7a0b\u5e8f\u3002 1.2 \u9644\u52a0\u7ec4\u4ef6 \u00b6 \u8fd9\u4e9b\u7ec4\u4ef6\u662f\u53ef\u9009\u7684\u3002 1.2.1 Citrix Provisioning \u00b6 \u662f\u4ee5\u524d\u7684PVS\u3002\u5b83\u4e3a MCS \u63d0\u4f9b\u4e86\u4f9b\u5e94\u865a\u62df\u673a\u7684\u66ff\u4ee3\u65b9\u6848\u3002MCS\u521b\u5efa\u4e3b\u6620\u50cf\u7684\u526f\u672c\uff0c\u800cPVS\u5c06\u4e3b\u6620\u50cf\u6d41\u5f0f\u4f20\u8f93\u5230\u7528\u6237\u8bbe\u5907\u3002PVS\u4e0d\u9700\u8981\u7ba1\u7406\u7a0b\u5e8f\u6765\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u6258\u7ba1\u7269\u7406\u673a\u3002 PVS\u4e0eController\u901a\u4fe1\u4ee5\u5411\u7528\u6237\u63d0\u4f9b\u8d44\u6e90\u3002 1.2.2 Citrix Gateway \u00b6 \u5f53\u7528\u6237\u4ece\u516c\u53f8\u9632\u706b\u5899\u5916\u90e8\u8fdb\u884c\u8fde\u63a5\u65f6\uff0cCitrix Virtual Apps and Desktops\u53ef\u4ee5\u4f7f\u7528 Citrix Gateway \uff08\u4ee5\u524d\u79f0\u4e3a Access Gateway \u548c NetScaler Gateway \uff09\u6280\u672f\u548cTLS\u6765\u4fdd\u62a4\u8fd9\u4e9b\u8fde\u63a5\u3002 1.2.3 Citrix SD-WAN \u00b6 \u5728\u5c06\u865a\u62df\u684c\u9762\u4ea4\u4ed8\u7ed9\u8fdc\u7a0b\u4f4d\u7f6e\uff08\u5982\u5206\u652f\u673a\u6784\uff09\u7684\u7528\u6237\u7684\u90e8\u7f72\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 Citrix SD-WAN \u6280\u672f\u6765\u4f18\u5316\u6027\u80fd\u3002 1.3 \u5178\u578b\u90e8\u7f72\u7684\u5de5\u4f5c\u539f\u7406 \u00b6 VDA \u8ba9\u7528\u6237\u80fd\u591f\u8fde\u63a5\u5230\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u5b89\u88c5\u5728\u6570\u636e\u4e2d\u5fc3\u7684\u670d\u52a1\u5668\u6216\u53f0\u5f0f\u673a\u4e0a\uff0c\u5b83\u5b89\u88c5\u5728\u6570\u636e\u4e2d\u5fc3\u7684\u670d\u52a1\u5668\u6216\u53f0\u5f0f\u673a\u4e0a\uff0c\u9002\u7528\u4e8e\u5927\u591a\u6570\u4ea4\u4ed8\u65b9\u5f0f\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5b89\u88c5\u5728\u7269\u7406PC\u4e0a\u4ee5\u8fdb\u884c\u8fdc\u7a0bPC\u8bbf\u95ee\u3002 Controller \u7531\u72ec\u7acb\u7684Windows\u670d\u52a1\u7ec4\u6210\uff0c\u53ef\u7ba1\u7406\u8d44\u6e90\uff0c\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\uff0c\u5e76\u4f18\u5316\u548c\u5e73\u8861\u7528\u6237\u8fde\u63a5\u3002 \u7528\u6237\u6c38\u8fdc\u4e0d\u4f1a\u76f4\u63a5\u8bbf\u95ee Controller \u3002 VDA \u5145\u5f53\u7528\u6237\u548c Controller \u4e4b\u95f4\u7684\u4e2d\u4ecb\u3002\u5f53\u7528\u6237\u4f7f\u7528 StoreFront \u767b\u5f55\u65f6\uff0c\u4ed6\u4eec\u7684\u51ed\u636e\u5c06\u4f20\u9012\u7ed9 Controller \u4e0a\u7684 Broker Service \u3002\u7136\u540e\uff0c Broker Service \u6839\u636e\u4e3a\u5176\u8bbe\u7f6e\u7684\u7b56\u7565\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6\u548c\u53ef\u7528\u8d44\u6e90\u3002 1.4 \u5982\u4f55\u5904\u7406\u7528\u6237\u8fde\u63a5 \u00b6 \u8981\u542f\u52a8\u4f1a\u8bdd\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u7528\u6237\u8bbe\u5907\u4e0a\u5b89\u88c5\u7684 Citrix Workspace \u5e94\u7528\u7a0b\u5e8f\u6216 StoreFront \u7f51\u7ad9\u8fdb\u884c\u8fde\u63a5\u3002 \u7528\u6237\u9009\u62e9\u6240\u9700\u7684\u7269\u7406\u6216\u865a\u62df\u684c\u9762\u6216\u865a\u62df\u5e94\u7528\u7a0b\u5e8f\u3002 \u7528\u6237\u7684\u51ed\u636e\u901a\u8fc7\u6b64\u8def\u5f84\u4f20\u9012\u4ee5\u8bbf\u95ee Controller \u3002 Broker Service \u51b3\u5b9a\u4e86\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u7684\u684c\u9762\u548c\u5e94\u7528\u3002 \u9a8c\u8bc1\u51ed\u636e\u4e4b\u540e\uff0c\u901a\u8fc7 StoreFront-Citrix Workspace \u8def\u5f84\u8fd4\u56de\u53ef\u7528\u7684\u5e94\u7528\u548c\u684c\u9762\u7684\u4fe1\u606f\u3002\u7528\u6237\u4ece\u5217\u8868\u9009\u62e9\u4e4b\u540e\uff0c Controller \u786e\u5b9a\u9002\u5f53\u7684 VDA \u4ee5\u6258\u7ba1\u7279\u5b9a\u5e94\u7528\u7a0b\u5e8f\u6216\u684c\u9762\u3002 Controller \u4f7f\u7528\u7528\u6237\u7684\u51ed\u636e\u5411 VDA \u53d1\u9001\u6d88\u606f\uff0c\u7136\u540e\u5c06\u6709\u5173\u7528\u6237\u548c\u8fde\u63a5\u7684\u6240\u6709\u6570\u636e\u53d1\u9001\u5230 VDA \u3002 VDA \u63a5\u53d7\u8fde\u63a5\u5e76\u901a\u8fc7\u76f8\u540c\u7684\u8def\u5f84\u5c06\u4fe1\u606f\u53d1\u9001\u56de Citrix Workspace \u5e94\u7528\u7a0b\u5e8f\u3002\u5728 StoreFront \u4e0a\u6536\u96c6\u4e00\u7ec4\u5fc5\u9700\u53c2\u6570\u3002\u7136\u540e\uff0c\u8fd9\u4e9b\u53c2\u6570\u4f5c\u4e3a Citrix-Workspace-app-StoreFront \u534f\u8bae\u4f1a\u8bdd\u7684\u4e00\u90e8\u5206\u53d1\u9001\u5230 Citrix Workspace \u5e94\u7528\u7a0b\u5e8f\uff0c\u6216\u8f6c\u6362\u4e3a Independent Computing Architecture\uff08ICA\uff09 \u6587\u4ef6\u5e76\u4e0b\u8f7d\u3002 ICA \u6587\u4ef6\u88ab\u590d\u5236\u5230\u7528\u6237\u7684\u8bbe\u5907\uff0c\u5e76\u5728\u8bbe\u5907\u548c VDA \u4e0a\u8fd0\u884c\u7684 ICA \u5806\u6808\u4e4b\u95f4\u5efa\u7acb\u76f4\u63a5\u8fde\u63a5\u3002 Citrix Workspace \u5e94\u7528\u7a0b\u5e8f\u4e0e VDA \u4e4b\u95f4\u7684\u8fde\u63a5\u4f7f\u7528 Citrix Gateway Protocol\uff08CGP\uff09 \u3002 \u5ba2\u6237\u7aef\u8fde\u63a5\u5230 VDA \u540e\uff0c VDA \u4f1a\u901a\u77e5 Controller \u7528\u6237\u5df2\u767b\u5f55\u3002\u7136\u540e\uff0c Controller \u5c06\u6b64\u4fe1\u606f\u53d1\u9001\u5230 Site \uff08 Site \u662f\u4f60\u4e3a Citrix Virtual Apps and Desktops \u90e8\u7f72\u63d0\u4f9b\u7684\u540d\u5b57\uff0c\u5b83\u5305\u62ecDelivery Controller\u548c\u5176\u4ed6\u6838\u5fc3\u7ec4\u4ef6\uff09\u6570\u636e\u5e93\uff0c\u5e76\u5f00\u59cb\u5728\u76d1\u89c6\u6570\u636e\u5e93\u4e2d\u8bb0\u5f55\u6570\u636e\u3002 1.5 \u6570\u636e\u8bbf\u95ee\u7684\u5de5\u4f5c\u539f\u7406 \u00b6 \u6bcf\u4e2a Citrix Virtual Apps and Desktops \u4f1a\u8bdd\u4ea7\u751f\u7684\u6570\u636e\uff0cIT\u90fd\u80fd\u901a\u8fc7 Studio \u6216 Director \u83b7\u53d6\u3002\u4f7f\u7528 Studio \uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u83b7\u53d6\u4ece Broker Agent \u5230\u7ba1\u7406\u7ad9\u70b9\u7684\u5b9e\u65f6\u6570\u636e\u3002 Director \u4ece\u76d1\u63a7\u6570\u636e\u5e93\u4e2d\u8bbf\u95ee\u5b9e\u65f6\u6570\u636e\u548c\u5386\u53f2\u6570\u636e\u3002\u8fd8\u53ef\u4ee5\u4ece NetScaler Gateway \u8bbf\u95ee HDX \u6570\u636e\uff0c\u4ee5\u83b7\u5f97\u6280\u672f\u652f\u6301\u548c\u6545\u969c\u6392\u9664\u3002 \u5728Controller\u5185\uff0c Broker Service \u62a5\u544a\u673a\u5668\u4e0a\u6bcf\u4e2a\u4f1a\u8bdd\u7684\u4f1a\u8bdd\u6570\u636e\uff0c\u63d0\u4f9b\u5b9e\u65f6\u6570\u636e\u3002 Monitor Service \u8fd8\u8ddf\u8e2a\u5b9e\u65f6\u6570\u636e\u5e76\u5c06\u5176\u4f5c\u4e3a\u5386\u53f2\u6570\u636e\u5b58\u50a8\u5728\u76d1\u63a7\u6570\u636e\u5e93\u4e2d\u3002 Director \u8fd8\u53ef\u4ee5\u8bbf\u95ee Citrix Gateway \u4ee5\u83b7\u53d6\u6709\u5173 HDX \u6570\u636e\u7684\u4fe1\u606f\u3002 1.6 \u63d0\u4f9b\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f \u00b6 \u4f60\u53ef\u4ee5\u4f7f\u7528 \u8ba1\u7b97\u673a\u76ee\u5f55 \uff08Machine catalogs\uff09\u8bbe\u7f6e\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\u7684\u8ba1\u7b97\u673a\u3002\u7136\u540e\uff0c\u521b\u5efa Delivery Groups \uff0c\u6307\u5b9a\u53ef\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\uff08\u4f7f\u7528\u76ee\u5f55\u4e2d\u7684\u8ba1\u7b97\u673a\uff09\uff0c\u4ee5\u53ca\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u5b83\u4eec\u3002\u53ef\u9009\u7684\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa Application Groups \u7ba1\u7406\u4e00\u6279\u5e94\u7528\u3002 1.6.1 Machine catalogs \u00b6 \u8ba1\u7b97\u673a\u76ee\u5f55\u662f\u4f5c\u4e3a\u5355\u4e2a\u5b9e\u4f53\u7ba1\u7406\u7684\u865a\u62df\u673a\u6216\u7269\u7406\u8ba1\u7b97\u673a\u7684\u96c6\u5408\u3002\u8fd9\u4e9b\u673a\u5668\uff0c\u548c\u5728\u673a\u5668\u4e0a\u9762\u7684\u5e94\u7528\u6216\u865a\u62df\u684c\u9762\u662f\u4f60\u63d0\u4f9b\u7ed9\u7528\u6237\u7684\u8d44\u6e90\u3002\u5728catalog\u4e2d\u6240\u6709\u7684\u673a\u5668\u90fd\u5b89\u88c5\u4e86 \u76f8\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u76f8\u540c\u7684VDA \u3002\u5b83\u4eec\u4e5f\u5177\u6709 \u76f8\u540c\u7684\u5e94\u7528\u7a0b\u5e8f\u6216\u865a\u62df\u684c\u9762 \u3002 \u901a\u5e38\uff0c\u60a8\u521b\u5efa\u4e3b\u955c\u50cf\uff08image\uff09\u5e76\u4f7f\u7528\u5b83\u5728\u76ee\u5f55\u4e2d\u521b\u5efa\u76f8\u540c\u7684VM\u3002\u5bf9\u4e8eVM\uff0c\u60a8\u53ef\u4ee5\u4e3a\u8be5\u76ee\u5f55\u4e2d\u7684\u8ba1\u7b97\u673a\u6307\u5b9a\u914d\u7f6e\u65b9\u6cd5\uff1aCitrix\u5de5\u5177\uff08 Citrix Provisioning \u6216 MCS \uff09\u6216\u5176\u4ed6\u5de5\u5177\u3002\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u73b0\u6709\u955c\u50cf\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u5fc5\u987b\u5355\u72ec\u7ba1\u7406\u76ee\u6807\u8bbe\u5907\uff0c\u6216\u4f7f\u7528\u7b2c\u4e09\u65b9 electronic software distribution\uff08ESD\uff09 \u5de5\u5177\u5171\u540c\u7ba1\u7406\u76ee\u6807\u8bbe\u5907\u3002 \u5408\u9002\u7684\u673a\u5668\u7c7b\u578b\uff1a Server OS machines \uff1a\u670d\u52a1\u5668\u64cd\u4f5c\u7cfb\u7edf\u7684\u865a\u62df\u673a\u6216\u7269\u7406\u673a\u3002 \u7528\u4e8e\u63d0\u4f9bCitrix Virtual Apps\u53d1\u5e03\u7684\u5e94\u7528\u7a0b\u5e8f\uff08\u4e5f\u79f0\u4e3a\u57fa\u4e8e\u670d\u52a1\u5668 server-based \u7684\u6258\u7ba1\u5e94\u7528\u7a0b\u5e8f\uff09\u548cCitrix Virtual Apps\u53d1\u5e03\u7684\u684c\u9762\uff08\u4e5f\u79f0\u4e3a\u670d\u52a1\u5668\u6258\u7ba1 server-hosted \u7684\u684c\u9762\uff09\u3002\u8fd9\u4e9b\u673a\u5668\u5141\u8bb8\u591a\u4e2a\u7528\u6237\u540c\u65f6\u8fde\u63a5\u5230\u5b83\u4eec\u3002 Desktop OS machines \uff1a\u684c\u9762\u64cd\u4f5c\u7cfb\u7edf\u7684\u865a\u62df\u673a\u6216\u7269\u7406\u673a\u3002 \u7528\u4e8e\u63d0\u4f9bVDI\u684c\u9762\uff08\u8fd0\u884c\u53ef\u9009\u62e9\u4e2a\u6027\u5316\u7684\u684c\u9762\u64cd\u4f5c\u7cfb\u7edf\u7684\u684c\u9762\uff09\uff0cVM\u6258\u7ba1\u7684\u5e94\u7528\u7a0b\u5e8f\uff08\u684c\u9762\u64cd\u4f5c\u7cfb\u7edf\u7684\u5e94\u7528\u7a0b\u5e8f\uff09\u548c\u6258\u7ba1\u7684\u7269\u7406\u684c\u9762\u3002\u4e00\u6b21\u53ea\u80fd\u6709\u4e00\u4e2a\u7528\u6237\u8fde\u63a5\u5230\u6bcf\u4e2a\u684c\u9762\u3002 Remote PC Access \uff1a\u5141\u8bb8\u8fdc\u7a0b\u7528\u6237\u4ece\u8fd0\u884c Citrix Workspace \u5e94\u7528\u7a0b\u5e8f\u7684\u4efb\u4f55\u8bbe\u5907\u8bbf\u95ee\u5176\u7269\u7406\u529e\u516c\u5ba4PC\u3002 \u529e\u516c\u5ba4PC\u901a\u8fc7Citrix Virtual Desktops\u90e8\u7f72\u8fdb\u884c\u7ba1\u7406\uff0c\u5e76\u8981\u6c42\u5728\u767d\u540d\u5355\u4e2d\u6307\u5b9a\u7528\u6237\u8bbe\u5907\u3002 1.6.2 Delivery Groups \u00b6 Delivery Groups \u6307\u5b9a\u4e86\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u54ea\u4e9b\u673a\u5668\u7684\u54ea\u4e9b\u5e94\u7528\u6216\u684c\u9762\u3002 Delivery Groups \u5305\u542b\u4e86\u673a\u5668\u76ee\u5f55\u4e2d\u7684\u673a\u5668\uff0c\u4ee5\u53ca\u548c\u6709\u6743\u8bbf\u95ee Site \u7684 Active Directory \u7528\u6237\u3002 Delivery Groups\u53ef\u4ee5\u5305\u62ec\u591a\u4e2a\u76ee\u5f55\u7684\u591a\u4e2a\u673a\u5668\uff0c\u6bcf\u4e2a\u76ee\u5f55\u4e5f\u53ef\u4ee5\u5411\u591a\u4e2aDelivery Groups\u8d21\u732e\u673a\u5668\u3002\u4f46\u662f\u5355\u72ec\u7684\u673a\u5668\u540c\u65f6\u53ea\u80fd\u5c5e\u4e8e\u4e00\u4e2aDelivery Groups\u3002 \u66f4\u591a\u8bf7\u53c2\u8003 Create Delivery Groups \u3002 1.6.3 Application Groups \u00b6 Application Groups\u63d0\u4f9b\u65b9\u4fbf\u7684\u5e94\u7528\u7ba1\u7406\u548c\u8d44\u6e90\u63a7\u5236\u3002 \u66f4\u591a\u8bf7\u53c2\u8003 Create Application Groups \u3002 2. Active Directory \u00b6 \u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u9700\u8981 Active Directory \u3002 \u8981\u4f7f\u7528\u7b56\u7565\u5efa\u6a21,\u57df\u63a7\u5236\u5668\u5fc5\u987b\u5728 Windows Server 2003 \u5230 Windows Server 2012 R2 \u4e0a\u8fd0\u884c;\u8fd9\u4e0d\u4f1a\u5f71\u54cd\u57df\u529f\u80fd\u7ea7\u522b\u3002 \u6b64\u4ea7\u54c1\u652f\u6301\uff1a \u7528\u6237\u5e10\u6237\u548c\u8ba1\u7b97\u673a\u5e10\u6237\u5b58\u5728\u4e8e\u5355\u4e2a Active Directory \u6797\u7684\u57df\u4e2d\u7684\u90e8\u7f72\u3002 \u7528\u6237\u548c\u8ba1\u7b97\u673a\u5e10\u6237\u53ef\u4ee5\u5b58\u5728\u4e8e\u5355\u4e2a\u6797\u4e2d\u7684\u4efb\u610f\u57df\u4e2d\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u90e8\u7f72\u652f\u6301\u6240\u6709\u57df\u529f\u80fd\u7ea7\u522b\u548c\u6797\u529f\u80fd\u7ea7\u522b\u3002 \u5176\u4e2d\u7528\u6237\u5e10\u6237\u5b58\u5728\u4e8e\u6d3b\u52a8\u76ee\u5f55\u6797\u4e2d\uff0c\u4e0e\u5305\u542b\u63a7\u5236\u5668\u548c\u865a\u62df\u684c\u9762\u7684\u8ba1\u7b97\u673a\u5e10\u6237\u7684 Active Directory \u6797\u4e0d\u540c\u7684\u90e8\u7f72\u3002 \u5305\u542b Controller and virtual desktop computer \u5e10\u6237\u7684\u57df\u5fc5\u987b\u4fe1\u4efb\u5305\u542b\u7528\u6237\u5e10\u6237\u7684\u57df\u3002\u53ef\u4ee5\u4f7f\u7528\u6797\u4fe1\u4efb\u6216\u5916\u90e8\u4fe1\u4efb\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u90e8\u7f72\u652f\u6301\u6240\u6709\u57df\u529f\u80fd\u7ea7\u522b\u548c\u6797\u529f\u80fd\u7ea7\u522b\u3002 Active Directory \u6797\u4e2d\u5b58\u5728\u8ba1\u7b97\u673a\u5e10\u6237\u63a7\u5236\u5668\uff0c\u8be5\u6797\u4e0d\u540c\u4e8e\u5305\u542b\u865a\u62df\u684c\u9762\u7684\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5176\u4ed6 Active Directory \u6797\u7684\u90e8\u7f72\u3002 \u5305\u542bController\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u57df\u4e0e\u5305\u542b\u865a\u62df\u684c\u9762\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u6240\u6709\u57df\u4e4b\u95f4\u5fc5\u987b\u5b58\u5728\u53cc\u5411\u4fe1\u4efb\u3002\u5305\u542bController\u6216\u865a\u62df\u684c\u9762\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u6240\u6709\u57df\u5fc5\u987b\u5904\u4e8e\"Windows 2000 native\"\u529f\u80fd\u7ea7\u522b\u6216\u66f4\u9ad8\u3002\u652f\u6301\u6240\u6709\u6797\u529f\u80fd\u7ea7\u522b\u3002 \u53ef\u5199\u57df\u63a7\u5236\u5668\u3002\u4e0d\u652f\u6301\u53ea\u8bfb\u57df\u63a7\u5236\u5668\u3002","title":"00\u6280\u672f\u6982\u8ff0"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#1","text":"Citrix Virtual Apps and Desktops \u662f\u865a\u62df\u5316\u89e3\u51b3\u65b9\u6848\uff0c\u53ef\u4ee5\u4e3aIT\u63d0\u4f9b\u5bf9\u865a\u62df\u673a\uff0c\u5e94\u7528\u7a0b\u5e8f\uff0c\u8bb8\u53ef\u548c\u5b89\u5168\u6027\u7684\u63a7\u5236\uff0c\u540c\u65f6\u4e3a\u4efb\u4f55\u8bbe\u5907\u63d0\u4f9b\u4efb\u4f55\u8bbf\u95ee\u6743\u9650\u3002 \u7ec8\u7aef\u7528\u6237\u72ec\u7acb\u4e8e\u8bbe\u5907\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u754c\u9762\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\u3002 \u7ba1\u7406\u5458\u53ef\u4ee5\u7ba1\u7406\u7f51\u7edc\u5e76\u63a7\u5236\u6240\u9009\u8bbe\u5907\u6216\u6240\u6709\u8bbe\u5907\u7684\u8bbf\u95ee\u3002 \u7ba1\u7406\u5458\u53ef\u4ee5\u4ece\u5355\u4e2a\u6570\u636e\u4e2d\u5fc3\u7ba1\u7406\u6574\u4e2a\u7f51\u7edc\u3002 Citrix Virtual Apps and Desktops\u5171\u4eab\u79f0\u4e3a FlexCast Management Architecture (FMA) \u7684\u7edf\u4e00\u4f53\u7cfb\u7ed3\u6784\u3002","title":"1. \u6280\u672f\u6982\u8ff0"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#11","text":"","title":"1.1 \u5173\u952e\u7ec4\u4ef6"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#111-delivery-controller","text":"Delivery Controller \u662f\u7ad9\u70b9\u7684\u4e2d\u5fc3\u7ba1\u7406\u7ec4\u4ef6\u3002 \u5982\u679c\u90e8\u7f72\u5305\u62ec\u865a\u62df\u673a\u7ba1\u7406\u7a0b\u5e8f\u6216\u4e91\u670d\u52a1\uff0c\u5219Controller\u670d\u52a1\u4e0e\u5176\u8fdb\u884c\u901a\u4fe1\u4ee5\u5206\u53d1\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\uff0c\u9a8c\u8bc1\u548c\u7ba1\u7406\u7528\u6237\u8bbf\u95ee\uff0c\u4ee3\u7406\u7528\u6237\u4e0e\u5176\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u4f18\u5316\u4f7f\u7528\u8fde\u63a5\u4ee5\u53ca\u5bf9\u8fd9\u4e9b\u8fde\u63a5\u8fdb\u884c\u8d1f\u8f7d\u5e73\u8861\u3002 Controller\u7ba1\u7406\u684c\u9762\u7684\u72b6\u6001\uff0c\u6839\u636e\u9700\u6c42\u548c\u7ba1\u7406\u914d\u7f6e\u542f\u52a8\u548c\u505c\u6b62\u5b83\u4eec\u3002","title":"1.1.1 Delivery Controller"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#112-database","text":"\u6bcf\u4e2a\u7ad9\u70b9\u81f3\u5c11\u9700\u8981\u4e00\u4e2a Microsoft SQL Server \u6570\u636e\u5e93\u6765\u5b58\u50a8\u914d\u7f6e\u548c\u4f1a\u8bdd\u4fe1\u606f\u3002\u6b64\u6570\u636e\u5e93\u5b58\u50a8\u7531\u7ec4\u6210Controller\u7684\u670d\u52a1\u6536\u96c6\u548c\u7ba1\u7406\u7684\u6570\u636e\u3002 \u8be5\u7ad9\u70b9\u8fd8\u4f7f\u7528\u914d\u7f6e\u65e5\u5fd7\u8bb0\u5f55\u6570\u636e\u5e93\u548c\u76d1\u63a7\u6570\u636e\u5e93\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e9b\u6570\u636e\u5e93\u5b89\u88c5\u5728\u4e0e\u7ad9\u70b9\u6570\u636e\u5e93\u76f8\u540c\u7684\u4f4d\u7f6e\u3002","title":"1.1.2 Database"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#113-virtual-delivery-agent-vda","text":"VDA \u5b89\u88c5\u5728\u7ad9\u70b9\u4e2d\u53ef\u4f9b\u7528\u6237\u4f7f\u7528\u7684\u6bcf\u53f0\u7269\u7406\u673a\u6216\u865a\u62df\u673a\u4e0a\u3002\u8fd9\u4e9b\u673a\u5668\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u6216\u684c\u9762\u3002VDA\u4f7f\u673a\u5668\u80fd\u591f\u5411Controller\u6ce8\u518c\uff0c\u4ece\u800c\u4f7f\u673a\u5668\u53ca\u5176\u6258\u7ba1\u7684\u8d44\u6e90\u53ef\u4f9b\u7528\u6237\u4f7f\u7528\u3002VDA\u5efa\u7acb\u548c\u7ba1\u7406\u673a\u5668\u4e0e\u7528\u6237\u8bbe\u5907\u4e4b\u95f4\u7684\u8fde\u63a5\u3002 \u201cVDA\u201d\u4e00\u8bcd\u901a\u5e38\u7528\u4e8e\u8868\u793a\u4ee3\u7406\u4ee5\u53ca\u5b89\u88c5\u5b83\u7684\u673a\u5668\u3002 \u652f\u6301Windows\u670d\u52a1\u5668\u548c\u684c\u9762\u7248\u3001Linux\u3002","title":"1.1.3 Virtual Delivery Agent (VDA)"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#114-citrix-storefront","text":"StoreFront \u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5e76\u7ba1\u7406\u7528\u6237\u8bbf\u95ee\u7684\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f\u7684\u5b58\u50a8\u3002\u5b83\u53ef\u4ee5\u6258\u7ba1\u60a8\u7684\u4f01\u4e1a\u5e94\u7528\u7a0b\u5e8f\u5546\u5e97\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u81ea\u52a9\u8bbf\u95ee\u60a8\u53ef\u4ee5\u4f7f\u7528\u7684\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f\u3002","title":"1.1.4 Citrix StoreFront"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#115-citrix-workspace-app","text":"Citrix Workspace app \u5b89\u88c5\u5728\u7528\u6237\u8bbe\u5907\u548c\u5176\u4ed6\u7aef\u70b9\uff08\u4f8b\u5982\u865a\u62df\u684c\u9762\uff09\u4e0a\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u5bf9\u6587\u6863\u3001\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\u7684\u5feb\u901f\u3001\u5b89\u5168\u3001\u81ea\u52a9\u5f0f\u670d\u52a1\u7684\u8bbf\u95ee\u3002","title":"1.1.5 Citrix Workspace app"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#116-citrix-studio","text":"Studio \u662f\u7ba1\u7406\u63a7\u5236\u53f0\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u914d\u7f6e\u548c\u7ba1\u7406 Citrix Virtual Apps and Desktops \u90e8\u7f72\u3002 Studio\u63d0\u4f9b\u5411\u5bfc\u6765\u6307\u5bfc\u5b8c\u6210\u73af\u5883\u8bbe\u7f6e\uff0c\u521b\u5efa\u6258\u7ba1\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u4ee5\u53ca\u4e3a\u7528\u6237\u5206\u914d\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528Studio\u4e3a\u7ad9\u70b9\u5206\u914d\u548c\u8ddf\u8e2aCitrix\u8bb8\u53ef\u8bc1\u3002","title":"1.1.6 Citrix Studio"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#117-citrix-director","text":"Director \u662f\u4e00\u4e2a\u57fa\u4e8eWeb\u7684\u5de5\u5177\uff0c\u4f7fIT\u652f\u6301\u548c\u5e2e\u52a9\u53f0\u56e2\u961f\u80fd\u591f\u76d1\u63a7\u73af\u5883\uff0c\u5728\u95ee\u9898\u53d8\u5f97\u5bf9\u7cfb\u7edf\u81f3\u5173\u91cd\u8981\u4e4b\u524d\u89e3\u51b3\u95ee\u9898\uff0c\u5e76\u4e3a\u6700\u7ec8\u7528\u6237\u6267\u884c\u652f\u6301\u4efb\u52a1\u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2aDirector\u90e8\u7f72\u6765\u8fde\u63a5\u548c\u76d1\u63a7\u591a\u4e2a Citrix Virtual Apps or Citrix Virtual Desktops Sites \u3002 \u5c55\u793a\u4e0b\u5217\u5185\u5bb9\uff1a \u6765\u81eaController\u4e2d Broker Service \u7684\u5b9e\u65f6\u4f1a\u8bdd\u6570\u636e\uff0c\u5176\u4e2d\u5305\u62ecBroker Service\u4eceVDA\u4e2d\u7684 Broker Agent \u83b7\u53d6\u7684\u6570\u636e\u3002 Controller\u4e2d Monitor Service \u7684\u5386\u53f2\u7ad9\u70b9\u6570\u636e\u3002","title":"1.1.7 Citrix Director"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#118-citrix-license-server","text":"License Server \u7ba1\u7406Citrix\u4ea7\u54c1\u8bb8\u53ef\u8bc1\u3002 \u5b83\u4e0eController\u901a\u4fe1\u4ee5\u7ba1\u7406\u6bcf\u4e2a\u7528\u6237\u4f1a\u8bdd\u7684\u8bb8\u53ef\uff0c\u5e76\u4e0eStudio\u901a\u4fe1\u5206\u914d\u8bb8\u53ef\u8bc1\u6587\u4ef6\u3002","title":"1.1.8 Citrix License Server"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#119-hypervisor-or-cloud-service","text":"hypervisor or cloud service \u6258\u7ba1\u7ad9\u70b9\u4e2d\u7684\u865a\u62df\u673a\u3002\u8fd9\u4e9b\u53ef\u4ee5\u662f\u7528\u4e8e\u6258\u7ba1 \u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762 \u7684VMs\uff0c\u4e5f\u53ef\u4ee5\u662f\u7528\u4e8e\u6258\u7ba1 Citrix Virtual Apps and Desktops \u7ec4\u4ef6\u7684VMs\u3002 Citrix Virtual Apps and Desktops \u652f\u6301\u591a\u79cd hypervisors and cloud services \u3002 \u867d\u7136\u8bb8\u591a\u90e8\u7f72\u9700\u8981\u7ba1\u7406\u7a0b\u5e8f\uff0c\u4f46\u60a8\u4e0d\u9700\u8981\u63d0\u4f9b\u8fdc\u7a0bPC\u8bbf\u95ee\u3002\u4f7f\u7528 Provisioning Services\uff08PVS\uff09 \u914d\u7f6eVM\u65f6\uff0c\u4e5f\u4e0d\u9700\u8981\u865a\u62df\u673a\u76d1\u63a7\u7a0b\u5e8f\u3002","title":"1.1.9 Hypervisor or cloud service"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#12","text":"\u8fd9\u4e9b\u7ec4\u4ef6\u662f\u53ef\u9009\u7684\u3002","title":"1.2 \u9644\u52a0\u7ec4\u4ef6"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#121-citrix-provisioning","text":"\u662f\u4ee5\u524d\u7684PVS\u3002\u5b83\u4e3a MCS \u63d0\u4f9b\u4e86\u4f9b\u5e94\u865a\u62df\u673a\u7684\u66ff\u4ee3\u65b9\u6848\u3002MCS\u521b\u5efa\u4e3b\u6620\u50cf\u7684\u526f\u672c\uff0c\u800cPVS\u5c06\u4e3b\u6620\u50cf\u6d41\u5f0f\u4f20\u8f93\u5230\u7528\u6237\u8bbe\u5907\u3002PVS\u4e0d\u9700\u8981\u7ba1\u7406\u7a0b\u5e8f\u6765\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u6258\u7ba1\u7269\u7406\u673a\u3002 PVS\u4e0eController\u901a\u4fe1\u4ee5\u5411\u7528\u6237\u63d0\u4f9b\u8d44\u6e90\u3002","title":"1.2.1 Citrix Provisioning"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#122-citrix-gateway","text":"\u5f53\u7528\u6237\u4ece\u516c\u53f8\u9632\u706b\u5899\u5916\u90e8\u8fdb\u884c\u8fde\u63a5\u65f6\uff0cCitrix Virtual Apps and Desktops\u53ef\u4ee5\u4f7f\u7528 Citrix Gateway \uff08\u4ee5\u524d\u79f0\u4e3a Access Gateway \u548c NetScaler Gateway \uff09\u6280\u672f\u548cTLS\u6765\u4fdd\u62a4\u8fd9\u4e9b\u8fde\u63a5\u3002","title":"1.2.2 Citrix Gateway"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#123-citrix-sd-wan","text":"\u5728\u5c06\u865a\u62df\u684c\u9762\u4ea4\u4ed8\u7ed9\u8fdc\u7a0b\u4f4d\u7f6e\uff08\u5982\u5206\u652f\u673a\u6784\uff09\u7684\u7528\u6237\u7684\u90e8\u7f72\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 Citrix SD-WAN \u6280\u672f\u6765\u4f18\u5316\u6027\u80fd\u3002","title":"1.2.3 Citrix SD-WAN"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#13","text":"VDA \u8ba9\u7528\u6237\u80fd\u591f\u8fde\u63a5\u5230\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u5b89\u88c5\u5728\u6570\u636e\u4e2d\u5fc3\u7684\u670d\u52a1\u5668\u6216\u53f0\u5f0f\u673a\u4e0a\uff0c\u5b83\u5b89\u88c5\u5728\u6570\u636e\u4e2d\u5fc3\u7684\u670d\u52a1\u5668\u6216\u53f0\u5f0f\u673a\u4e0a\uff0c\u9002\u7528\u4e8e\u5927\u591a\u6570\u4ea4\u4ed8\u65b9\u5f0f\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5b89\u88c5\u5728\u7269\u7406PC\u4e0a\u4ee5\u8fdb\u884c\u8fdc\u7a0bPC\u8bbf\u95ee\u3002 Controller \u7531\u72ec\u7acb\u7684Windows\u670d\u52a1\u7ec4\u6210\uff0c\u53ef\u7ba1\u7406\u8d44\u6e90\uff0c\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\uff0c\u5e76\u4f18\u5316\u548c\u5e73\u8861\u7528\u6237\u8fde\u63a5\u3002 \u7528\u6237\u6c38\u8fdc\u4e0d\u4f1a\u76f4\u63a5\u8bbf\u95ee Controller \u3002 VDA \u5145\u5f53\u7528\u6237\u548c Controller \u4e4b\u95f4\u7684\u4e2d\u4ecb\u3002\u5f53\u7528\u6237\u4f7f\u7528 StoreFront \u767b\u5f55\u65f6\uff0c\u4ed6\u4eec\u7684\u51ed\u636e\u5c06\u4f20\u9012\u7ed9 Controller \u4e0a\u7684 Broker Service \u3002\u7136\u540e\uff0c Broker Service \u6839\u636e\u4e3a\u5176\u8bbe\u7f6e\u7684\u7b56\u7565\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6\u548c\u53ef\u7528\u8d44\u6e90\u3002","title":"1.3 \u5178\u578b\u90e8\u7f72\u7684\u5de5\u4f5c\u539f\u7406"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#14","text":"\u8981\u542f\u52a8\u4f1a\u8bdd\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u7528\u6237\u8bbe\u5907\u4e0a\u5b89\u88c5\u7684 Citrix Workspace \u5e94\u7528\u7a0b\u5e8f\u6216 StoreFront \u7f51\u7ad9\u8fdb\u884c\u8fde\u63a5\u3002 \u7528\u6237\u9009\u62e9\u6240\u9700\u7684\u7269\u7406\u6216\u865a\u62df\u684c\u9762\u6216\u865a\u62df\u5e94\u7528\u7a0b\u5e8f\u3002 \u7528\u6237\u7684\u51ed\u636e\u901a\u8fc7\u6b64\u8def\u5f84\u4f20\u9012\u4ee5\u8bbf\u95ee Controller \u3002 Broker Service \u51b3\u5b9a\u4e86\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u7684\u684c\u9762\u548c\u5e94\u7528\u3002 \u9a8c\u8bc1\u51ed\u636e\u4e4b\u540e\uff0c\u901a\u8fc7 StoreFront-Citrix Workspace \u8def\u5f84\u8fd4\u56de\u53ef\u7528\u7684\u5e94\u7528\u548c\u684c\u9762\u7684\u4fe1\u606f\u3002\u7528\u6237\u4ece\u5217\u8868\u9009\u62e9\u4e4b\u540e\uff0c Controller \u786e\u5b9a\u9002\u5f53\u7684 VDA \u4ee5\u6258\u7ba1\u7279\u5b9a\u5e94\u7528\u7a0b\u5e8f\u6216\u684c\u9762\u3002 Controller \u4f7f\u7528\u7528\u6237\u7684\u51ed\u636e\u5411 VDA \u53d1\u9001\u6d88\u606f\uff0c\u7136\u540e\u5c06\u6709\u5173\u7528\u6237\u548c\u8fde\u63a5\u7684\u6240\u6709\u6570\u636e\u53d1\u9001\u5230 VDA \u3002 VDA \u63a5\u53d7\u8fde\u63a5\u5e76\u901a\u8fc7\u76f8\u540c\u7684\u8def\u5f84\u5c06\u4fe1\u606f\u53d1\u9001\u56de Citrix Workspace \u5e94\u7528\u7a0b\u5e8f\u3002\u5728 StoreFront \u4e0a\u6536\u96c6\u4e00\u7ec4\u5fc5\u9700\u53c2\u6570\u3002\u7136\u540e\uff0c\u8fd9\u4e9b\u53c2\u6570\u4f5c\u4e3a Citrix-Workspace-app-StoreFront \u534f\u8bae\u4f1a\u8bdd\u7684\u4e00\u90e8\u5206\u53d1\u9001\u5230 Citrix Workspace \u5e94\u7528\u7a0b\u5e8f\uff0c\u6216\u8f6c\u6362\u4e3a Independent Computing Architecture\uff08ICA\uff09 \u6587\u4ef6\u5e76\u4e0b\u8f7d\u3002 ICA \u6587\u4ef6\u88ab\u590d\u5236\u5230\u7528\u6237\u7684\u8bbe\u5907\uff0c\u5e76\u5728\u8bbe\u5907\u548c VDA \u4e0a\u8fd0\u884c\u7684 ICA \u5806\u6808\u4e4b\u95f4\u5efa\u7acb\u76f4\u63a5\u8fde\u63a5\u3002 Citrix Workspace \u5e94\u7528\u7a0b\u5e8f\u4e0e VDA \u4e4b\u95f4\u7684\u8fde\u63a5\u4f7f\u7528 Citrix Gateway Protocol\uff08CGP\uff09 \u3002 \u5ba2\u6237\u7aef\u8fde\u63a5\u5230 VDA \u540e\uff0c VDA \u4f1a\u901a\u77e5 Controller \u7528\u6237\u5df2\u767b\u5f55\u3002\u7136\u540e\uff0c Controller \u5c06\u6b64\u4fe1\u606f\u53d1\u9001\u5230 Site \uff08 Site \u662f\u4f60\u4e3a Citrix Virtual Apps and Desktops \u90e8\u7f72\u63d0\u4f9b\u7684\u540d\u5b57\uff0c\u5b83\u5305\u62ecDelivery Controller\u548c\u5176\u4ed6\u6838\u5fc3\u7ec4\u4ef6\uff09\u6570\u636e\u5e93\uff0c\u5e76\u5f00\u59cb\u5728\u76d1\u89c6\u6570\u636e\u5e93\u4e2d\u8bb0\u5f55\u6570\u636e\u3002","title":"1.4 \u5982\u4f55\u5904\u7406\u7528\u6237\u8fde\u63a5"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#15","text":"\u6bcf\u4e2a Citrix Virtual Apps and Desktops \u4f1a\u8bdd\u4ea7\u751f\u7684\u6570\u636e\uff0cIT\u90fd\u80fd\u901a\u8fc7 Studio \u6216 Director \u83b7\u53d6\u3002\u4f7f\u7528 Studio \uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u83b7\u53d6\u4ece Broker Agent \u5230\u7ba1\u7406\u7ad9\u70b9\u7684\u5b9e\u65f6\u6570\u636e\u3002 Director \u4ece\u76d1\u63a7\u6570\u636e\u5e93\u4e2d\u8bbf\u95ee\u5b9e\u65f6\u6570\u636e\u548c\u5386\u53f2\u6570\u636e\u3002\u8fd8\u53ef\u4ee5\u4ece NetScaler Gateway \u8bbf\u95ee HDX \u6570\u636e\uff0c\u4ee5\u83b7\u5f97\u6280\u672f\u652f\u6301\u548c\u6545\u969c\u6392\u9664\u3002 \u5728Controller\u5185\uff0c Broker Service \u62a5\u544a\u673a\u5668\u4e0a\u6bcf\u4e2a\u4f1a\u8bdd\u7684\u4f1a\u8bdd\u6570\u636e\uff0c\u63d0\u4f9b\u5b9e\u65f6\u6570\u636e\u3002 Monitor Service \u8fd8\u8ddf\u8e2a\u5b9e\u65f6\u6570\u636e\u5e76\u5c06\u5176\u4f5c\u4e3a\u5386\u53f2\u6570\u636e\u5b58\u50a8\u5728\u76d1\u63a7\u6570\u636e\u5e93\u4e2d\u3002 Director \u8fd8\u53ef\u4ee5\u8bbf\u95ee Citrix Gateway \u4ee5\u83b7\u53d6\u6709\u5173 HDX \u6570\u636e\u7684\u4fe1\u606f\u3002","title":"1.5 \u6570\u636e\u8bbf\u95ee\u7684\u5de5\u4f5c\u539f\u7406"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#16","text":"\u4f60\u53ef\u4ee5\u4f7f\u7528 \u8ba1\u7b97\u673a\u76ee\u5f55 \uff08Machine catalogs\uff09\u8bbe\u7f6e\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\u7684\u8ba1\u7b97\u673a\u3002\u7136\u540e\uff0c\u521b\u5efa Delivery Groups \uff0c\u6307\u5b9a\u53ef\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u548c\u684c\u9762\uff08\u4f7f\u7528\u76ee\u5f55\u4e2d\u7684\u8ba1\u7b97\u673a\uff09\uff0c\u4ee5\u53ca\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u5b83\u4eec\u3002\u53ef\u9009\u7684\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa Application Groups \u7ba1\u7406\u4e00\u6279\u5e94\u7528\u3002","title":"1.6 \u63d0\u4f9b\u684c\u9762\u548c\u5e94\u7528\u7a0b\u5e8f"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#161-machine-catalogs","text":"\u8ba1\u7b97\u673a\u76ee\u5f55\u662f\u4f5c\u4e3a\u5355\u4e2a\u5b9e\u4f53\u7ba1\u7406\u7684\u865a\u62df\u673a\u6216\u7269\u7406\u8ba1\u7b97\u673a\u7684\u96c6\u5408\u3002\u8fd9\u4e9b\u673a\u5668\uff0c\u548c\u5728\u673a\u5668\u4e0a\u9762\u7684\u5e94\u7528\u6216\u865a\u62df\u684c\u9762\u662f\u4f60\u63d0\u4f9b\u7ed9\u7528\u6237\u7684\u8d44\u6e90\u3002\u5728catalog\u4e2d\u6240\u6709\u7684\u673a\u5668\u90fd\u5b89\u88c5\u4e86 \u76f8\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u548c\u76f8\u540c\u7684VDA \u3002\u5b83\u4eec\u4e5f\u5177\u6709 \u76f8\u540c\u7684\u5e94\u7528\u7a0b\u5e8f\u6216\u865a\u62df\u684c\u9762 \u3002 \u901a\u5e38\uff0c\u60a8\u521b\u5efa\u4e3b\u955c\u50cf\uff08image\uff09\u5e76\u4f7f\u7528\u5b83\u5728\u76ee\u5f55\u4e2d\u521b\u5efa\u76f8\u540c\u7684VM\u3002\u5bf9\u4e8eVM\uff0c\u60a8\u53ef\u4ee5\u4e3a\u8be5\u76ee\u5f55\u4e2d\u7684\u8ba1\u7b97\u673a\u6307\u5b9a\u914d\u7f6e\u65b9\u6cd5\uff1aCitrix\u5de5\u5177\uff08 Citrix Provisioning \u6216 MCS \uff09\u6216\u5176\u4ed6\u5de5\u5177\u3002\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u73b0\u6709\u955c\u50cf\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u5fc5\u987b\u5355\u72ec\u7ba1\u7406\u76ee\u6807\u8bbe\u5907\uff0c\u6216\u4f7f\u7528\u7b2c\u4e09\u65b9 electronic software distribution\uff08ESD\uff09 \u5de5\u5177\u5171\u540c\u7ba1\u7406\u76ee\u6807\u8bbe\u5907\u3002 \u5408\u9002\u7684\u673a\u5668\u7c7b\u578b\uff1a Server OS machines \uff1a\u670d\u52a1\u5668\u64cd\u4f5c\u7cfb\u7edf\u7684\u865a\u62df\u673a\u6216\u7269\u7406\u673a\u3002 \u7528\u4e8e\u63d0\u4f9bCitrix Virtual Apps\u53d1\u5e03\u7684\u5e94\u7528\u7a0b\u5e8f\uff08\u4e5f\u79f0\u4e3a\u57fa\u4e8e\u670d\u52a1\u5668 server-based \u7684\u6258\u7ba1\u5e94\u7528\u7a0b\u5e8f\uff09\u548cCitrix Virtual Apps\u53d1\u5e03\u7684\u684c\u9762\uff08\u4e5f\u79f0\u4e3a\u670d\u52a1\u5668\u6258\u7ba1 server-hosted \u7684\u684c\u9762\uff09\u3002\u8fd9\u4e9b\u673a\u5668\u5141\u8bb8\u591a\u4e2a\u7528\u6237\u540c\u65f6\u8fde\u63a5\u5230\u5b83\u4eec\u3002 Desktop OS machines \uff1a\u684c\u9762\u64cd\u4f5c\u7cfb\u7edf\u7684\u865a\u62df\u673a\u6216\u7269\u7406\u673a\u3002 \u7528\u4e8e\u63d0\u4f9bVDI\u684c\u9762\uff08\u8fd0\u884c\u53ef\u9009\u62e9\u4e2a\u6027\u5316\u7684\u684c\u9762\u64cd\u4f5c\u7cfb\u7edf\u7684\u684c\u9762\uff09\uff0cVM\u6258\u7ba1\u7684\u5e94\u7528\u7a0b\u5e8f\uff08\u684c\u9762\u64cd\u4f5c\u7cfb\u7edf\u7684\u5e94\u7528\u7a0b\u5e8f\uff09\u548c\u6258\u7ba1\u7684\u7269\u7406\u684c\u9762\u3002\u4e00\u6b21\u53ea\u80fd\u6709\u4e00\u4e2a\u7528\u6237\u8fde\u63a5\u5230\u6bcf\u4e2a\u684c\u9762\u3002 Remote PC Access \uff1a\u5141\u8bb8\u8fdc\u7a0b\u7528\u6237\u4ece\u8fd0\u884c Citrix Workspace \u5e94\u7528\u7a0b\u5e8f\u7684\u4efb\u4f55\u8bbe\u5907\u8bbf\u95ee\u5176\u7269\u7406\u529e\u516c\u5ba4PC\u3002 \u529e\u516c\u5ba4PC\u901a\u8fc7Citrix Virtual Desktops\u90e8\u7f72\u8fdb\u884c\u7ba1\u7406\uff0c\u5e76\u8981\u6c42\u5728\u767d\u540d\u5355\u4e2d\u6307\u5b9a\u7528\u6237\u8bbe\u5907\u3002","title":"1.6.1 Machine catalogs"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#162-delivery-groups","text":"Delivery Groups \u6307\u5b9a\u4e86\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u54ea\u4e9b\u673a\u5668\u7684\u54ea\u4e9b\u5e94\u7528\u6216\u684c\u9762\u3002 Delivery Groups \u5305\u542b\u4e86\u673a\u5668\u76ee\u5f55\u4e2d\u7684\u673a\u5668\uff0c\u4ee5\u53ca\u548c\u6709\u6743\u8bbf\u95ee Site \u7684 Active Directory \u7528\u6237\u3002 Delivery Groups\u53ef\u4ee5\u5305\u62ec\u591a\u4e2a\u76ee\u5f55\u7684\u591a\u4e2a\u673a\u5668\uff0c\u6bcf\u4e2a\u76ee\u5f55\u4e5f\u53ef\u4ee5\u5411\u591a\u4e2aDelivery Groups\u8d21\u732e\u673a\u5668\u3002\u4f46\u662f\u5355\u72ec\u7684\u673a\u5668\u540c\u65f6\u53ea\u80fd\u5c5e\u4e8e\u4e00\u4e2aDelivery Groups\u3002 \u66f4\u591a\u8bf7\u53c2\u8003 Create Delivery Groups \u3002","title":"1.6.2 Delivery Groups"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#163-application-groups","text":"Application Groups\u63d0\u4f9b\u65b9\u4fbf\u7684\u5e94\u7528\u7ba1\u7406\u548c\u8d44\u6e90\u63a7\u5236\u3002 \u66f4\u591a\u8bf7\u53c2\u8003 Create Application Groups \u3002","title":"1.6.3 Application Groups"},{"location":"citrix/00%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/#2-active-directory","text":"\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u9700\u8981 Active Directory \u3002 \u8981\u4f7f\u7528\u7b56\u7565\u5efa\u6a21,\u57df\u63a7\u5236\u5668\u5fc5\u987b\u5728 Windows Server 2003 \u5230 Windows Server 2012 R2 \u4e0a\u8fd0\u884c;\u8fd9\u4e0d\u4f1a\u5f71\u54cd\u57df\u529f\u80fd\u7ea7\u522b\u3002 \u6b64\u4ea7\u54c1\u652f\u6301\uff1a \u7528\u6237\u5e10\u6237\u548c\u8ba1\u7b97\u673a\u5e10\u6237\u5b58\u5728\u4e8e\u5355\u4e2a Active Directory \u6797\u7684\u57df\u4e2d\u7684\u90e8\u7f72\u3002 \u7528\u6237\u548c\u8ba1\u7b97\u673a\u5e10\u6237\u53ef\u4ee5\u5b58\u5728\u4e8e\u5355\u4e2a\u6797\u4e2d\u7684\u4efb\u610f\u57df\u4e2d\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u90e8\u7f72\u652f\u6301\u6240\u6709\u57df\u529f\u80fd\u7ea7\u522b\u548c\u6797\u529f\u80fd\u7ea7\u522b\u3002 \u5176\u4e2d\u7528\u6237\u5e10\u6237\u5b58\u5728\u4e8e\u6d3b\u52a8\u76ee\u5f55\u6797\u4e2d\uff0c\u4e0e\u5305\u542b\u63a7\u5236\u5668\u548c\u865a\u62df\u684c\u9762\u7684\u8ba1\u7b97\u673a\u5e10\u6237\u7684 Active Directory \u6797\u4e0d\u540c\u7684\u90e8\u7f72\u3002 \u5305\u542b Controller and virtual desktop computer \u5e10\u6237\u7684\u57df\u5fc5\u987b\u4fe1\u4efb\u5305\u542b\u7528\u6237\u5e10\u6237\u7684\u57df\u3002\u53ef\u4ee5\u4f7f\u7528\u6797\u4fe1\u4efb\u6216\u5916\u90e8\u4fe1\u4efb\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u90e8\u7f72\u652f\u6301\u6240\u6709\u57df\u529f\u80fd\u7ea7\u522b\u548c\u6797\u529f\u80fd\u7ea7\u522b\u3002 Active Directory \u6797\u4e2d\u5b58\u5728\u8ba1\u7b97\u673a\u5e10\u6237\u63a7\u5236\u5668\uff0c\u8be5\u6797\u4e0d\u540c\u4e8e\u5305\u542b\u865a\u62df\u684c\u9762\u7684\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5176\u4ed6 Active Directory \u6797\u7684\u90e8\u7f72\u3002 \u5305\u542bController\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u57df\u4e0e\u5305\u542b\u865a\u62df\u684c\u9762\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u6240\u6709\u57df\u4e4b\u95f4\u5fc5\u987b\u5b58\u5728\u53cc\u5411\u4fe1\u4efb\u3002\u5305\u542bController\u6216\u865a\u62df\u684c\u9762\u8ba1\u7b97\u673a\u5e10\u6237\u7684\u6240\u6709\u57df\u5fc5\u987b\u5904\u4e8e\"Windows 2000 native\"\u529f\u80fd\u7ea7\u522b\u6216\u66f4\u9ad8\u3002\u652f\u6301\u6240\u6709\u6797\u529f\u80fd\u7ea7\u522b\u3002 \u53ef\u5199\u57df\u63a7\u5236\u5668\u3002\u4e0d\u652f\u6301\u53ea\u8bfb\u57df\u63a7\u5236\u5668\u3002","title":"2. Active Directory"},{"location":"citrix/01%E5%AE%89%E8%A3%85/","text":"\u5b89\u88c5\u8981\u6c42 1. \u5728\u54ea\u91cc\u5b89\u88c5\u7ec4\u4ef6 \u00b6 \u53ef\u4ee5\u5728\u540c\u4e00\u4e2a\u6216\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u6838\u5fc3\u7ec4\u4ef6\u3002 \u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u6240\u6709\u6838\u5fc3\u7ec4\u4ef6\u53ef\u7528\u4e8e\u8bc4\u4f30\u3001\u6d4b\u8bd5\u6216\u5c0f\u578b\u751f\u4ea7\u90e8\u7f72\u3002 \u4e3a\u4e86\u9002\u5e94\u672a\u6765\u7684\u6269\u5c55\uff0c\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u7ec4\u4ef6\u3002 \u5bf9\u4e8e\u5927\u591a\u6570\u4ea7\u54c1\u90e8\u7f72\uff0c\u5efa\u8bae\u5728\u5206\u79bb\u7684\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u6838\u5fc3\u7ec4\u4ef6\u3002 \u4e3a\u4e86\u5728 Server Core OS \uff08\u4f8b\u5982 Delivery Controller \uff09\u5b89\u88c5\u4e00\u4e2a\u652f\u6301\u7684\u7ec4\u4ef6\uff0c\u5fc5\u987b\u4f7f\u7528\u547d\u4ee4\u884c\u3002\u90a3\u79cd\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u4e0d\u63d0\u4f9b\u56fe\u5f62\u5316\u63a5\u53e3\uff0c\u6240\u4ee5\u5728\u5176\u4ed6\u5730\u65b9\u5b89\u88c5Studio\u548c\u5176\u4ed6\u5de5\u5177\uff0c\u7136\u540e\u5c06\u4ed6\u4eec\u6307\u5411Controller\u670d\u52a1\u5668\u3002 \u786e\u4fdd\u6bcf\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u6709\u6700\u65b0\u7684\u66f4\u65b0\u3002\u786e\u4fdd\u6240\u6709\u7684\u673a\u5668\u6709\u76f8\u540c\u7684\u7cfb\u7edf\u65f6\u95f4\u3002\u5fc5\u987b\u6709\u81f3\u5c11\u4e00\u4e2a\u57df\u63a7\u5668\u8fd0\u884c Active Directory Domain Services \u3002\u82e5\u60f3\u5c06Delivery Controller\u548cVDA\u5b89\u88c5\u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\uff0c\u9700\u8981\u5148\u5b89\u88c5Controller\uff0c\u518d\u5b89\u88c5VDA\u3002 \u4ee5\u4e0b\u662f \u7981\u5fcc \uff1a \u4e0d\u8981\u5728\u4e00\u4e2a Active Directory \u57df\u63a7\u5668\u4e0a\u5b89\u88c5\u4efb\u4f55\u7ec4\u4ef6\u3002 \u4e0d\u652f\u6301\u5728 SQL Server \u7fa4\u96c6\u5b89\u88c5\u3001SQL Server \u955c\u50cf\u5b89\u88c5\u6216\u8fd0\u884c Hyper-V \u7684\u670d\u52a1\u5668\u4e0a\u7684\u8282\u70b9\u4e0a\u5b89\u88c5Controller\u3002 \u8bf7\u52ff\u5728\u8fd0\u884c XenApp 6.5 \u529f\u80fd\u5305 2 \u7684\u670d\u52a1\u5668\u4e0a\u5b89\u88c5 Studio\uff0c\u9002\u7528\u4e8e Windows Server 2008 R2 \u6216\u4efb\u4f55\u65e9\u671f\u7248\u672c\u7684 XenApp\u3002 \u5728 Studio \u4e2d\u6307\u5b9a\u7ec4\u7ec7\u5355\u4f4d\u540d\u79f0\u65f6,\u4e0d\u8981\u4f7f\u7528\u6b63\u659c\u6760 (/)\u3002","title":"01\u5b89\u88c5"},{"location":"citrix/01%E5%AE%89%E8%A3%85/#1","text":"\u53ef\u4ee5\u5728\u540c\u4e00\u4e2a\u6216\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u6838\u5fc3\u7ec4\u4ef6\u3002 \u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u6240\u6709\u6838\u5fc3\u7ec4\u4ef6\u53ef\u7528\u4e8e\u8bc4\u4f30\u3001\u6d4b\u8bd5\u6216\u5c0f\u578b\u751f\u4ea7\u90e8\u7f72\u3002 \u4e3a\u4e86\u9002\u5e94\u672a\u6765\u7684\u6269\u5c55\uff0c\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u7ec4\u4ef6\u3002 \u5bf9\u4e8e\u5927\u591a\u6570\u4ea7\u54c1\u90e8\u7f72\uff0c\u5efa\u8bae\u5728\u5206\u79bb\u7684\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u6838\u5fc3\u7ec4\u4ef6\u3002 \u4e3a\u4e86\u5728 Server Core OS \uff08\u4f8b\u5982 Delivery Controller \uff09\u5b89\u88c5\u4e00\u4e2a\u652f\u6301\u7684\u7ec4\u4ef6\uff0c\u5fc5\u987b\u4f7f\u7528\u547d\u4ee4\u884c\u3002\u90a3\u79cd\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u4e0d\u63d0\u4f9b\u56fe\u5f62\u5316\u63a5\u53e3\uff0c\u6240\u4ee5\u5728\u5176\u4ed6\u5730\u65b9\u5b89\u88c5Studio\u548c\u5176\u4ed6\u5de5\u5177\uff0c\u7136\u540e\u5c06\u4ed6\u4eec\u6307\u5411Controller\u670d\u52a1\u5668\u3002 \u786e\u4fdd\u6bcf\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u6709\u6700\u65b0\u7684\u66f4\u65b0\u3002\u786e\u4fdd\u6240\u6709\u7684\u673a\u5668\u6709\u76f8\u540c\u7684\u7cfb\u7edf\u65f6\u95f4\u3002\u5fc5\u987b\u6709\u81f3\u5c11\u4e00\u4e2a\u57df\u63a7\u5668\u8fd0\u884c Active Directory Domain Services \u3002\u82e5\u60f3\u5c06Delivery Controller\u548cVDA\u5b89\u88c5\u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\uff0c\u9700\u8981\u5148\u5b89\u88c5Controller\uff0c\u518d\u5b89\u88c5VDA\u3002 \u4ee5\u4e0b\u662f \u7981\u5fcc \uff1a \u4e0d\u8981\u5728\u4e00\u4e2a Active Directory \u57df\u63a7\u5668\u4e0a\u5b89\u88c5\u4efb\u4f55\u7ec4\u4ef6\u3002 \u4e0d\u652f\u6301\u5728 SQL Server \u7fa4\u96c6\u5b89\u88c5\u3001SQL Server \u955c\u50cf\u5b89\u88c5\u6216\u8fd0\u884c Hyper-V \u7684\u670d\u52a1\u5668\u4e0a\u7684\u8282\u70b9\u4e0a\u5b89\u88c5Controller\u3002 \u8bf7\u52ff\u5728\u8fd0\u884c XenApp 6.5 \u529f\u80fd\u5305 2 \u7684\u670d\u52a1\u5668\u4e0a\u5b89\u88c5 Studio\uff0c\u9002\u7528\u4e8e Windows Server 2008 R2 \u6216\u4efb\u4f55\u65e9\u671f\u7248\u672c\u7684 XenApp\u3002 \u5728 Studio \u4e2d\u6307\u5b9a\u7ec4\u7ec7\u5355\u4f4d\u540d\u79f0\u65f6,\u4e0d\u8981\u4f7f\u7528\u6b63\u659c\u6760 (/)\u3002","title":"1. \u5728\u54ea\u91cc\u5b89\u88c5\u7ec4\u4ef6"},{"location":"m4/11.%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E7%9A%84%E5%AE%8F/","text":"\u641c\u7d22\u6b63\u5219\u8868\u8fbe\u5f0f \u00b6 regexp (string, regexp, [replacement]) \u5728 string \u4e2d\u641c\u7d22 regexp \u3002 \u6ca1\u6709 replacement \uff0c\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u5b57\u7b26\u4e32\u7684\u4f4d\u7f6e\u3002\u6ca1\u6709\u5339\u914d\uff0c\u8fd4\u56de-1\u3002 \u7ed9\u51fa\u4e86 replacement \uff0c\u5e76\u4e14\u6709\u5339\u914d\u7684\u5b57\u7b26\u4e32\uff0c\u4f7f\u7528 \\n \u66ff\u6362 regexp \u7684\u7b2c n \u4e2a\u5e26\u62ec\u53f7\u7684\u5b50\u8868\u8fbe\u5f0f\u7684\u5339\u914d\u6587\u672c\uff0c\u6700\u591a\u4e5d\u4e2a\u5b50\u8868\u8fbe\u5f0f\u3002 \\& \u66ff\u6362\u6574\u4e2a\u5339\u914d\u6587\u672c\u3002\u6ca1\u6709\u5339\u914d\u5219\u7f6e\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002 VERSION = \"Wine version 3.0\" regexp(m4_include(VERSION),[version \\([-.0-9A-Za-z]+\\)],[\\1])","title":"11.\u6587\u672c\u5904\u7406\u7684\u5b8f"},{"location":"m4/11.%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E7%9A%84%E5%AE%8F/#_1","text":"regexp (string, regexp, [replacement]) \u5728 string \u4e2d\u641c\u7d22 regexp \u3002 \u6ca1\u6709 replacement \uff0c\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u5b57\u7b26\u4e32\u7684\u4f4d\u7f6e\u3002\u6ca1\u6709\u5339\u914d\uff0c\u8fd4\u56de-1\u3002 \u7ed9\u51fa\u4e86 replacement \uff0c\u5e76\u4e14\u6709\u5339\u914d\u7684\u5b57\u7b26\u4e32\uff0c\u4f7f\u7528 \\n \u66ff\u6362 regexp \u7684\u7b2c n \u4e2a\u5e26\u62ec\u53f7\u7684\u5b50\u8868\u8fbe\u5f0f\u7684\u5339\u914d\u6587\u672c\uff0c\u6700\u591a\u4e5d\u4e2a\u5b50\u8868\u8fbe\u5f0f\u3002 \\& \u66ff\u6362\u6574\u4e2a\u5339\u914d\u6587\u672c\u3002\u6ca1\u6709\u5339\u914d\u5219\u7f6e\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002 VERSION = \"Wine version 3.0\" regexp(m4_include(VERSION),[version \\([-.0-9A-Za-z]+\\)],[\\1])","title":"\u641c\u7d22\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"m4/6.%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E3%80%81%E9%80%92%E5%BD%92/","text":"6.1 \u68c0\u6d4b\u4e00\u4e2a\u5b8f\u662f\u5426\u88ab\u5b9a\u4e49 \u00b6 m4\u4e2d\u5b58\u5728\u4e24\u4e2a\u4e0d\u540c\u7684\u5185\u7f6e\u6761\u4ef6\u3002\u7b2c\u4e00\u4e2a\u662f ifdef \uff0c\u7b2c\u4e8c\u4e2a\u662f ifelse \u3002 ifdef (name, string-1, [string-2]) \u00b6 \u5982\u679c name \u88ab\u5b9a\u4e49\u4e3a\u4e86\u5b8f\uff0c\u90a3\u4e48\u6269\u5c55\u5230 string-1 \uff0c\u5426\u5219\u5230 string-2 \u3002\u5982\u679c string-2 \u6ca1\u6709\uff0c\u90a3\u4e48\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002 ifdef(`foo', ``foo' is defined', ``foo' is not defined') \u21d2foo is not defined define(`foo', `') \u21d2 ifdef(`foo', ``foo' is defined', ``foo' is not defined') \u21d2foo is defined ifdef(`no_such_macro', `yes', `no', `extra argument') error\u2192m4:stdin:4: Warning: excess arguments to builtin `ifdef' ignored \u21d2no 6.2 if-else \u7ed3\u6784\uff0c\u591a\u5206\u652f \u00b6 ifelse (comment) \u00b6 ifelse (string-1, string-2, equal, [not-equal]) \u00b6 ifelse (string-1, string-2, equal-1, string-3, string-4, equal-2, \u2026, [not-equal]) \u00b6 \u4f20\u5165\u4e00\u4e2a\u53c2\u6570\uff1a\u5c06\u5ffd\u7565\u53c2\u6570\u4e14\u6ca1\u6709\u4efb\u4f55\u8f93\u51fa\u3002 \u4e09\u4e2a\u6216\u56db\u4e2a\u53c2\u6570\uff1a string-1 == string-2 \uff0c ifelse \u6269\u5c55\u5230 equal \uff1b\u5426\u5219\u5230 not-equal \u3002\u6700\u540e\u7684\u7b2c\u4e94\u4e2a\u53c2\u6570\u4f1a\u88ab\u5ffd\u7565\u3002 \u4f20\u5165\u516d\u4e2a\u6216\u66f4\u591a\u53c2\u6570\uff1a string-1 == string-2 \uff0c ifelse \u6269\u5c55\u5230 equal-1 \uff1b\u5426\u5219\u524d\u4e09\u4e2a\u53c2\u6570\u88ab\u5ffd\u7565\uff0c\u91cd\u65b0\u8ba1\u7b97\u3002 1\u4e2a\u53c2\u6570\u7684\u60c5\u51b5\u53ef\u4ee5\u4ee3\u66ff dnl \u4f5c\u4e3a\u6ce8\u91ca\u6765\u4f7f\u7528\uff1a ifelse(`some comments') \u21d2 3~4\u4e2a\u53c2\u6570\uff1a ifelse(`foo', `bar', `true') \u21d2 ifelse(`foo', `foo', `true') \u21d2true define(`foo', `bar') \u21d2 ifelse(foo, `bar', `true', `false') \u21d2true ifelse(foo, `foo', `true', `false') \u21d2false","title":"6.\u6761\u4ef6\u3001\u5faa\u73af\u3001\u9012\u5f52"},{"location":"m4/6.%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E3%80%81%E9%80%92%E5%BD%92/#61","text":"m4\u4e2d\u5b58\u5728\u4e24\u4e2a\u4e0d\u540c\u7684\u5185\u7f6e\u6761\u4ef6\u3002\u7b2c\u4e00\u4e2a\u662f ifdef \uff0c\u7b2c\u4e8c\u4e2a\u662f ifelse \u3002","title":"6.1 \u68c0\u6d4b\u4e00\u4e2a\u5b8f\u662f\u5426\u88ab\u5b9a\u4e49"},{"location":"m4/6.%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E3%80%81%E9%80%92%E5%BD%92/#ifdef-name-string-1-string-2","text":"\u5982\u679c name \u88ab\u5b9a\u4e49\u4e3a\u4e86\u5b8f\uff0c\u90a3\u4e48\u6269\u5c55\u5230 string-1 \uff0c\u5426\u5219\u5230 string-2 \u3002\u5982\u679c string-2 \u6ca1\u6709\uff0c\u90a3\u4e48\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002 ifdef(`foo', ``foo' is defined', ``foo' is not defined') \u21d2foo is not defined define(`foo', `') \u21d2 ifdef(`foo', ``foo' is defined', ``foo' is not defined') \u21d2foo is defined ifdef(`no_such_macro', `yes', `no', `extra argument') error\u2192m4:stdin:4: Warning: excess arguments to builtin `ifdef' ignored \u21d2no","title":"ifdef (name, string-1, [string-2])"},{"location":"m4/6.%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E3%80%81%E9%80%92%E5%BD%92/#62-if-else","text":"","title":"6.2 if-else \u7ed3\u6784\uff0c\u591a\u5206\u652f"},{"location":"m4/6.%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E3%80%81%E9%80%92%E5%BD%92/#ifelse-comment","text":"","title":"ifelse (comment)"},{"location":"m4/6.%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E3%80%81%E9%80%92%E5%BD%92/#ifelse-string-1-string-2-equal-not-equal","text":"","title":"ifelse (string-1, string-2, equal, [not-equal])"},{"location":"m4/6.%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E3%80%81%E9%80%92%E5%BD%92/#ifelse-string-1-string-2-equal-1-string-3-string-4-equal-2-not-equal","text":"\u4f20\u5165\u4e00\u4e2a\u53c2\u6570\uff1a\u5c06\u5ffd\u7565\u53c2\u6570\u4e14\u6ca1\u6709\u4efb\u4f55\u8f93\u51fa\u3002 \u4e09\u4e2a\u6216\u56db\u4e2a\u53c2\u6570\uff1a string-1 == string-2 \uff0c ifelse \u6269\u5c55\u5230 equal \uff1b\u5426\u5219\u5230 not-equal \u3002\u6700\u540e\u7684\u7b2c\u4e94\u4e2a\u53c2\u6570\u4f1a\u88ab\u5ffd\u7565\u3002 \u4f20\u5165\u516d\u4e2a\u6216\u66f4\u591a\u53c2\u6570\uff1a string-1 == string-2 \uff0c ifelse \u6269\u5c55\u5230 equal-1 \uff1b\u5426\u5219\u524d\u4e09\u4e2a\u53c2\u6570\u88ab\u5ffd\u7565\uff0c\u91cd\u65b0\u8ba1\u7b97\u3002 1\u4e2a\u53c2\u6570\u7684\u60c5\u51b5\u53ef\u4ee5\u4ee3\u66ff dnl \u4f5c\u4e3a\u6ce8\u91ca\u6765\u4f7f\u7528\uff1a ifelse(`some comments') \u21d2 3~4\u4e2a\u53c2\u6570\uff1a ifelse(`foo', `bar', `true') \u21d2 ifelse(`foo', `foo', `true') \u21d2true define(`foo', `bar') \u21d2 ifelse(foo, `bar', `true', `false') \u21d2true ifelse(foo, `foo', `true', `false') \u21d2false","title":"ifelse (string-1, string-2, equal-1, string-3, string-4, equal-2, \u2026, [not-equal])"},{"location":"m4/%E7%AE%80%E4%BB%8B/","text":"m4\u662f\u4e00\u4e2a\u5b8f\u5904\u7406\u5668\u3002\u6709\u5185\u90e8\u5b8f\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u5b8f\u3002 \u6587\u6863\u9605\u8bfb\u624b\u518c \u00b6 \u6b64\u6587\u6863\u7684\u63d0\u793a\u7b26\uff1a\u8f93\u51fa\u7528 \u21d2 \uff0c\u9519\u8bef\u4fe1\u606f\u7528 error\u2192 \uff0c\u547d\u4ee4\u884c\u4f7f\u7528 $ $ command line to invoke m4 Example of input line \u21d2Output line from m4 error\u2192and an error message m4\u7684\u65e0\u53c2\u5b8f\u8c03\u7528\u53ea\u8981\u5199\u540d\u5b57 name \u5373\u53ef\uff1b\u5982\u679c\u52a0\u4e86\u62ec\u53f7 name() \uff0c\u90a3\u4e48\u8c03\u7528\u65f6\u6709\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\u53c2\u6570\u4f20\u5165\uff0c\u800c\u4e0d\u662f\u65e0\u53c2\u8c03\u7528\u3002 \u4e3a\u4e86\u9632\u6b62\u5b8f\u8c03\u7528\uff0c\u53ef\u4ee5\u52a0\u4e0a\u9009\u9879 -P \uff0c\u8fd9\u6837\u5728\u6bcf\u6b21\u8c03\u7528\u5185\u7f6e\u5b8f\u7684\u65f6\u5019\uff0c\u90fd\u9700\u8981\u52a0\u4e0a\u524d\u7f00 m4_ \uff0c\u8fd9\u5bf9\u81ea\u5b9a\u4e49\u7684\u5b8f\u6ca1\u6709\u5f71\u54cd \u81ea\u5b9a\u4e49\u5b8f \u00b6 eg. define(`foo', `Hello world.') \u91cd\u590d\u5b9a\u4e49\u4f1a\u8986\u76d6pushdef\u6700\u9ad8\u7684\u5b9a\u4e49\uff0c\u5982\u679c\u4f7f\u7528undefined\u5220\u9664\uff0c\u90a3\u4e48\u6240\u6709\u7684\u5b9a\u4e49\u90fd\u4f1a\u88ab\u5220\u9664 define(foo, one) \u21d2 define(foo, two) \u21d2 one \u21d2two \u53ef\u4ee5\u4f7f\u7528 $n \u4ee3\u8868\u7b2cn\u4e2a\u8f93\u5165\u53c2\u6570\uff0c $0 \u4ee3\u8868\u5b8f\u540d define(`exch', `$2, $1') \u21d2 exch(`arg1', `arg2') \u21d2arg2, arg1 \u5982\u679c\u60f3\u8981\u5f15\u7528\u7684text\u6210\u4e3a\u6269\u5c55text\u7684\u4e00\u90e8\u5206\uff0c\u90a3\u4e48\u4f7f\u7528\u53cc\u91cd\u5f15\u7528 define(`foo', `This is macro `foo'.') \u21d2 foo \u21d2This is macro foo. \u91cd\u547d\u540d\u5b8f \u00b6 defn(name\u2026) \u5982\u679cname\u662f\u81ea\u5b9a\u4e49\u5b8f\uff0c\u90a3\u4e48\u4e45\u53ea\u662f\u7b80\u5355\u7684\u5f15\u7528\u3002\u5982\u679c\u53ea\u6709\u4e00\u4e2aname\u5e76\u4e14\u662f\u5185\u7f6e\u5b8f\uff0c\u6269\u5c55\u53ea\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u6807\u8bb0\uff0c\u6307\u5411\u5185\u90e8\u5b9a\u4e49\u3002 \u6267\u884cshell\u547d\u4ee4 \u00b6 \u4e0e\u5b50\u8fdb\u7a0b\u5171\u4eab\u8f93\u5165\uff0c\u5373\u5b50\u8fdb\u7a0b\u4f1a\u5904\u7406\u4e0b\u4e00\u4e2a\u8f93\u5165\u3002 syscmd(shell-command) \u4e0d\u4f1a\u8f93\u51fa\u6267\u884c\u7ed3\u679c\u548c\u9519\u8bef\u4fe1\u606f\uff0c\u4f7f\u7528 esyscmd(shell-command) \u5373\u53ef\u8f93\u51fa\u3002 dnl \u00b6 \u4ece\u5f53\u524d\u5f00\u59cb\u5220\u9664\u5230\u4e0b\u4e00\u884c define(`foo', `Macro `foo'.')dnl A very simple macro, indeed. foo \u21d2Macro foo. \u6539\u53d8\u5f15\u7528\u7b26\u53f7 \u00b6 changequote ( ` [ ', ` ] ' ) \u21d2 define ( [ foo ] , [ Macro [foo ] . ] ) \u21d2 foo \u21d2 Macro foo . \u6539\u53d8\u6ce8\u91ca\u7684\u5206\u9694\u7b26 \u00b6 changecom([start], [end = \u2018NL\u2019]) \u8f93\u5165\u6307\u5b9a\u6587\u4ef6 \u00b6 \u4e24\u4e2a\u547d\u4ee4\u90fd\u662f\u8c03\u7528m4\u8bfb\u53d6\u6587\u4ef6\u3002 include(file) \u3001 sinclude(file) \u3002\u8981\u4e0e -I \u9009\u9879\u914d\u5408\u4f7f\u7528 \u6587\u4ef6\u5185\u5bb9\u53ef\u80fd\u4f1a\u5f71\u54cd\u5230m4\u7684\u8f93\u51fa\uff0c\u53ef\u4ee5\u914d\u5408divert\u4f7f\u7528\u3002 divert\uff0c\u5b58\u50a8\u5b57\u7b26\u4e32 \u00b6 \u7528\u6cd5\uff1a \u5b58\u50a8\u5185\u5bb9 divert(\u7f16\u53f7) \u5185\u5bb9 divert \u21d2 \u91ca\u653e\u5185\u5bb9 undivert(`1') \u21d2 \u21d2This text is diverted. \u21d2 tag \uff1a\u91ca\u653e\u65f6\u6709\u4e24\u884c\u7a7a\u884c\u3002","title":"\u7b80\u4ecb"},{"location":"m4/%E7%AE%80%E4%BB%8B/#_1","text":"\u6b64\u6587\u6863\u7684\u63d0\u793a\u7b26\uff1a\u8f93\u51fa\u7528 \u21d2 \uff0c\u9519\u8bef\u4fe1\u606f\u7528 error\u2192 \uff0c\u547d\u4ee4\u884c\u4f7f\u7528 $ $ command line to invoke m4 Example of input line \u21d2Output line from m4 error\u2192and an error message m4\u7684\u65e0\u53c2\u5b8f\u8c03\u7528\u53ea\u8981\u5199\u540d\u5b57 name \u5373\u53ef\uff1b\u5982\u679c\u52a0\u4e86\u62ec\u53f7 name() \uff0c\u90a3\u4e48\u8c03\u7528\u65f6\u6709\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\u53c2\u6570\u4f20\u5165\uff0c\u800c\u4e0d\u662f\u65e0\u53c2\u8c03\u7528\u3002 \u4e3a\u4e86\u9632\u6b62\u5b8f\u8c03\u7528\uff0c\u53ef\u4ee5\u52a0\u4e0a\u9009\u9879 -P \uff0c\u8fd9\u6837\u5728\u6bcf\u6b21\u8c03\u7528\u5185\u7f6e\u5b8f\u7684\u65f6\u5019\uff0c\u90fd\u9700\u8981\u52a0\u4e0a\u524d\u7f00 m4_ \uff0c\u8fd9\u5bf9\u81ea\u5b9a\u4e49\u7684\u5b8f\u6ca1\u6709\u5f71\u54cd","title":"\u6587\u6863\u9605\u8bfb\u624b\u518c"},{"location":"m4/%E7%AE%80%E4%BB%8B/#_2","text":"eg. define(`foo', `Hello world.') \u91cd\u590d\u5b9a\u4e49\u4f1a\u8986\u76d6pushdef\u6700\u9ad8\u7684\u5b9a\u4e49\uff0c\u5982\u679c\u4f7f\u7528undefined\u5220\u9664\uff0c\u90a3\u4e48\u6240\u6709\u7684\u5b9a\u4e49\u90fd\u4f1a\u88ab\u5220\u9664 define(foo, one) \u21d2 define(foo, two) \u21d2 one \u21d2two \u53ef\u4ee5\u4f7f\u7528 $n \u4ee3\u8868\u7b2cn\u4e2a\u8f93\u5165\u53c2\u6570\uff0c $0 \u4ee3\u8868\u5b8f\u540d define(`exch', `$2, $1') \u21d2 exch(`arg1', `arg2') \u21d2arg2, arg1 \u5982\u679c\u60f3\u8981\u5f15\u7528\u7684text\u6210\u4e3a\u6269\u5c55text\u7684\u4e00\u90e8\u5206\uff0c\u90a3\u4e48\u4f7f\u7528\u53cc\u91cd\u5f15\u7528 define(`foo', `This is macro `foo'.') \u21d2 foo \u21d2This is macro foo.","title":"\u81ea\u5b9a\u4e49\u5b8f"},{"location":"m4/%E7%AE%80%E4%BB%8B/#_3","text":"defn(name\u2026) \u5982\u679cname\u662f\u81ea\u5b9a\u4e49\u5b8f\uff0c\u90a3\u4e48\u4e45\u53ea\u662f\u7b80\u5355\u7684\u5f15\u7528\u3002\u5982\u679c\u53ea\u6709\u4e00\u4e2aname\u5e76\u4e14\u662f\u5185\u7f6e\u5b8f\uff0c\u6269\u5c55\u53ea\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u6807\u8bb0\uff0c\u6307\u5411\u5185\u90e8\u5b9a\u4e49\u3002","title":"\u91cd\u547d\u540d\u5b8f"},{"location":"m4/%E7%AE%80%E4%BB%8B/#shell","text":"\u4e0e\u5b50\u8fdb\u7a0b\u5171\u4eab\u8f93\u5165\uff0c\u5373\u5b50\u8fdb\u7a0b\u4f1a\u5904\u7406\u4e0b\u4e00\u4e2a\u8f93\u5165\u3002 syscmd(shell-command) \u4e0d\u4f1a\u8f93\u51fa\u6267\u884c\u7ed3\u679c\u548c\u9519\u8bef\u4fe1\u606f\uff0c\u4f7f\u7528 esyscmd(shell-command) \u5373\u53ef\u8f93\u51fa\u3002","title":"\u6267\u884cshell\u547d\u4ee4"},{"location":"m4/%E7%AE%80%E4%BB%8B/#dnl","text":"\u4ece\u5f53\u524d\u5f00\u59cb\u5220\u9664\u5230\u4e0b\u4e00\u884c define(`foo', `Macro `foo'.')dnl A very simple macro, indeed. foo \u21d2Macro foo.","title":"dnl"},{"location":"m4/%E7%AE%80%E4%BB%8B/#_4","text":"changequote ( ` [ ', ` ] ' ) \u21d2 define ( [ foo ] , [ Macro [foo ] . ] ) \u21d2 foo \u21d2 Macro foo .","title":"\u6539\u53d8\u5f15\u7528\u7b26\u53f7"},{"location":"m4/%E7%AE%80%E4%BB%8B/#_5","text":"changecom([start], [end = \u2018NL\u2019])","title":"\u6539\u53d8\u6ce8\u91ca\u7684\u5206\u9694\u7b26"},{"location":"m4/%E7%AE%80%E4%BB%8B/#_6","text":"\u4e24\u4e2a\u547d\u4ee4\u90fd\u662f\u8c03\u7528m4\u8bfb\u53d6\u6587\u4ef6\u3002 include(file) \u3001 sinclude(file) \u3002\u8981\u4e0e -I \u9009\u9879\u914d\u5408\u4f7f\u7528 \u6587\u4ef6\u5185\u5bb9\u53ef\u80fd\u4f1a\u5f71\u54cd\u5230m4\u7684\u8f93\u51fa\uff0c\u53ef\u4ee5\u914d\u5408divert\u4f7f\u7528\u3002","title":"\u8f93\u5165\u6307\u5b9a\u6587\u4ef6"},{"location":"m4/%E7%AE%80%E4%BB%8B/#divert","text":"\u7528\u6cd5\uff1a \u5b58\u50a8\u5185\u5bb9 divert(\u7f16\u53f7) \u5185\u5bb9 divert \u21d2 \u91ca\u653e\u5185\u5bb9 undivert(`1') \u21d2 \u21d2This text is diverted. \u21d2 tag \uff1a\u91ca\u653e\u65f6\u6709\u4e24\u884c\u7a7a\u884c\u3002","title":"divert\uff0c\u5b58\u50a8\u5b57\u7b26\u4e32"},{"location":"make/10.%E4%BD%BF%E7%94%A8%E9%9A%90%E5%90%AB%E8%A7%84%E5%88%99/","text":"10.5 \u5339\u914d\u89c4\u5219\u4e0e\u81ea\u52a8\u53d8\u91cf \u00b6 10.5.1 \u5339\u914d\u89c4\u5219\u4ecb\u7ecd \u00b6 % \u5b57\u7b26\u5339\u914d\u4efb\u4f55\u975e\u7a7a\u5b57\u7b26\u4e32\u3002 % \u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\u53eb\u505a stem \uff08\u8bcd\u5e72\uff09\u3002 prerequisites \u4e2d\u7684 % \u4ee3\u8868\u4e86\u76ee\u6807\u4e2d % \u5339\u914d\u7684\u540c\u6837\u7684 stem \u3002 %.o : %.c ; recipe\u2026 \u8981\u6c42xxx.c\u5fc5\u987b\u5b58\u5728\u6216\u8005\u53ef\u4ee5\u521b\u5efa\u3002 10.5.4 \u6a21\u5f0f\u662f\u5982\u4f55\u5339\u914d\u7684 \u00b6 \u6a21\u5f0f\u4e0d\u5305\u62ec / \u65f6\uff0c\u6587\u4ef6\u540d\u4e2d\u7684\u76ee\u5f55\u540d\u4f1a\u88ab\u5148\u79fb\u9664\uff0c\u5339\u914d\u5b8c\u6587\u4ef6\u540d\u7684\u90e8\u5206\u4e4b\u540e\uff0c\u518d\u628a\u76ee\u5f55\u90e8\u5206\u52a0\u4e0a\u6765\u3002\u4f8b\uff1a e%t \u5339\u914d\u6587\u4ef6 src/eat \uff0c stem \u5c31\u662f src/a \u3002 note \uff1a\u5df2\u7ecf\u5b58\u5728\u6216\u88ab\u5f15\u7528\u7684prerequisites\u7684\u4f18\u5148\u7ea7\u603b\u662f\u6bd4\u9700\u8981\u88ab\u5176\u5b83\u9690\u542b\u89c4\u5219\u521b\u5efa\u7684prerequisites\u9ad8\u3002 \u591a\u4e2a\u5339\u914d\u89c4\u5219\u6ee1\u8db3\u65f6\uff1a make\u4f1a\u9009\u62e9 stem \u6700\u77ed\u7684\u90a3\u4e2a\u89c4\u5219\u3002 \u5982\u679c stem \u7b49\u957f\uff0c\u9009\u62e9\u7b2c\u4e00\u4e2a\u53d1\u73b0\u7684\u89c4\u5219\u3002 10.5.5 \u5339\u914d\u4efb\u4f55\u6587\u4ef6\u7684\u6a21\u5f0f\u89c4\u5219 \u00b6 \u6a21\u5f0f\u89c4\u5219\u7684\u76ee\u6807\u53ea\u662f\u4e00\u4e2a % \u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u5339\u914d\u4efb\u4f55\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u79f0\u4f5c match-anything \u89c4\u5219\u3002 \u6bcf\u6b21\u5b9a\u4e49\u8fd9\u79cd\u89c4\u5219\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u9009\u62e9\u4e0b\u9762\u7684\u4e00\u9879\u8fdb\u884c\u7ea6\u675f\uff1a 1. \u4f7f\u7528 :: \u6807\u8bb0\u89c4\u5219\u4e3a terminal \uff0c\u53ea\u6709prerequisites\u5df2\u7ecf\u5b58\u5728\u7684\u65f6\u5019\u624d\u80fd\u5e94\u7528\u89c4\u5219\u3002 2. \u975e\u7ec8\u7aef\u89c4\u5219\u3002 non-terminal match-anything rule \u4e0d\u80fd\u5e94\u7528\u4e8e\u6307\u5b9a\u4e86\u6587\u4ef6\u7c7b\u578b\u7684\u6587\u4ef6\u540d\u3002\uff1f\uff1f\uff1f 10.5.3 \u81ea\u52a8\u53d8\u91cf \u00b6 \u81ea\u52a8\u53d8\u91cf\u53ea\u5728 recipe \u4e2d\u751f\u6548\u3002\u4f46\u662f\uff0cmake\u7684\u4e8c\u6b21\u6269\u5c55\u7279\u6027\uff08 see Secondary Expansion \uff09\u5141\u8bb8\u5728 prerequisites \u4e2d\u4f7f\u7528\u81ea\u52a8\u53d8\u91cf\u7684\u503c\u3002 $@ - \u76ee\u6807\u6587\u4ef6\u540d\u3002\u76ee\u6807\u662f\u5f52\u6863\u6210\u5458\u65f6\uff0c\u4ee3\u8868\u7684\u662f\u5f52\u6863\u6587\u4ef6\u540d\u3002\u5728\u6709\u591a\u4e2a\u751f\u6210\u76ee\u6807\u7684\u5339\u914d\u89c4\u5219\u60c5\u51b5\u4e0b\uff0c\u4ee3\u8868\u4e86\u4efb\u4f55\u5f15\u8d77recipe\u6267\u884c\u7684\u76ee\u6807\u6587\u4ef6\u3002 $% - \u76ee\u6807\u662f\u5f52\u6863\u6210\u5458\u65f6\uff0c\u4ee3\u8868\u76ee\u6807\u6210\u5458\u540d\u3002\u5426\u5219\u4e3a\u7a7a\u3002\u4f8b\u5982\uff1a\u5982\u679c\u76ee\u6807\u662ffoo.a(bar.o)\uff0c\u90a3\u4e48 $@ \u4ee3\u8868foo.a\uff0c $% \u4ee3\u8868bar.o\u3002 $< - \u7b2c\u4e00\u4e2a prerequisites \u7684\u540d\u5b57\u3002\u5982\u679c\u76ee\u6807\u4ece\u9690\u542b\u89c4\u5219\u6267\u884crecipe\uff0c\u8fd9\u4f1a\u6210\u4e3a\u7b2c\u4e00\u4e2a prerequisite \u3002 see Implicit Rules . $? - \u6240\u6709\u7684\u6bd4\u76ee\u6807\u65b0\u7684 prerequisites \u7684\u540d\u5b57\uff0c\u7a7a\u683c\u5206\u9694\u3002\u5bf9\u4e8e\u662f\u5f52\u6863\u6210\u5458\u7684prerequisites\uff0c\u53ea\u6709\u547d\u540d\u7684\u6210\u5458\u88ab\u4f7f\u7528\u3002\uff1f\uff1f\uff1f $^ - \u6240\u6709\u7684 prerequisites \uff0c\u7a7a\u683c\u5206\u9694\u3002\u5f52\u6863\u6210\u5458\u7684\u89c4\u5219\u540c\u4e0a\u3002\u5982\u679cprerequisites\u4e2d\u6709\u91cd\u590d\u591a\u6b21\u7684 prerequisite \uff0c\u90a3\u4e48\u8be5\u53d8\u91cf\u53ea\u4f1a\u5305\u542b\u4e00\u4e2a\u91cd\u590d\u7684 prerequisite \u3002\u6b64\u53d8\u91cf\u4e0d\u5305\u62ec order-only prerequisites \uff08\u6307\u53ea\u6709\u76ee\u6807\u4e0d\u5b58\u5728\u7684\u65f6\u5019\u624d\u4f1a\u53c2\u4e0e\u76ee\u6807\u7684\u751f\u6210\u7684prerequisites\uff0c\u4e0e\u5e38\u89c4\u7684\u7528 | \u5206\u9694\uff09\u3002 $+ - \u4e0e $^ \u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u5b83\u5305\u542b\u91cd\u590d\u7684 prerequisite \u3002 $| - \u6240\u6709\u7684 order-only prerequisites \uff0c\u7a7a\u683c\u5206\u9694\u3002 $* - \u9690\u542b\u89c4\u5219\u5339\u914d\u7684\u8bcd\u5e72\u3002\u4ee5\u540e\u518d\u770b\uff01\uff01\uff01 $(@D) - \u76ee\u6807\u6587\u4ef6\u540d\u7684\u76ee\u5f55\u90e8\u5206\uff08\u53bb\u6389 / \uff09\u3002\u4f8b\uff1a$@='dir/foo.a'\uff0c$(@D)='dir'\u3002\u5982\u679c\u76ee\u6807\u6ca1\u6709 / \uff0c\u6b64\u503c\u4e3a . \u3002 $(@F) - \u76ee\u6807\u6587\u4ef6\u540d\u7684\u6587\u4ef6\u90e8\u5206\u3002\u4e0e $(notdir $@) \u76f8\u7b49\u3002 \u4ee5\u4e0b\u53d8\u91cf\u90fd\u662f\u7c7b\u4f3c\u7684\uff1a $(*D) $(*F) $(%D) $(%F) $(<D) $(<F) $(^D) $(^F) $(+D) $(+F) $(?D) $(?F)","title":"10.\u4f7f\u7528\u9690\u542b\u89c4\u5219"},{"location":"make/10.%E4%BD%BF%E7%94%A8%E9%9A%90%E5%90%AB%E8%A7%84%E5%88%99/#105","text":"","title":"10.5 \u5339\u914d\u89c4\u5219\u4e0e\u81ea\u52a8\u53d8\u91cf"},{"location":"make/10.%E4%BD%BF%E7%94%A8%E9%9A%90%E5%90%AB%E8%A7%84%E5%88%99/#1051","text":"% \u5b57\u7b26\u5339\u914d\u4efb\u4f55\u975e\u7a7a\u5b57\u7b26\u4e32\u3002 % \u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\u53eb\u505a stem \uff08\u8bcd\u5e72\uff09\u3002 prerequisites \u4e2d\u7684 % \u4ee3\u8868\u4e86\u76ee\u6807\u4e2d % \u5339\u914d\u7684\u540c\u6837\u7684 stem \u3002 %.o : %.c ; recipe\u2026 \u8981\u6c42xxx.c\u5fc5\u987b\u5b58\u5728\u6216\u8005\u53ef\u4ee5\u521b\u5efa\u3002","title":"10.5.1 \u5339\u914d\u89c4\u5219\u4ecb\u7ecd"},{"location":"make/10.%E4%BD%BF%E7%94%A8%E9%9A%90%E5%90%AB%E8%A7%84%E5%88%99/#1054","text":"\u6a21\u5f0f\u4e0d\u5305\u62ec / \u65f6\uff0c\u6587\u4ef6\u540d\u4e2d\u7684\u76ee\u5f55\u540d\u4f1a\u88ab\u5148\u79fb\u9664\uff0c\u5339\u914d\u5b8c\u6587\u4ef6\u540d\u7684\u90e8\u5206\u4e4b\u540e\uff0c\u518d\u628a\u76ee\u5f55\u90e8\u5206\u52a0\u4e0a\u6765\u3002\u4f8b\uff1a e%t \u5339\u914d\u6587\u4ef6 src/eat \uff0c stem \u5c31\u662f src/a \u3002 note \uff1a\u5df2\u7ecf\u5b58\u5728\u6216\u88ab\u5f15\u7528\u7684prerequisites\u7684\u4f18\u5148\u7ea7\u603b\u662f\u6bd4\u9700\u8981\u88ab\u5176\u5b83\u9690\u542b\u89c4\u5219\u521b\u5efa\u7684prerequisites\u9ad8\u3002 \u591a\u4e2a\u5339\u914d\u89c4\u5219\u6ee1\u8db3\u65f6\uff1a make\u4f1a\u9009\u62e9 stem \u6700\u77ed\u7684\u90a3\u4e2a\u89c4\u5219\u3002 \u5982\u679c stem \u7b49\u957f\uff0c\u9009\u62e9\u7b2c\u4e00\u4e2a\u53d1\u73b0\u7684\u89c4\u5219\u3002","title":"10.5.4 \u6a21\u5f0f\u662f\u5982\u4f55\u5339\u914d\u7684"},{"location":"make/10.%E4%BD%BF%E7%94%A8%E9%9A%90%E5%90%AB%E8%A7%84%E5%88%99/#1055","text":"\u6a21\u5f0f\u89c4\u5219\u7684\u76ee\u6807\u53ea\u662f\u4e00\u4e2a % \u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u5339\u914d\u4efb\u4f55\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u79f0\u4f5c match-anything \u89c4\u5219\u3002 \u6bcf\u6b21\u5b9a\u4e49\u8fd9\u79cd\u89c4\u5219\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u9009\u62e9\u4e0b\u9762\u7684\u4e00\u9879\u8fdb\u884c\u7ea6\u675f\uff1a 1. \u4f7f\u7528 :: \u6807\u8bb0\u89c4\u5219\u4e3a terminal \uff0c\u53ea\u6709prerequisites\u5df2\u7ecf\u5b58\u5728\u7684\u65f6\u5019\u624d\u80fd\u5e94\u7528\u89c4\u5219\u3002 2. \u975e\u7ec8\u7aef\u89c4\u5219\u3002 non-terminal match-anything rule \u4e0d\u80fd\u5e94\u7528\u4e8e\u6307\u5b9a\u4e86\u6587\u4ef6\u7c7b\u578b\u7684\u6587\u4ef6\u540d\u3002\uff1f\uff1f\uff1f","title":"10.5.5 \u5339\u914d\u4efb\u4f55\u6587\u4ef6\u7684\u6a21\u5f0f\u89c4\u5219"},{"location":"make/10.%E4%BD%BF%E7%94%A8%E9%9A%90%E5%90%AB%E8%A7%84%E5%88%99/#1053","text":"\u81ea\u52a8\u53d8\u91cf\u53ea\u5728 recipe \u4e2d\u751f\u6548\u3002\u4f46\u662f\uff0cmake\u7684\u4e8c\u6b21\u6269\u5c55\u7279\u6027\uff08 see Secondary Expansion \uff09\u5141\u8bb8\u5728 prerequisites \u4e2d\u4f7f\u7528\u81ea\u52a8\u53d8\u91cf\u7684\u503c\u3002 $@ - \u76ee\u6807\u6587\u4ef6\u540d\u3002\u76ee\u6807\u662f\u5f52\u6863\u6210\u5458\u65f6\uff0c\u4ee3\u8868\u7684\u662f\u5f52\u6863\u6587\u4ef6\u540d\u3002\u5728\u6709\u591a\u4e2a\u751f\u6210\u76ee\u6807\u7684\u5339\u914d\u89c4\u5219\u60c5\u51b5\u4e0b\uff0c\u4ee3\u8868\u4e86\u4efb\u4f55\u5f15\u8d77recipe\u6267\u884c\u7684\u76ee\u6807\u6587\u4ef6\u3002 $% - \u76ee\u6807\u662f\u5f52\u6863\u6210\u5458\u65f6\uff0c\u4ee3\u8868\u76ee\u6807\u6210\u5458\u540d\u3002\u5426\u5219\u4e3a\u7a7a\u3002\u4f8b\u5982\uff1a\u5982\u679c\u76ee\u6807\u662ffoo.a(bar.o)\uff0c\u90a3\u4e48 $@ \u4ee3\u8868foo.a\uff0c $% \u4ee3\u8868bar.o\u3002 $< - \u7b2c\u4e00\u4e2a prerequisites \u7684\u540d\u5b57\u3002\u5982\u679c\u76ee\u6807\u4ece\u9690\u542b\u89c4\u5219\u6267\u884crecipe\uff0c\u8fd9\u4f1a\u6210\u4e3a\u7b2c\u4e00\u4e2a prerequisite \u3002 see Implicit Rules . $? - \u6240\u6709\u7684\u6bd4\u76ee\u6807\u65b0\u7684 prerequisites \u7684\u540d\u5b57\uff0c\u7a7a\u683c\u5206\u9694\u3002\u5bf9\u4e8e\u662f\u5f52\u6863\u6210\u5458\u7684prerequisites\uff0c\u53ea\u6709\u547d\u540d\u7684\u6210\u5458\u88ab\u4f7f\u7528\u3002\uff1f\uff1f\uff1f $^ - \u6240\u6709\u7684 prerequisites \uff0c\u7a7a\u683c\u5206\u9694\u3002\u5f52\u6863\u6210\u5458\u7684\u89c4\u5219\u540c\u4e0a\u3002\u5982\u679cprerequisites\u4e2d\u6709\u91cd\u590d\u591a\u6b21\u7684 prerequisite \uff0c\u90a3\u4e48\u8be5\u53d8\u91cf\u53ea\u4f1a\u5305\u542b\u4e00\u4e2a\u91cd\u590d\u7684 prerequisite \u3002\u6b64\u53d8\u91cf\u4e0d\u5305\u62ec order-only prerequisites \uff08\u6307\u53ea\u6709\u76ee\u6807\u4e0d\u5b58\u5728\u7684\u65f6\u5019\u624d\u4f1a\u53c2\u4e0e\u76ee\u6807\u7684\u751f\u6210\u7684prerequisites\uff0c\u4e0e\u5e38\u89c4\u7684\u7528 | \u5206\u9694\uff09\u3002 $+ - \u4e0e $^ \u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u5b83\u5305\u542b\u91cd\u590d\u7684 prerequisite \u3002 $| - \u6240\u6709\u7684 order-only prerequisites \uff0c\u7a7a\u683c\u5206\u9694\u3002 $* - \u9690\u542b\u89c4\u5219\u5339\u914d\u7684\u8bcd\u5e72\u3002\u4ee5\u540e\u518d\u770b\uff01\uff01\uff01 $(@D) - \u76ee\u6807\u6587\u4ef6\u540d\u7684\u76ee\u5f55\u90e8\u5206\uff08\u53bb\u6389 / \uff09\u3002\u4f8b\uff1a$@='dir/foo.a'\uff0c$(@D)='dir'\u3002\u5982\u679c\u76ee\u6807\u6ca1\u6709 / \uff0c\u6b64\u503c\u4e3a . \u3002 $(@F) - \u76ee\u6807\u6587\u4ef6\u540d\u7684\u6587\u4ef6\u90e8\u5206\u3002\u4e0e $(notdir $@) \u76f8\u7b49\u3002 \u4ee5\u4e0b\u53d8\u91cf\u90fd\u662f\u7c7b\u4f3c\u7684\uff1a $(*D) $(*F) $(%D) $(%F) $(<D) $(<F) $(^D) $(^F) $(+D) $(+F) $(?D) $(?F)","title":"10.5.3 \u81ea\u52a8\u53d8\u91cf"},{"location":"make/11.%E4%BD%BF%E7%94%A8make%E6%9B%B4%E6%96%B0%E5%BD%92%E6%A1%A3%E6%96%87%E4%BB%B6/","text":"Archive files (\u5f52\u6863\u6587\u4ef6)\u662f\u5305\u542b\u4e86 sub-files \u7684\u6587\u4ef6\uff0c sub-files \u88ab\u79f0\u505a members \uff1b\u5b83\u4eec\u88ab ar \u7a0b\u5e8f\u7ef4\u62a4\uff0c\u4e3b\u8981\u7528\u9014\u662f\u4e3a\u94fe\u63a5\u4f5c\u4e3a\u5b50\u7a0b\u5e8f\u5e93\u3002 \u5f52\u6863\u6210\u5458\u4f5c\u4e3a\u76ee\u6807 \u00b6 \u4e00\u4e2a\u5355\u72ec\u7684\u5f52\u6863\u6587\u4ef6\u6210\u5458\u53ef\u4ee5\u88ab\u4f5c\u4e3a\u4e00\u4e2a target \u6216\u8005 prerequisite \u3002 archive(member) \u6b64\u7ed3\u6784\u53ea\u80fd\u5728 target \u548c prerequisites \u4e2d\u4f7f\u7528\u3002\u6700\u597d\u4f7f\u7528 ar \u6765\u7ba1\u7406\u3002 \u901a\u8fc7\u590d\u5236hack.o\u5728foolib\u4e2d\u521b\u5efa\u4e00\u4e2a\u6210\u5458hack.o\u6587\u4ef6\uff1a foolib(hack.o) : hack.o ar cr foolib hack.o \u4e8b\u5b9e\u4e0a\u51e0\u4e4e\u6240\u6709\u7684\u5f52\u6863\u6210\u5458\u76ee\u6807\u90fd\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u66f4\u65b0\u5e76\u4e14\u6709\u4e00\u4e2a\u9ed8\u8ba4\u89c4\u5219\u4e3a\u4f60\u505a\u8fd9\u4ef6\u4e8b\u3002\u5982\u679c\u5f52\u6863\u6587\u4ef6\u4e0d\u5b58\u5728\u5219\u9700\u8981\u4e3a ar \u52a0\u4e0a c flag\u3002 \u6307\u5b9a\u591a\u4e2a\u6210\u5458\uff1a foolib(hack.o kludge.o) \u4f7f\u7528\u901a\u914d\u7b26\uff1a foolib(*.o) \u5f52\u6863\u6210\u5458\u76ee\u6807\u7684\u9690\u542b\u89c4\u5219 \u00b6 make \"foo.a(bar.o)\": cc -c bar.c -o bar.o ar r foo.a bar.o rm -f bar.o \u6210\u5458\u4e0d\u80fd\u5305\u62ec\u4e00\u4e2a\u76ee\u5f55\u540d\uff0c\u4f46\u662f\u5728\u4e00\u4e2amakefile\u4e2d\u53ef\u80fd\u662f\u6709\u7528\u7684\u6765\u5047\u88c5\u5b83\u786e\u5b9e\u5b58\u5728\uff08but it may be useful in a makefile to pretend that it does\uff09\u3002 foo.a(dir/file.o) -> ar r foo.a dir/file.o \u3002\uff1f\uff1f\uff1f \u66f4\u65b0\u5f52\u6863\u6807\u5fd7\u6587\u4ef6\u5939 \u00b6 \u5f52\u6863\u6587\u4ef6\u4e2d\u6709\u4e00\u4e2a\u7279\u6b8a\u7684\u6210\u5458 __.SYMDEF \uff0c\u662f\u4e00\u4e2a\u5305\u542b\u4e86\u989d\u5916\u7684\u88ab\u6240\u6709\u5176\u4ed6\u6210\u5458\u5b9a\u4e49\u7684\u6807\u5fd7\u540d\u7684\u6587\u4ef6\u5939\u3002 \u66f4\u65b0\u4e86\u6210\u5458\u4e4b\u540e\uff0c\u901a\u8fc7 ranlib \u9700\u8981\u66f4\u65b0\u6b64\u6210\u5458\u3002 libfoo.a: libfoo.a(x.o) libfoo.a(y.o) \u2026 ranlib libfoo.a \u4f7f\u7528 ar \u8fdb\u884c\u66f4\u65b0\u65f6\uff0c\u4f1a\u81ea\u52a8\u66f4\u65b0\u6b64\u6210\u5458\u3002 note \uff1a\u5982\u679c\u591a\u4e2a ar \u540c\u65f6\u5728\u4e00\u4e2a\u5f52\u6863\u6587\u4ef6\u4e2d\u6267\u884c\uff0c\u4e0d\u80fd\u8f93\u51fa\u6b63\u786e\u5730\u7ed3\u679c\u3002 \u5f52\u6863\u6587\u4ef6\u7684\u540e\u7f00\u89c4\u5219 \u00b6 \u8fc7\u65f6\u5199\u6cd5\uff1a .c.a: $ ( CC ) $ ( CFLAGS ) $ ( CPPFLAGS ) - c $ < - o $ *. o $ ( AR ) r $@ $ *. o $ ( RM ) $ *. o \u5339\u914d\u5199\u6cd5\uff1a (%.o): %.c $(CC) $(CFLAGS) $(CPPFLAGS) -c $< -o $*.o $(AR) r $@ $*.o $(RM) $*.o","title":"11.\u4f7f\u7528make\u66f4\u65b0\u5f52\u6863\u6587\u4ef6"},{"location":"make/11.%E4%BD%BF%E7%94%A8make%E6%9B%B4%E6%96%B0%E5%BD%92%E6%A1%A3%E6%96%87%E4%BB%B6/#_1","text":"\u4e00\u4e2a\u5355\u72ec\u7684\u5f52\u6863\u6587\u4ef6\u6210\u5458\u53ef\u4ee5\u88ab\u4f5c\u4e3a\u4e00\u4e2a target \u6216\u8005 prerequisite \u3002 archive(member) \u6b64\u7ed3\u6784\u53ea\u80fd\u5728 target \u548c prerequisites \u4e2d\u4f7f\u7528\u3002\u6700\u597d\u4f7f\u7528 ar \u6765\u7ba1\u7406\u3002 \u901a\u8fc7\u590d\u5236hack.o\u5728foolib\u4e2d\u521b\u5efa\u4e00\u4e2a\u6210\u5458hack.o\u6587\u4ef6\uff1a foolib(hack.o) : hack.o ar cr foolib hack.o \u4e8b\u5b9e\u4e0a\u51e0\u4e4e\u6240\u6709\u7684\u5f52\u6863\u6210\u5458\u76ee\u6807\u90fd\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u66f4\u65b0\u5e76\u4e14\u6709\u4e00\u4e2a\u9ed8\u8ba4\u89c4\u5219\u4e3a\u4f60\u505a\u8fd9\u4ef6\u4e8b\u3002\u5982\u679c\u5f52\u6863\u6587\u4ef6\u4e0d\u5b58\u5728\u5219\u9700\u8981\u4e3a ar \u52a0\u4e0a c flag\u3002 \u6307\u5b9a\u591a\u4e2a\u6210\u5458\uff1a foolib(hack.o kludge.o) \u4f7f\u7528\u901a\u914d\u7b26\uff1a foolib(*.o)","title":"\u5f52\u6863\u6210\u5458\u4f5c\u4e3a\u76ee\u6807"},{"location":"make/11.%E4%BD%BF%E7%94%A8make%E6%9B%B4%E6%96%B0%E5%BD%92%E6%A1%A3%E6%96%87%E4%BB%B6/#_2","text":"make \"foo.a(bar.o)\": cc -c bar.c -o bar.o ar r foo.a bar.o rm -f bar.o \u6210\u5458\u4e0d\u80fd\u5305\u62ec\u4e00\u4e2a\u76ee\u5f55\u540d\uff0c\u4f46\u662f\u5728\u4e00\u4e2amakefile\u4e2d\u53ef\u80fd\u662f\u6709\u7528\u7684\u6765\u5047\u88c5\u5b83\u786e\u5b9e\u5b58\u5728\uff08but it may be useful in a makefile to pretend that it does\uff09\u3002 foo.a(dir/file.o) -> ar r foo.a dir/file.o \u3002\uff1f\uff1f\uff1f","title":"\u5f52\u6863\u6210\u5458\u76ee\u6807\u7684\u9690\u542b\u89c4\u5219"},{"location":"make/11.%E4%BD%BF%E7%94%A8make%E6%9B%B4%E6%96%B0%E5%BD%92%E6%A1%A3%E6%96%87%E4%BB%B6/#_3","text":"\u5f52\u6863\u6587\u4ef6\u4e2d\u6709\u4e00\u4e2a\u7279\u6b8a\u7684\u6210\u5458 __.SYMDEF \uff0c\u662f\u4e00\u4e2a\u5305\u542b\u4e86\u989d\u5916\u7684\u88ab\u6240\u6709\u5176\u4ed6\u6210\u5458\u5b9a\u4e49\u7684\u6807\u5fd7\u540d\u7684\u6587\u4ef6\u5939\u3002 \u66f4\u65b0\u4e86\u6210\u5458\u4e4b\u540e\uff0c\u901a\u8fc7 ranlib \u9700\u8981\u66f4\u65b0\u6b64\u6210\u5458\u3002 libfoo.a: libfoo.a(x.o) libfoo.a(y.o) \u2026 ranlib libfoo.a \u4f7f\u7528 ar \u8fdb\u884c\u66f4\u65b0\u65f6\uff0c\u4f1a\u81ea\u52a8\u66f4\u65b0\u6b64\u6210\u5458\u3002 note \uff1a\u5982\u679c\u591a\u4e2a ar \u540c\u65f6\u5728\u4e00\u4e2a\u5f52\u6863\u6587\u4ef6\u4e2d\u6267\u884c\uff0c\u4e0d\u80fd\u8f93\u51fa\u6b63\u786e\u5730\u7ed3\u679c\u3002","title":"\u66f4\u65b0\u5f52\u6863\u6807\u5fd7\u6587\u4ef6\u5939"},{"location":"make/11.%E4%BD%BF%E7%94%A8make%E6%9B%B4%E6%96%B0%E5%BD%92%E6%A1%A3%E6%96%87%E4%BB%B6/#_4","text":"\u8fc7\u65f6\u5199\u6cd5\uff1a .c.a: $ ( CC ) $ ( CFLAGS ) $ ( CPPFLAGS ) - c $ < - o $ *. o $ ( AR ) r $@ $ *. o $ ( RM ) $ *. o \u5339\u914d\u5199\u6cd5\uff1a (%.o): %.c $(CC) $(CFLAGS) $(CPPFLAGS) -c $< -o $*.o $(AR) r $@ $*.o $(RM) $*.o","title":"\u5f52\u6863\u6587\u4ef6\u7684\u540e\u7f00\u89c4\u5219"},{"location":"make/16.Makefile%E7%BA%A6%E5%AE%9A/","text":"DESTDIR\uff1a\u5206\u9636\u6bb5\u5b89\u88c5\u7684\u652f\u6301 \u00b6 DESTDIR \u662f\u4e00\u4e2a\u6dfb\u52a0\u5230\u6bcf\u4e00\u4e2a\u5b89\u88c5\u7684\u76ee\u6807\u6587\u4ef6\u7684\u53d8\u91cf\uff0c\u7531\u547d\u4ee4\u884c\u53c2\u6570\u6307\u5b9a\u3002 make DESTDIR=/tmp/stage install $(INSTALL_PROGRAM) foo $(DESTDIR)$(bindir)/foo $(INSTALL_DATA) libfoo.a $(DESTDIR)$(libdir)/libfoo.a \u6b63\u5e38\u60c5\u51b5\u4e0bfoo\u5e94\u8be5\u5b89\u88c5\u5728 /usr/local/bin/foo \uff0c\u4f46\u662f\u6839\u636e\u4e0a\u9762\u7684\u5199\u6cd5\uff0cfoo\u4f1a\u88ab\u5b89\u88c5\u5728 /tmp/stage/usr/local/bin/foo \u3002 DESTDIR \u53ea\u652f\u6301 install* \u548c uninstall* \u76ee\u6807\u3002","title":"16.Makefile\u7ea6\u5b9a"},{"location":"make/16.Makefile%E7%BA%A6%E5%AE%9A/#destdir","text":"DESTDIR \u662f\u4e00\u4e2a\u6dfb\u52a0\u5230\u6bcf\u4e00\u4e2a\u5b89\u88c5\u7684\u76ee\u6807\u6587\u4ef6\u7684\u53d8\u91cf\uff0c\u7531\u547d\u4ee4\u884c\u53c2\u6570\u6307\u5b9a\u3002 make DESTDIR=/tmp/stage install $(INSTALL_PROGRAM) foo $(DESTDIR)$(bindir)/foo $(INSTALL_DATA) libfoo.a $(DESTDIR)$(libdir)/libfoo.a \u6b63\u5e38\u60c5\u51b5\u4e0bfoo\u5e94\u8be5\u5b89\u88c5\u5728 /usr/local/bin/foo \uff0c\u4f46\u662f\u6839\u636e\u4e0a\u9762\u7684\u5199\u6cd5\uff0cfoo\u4f1a\u88ab\u5b89\u88c5\u5728 /tmp/stage/usr/local/bin/foo \u3002 DESTDIR \u53ea\u652f\u6301 install* \u548c uninstall* \u76ee\u6807\u3002","title":"DESTDIR\uff1a\u5206\u9636\u6bb5\u5b89\u88c5\u7684\u652f\u6301"},{"location":"make/4.%E7%BC%96%E5%86%99%E8%A7%84%E5%88%99/","text":"Phony Targets \u00b6 \u4e00\u4e2a\u4f2a\u76ee\u6807\u4e0d\u662f\u4e00\u4e2a\u771f\u6b63\u7684\u6587\u4ef6\u540d\uff0c\u53ea\u662f\u4e00\u4e2a\u5f53\u4f60\u660e\u786e\u7684\u8fd0\u884cmake\u8bf7\u6c42\u65f6\u4f1a\u88ab\u6267\u884c\u7684 recipe \u540d\u5b57\u3002\u6709\u4e24\u4e2a\u539f\u56e0\u4f7f\u7528\u4f2a\u76ee\u6807\uff1a \u907f\u514d\u540c\u540d\u6587\u4ef6\u51b2\u7a81 \u63d0\u5347\u6027\u80fd \u89e3\u51b3\u7684\u95ee\u9898\uff1a clean : rm *. o temp \u8fd9\u79cd\u5199\u6cd5\u5728\u6ca1\u6709\u6587\u4ef6\u540d\u51b2\u7a81\u7684\u65f6\u5019\u53ef\u4ee5\u901a\u8fc7 make clean \u6b63\u5e38\u6267\u884c\u3002\u4f46\u662f\u5982\u679c\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u540c\u540d\u7684\u6587\u4ef6 clean \uff0c clean \u603b\u662f\u4f1a\u88ab\u8003\u8651\u662f\u6700\u65b0\u7684\u6587\u4ef6\uff0c\u5b83\u7684 recipe \u4e0d\u4f1a\u6267\u884c\u3002 \u6dfb\u52a0\u4e00\u4e2a\u4f2a\u76ee\u6807\u5373\u53ef\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a .PHONY: clean clean: rm *. o temp \u4e0emake\u7684\u9012\u5f52\u8c03\u7528\u7ed3\u5408\u4f7f\u7528\uff1a SUBDIRS = foo bar baz subdirs : for dir in $( SUBDIRS ) ; do \\ $( MAKE ) -C $$ dir ; \\ done \u8fd9\u79cd\u5199\u6cd5\u7684\u95ee\u9898\uff1a\u4efb\u4f55\u5728sub-make\u4e2d\u7684\u9519\u8bef\u90fd\u4f1a\u88ab\u5ffd\u89c6\uff1b\u4e0d\u80fd\u5e76\u884c\u6784\u5efa\u76ee\u6807\u3002 \u6539\u8fdb\u540e\u7684\u5199\u6cd5\uff1a SUBDIRS = foo bar baz .PHONY: subdirs $ ( SUBDIRS ) subdirs: $ ( SUBDIRS ) $ ( SUBDIRS ): $ ( MAKE ) - C $@ foo: baz \u6700\u540e\u4e00\u53e5\u58f0\u660e\u4e86baz\u5b8c\u6210\u4e4b\u540e\u624d\u80fd\u6784\u5efafoo\u3002 \u5bf9\u4e8e\u4f2a\u76ee\u6807\u5c06\u8df3\u8fc7\u9690\u542b\u89c4\u5219\u7684\u641c\u7d22\u3002 \u4f2a\u76ee\u6807\u4e0d\u5e94\u8be5\u6210\u4e3a\u4e00\u4e2a\u771f\u5b9e\u7684\u76ee\u6807\u6587\u4ef6\u7684 prerequisites \uff0c\u8d1f\u8d23\u6bcf\u6b21make\u66f4\u65b0\u6587\u4ef6\u90fd\u4f1a\u6267\u884c\u4f2a\u76ee\u6807\u7684 recipe \u3002 \u4f2a\u76ee\u6807\u4e5f\u53ef\u4ee5\u6709 prerequisites \uff1a all : prog1 prog2 prog3 . PHONY : all prog1 : prog1 . o utils . o cc - o prog1 prog1 . o utils . o prog2 : prog2 . o cc - o prog2 prog2 . o prog3 : prog3 . o sort . o utils . o cc - o prog3 prog3 . o sort . o utils . o \u4e00\u4e2a\u4f2a\u76ee\u6807\u7684 prerequisites \u662f\u53e6\u4e00\u4e2a\u4f2a\u76ee\u6807\u65f6\uff0c\u8868\u73b0\u4e3a\u53e6\u4e00\u4e2a\u7684\u5b50\u7a0b\u5e8f\uff1a .PHONY: cleanall cleanobj cleandiff cleanall : cleanobj cleandiff rm program cleanobj : rm *. o cleandiff : rm *. diff \u6267\u884c\u987a\u5e8f\uff1a rm *.o -> rm *.diff -> rm program","title":"4.\u7f16\u5199\u89c4\u5219"},{"location":"make/4.%E7%BC%96%E5%86%99%E8%A7%84%E5%88%99/#phony-targets","text":"\u4e00\u4e2a\u4f2a\u76ee\u6807\u4e0d\u662f\u4e00\u4e2a\u771f\u6b63\u7684\u6587\u4ef6\u540d\uff0c\u53ea\u662f\u4e00\u4e2a\u5f53\u4f60\u660e\u786e\u7684\u8fd0\u884cmake\u8bf7\u6c42\u65f6\u4f1a\u88ab\u6267\u884c\u7684 recipe \u540d\u5b57\u3002\u6709\u4e24\u4e2a\u539f\u56e0\u4f7f\u7528\u4f2a\u76ee\u6807\uff1a \u907f\u514d\u540c\u540d\u6587\u4ef6\u51b2\u7a81 \u63d0\u5347\u6027\u80fd \u89e3\u51b3\u7684\u95ee\u9898\uff1a clean : rm *. o temp \u8fd9\u79cd\u5199\u6cd5\u5728\u6ca1\u6709\u6587\u4ef6\u540d\u51b2\u7a81\u7684\u65f6\u5019\u53ef\u4ee5\u901a\u8fc7 make clean \u6b63\u5e38\u6267\u884c\u3002\u4f46\u662f\u5982\u679c\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u540c\u540d\u7684\u6587\u4ef6 clean \uff0c clean \u603b\u662f\u4f1a\u88ab\u8003\u8651\u662f\u6700\u65b0\u7684\u6587\u4ef6\uff0c\u5b83\u7684 recipe \u4e0d\u4f1a\u6267\u884c\u3002 \u6dfb\u52a0\u4e00\u4e2a\u4f2a\u76ee\u6807\u5373\u53ef\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a .PHONY: clean clean: rm *. o temp \u4e0emake\u7684\u9012\u5f52\u8c03\u7528\u7ed3\u5408\u4f7f\u7528\uff1a SUBDIRS = foo bar baz subdirs : for dir in $( SUBDIRS ) ; do \\ $( MAKE ) -C $$ dir ; \\ done \u8fd9\u79cd\u5199\u6cd5\u7684\u95ee\u9898\uff1a\u4efb\u4f55\u5728sub-make\u4e2d\u7684\u9519\u8bef\u90fd\u4f1a\u88ab\u5ffd\u89c6\uff1b\u4e0d\u80fd\u5e76\u884c\u6784\u5efa\u76ee\u6807\u3002 \u6539\u8fdb\u540e\u7684\u5199\u6cd5\uff1a SUBDIRS = foo bar baz .PHONY: subdirs $ ( SUBDIRS ) subdirs: $ ( SUBDIRS ) $ ( SUBDIRS ): $ ( MAKE ) - C $@ foo: baz \u6700\u540e\u4e00\u53e5\u58f0\u660e\u4e86baz\u5b8c\u6210\u4e4b\u540e\u624d\u80fd\u6784\u5efafoo\u3002 \u5bf9\u4e8e\u4f2a\u76ee\u6807\u5c06\u8df3\u8fc7\u9690\u542b\u89c4\u5219\u7684\u641c\u7d22\u3002 \u4f2a\u76ee\u6807\u4e0d\u5e94\u8be5\u6210\u4e3a\u4e00\u4e2a\u771f\u5b9e\u7684\u76ee\u6807\u6587\u4ef6\u7684 prerequisites \uff0c\u8d1f\u8d23\u6bcf\u6b21make\u66f4\u65b0\u6587\u4ef6\u90fd\u4f1a\u6267\u884c\u4f2a\u76ee\u6807\u7684 recipe \u3002 \u4f2a\u76ee\u6807\u4e5f\u53ef\u4ee5\u6709 prerequisites \uff1a all : prog1 prog2 prog3 . PHONY : all prog1 : prog1 . o utils . o cc - o prog1 prog1 . o utils . o prog2 : prog2 . o cc - o prog2 prog2 . o prog3 : prog3 . o sort . o utils . o cc - o prog3 prog3 . o sort . o utils . o \u4e00\u4e2a\u4f2a\u76ee\u6807\u7684 prerequisites \u662f\u53e6\u4e00\u4e2a\u4f2a\u76ee\u6807\u65f6\uff0c\u8868\u73b0\u4e3a\u53e6\u4e00\u4e2a\u7684\u5b50\u7a0b\u5e8f\uff1a .PHONY: cleanall cleanobj cleandiff cleanall : cleanobj cleandiff rm program cleanobj : rm *. o cleandiff : rm *. diff \u6267\u884c\u987a\u5e8f\uff1a rm *.o -> rm *.diff -> rm program","title":"Phony Targets"},{"location":"make/5.%E7%BC%96%E5%86%99recipes/","text":"\u7528\u6237\u4f7f\u7528\u4e0d\u540c\u7684shell\u7a0b\u5e8f\uff0c\u4f46\u662f\u5728makefiles\u603b\u662f\u4f7f\u7528 /bin/sh \u6267\u884crecipe\uff0c\u9664\u975emakefile\u6307\u5b9a\u4e86\u5176\u5b83\u7684shell\u3002 recipe\u8bed\u6cd5 \u00b6 Makefile\u6709\u4e24\u79cd\u8bed\u6cd5\uff1amake\u8bed\u6cd5\u548cshell\u8bed\u6cd5\u3002make\u4e0d\u4f1a\u53bb\u7406\u89e3shell\u8bed\u6cd5\uff0c\u6267\u884c\u7b80\u5355\u7684\u7ffb\u8bd1\u5c31\u4ea4\u7ed9shell\u53bb\u5904\u7406\u3002recipe\u4f7f\u7528\u7684\u662fshell\u8bed\u6cd5\u3002 \u6bcf\u4e2arecipe\u6240\u5728\u884c\u90fd\u8981\u6709tab\u5f00\u5934\uff0c\u9664\u4e86\u7b2c\u4e00\u884crecipe\u53ef\u80fd\u4f1a\u88ab\u9644\u52a0\u5230\u76ee\u6807\u884c\uff08\u5206\u53f7\u9694\u5f00\uff09\u3002 \u5206\u5272recipe\u884c \u00b6 \u4f8b1\uff1a all : @echo no\\ space @echo no\\ space @echo one \\ space @echo one\\ space \u8f93\u51fa\uff1a nospace nospace one space one space \u4f8b2\uff1a all : ; @echo 'hello \\ world' ; echo \"hello \\ world\" \u8f93\u51fa\uff1a hello \\ world hello world \u60f3\u8981\u4f7f\u7528\u5355\u5f15\u53f7\uff0c\u5e76\u4e14\u4e0d\u60f3\u51fa\u73b0 \\ \uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06\u5176\u8f6c\u6362\u4e3amake\u53d8\u91cf\uff1a HELLO = ' hello \\ world' all : ; @ echo $( HELLO ) \u8f93\u51fa\uff1a hello world \u5728recipes\u4e2d\u4f7f\u7528\u53d8\u91cf \u00b6 \u4e0d\u4f1a\u91cd\u65b0\u6784\u5efa\u7684\u76ee\u6807\u4e0d\u4f1a\u88ab\u6269\u5c55\uff0c\u5373\u4e0d\u4f1a\u8c03\u7528\u65b0\u7684recipe\u3002 \u5982\u679c\u60f3\u8981 $ \u51fa\u73b0\u5728recipe\u4e2d\uff0c\u5fc5\u987b\u952e\u5165\u4e24\u4e2a\u5f15\u7528\uff1a $$ LIST = one two three all: for i in $(LIST); do \\ echo $$i; \\ done recipe\u8f93\u51fa \u00b6 \u6b63\u5e38\u60c5\u51b5\u4e0bmake\u5728\u6267\u884crecipe\u4e4b\u524d\u4f1a\u6253\u5370\u5b83\u3002 \u5982\u679crecipe\u524d\u52a0\u4e0a\u4e86 @ \u7b26\u53f7\uff0c\u5c31\u4e0d\u4f1a\u6253\u5370recipe\uff0c\u5f53\u4f20\u7ed9shell\u5904\u7406\u7684\u65f6\u5019\u8be5\u7b26\u53f7\u4f1a\u88ab\u4e22\u5f03\u6389\u3002 \u7ed9make -n \u3001 --just-print \u7684flag\u65f6\u5019\uff0c\u53ea\u4f1a\u8f93\u51fa\u5927\u90e8\u5206recipe\u800c\u4e0d\u6267\u884c\uff0c\u5e26\u6709 @ \u7b26\u53f7\u7684\u884c\u4e5f\u4f1a\u88ab\u6253\u5370\u51fa\u6765\u3002 flag -s \u3001 --silent \u4f1a\u963b\u6b62 echoing \uff0c\u5c31\u50cf\u6240\u6709\u7684\u884c\u90fd\u52a0\u4e86 @ \u7b26\u53f7\u3002 recipe\u6267\u884c \u00b6 \u6267\u884crecipe\u65f6\uff0c\u6bcf\u884crecipe\u90fd\u4f1a\u8c03\u7528\u4e00\u4e2a\u65b0\u7684 sub-shell \u6765\u6267\u884c\uff0c\u9664\u975e\u5b9a\u4e49 .ONESHELL \u7279\u6b8a\u76ee\u6807\u3002\u6240\u4ee5\u672c\u884c\u7684shell\u53d8\u91cf\u548c\u8bf8\u5982 cd \u7684\u76ee\u5f55\u4e0d\u4f1a\u5f71\u54cd\u540e\u7eed\u7684recipe\u3002 make\u7684\u9012\u5f52\u4f7f\u7528 \u00b6 \u610f\u601d\u5c31\u662f\u5728makefile\u6587\u4ef6\u4e2d\u4f7f\u7528 make \u4f5c\u4e3a\u547d\u4ee4\u3002\u5f53\u4f60\u73b0\u8981\u4e3a\u5b50\u7cfb\u7edf\u5206\u79bbmakefile\u7684\u65f6\u5019\u5f88\u6709\u7528\u3002 subsystem : cd subdir && $( MAKE )","title":"5.\u7f16\u5199recipes"},{"location":"make/5.%E7%BC%96%E5%86%99recipes/#recipe","text":"Makefile\u6709\u4e24\u79cd\u8bed\u6cd5\uff1amake\u8bed\u6cd5\u548cshell\u8bed\u6cd5\u3002make\u4e0d\u4f1a\u53bb\u7406\u89e3shell\u8bed\u6cd5\uff0c\u6267\u884c\u7b80\u5355\u7684\u7ffb\u8bd1\u5c31\u4ea4\u7ed9shell\u53bb\u5904\u7406\u3002recipe\u4f7f\u7528\u7684\u662fshell\u8bed\u6cd5\u3002 \u6bcf\u4e2arecipe\u6240\u5728\u884c\u90fd\u8981\u6709tab\u5f00\u5934\uff0c\u9664\u4e86\u7b2c\u4e00\u884crecipe\u53ef\u80fd\u4f1a\u88ab\u9644\u52a0\u5230\u76ee\u6807\u884c\uff08\u5206\u53f7\u9694\u5f00\uff09\u3002","title":"recipe\u8bed\u6cd5"},{"location":"make/5.%E7%BC%96%E5%86%99recipes/#recipe_1","text":"\u4f8b1\uff1a all : @echo no\\ space @echo no\\ space @echo one \\ space @echo one\\ space \u8f93\u51fa\uff1a nospace nospace one space one space \u4f8b2\uff1a all : ; @echo 'hello \\ world' ; echo \"hello \\ world\" \u8f93\u51fa\uff1a hello \\ world hello world \u60f3\u8981\u4f7f\u7528\u5355\u5f15\u53f7\uff0c\u5e76\u4e14\u4e0d\u60f3\u51fa\u73b0 \\ \uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06\u5176\u8f6c\u6362\u4e3amake\u53d8\u91cf\uff1a HELLO = ' hello \\ world' all : ; @ echo $( HELLO ) \u8f93\u51fa\uff1a hello world","title":"\u5206\u5272recipe\u884c"},{"location":"make/5.%E7%BC%96%E5%86%99recipes/#recipes","text":"\u4e0d\u4f1a\u91cd\u65b0\u6784\u5efa\u7684\u76ee\u6807\u4e0d\u4f1a\u88ab\u6269\u5c55\uff0c\u5373\u4e0d\u4f1a\u8c03\u7528\u65b0\u7684recipe\u3002 \u5982\u679c\u60f3\u8981 $ \u51fa\u73b0\u5728recipe\u4e2d\uff0c\u5fc5\u987b\u952e\u5165\u4e24\u4e2a\u5f15\u7528\uff1a $$ LIST = one two three all: for i in $(LIST); do \\ echo $$i; \\ done","title":"\u5728recipes\u4e2d\u4f7f\u7528\u53d8\u91cf"},{"location":"make/5.%E7%BC%96%E5%86%99recipes/#recipe_2","text":"\u6b63\u5e38\u60c5\u51b5\u4e0bmake\u5728\u6267\u884crecipe\u4e4b\u524d\u4f1a\u6253\u5370\u5b83\u3002 \u5982\u679crecipe\u524d\u52a0\u4e0a\u4e86 @ \u7b26\u53f7\uff0c\u5c31\u4e0d\u4f1a\u6253\u5370recipe\uff0c\u5f53\u4f20\u7ed9shell\u5904\u7406\u7684\u65f6\u5019\u8be5\u7b26\u53f7\u4f1a\u88ab\u4e22\u5f03\u6389\u3002 \u7ed9make -n \u3001 --just-print \u7684flag\u65f6\u5019\uff0c\u53ea\u4f1a\u8f93\u51fa\u5927\u90e8\u5206recipe\u800c\u4e0d\u6267\u884c\uff0c\u5e26\u6709 @ \u7b26\u53f7\u7684\u884c\u4e5f\u4f1a\u88ab\u6253\u5370\u51fa\u6765\u3002 flag -s \u3001 --silent \u4f1a\u963b\u6b62 echoing \uff0c\u5c31\u50cf\u6240\u6709\u7684\u884c\u90fd\u52a0\u4e86 @ \u7b26\u53f7\u3002","title":"recipe\u8f93\u51fa"},{"location":"make/5.%E7%BC%96%E5%86%99recipes/#recipe_3","text":"\u6267\u884crecipe\u65f6\uff0c\u6bcf\u884crecipe\u90fd\u4f1a\u8c03\u7528\u4e00\u4e2a\u65b0\u7684 sub-shell \u6765\u6267\u884c\uff0c\u9664\u975e\u5b9a\u4e49 .ONESHELL \u7279\u6b8a\u76ee\u6807\u3002\u6240\u4ee5\u672c\u884c\u7684shell\u53d8\u91cf\u548c\u8bf8\u5982 cd \u7684\u76ee\u5f55\u4e0d\u4f1a\u5f71\u54cd\u540e\u7eed\u7684recipe\u3002","title":"recipe\u6267\u884c"},{"location":"make/5.%E7%BC%96%E5%86%99recipes/#make","text":"\u610f\u601d\u5c31\u662f\u5728makefile\u6587\u4ef6\u4e2d\u4f7f\u7528 make \u4f5c\u4e3a\u547d\u4ee4\u3002\u5f53\u4f60\u73b0\u8981\u4e3a\u5b50\u7cfb\u7edf\u5206\u79bbmakefile\u7684\u65f6\u5019\u5f88\u6709\u7528\u3002 subsystem : cd subdir && $( MAKE )","title":"make\u7684\u9012\u5f52\u4f7f\u7528"},{"location":"make/6.%E5%8F%98%E9%87%8F/","text":"\u53d8\u91cf\u540d\u662f\u5927\u5c0f\u5199\u654f\u611f\u7684\u3002 \u63a8\u8350\u5927\u5199\u7684\u53d8\u91cf\u540d\u6765\u63a7\u5236\u9690\u542b\u89c4\u5219\u6216\u8005\u7528\u6237\u4f7f\u7528\u547d\u4ee4\u884c\u65f6\u4f1a\u8986\u76d6\u7684\u53c2\u6570\uff1b\u5c0f\u5199\u53d8\u91cf\u540d\u5728Makefile\u5185\u90e8\u4f7f\u7528\u3002 \u53d8\u91cf\u5f15\u7528\u57fa\u7840 \u00b6 $(xxx) \u4e0e ${xxx} \u90fd\u662f\u53ef\u4ee5\u7684\u3002 \u5728\u6587\u4ef6\u540d\u6216 recipe \u4e2d\u5199\u5165 $ \u7b26\u53f7\u5fc5\u987b\u952e\u5165 $$ \u3002 \u53d8\u91cf\u7684\u4e24\u79cd\u7c7b\u578b \u00b6 recursively expanded \u53d8\u91cf\u3002\u4f7f\u7528 = \uff08\u5355\u884c\uff09\u6216 define \uff08\u591a\u884c\uff09\u5b9a\u4e49\u53d8\u91cf\u3002 \u7f3a\u70b9\uff1a CFLAGS = $(CFLAGS) -O \u4f1a\u5f15\u8d77\u81ea\u5faa\u73af\uff0cmake\u4f1a\u68c0\u6d4b\u5230\u81ea\u5faa\u73af\u5e76\u62a5\u544a\u4e00\u4e2a\u9519\u8bef\u3002 \u6bcf\u6b21\u53d8\u91cf\u88ab\u6269\u5c55\u7684\u65f6\u5019\u4efb\u4f55\u5728\u5b9a\u4e49\u4e2d\u7684\u51fd\u6570 (see Functions for Transforming Text) \u5f15\u7528\u90fd\u4f1a\u6267\u884c\u3002\u4f1a\u5f15\u8d77 wildcard \u548c shell \u51fd\u6570\u7ed9\u51fa\u4e0d\u53ef\u9884\u77e5\u7684\u7ed3\u679c\u3002 simply expanded \u53d8\u91cf\uff0c\u53ef\u4ee5\u89e3\u51b3\u4e0a\u8ff0\u7684\u7f3a\u70b9\u3002\u4f7f\u7528 := \u6216 ::= \u6765\u5b9a\u4e49\u3002\u53ea\u6709 ::= \u88abPOSIX\u6807\u51c6\u652f\u6301\u3002\u5bf9\u4e8e\u6240\u6709\u5f15\u7528\u8be5\u53d8\u91cf\u7684\u5176\u5b83\u53d8\u91cf\u6216\u8005\u51fd\u6570\uff0c\u5b83\u53ea\u4f1a\u88ab\u626b\u63cf\u4e00\u6b21\u3002 \u4f8b\uff1a x := foo y := $(x) bar x := later \u7ed3\u679c\uff1a y := foo bar x := later \u533a\u522b \uff1amake\u5728\u6267\u884c\u5b9a\u4e49 recursively expanded variable \u65f6\uff0c\u4e0d\u4f1a\u6269\u5c55\u8be5\u53d8\u91cf\u4e2d\u7684\u5f15\u7528\u53d8\u91cf\uff0c\u53ea\u6709\u5728\u5f15\u7528\u8be5\u53d8\u91cf\u7684\u65f6\u5019\u5f15\u7528\u53d8\u91cf\u624d\u4f1a\u88ab\u6269\u5c55\uff1b simply expanded variable \u5219\u662f\u5728\u5b9a\u4e49\u53d8\u91cf\u7684\u65f6\u5019\u5c31\u5df2\u7ecf\u5c06\u5f15\u7528\u53d8\u91cf\u6269\u5c55\u4e86\u3002 \u8fd8\u6709\u53e6\u4e00\u79cd\u5b9a\u4e49\u64cd\u4f5c ?= \uff0c\u6761\u4ef6\u8d4b\u503c\u53d8\u91cf\uff0c\u5982\u679c\u8be5\u53d8\u91cf\u6ca1\u6709\u88ab\u5b9a\u4e49\u8fc7\uff0c\u90a3\u4e48\u624d\u4f1a\u88ab\u8d4b\u503c\u3002 \u00b6 FOO ?= bar \u7b49\u4e8e ifeq ($(origin FOO), undefined) FOO = bar endif note \uff1a\u53d8\u91cf\u88ab\u8d4b\u4e88\u7a7a\u503c\u7684\u8bdd\uff0c\u5b83\u4ecd\u7136\u662f\u88ab\u5b9a\u4e49\u4e86\u3002\u6240\u4ee5 ?= \u4e0d\u4f1a\u88ab\u8bbe\u7f6e\u53d8\u91cf\u3002 \u5f15\u7528\u53d8\u91cf\u7684\u9ad8\u7ea7\u7279\u6027 \u00b6 \u66ff\u6362\u5f15\u7528 \u00b6 \u683c\u5f0f $(var:a=b) (or ${var:a=b} )\u4f1a\u5bfc\u81f4\u66ff\u6362\u6389 var \u7684\u503c\u4e2d\u7528 b \u66ff\u6362 a \u3002 \u53ef\u4e0e patsubst \u7ed3\u5408\u4f7f\u7528\u3002 foo := a.o b.o c.o bar := $( foo:%.o = %.c ) \u7ed3\u679c\uff1a bar = a.c b.c c.c \u8ba1\u7b97\u53d8\u91cf\u540d \u00b6 \u53d8\u91cf\u53ef\u80fd\u88ab\u5f15\u7528\u5728\u4e00\u4e2a\u53d8\u91cf\u540d\u4e2d\u3002\u8fd9\u53eb\u505a computed variable name \u6216 nested variable reference \u3002 \u8fd9\u79cd\u65b9\u5f0f\u7684\u552f\u4e00\u7f3a\u70b9\u5c31\u662f\u4e0d\u80fd\u6307\u5b9a\u88ab\u8c03\u7528\u7684\u51fd\u6570\u540d\u3002\uff1f\uff1f\uff1f \u6267\u884cshell\u811a\u672c \u00b6 != \u53ef\u7528\u4e8e\u6267\u884cshell\u811a\u672c\u5e76\u628a\u8f93\u51fa\u8bbe\u7f6e\u4e3a\u53d8\u91cf\u7684\u503c\u3002 hash != printf '\\043' file_list != find . -name '*.c' \u5982\u679c\u7ed3\u679c\u4e2d\u542b\u6709 $ \uff0c\u5e76\u4e14\u4e0d\u60f3\u4f7f\u5176\u6269\u5c55\u4e3amake\u53d8\u91cf\uff0c\u90a3\u4e48\u5fc5\u987b\u66ff\u6362\u4e3a $$ \u3002\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528shell\u51fd\u6570\uff08 See The shell Function \uff09\u3002 hash := $( shell printf '\\043' ) var := $( shell find . -name \"*.c\" ) \u5411\u53d8\u91cf\u6dfb\u52a0\u5185\u5bb9 \u00b6 \u5411\u4e00\u4e2a\u5df2\u7ecf\u5b9a\u4e49\u7684\u53d8\u91cf\u4e2d\u6dfb\u52a0\u5185\u5bb9\uff1a objects = main.o foo.o bar.o utils.o objects += another.o \u53d8\u91cf\u6ca1\u6709\u88ab\u5b9a\u4e49\u65f6\uff0c += \u76f8\u5f53\u4e8e = \u3002 \u5982\u679c\u5b9a\u4e49\u4e86\uff0c\u53d6\u51b3\u4e8e\u53d8\u91cf\u7c7b\u578b\u3002 override\u6307\u4ee4 \u00b6 \u5982\u679c\u4f7f\u7528\u547d\u4ee4\u884c\u53c2\u6570\u8bbe\u7f6e\u4e86\u53d8\u91cf\uff0c\u90a3\u4e48\u5728makefile\u4e2d\u7684\u8bbe\u7f6e\u5c06\u88ab\u5ffd\u7565\u3002 override \u53ef\u4ee5\u6253\u7834\u8fd9\u4e2a\u89c4\u5219\u3002 override variable = value \u6bd4\u6240\u6709\u5176\u5b83\u65b9\u5f0f\u5b9a\u4e49\u7684\u53d8\u91cf\u7684\u4f18\u5148\u7ea7\u90fd\u8981\u9ad8\u3002 \u7528\u6765\u63d0\u793a\u5e76\u6dfb\u52a0\u7528\u6237\u6307\u5b9a\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff1a override CFLAGS += -g \u7ed3\u5408define\u4f7f\u7528\uff1a override define foo = bar endef \u5b9a\u4e49\u591a\u884c\u53d8\u91cf \u00b6 define two-lines = echo foo echo $( bar ) endef \u5f53\u5728 recipe \u4e2d\u4f7f\u7528\u6b64\u79cd\u53d8\u91cf\u65f6\uff0c\u76f8\u5f53\u4e8e two-lines = echo foo ; echo $( bar )","title":"6.\u53d8\u91cf"},{"location":"make/6.%E5%8F%98%E9%87%8F/#_1","text":"$(xxx) \u4e0e ${xxx} \u90fd\u662f\u53ef\u4ee5\u7684\u3002 \u5728\u6587\u4ef6\u540d\u6216 recipe \u4e2d\u5199\u5165 $ \u7b26\u53f7\u5fc5\u987b\u952e\u5165 $$ \u3002","title":"\u53d8\u91cf\u5f15\u7528\u57fa\u7840"},{"location":"make/6.%E5%8F%98%E9%87%8F/#_2","text":"recursively expanded \u53d8\u91cf\u3002\u4f7f\u7528 = \uff08\u5355\u884c\uff09\u6216 define \uff08\u591a\u884c\uff09\u5b9a\u4e49\u53d8\u91cf\u3002 \u7f3a\u70b9\uff1a CFLAGS = $(CFLAGS) -O \u4f1a\u5f15\u8d77\u81ea\u5faa\u73af\uff0cmake\u4f1a\u68c0\u6d4b\u5230\u81ea\u5faa\u73af\u5e76\u62a5\u544a\u4e00\u4e2a\u9519\u8bef\u3002 \u6bcf\u6b21\u53d8\u91cf\u88ab\u6269\u5c55\u7684\u65f6\u5019\u4efb\u4f55\u5728\u5b9a\u4e49\u4e2d\u7684\u51fd\u6570 (see Functions for Transforming Text) \u5f15\u7528\u90fd\u4f1a\u6267\u884c\u3002\u4f1a\u5f15\u8d77 wildcard \u548c shell \u51fd\u6570\u7ed9\u51fa\u4e0d\u53ef\u9884\u77e5\u7684\u7ed3\u679c\u3002 simply expanded \u53d8\u91cf\uff0c\u53ef\u4ee5\u89e3\u51b3\u4e0a\u8ff0\u7684\u7f3a\u70b9\u3002\u4f7f\u7528 := \u6216 ::= \u6765\u5b9a\u4e49\u3002\u53ea\u6709 ::= \u88abPOSIX\u6807\u51c6\u652f\u6301\u3002\u5bf9\u4e8e\u6240\u6709\u5f15\u7528\u8be5\u53d8\u91cf\u7684\u5176\u5b83\u53d8\u91cf\u6216\u8005\u51fd\u6570\uff0c\u5b83\u53ea\u4f1a\u88ab\u626b\u63cf\u4e00\u6b21\u3002 \u4f8b\uff1a x := foo y := $(x) bar x := later \u7ed3\u679c\uff1a y := foo bar x := later \u533a\u522b \uff1amake\u5728\u6267\u884c\u5b9a\u4e49 recursively expanded variable \u65f6\uff0c\u4e0d\u4f1a\u6269\u5c55\u8be5\u53d8\u91cf\u4e2d\u7684\u5f15\u7528\u53d8\u91cf\uff0c\u53ea\u6709\u5728\u5f15\u7528\u8be5\u53d8\u91cf\u7684\u65f6\u5019\u5f15\u7528\u53d8\u91cf\u624d\u4f1a\u88ab\u6269\u5c55\uff1b simply expanded variable \u5219\u662f\u5728\u5b9a\u4e49\u53d8\u91cf\u7684\u65f6\u5019\u5c31\u5df2\u7ecf\u5c06\u5f15\u7528\u53d8\u91cf\u6269\u5c55\u4e86\u3002","title":"\u53d8\u91cf\u7684\u4e24\u79cd\u7c7b\u578b"},{"location":"make/6.%E5%8F%98%E9%87%8F/#_3","text":"FOO ?= bar \u7b49\u4e8e ifeq ($(origin FOO), undefined) FOO = bar endif note \uff1a\u53d8\u91cf\u88ab\u8d4b\u4e88\u7a7a\u503c\u7684\u8bdd\uff0c\u5b83\u4ecd\u7136\u662f\u88ab\u5b9a\u4e49\u4e86\u3002\u6240\u4ee5 ?= \u4e0d\u4f1a\u88ab\u8bbe\u7f6e\u53d8\u91cf\u3002","title":"\u8fd8\u6709\u53e6\u4e00\u79cd\u5b9a\u4e49\u64cd\u4f5c?=\uff0c\u6761\u4ef6\u8d4b\u503c\u53d8\u91cf\uff0c\u5982\u679c\u8be5\u53d8\u91cf\u6ca1\u6709\u88ab\u5b9a\u4e49\u8fc7\uff0c\u90a3\u4e48\u624d\u4f1a\u88ab\u8d4b\u503c\u3002"},{"location":"make/6.%E5%8F%98%E9%87%8F/#_4","text":"","title":"\u5f15\u7528\u53d8\u91cf\u7684\u9ad8\u7ea7\u7279\u6027"},{"location":"make/6.%E5%8F%98%E9%87%8F/#_5","text":"\u683c\u5f0f $(var:a=b) (or ${var:a=b} )\u4f1a\u5bfc\u81f4\u66ff\u6362\u6389 var \u7684\u503c\u4e2d\u7528 b \u66ff\u6362 a \u3002 \u53ef\u4e0e patsubst \u7ed3\u5408\u4f7f\u7528\u3002 foo := a.o b.o c.o bar := $( foo:%.o = %.c ) \u7ed3\u679c\uff1a bar = a.c b.c c.c","title":"\u66ff\u6362\u5f15\u7528"},{"location":"make/6.%E5%8F%98%E9%87%8F/#_6","text":"\u53d8\u91cf\u53ef\u80fd\u88ab\u5f15\u7528\u5728\u4e00\u4e2a\u53d8\u91cf\u540d\u4e2d\u3002\u8fd9\u53eb\u505a computed variable name \u6216 nested variable reference \u3002 \u8fd9\u79cd\u65b9\u5f0f\u7684\u552f\u4e00\u7f3a\u70b9\u5c31\u662f\u4e0d\u80fd\u6307\u5b9a\u88ab\u8c03\u7528\u7684\u51fd\u6570\u540d\u3002\uff1f\uff1f\uff1f","title":"\u8ba1\u7b97\u53d8\u91cf\u540d"},{"location":"make/6.%E5%8F%98%E9%87%8F/#shell","text":"!= \u53ef\u7528\u4e8e\u6267\u884cshell\u811a\u672c\u5e76\u628a\u8f93\u51fa\u8bbe\u7f6e\u4e3a\u53d8\u91cf\u7684\u503c\u3002 hash != printf '\\043' file_list != find . -name '*.c' \u5982\u679c\u7ed3\u679c\u4e2d\u542b\u6709 $ \uff0c\u5e76\u4e14\u4e0d\u60f3\u4f7f\u5176\u6269\u5c55\u4e3amake\u53d8\u91cf\uff0c\u90a3\u4e48\u5fc5\u987b\u66ff\u6362\u4e3a $$ \u3002\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528shell\u51fd\u6570\uff08 See The shell Function \uff09\u3002 hash := $( shell printf '\\043' ) var := $( shell find . -name \"*.c\" )","title":"\u6267\u884cshell\u811a\u672c"},{"location":"make/6.%E5%8F%98%E9%87%8F/#_7","text":"\u5411\u4e00\u4e2a\u5df2\u7ecf\u5b9a\u4e49\u7684\u53d8\u91cf\u4e2d\u6dfb\u52a0\u5185\u5bb9\uff1a objects = main.o foo.o bar.o utils.o objects += another.o \u53d8\u91cf\u6ca1\u6709\u88ab\u5b9a\u4e49\u65f6\uff0c += \u76f8\u5f53\u4e8e = \u3002 \u5982\u679c\u5b9a\u4e49\u4e86\uff0c\u53d6\u51b3\u4e8e\u53d8\u91cf\u7c7b\u578b\u3002","title":"\u5411\u53d8\u91cf\u6dfb\u52a0\u5185\u5bb9"},{"location":"make/6.%E5%8F%98%E9%87%8F/#override","text":"\u5982\u679c\u4f7f\u7528\u547d\u4ee4\u884c\u53c2\u6570\u8bbe\u7f6e\u4e86\u53d8\u91cf\uff0c\u90a3\u4e48\u5728makefile\u4e2d\u7684\u8bbe\u7f6e\u5c06\u88ab\u5ffd\u7565\u3002 override \u53ef\u4ee5\u6253\u7834\u8fd9\u4e2a\u89c4\u5219\u3002 override variable = value \u6bd4\u6240\u6709\u5176\u5b83\u65b9\u5f0f\u5b9a\u4e49\u7684\u53d8\u91cf\u7684\u4f18\u5148\u7ea7\u90fd\u8981\u9ad8\u3002 \u7528\u6765\u63d0\u793a\u5e76\u6dfb\u52a0\u7528\u6237\u6307\u5b9a\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff1a override CFLAGS += -g \u7ed3\u5408define\u4f7f\u7528\uff1a override define foo = bar endef","title":"override\u6307\u4ee4"},{"location":"make/6.%E5%8F%98%E9%87%8F/#_8","text":"define two-lines = echo foo echo $( bar ) endef \u5f53\u5728 recipe \u4e2d\u4f7f\u7528\u6b64\u79cd\u53d8\u91cf\u65f6\uff0c\u76f8\u5f53\u4e8e two-lines = echo foo ; echo $( bar )","title":"\u5b9a\u4e49\u591a\u884c\u53d8\u91cf"},{"location":"make/7.Makefile%E4%B8%AD%E7%9A%84%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/","text":"\u4e0d\u80fd\u7528\u4e8e\u63a7\u5236 recipes \u3002 warning \uff1a\u4e0d\u80fd\u5728Makefile.am\u4e2d\u4f7f\u7528\u3002 \u4f8b\u5b50 \u00b6 libs_for_gcc = -lgnu normal_libs = foo : $( objects ) ifeq ($(CC),gcc) $( CC ) -o foo $( objects ) $( libs_for_gcc ) else $( CC ) -o foo $( objects ) $( normal_libs ) endif \u5e26\u6709 tab \u624d\u80fd\u7b97\u4f5crecipe\uff0c\u8fd9\u91cc\u7684\u6761\u4ef6\u8bed\u53e5\u88ab\u5f53\u4f5c\u6587\u672c\u6765\u770b\u5f85\u3002 \u8bed\u6cd5 \u00b6 conditional-directive-one text-if-one-is-true else conditional-directive-two text-if-two-is-true ... else text-if-one-and-two-are-false endif else\u53ef\u7701\u7565\u3002 \u6d4b\u8bd5\u53d8\u91cf\u662f\u5426\u76f8\u7b49\uff0c\u6709\u4e94\u79cd\u6761\u4ef6 conditional-directive \u7684\u5199\u6cd5\uff1a ifeq (arg1, arg2) ifeq 'arg1' 'arg2' ifeq \"arg1\" \"arg2\" ifeq \"arg1\" 'arg2' ifeq 'arg1' \"arg2\" \u6d4b\u8bd5\u53d8\u91cf\u662f\u5426\u4e3a\u7a7a\u503c\uff08\u7c7b\u4f3c\u4e8e\"\"\uff09\uff1a ifeq ($(strip $(foo)),) text-if-empty endif \u6d4b\u8bd5\u53d8\u91cf\u662f\u5426\u4e0d\u7b49\uff0c\u4e5f\u6709\u4e94\u79cd\u5199\u6cd5\uff1a ifneq (arg1, arg2) ifneq 'arg1' 'arg2' ifneq \"arg1\" \"arg2\" ifneq \"arg1\" 'arg2' ifneq 'arg1' \"arg2\" ifdef variable-name ifdef\u83b7\u53d6\u53d8\u91cf\u7684\u540d\u5b57\u4f5c\u4e3a\u53c2\u6570\uff0c\u800c\u4e0d\u662f\u53d8\u91cf\u503c\u7684\u5f15\u7528\u3002\u5982\u679c\u53d8\u91cf\u7684\u503c\u662f\u975e\u7a7a\u7684\uff0c\u5219\u6267\u884c text-if-true \u3002 variable-name \u662f\u53ef\u6269\u5c55\u7684\uff0c\u6240\u4ee5\u5176\u53ef\u4ee5\u662f\u4e00\u4e2a\u6269\u5c55\u6210\u4e00\u4e2a\u53d8\u91cf\u540d\u7684\u53d8\u91cf\u6216\u51fd\u6570\u3002 note \uff1a ifdef \u53ea\u6d4b\u8bd5\u503c\u662f\u5426\u4e3a\u975e\u7a7a\u3002\u6240\u4ee5\u9664\u4e86\u50cf\u8fd9\u6837\u5b9a\u4e49\u7684\u53d8\u91cf\uff1a foo = \uff0c\u90fd\u4f1a\u8fd4\u56de\u771f\u3002 \u5982\u679c\u60f3\u6d4b\u8bd5\u7a7a\u503c\uff0c\u4f7f\u7528 ifeq \u3002 \u4f8b\u5982\uff1a bar = foo = $(bar) ifdef foo frobozz = yes else frobozz = no endif \u7ed3\u679c\u662f\uff1afrobozz = yes foo = ifdef foo frobozz = yes else frobozz = no endif \u7ed3\u679c\u662f\uff1afrobozz = no ifndef variable-name \u4e0e ifdef \u76f8\u53cd\u3002 make\u662f\u5728\u8bfb\u53d6Makefile\u7684\u65f6\u5019\u5224\u65ad\u6761\u4ef6\u7684\uff0c\u6240\u4ee5\u4e0d\u80fd\u5728\u6761\u4ef6\u7684\u6d4b\u8bd5\u4e2d\u4f7f\u7528\u81ea\u52a8\u53d8\u91cf\uff0c\u56e0\u4e3a\u76f4\u5230recipes\u8fd0\u884c\u65f6\u4ed6\u4eec\u624d\u88ab\u5b9a\u4e49\u3002\u53c2\u8003 \u81ea\u52a8\u53d8\u91cf","title":"7.Makefile\u4e2d\u7684\u6761\u4ef6\u8bed\u53e5"},{"location":"make/7.Makefile%E4%B8%AD%E7%9A%84%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/#_1","text":"libs_for_gcc = -lgnu normal_libs = foo : $( objects ) ifeq ($(CC),gcc) $( CC ) -o foo $( objects ) $( libs_for_gcc ) else $( CC ) -o foo $( objects ) $( normal_libs ) endif \u5e26\u6709 tab \u624d\u80fd\u7b97\u4f5crecipe\uff0c\u8fd9\u91cc\u7684\u6761\u4ef6\u8bed\u53e5\u88ab\u5f53\u4f5c\u6587\u672c\u6765\u770b\u5f85\u3002","title":"\u4f8b\u5b50"},{"location":"make/7.Makefile%E4%B8%AD%E7%9A%84%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/#_2","text":"conditional-directive-one text-if-one-is-true else conditional-directive-two text-if-two-is-true ... else text-if-one-and-two-are-false endif else\u53ef\u7701\u7565\u3002 \u6d4b\u8bd5\u53d8\u91cf\u662f\u5426\u76f8\u7b49\uff0c\u6709\u4e94\u79cd\u6761\u4ef6 conditional-directive \u7684\u5199\u6cd5\uff1a ifeq (arg1, arg2) ifeq 'arg1' 'arg2' ifeq \"arg1\" \"arg2\" ifeq \"arg1\" 'arg2' ifeq 'arg1' \"arg2\" \u6d4b\u8bd5\u53d8\u91cf\u662f\u5426\u4e3a\u7a7a\u503c\uff08\u7c7b\u4f3c\u4e8e\"\"\uff09\uff1a ifeq ($(strip $(foo)),) text-if-empty endif \u6d4b\u8bd5\u53d8\u91cf\u662f\u5426\u4e0d\u7b49\uff0c\u4e5f\u6709\u4e94\u79cd\u5199\u6cd5\uff1a ifneq (arg1, arg2) ifneq 'arg1' 'arg2' ifneq \"arg1\" \"arg2\" ifneq \"arg1\" 'arg2' ifneq 'arg1' \"arg2\" ifdef variable-name ifdef\u83b7\u53d6\u53d8\u91cf\u7684\u540d\u5b57\u4f5c\u4e3a\u53c2\u6570\uff0c\u800c\u4e0d\u662f\u53d8\u91cf\u503c\u7684\u5f15\u7528\u3002\u5982\u679c\u53d8\u91cf\u7684\u503c\u662f\u975e\u7a7a\u7684\uff0c\u5219\u6267\u884c text-if-true \u3002 variable-name \u662f\u53ef\u6269\u5c55\u7684\uff0c\u6240\u4ee5\u5176\u53ef\u4ee5\u662f\u4e00\u4e2a\u6269\u5c55\u6210\u4e00\u4e2a\u53d8\u91cf\u540d\u7684\u53d8\u91cf\u6216\u51fd\u6570\u3002 note \uff1a ifdef \u53ea\u6d4b\u8bd5\u503c\u662f\u5426\u4e3a\u975e\u7a7a\u3002\u6240\u4ee5\u9664\u4e86\u50cf\u8fd9\u6837\u5b9a\u4e49\u7684\u53d8\u91cf\uff1a foo = \uff0c\u90fd\u4f1a\u8fd4\u56de\u771f\u3002 \u5982\u679c\u60f3\u6d4b\u8bd5\u7a7a\u503c\uff0c\u4f7f\u7528 ifeq \u3002 \u4f8b\u5982\uff1a bar = foo = $(bar) ifdef foo frobozz = yes else frobozz = no endif \u7ed3\u679c\u662f\uff1afrobozz = yes foo = ifdef foo frobozz = yes else frobozz = no endif \u7ed3\u679c\u662f\uff1afrobozz = no ifndef variable-name \u4e0e ifdef \u76f8\u53cd\u3002 make\u662f\u5728\u8bfb\u53d6Makefile\u7684\u65f6\u5019\u5224\u65ad\u6761\u4ef6\u7684\uff0c\u6240\u4ee5\u4e0d\u80fd\u5728\u6761\u4ef6\u7684\u6d4b\u8bd5\u4e2d\u4f7f\u7528\u81ea\u52a8\u53d8\u91cf\uff0c\u56e0\u4e3a\u76f4\u5230recipes\u8fd0\u884c\u65f6\u4ed6\u4eec\u624d\u88ab\u5b9a\u4e49\u3002\u53c2\u8003 \u81ea\u52a8\u53d8\u91cf","title":"\u8bed\u6cd5"},{"location":"make/8.%E8%BD%AC%E6%8D%A2%E6%96%87%E6%9C%AC%E5%87%BD%E6%95%B0/","text":"\u4e0d\u80fd\u88abAutomake\u6240\u8bc6\u522b\u3002 8.9 value \u00b6 \u8bed\u6cd5\uff1a $(value \\*variable\\*) \u3002 variable \u662f\u53d8\u91cf\u7684\u540d\u5b57\uff0c\u800c\u4e0d\u662f\u5176\u5f15\u7528\u3002 \u4f7f\u7528\u53d8\u91cf\u7684\u503c\uff0c\u503c\u4e0d\u4f1a\u88ab\u6269\u5c55\u3002 FOO = $PATH all : @echo $( FOO ) @echo $( value FOO ) \u7b2c\u4e00\u884c\u8f93\u51fa\u662fATH\uff0c\u4ee5\u4e3a $P \u88ab\u6269\u5c55\u4e3amake\u53d8\u91cf\u4e86\uff1b\u7b2c\u4e8c\u884c\u8f93\u51fa\u624d\u662f $PATH \u73af\u5883\u53d8\u91cf\u7684\u503c\u3002 note \uff1a\u5f53\u53d8\u91cf\u5df2\u7ecf\u88ab\u6269\u5c55\u4e86\uff0c\u90a3\u4e48\u8be5\u51fd\u6570\u4e0d\u4f1a\u8d77\u4f5c\u7528\u3002 8.9 eval \u00b6 \u5141\u8bb8\u4f60\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u975e\u5e38\u91cfmakefile\u6784\u9020\uff1a\u8ba1\u7b97\u5176\u5b83\u53d8\u91cf\u548c\u51fd\u6570\u7684\u7ed3\u679c\u3002 eval\u7684\u53c2\u6570\u88ab\u6269\u5c55\uff0c\u6269\u5c55\u7684\u7ed3\u679c\u4f1a\u88ab\u89e3\u6790\u4e3amakefile\u7684\u8bed\u6cd5\u3002\u6269\u5c55\u7ed3\u679c\u53ef\u4ee5\u5b9a\u4e49\u65b0\u7684make\u53d8\u91cf\u3001\u76ee\u6807\u3001\u9690\u542b\u6216\u660e\u786e\u7684\u89c4\u5219\u3001etc. eval\u7684\u7ed3\u679c\u603b\u662f\u7a7a\u5b57\u7b26\u4e32\u3002 eval\u7684\u53c2\u6570\u5b9e\u9645\u4e0a\u88ab\u6269\u5c55\u4e24\u6b21\uff1b\u7b2c\u4e00\u6b21\u7684\u6269\u5c55\u7ed3\u679c\u5c06\u5728\u89e3\u6790\u4e3amakefile\u8bed\u6cd5\u7684\u65f6\u5019\u518d\u6b21\u88ab\u6269\u5c55\u3002 \u8fd9\u610f\u5473\u7740\u4f60\u9700\u8981\u63d0\u4f9b\u989d\u5916\u7684\u7ea7\u522b\u6765\u4f7f\u7528 $ \u5b57\u7b26\u3002","title":"8.\u8f6c\u6362\u6587\u672c\u51fd\u6570"},{"location":"make/8.%E8%BD%AC%E6%8D%A2%E6%96%87%E6%9C%AC%E5%87%BD%E6%95%B0/#89-value","text":"\u8bed\u6cd5\uff1a $(value \\*variable\\*) \u3002 variable \u662f\u53d8\u91cf\u7684\u540d\u5b57\uff0c\u800c\u4e0d\u662f\u5176\u5f15\u7528\u3002 \u4f7f\u7528\u53d8\u91cf\u7684\u503c\uff0c\u503c\u4e0d\u4f1a\u88ab\u6269\u5c55\u3002 FOO = $PATH all : @echo $( FOO ) @echo $( value FOO ) \u7b2c\u4e00\u884c\u8f93\u51fa\u662fATH\uff0c\u4ee5\u4e3a $P \u88ab\u6269\u5c55\u4e3amake\u53d8\u91cf\u4e86\uff1b\u7b2c\u4e8c\u884c\u8f93\u51fa\u624d\u662f $PATH \u73af\u5883\u53d8\u91cf\u7684\u503c\u3002 note \uff1a\u5f53\u53d8\u91cf\u5df2\u7ecf\u88ab\u6269\u5c55\u4e86\uff0c\u90a3\u4e48\u8be5\u51fd\u6570\u4e0d\u4f1a\u8d77\u4f5c\u7528\u3002","title":"8.9 value"},{"location":"make/8.%E8%BD%AC%E6%8D%A2%E6%96%87%E6%9C%AC%E5%87%BD%E6%95%B0/#89-eval","text":"\u5141\u8bb8\u4f60\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u975e\u5e38\u91cfmakefile\u6784\u9020\uff1a\u8ba1\u7b97\u5176\u5b83\u53d8\u91cf\u548c\u51fd\u6570\u7684\u7ed3\u679c\u3002 eval\u7684\u53c2\u6570\u88ab\u6269\u5c55\uff0c\u6269\u5c55\u7684\u7ed3\u679c\u4f1a\u88ab\u89e3\u6790\u4e3amakefile\u7684\u8bed\u6cd5\u3002\u6269\u5c55\u7ed3\u679c\u53ef\u4ee5\u5b9a\u4e49\u65b0\u7684make\u53d8\u91cf\u3001\u76ee\u6807\u3001\u9690\u542b\u6216\u660e\u786e\u7684\u89c4\u5219\u3001etc. eval\u7684\u7ed3\u679c\u603b\u662f\u7a7a\u5b57\u7b26\u4e32\u3002 eval\u7684\u53c2\u6570\u5b9e\u9645\u4e0a\u88ab\u6269\u5c55\u4e24\u6b21\uff1b\u7b2c\u4e00\u6b21\u7684\u6269\u5c55\u7ed3\u679c\u5c06\u5728\u89e3\u6790\u4e3amakefile\u8bed\u6cd5\u7684\u65f6\u5019\u518d\u6b21\u88ab\u6269\u5c55\u3002 \u8fd9\u610f\u5473\u7740\u4f60\u9700\u8981\u63d0\u4f9b\u989d\u5916\u7684\u7ea7\u522b\u6765\u4f7f\u7528 $ \u5b57\u7b26\u3002","title":"8.9 eval"},{"location":"make/%E7%AE%80%E4%BB%8B/","text":"make \u6307\u660e\u4e86\u4e00\u4e2a\u5927\u7a0b\u5e8f\u7684\u54ea\u4e00\u90e8\u5206\u9700\u8981\u91cd\u65b0\u6784\u5efa\uff0c\u7136\u540e\u53d1\u51fa\u547d\u4ee4\u6765\u91cd\u65b0\u7f16\u8bd1\u5b83\u4eec\u3002 Makefile\u4ecb\u7ecd \u00b6 Makefile \u6587\u4ef6\u544a\u8bc9make\u5982\u4f55\u7f16\u8bd1\u548c\u94fe\u63a5\u4e00\u4e2a\u7a0b\u5e8f\u3002 \u89c4\u5219\u4ecb\u7ecd \u00b6 rule \u6a21\u578b target \u2026 : prerequisites \u2026 recipe \u2026 \u2026 target \u901a\u5e38\u662f\u88ab\u4e00\u4e2a\u7a0b\u5e8f\u751f\u6210\u7684\u6587\u4ef6\u540d\uff08\u53ef\u6267\u884c\u7684\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u53ef\u6267\u884c\u7684\u52a8\u4f5c\u3002 prerequisites \u662f\u8f93\u5165\u6587\u4ef6\u3002 recipe \u662f\u5c06\u8981\u6267\u884c\u7684\u52a8\u4f5c\u3002\u9700\u8981\u5728\u6bcf\u884c\u7684\u5f00\u5934\u952e\u5165\u4e00\u4e2atab\u5b57\u7b26\u3002 \u901a\u5e38\u4e00\u4e2a recipe \u662f\u4e00\u4e2a\u5e26\u6709\u5148\u51b3\u6761\u4ef6\u548c\u8868\u73b0\u7684\u89c4\u5219\u6765\u521b\u5efa\u4e00\u4e2a\u76ee\u6807\u6587\u4ef6\u5982\u679c\u4efb\u4f55\u6761\u4ef6\u53d1\u751f\u6539\u53d8\u3002\u4f46\u662f\uff0c\u4e3a\u76ee\u6807\u6307\u5b9a\u4e00\u4e2a recipe \u7684 rule \u4e0d\u9700\u8981\u5148\u51b3\u6761\u4ef6\u3002 rule \u89e3\u91ca\u5982\u4f55\u3001\u4f55\u65f6\u91cd\u65b0\u6784\u5efa\u67d0\u4e9b\u7279\u5b9a\u89c4\u5219\u7684\u76ee\u6807\u6587\u4ef6\u3002make\u6267\u884c\u5e26\u6709 prerequisites \u7684 recipe \u521b\u5efa\u3001\u66f4\u65b0\u76ee\u6807\uff1b rule \u4e5f\u53ef\u4ee5\u89e3\u91ca\u5982\u4f55\u3001\u4f55\u65f6\u6267\u884c\u52a8\u4f5c\u3002 Makefile\u8fd8\u53ef\u4ee5\u5305\u542b\u9664\u4e86\u89c4\u5219\u4ee5\u5916\u7684\u5176\u4ed6\u6587\u672c\u3002 \u90a3\u4e9b\u4e0d\u5f15\u7528\u6587\u4ef6\u4ec5\u4ec5\u662f\u64cd\u4f5c\u7684\u76ee\u6807\u79f0\u4e3a phony targets \uff08\u4f2a\u76ee\u6807\uff09\u3002 See Phony Targets \u3002 See Errors in Recipes \u67e5\u770b\u5982\u4f55\u5ffd\u7565\u9519\u8bef\u3002 make\u5982\u4f55\u6267\u884cMakefile \u00b6 make\u9ed8\u8ba4\u4f34\u968f\u7740\u7b2c\u4e00\u4e2a\u76ee\u6807\u5f00\u59cb\u3002\u53eb\u505a default goal \u3002 Goals \u662fmake\u6700\u7ec8\u8981\u66f4\u65b0\u7684\u76ee\u6807\u3002 \u6267\u884c rule \u4e4b\u524d\uff0c\u9700\u8981\u6ee1\u8db3 prerequisites \uff0c\u6240\u4ee5\u4f1a\u5148\u6267\u884c\u6ee1\u8db3 prerequisites \u7684 rule \u3002 objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o edit : $( objects ) cc -o edit $( objects ) main.o : main . c defs . h cc -c main.c kbd.o : kbd . c defs . h command . h cc -c kbd.c command.o : command . c defs . h command . h cc -c command.c display.o : display . c defs . h buffer . h cc -c display.c insert.o : insert . c defs . h buffer . h cc -c insert.c search.o : search . c defs . h buffer . h cc -c search.c files.o : files . c defs . h buffer . h command . h cc -c files.c utils.o : utils . c defs . h cc -c utils.c clean : rm edit $( objects ) \u4f7f\u7528\u53d8\u91cf \u00b6 \u5b9a\u4e49\u53d8\u91cf\uff1a objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o \u4f7f\u7528\u53d8\u91cf\uff1a $( objects ) \u8ba9make\u63a8\u6d4brecipe \u00b6 \u4f8b\u5b50\uff1a \u4e0d\u5fc5\u4e3a\u4e86\u5355\u4e2aC\u6e90\u6587\u4ef6\u62fc\u5199 recipe \uff0c\u56e0\u4e3amake\u53ef\u4ee5\u81ea\u52a8\u5730\u89e3\u51b3\uff1a\u5b83\u6709 implicit rule \uff08\u9690\u542b\u89c4\u5219\uff09\u4f7f\u7528 cc -c \u547d\u4ee4\u66f4\u65b0\u4e00\u4e2a .o \u6587\u4ef6\u4ece\u76f8\u5173\u7684 .c \u6587\u4ef6\u3002 objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o edit : $( objects ) cc -o edit $( objects ) main.o : defs . h kbd.o : defs . h command . h command.o : defs . h command . h display.o : defs . h buffer . h insert.o : defs . h buffer . h search.o : defs . h buffer . h files.o : defs . h buffer . h command . h utils.o : defs . h .PHONY : clean clean : rm edit $( objects ) Makefile\u7684\u53e6\u4e00\u79cd\u98ce\u683c \u00b6 \u5f53Makefile\u6587\u4ef6\u53ea\u7531 implicit rule \u7ec4\u6210\u65f6\uff0c\u53ef\u4ee5\u5199\u6210\u53e6\u4e00\u79cd\u7684\u98ce\u683c\uff1a\u901a\u8fc7\u4ed6\u4eec\u7684 prerequisites \u5c06\u5bf9\u8c61\u5206\u7ec4\u800c\u4e0d\u662f\u4ed6\u4eec\u7684 targets \u3002 objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o edit : $( objects ) cc -o edit $( objects ) $(objects) : defs . h kbd.o command.o files.o : command . h display.o insert.o search.o files.o : buffer . h \u6e05\u7406\u6587\u4ef6\u5939\u7684\u89c4\u5219 \u00b6 .PHONY : clean clean : -rm edit $( objects ) \u9632\u6b62make\u88ab\u4e00\u4e2a\u53eb\u505a clean \u7684\u6587\u4ef6\u5f04\u7cca\u6d82\uff0c\u5e76\u4f7f\u5176\u5728\u51fa\u9519\u7684\u60c5\u51b5\u4e0b\u7ee7\u7eed\u6267\u884c\u3002","title":"\u7b80\u4ecb"},{"location":"make/%E7%AE%80%E4%BB%8B/#makefile","text":"Makefile \u6587\u4ef6\u544a\u8bc9make\u5982\u4f55\u7f16\u8bd1\u548c\u94fe\u63a5\u4e00\u4e2a\u7a0b\u5e8f\u3002","title":"Makefile\u4ecb\u7ecd"},{"location":"make/%E7%AE%80%E4%BB%8B/#_1","text":"rule \u6a21\u578b target \u2026 : prerequisites \u2026 recipe \u2026 \u2026 target \u901a\u5e38\u662f\u88ab\u4e00\u4e2a\u7a0b\u5e8f\u751f\u6210\u7684\u6587\u4ef6\u540d\uff08\u53ef\u6267\u884c\u7684\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u53ef\u6267\u884c\u7684\u52a8\u4f5c\u3002 prerequisites \u662f\u8f93\u5165\u6587\u4ef6\u3002 recipe \u662f\u5c06\u8981\u6267\u884c\u7684\u52a8\u4f5c\u3002\u9700\u8981\u5728\u6bcf\u884c\u7684\u5f00\u5934\u952e\u5165\u4e00\u4e2atab\u5b57\u7b26\u3002 \u901a\u5e38\u4e00\u4e2a recipe \u662f\u4e00\u4e2a\u5e26\u6709\u5148\u51b3\u6761\u4ef6\u548c\u8868\u73b0\u7684\u89c4\u5219\u6765\u521b\u5efa\u4e00\u4e2a\u76ee\u6807\u6587\u4ef6\u5982\u679c\u4efb\u4f55\u6761\u4ef6\u53d1\u751f\u6539\u53d8\u3002\u4f46\u662f\uff0c\u4e3a\u76ee\u6807\u6307\u5b9a\u4e00\u4e2a recipe \u7684 rule \u4e0d\u9700\u8981\u5148\u51b3\u6761\u4ef6\u3002 rule \u89e3\u91ca\u5982\u4f55\u3001\u4f55\u65f6\u91cd\u65b0\u6784\u5efa\u67d0\u4e9b\u7279\u5b9a\u89c4\u5219\u7684\u76ee\u6807\u6587\u4ef6\u3002make\u6267\u884c\u5e26\u6709 prerequisites \u7684 recipe \u521b\u5efa\u3001\u66f4\u65b0\u76ee\u6807\uff1b rule \u4e5f\u53ef\u4ee5\u89e3\u91ca\u5982\u4f55\u3001\u4f55\u65f6\u6267\u884c\u52a8\u4f5c\u3002 Makefile\u8fd8\u53ef\u4ee5\u5305\u542b\u9664\u4e86\u89c4\u5219\u4ee5\u5916\u7684\u5176\u4ed6\u6587\u672c\u3002 \u90a3\u4e9b\u4e0d\u5f15\u7528\u6587\u4ef6\u4ec5\u4ec5\u662f\u64cd\u4f5c\u7684\u76ee\u6807\u79f0\u4e3a phony targets \uff08\u4f2a\u76ee\u6807\uff09\u3002 See Phony Targets \u3002 See Errors in Recipes \u67e5\u770b\u5982\u4f55\u5ffd\u7565\u9519\u8bef\u3002","title":"\u89c4\u5219\u4ecb\u7ecd"},{"location":"make/%E7%AE%80%E4%BB%8B/#makemakefile","text":"make\u9ed8\u8ba4\u4f34\u968f\u7740\u7b2c\u4e00\u4e2a\u76ee\u6807\u5f00\u59cb\u3002\u53eb\u505a default goal \u3002 Goals \u662fmake\u6700\u7ec8\u8981\u66f4\u65b0\u7684\u76ee\u6807\u3002 \u6267\u884c rule \u4e4b\u524d\uff0c\u9700\u8981\u6ee1\u8db3 prerequisites \uff0c\u6240\u4ee5\u4f1a\u5148\u6267\u884c\u6ee1\u8db3 prerequisites \u7684 rule \u3002 objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o edit : $( objects ) cc -o edit $( objects ) main.o : main . c defs . h cc -c main.c kbd.o : kbd . c defs . h command . h cc -c kbd.c command.o : command . c defs . h command . h cc -c command.c display.o : display . c defs . h buffer . h cc -c display.c insert.o : insert . c defs . h buffer . h cc -c insert.c search.o : search . c defs . h buffer . h cc -c search.c files.o : files . c defs . h buffer . h command . h cc -c files.c utils.o : utils . c defs . h cc -c utils.c clean : rm edit $( objects )","title":"make\u5982\u4f55\u6267\u884cMakefile"},{"location":"make/%E7%AE%80%E4%BB%8B/#_2","text":"\u5b9a\u4e49\u53d8\u91cf\uff1a objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o \u4f7f\u7528\u53d8\u91cf\uff1a $( objects )","title":"\u4f7f\u7528\u53d8\u91cf"},{"location":"make/%E7%AE%80%E4%BB%8B/#makerecipe","text":"\u4f8b\u5b50\uff1a \u4e0d\u5fc5\u4e3a\u4e86\u5355\u4e2aC\u6e90\u6587\u4ef6\u62fc\u5199 recipe \uff0c\u56e0\u4e3amake\u53ef\u4ee5\u81ea\u52a8\u5730\u89e3\u51b3\uff1a\u5b83\u6709 implicit rule \uff08\u9690\u542b\u89c4\u5219\uff09\u4f7f\u7528 cc -c \u547d\u4ee4\u66f4\u65b0\u4e00\u4e2a .o \u6587\u4ef6\u4ece\u76f8\u5173\u7684 .c \u6587\u4ef6\u3002 objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o edit : $( objects ) cc -o edit $( objects ) main.o : defs . h kbd.o : defs . h command . h command.o : defs . h command . h display.o : defs . h buffer . h insert.o : defs . h buffer . h search.o : defs . h buffer . h files.o : defs . h buffer . h command . h utils.o : defs . h .PHONY : clean clean : rm edit $( objects )","title":"\u8ba9make\u63a8\u6d4brecipe"},{"location":"make/%E7%AE%80%E4%BB%8B/#makefile_1","text":"\u5f53Makefile\u6587\u4ef6\u53ea\u7531 implicit rule \u7ec4\u6210\u65f6\uff0c\u53ef\u4ee5\u5199\u6210\u53e6\u4e00\u79cd\u7684\u98ce\u683c\uff1a\u901a\u8fc7\u4ed6\u4eec\u7684 prerequisites \u5c06\u5bf9\u8c61\u5206\u7ec4\u800c\u4e0d\u662f\u4ed6\u4eec\u7684 targets \u3002 objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o edit : $( objects ) cc -o edit $( objects ) $(objects) : defs . h kbd.o command.o files.o : command . h display.o insert.o search.o files.o : buffer . h","title":"Makefile\u7684\u53e6\u4e00\u79cd\u98ce\u683c"},{"location":"make/%E7%AE%80%E4%BB%8B/#_3","text":".PHONY : clean clean : -rm edit $( objects ) \u9632\u6b62make\u88ab\u4e00\u4e2a\u53eb\u505a clean \u7684\u6587\u4ef6\u5f04\u7cca\u6d82\uff0c\u5e76\u4f7f\u5176\u5728\u51fa\u9519\u7684\u60c5\u51b5\u4e0b\u7ee7\u7eed\u6267\u884c\u3002","title":"\u6e05\u7406\u6587\u4ef6\u5939\u7684\u89c4\u5219"},{"location":"spice/%E4%BD%BF%E7%94%A8%E8%8C%83%E4%BE%8B/","text":"Host \u00b6 \u5f00\u542fCPU\u865a\u62df\u5316\u6280\u672f \u5b89\u88c5 qemu-kvm \u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u91cd\u547d\u540d\u4e3a qemu-spice \u00b6 yum install qemu-kvm ln -s /usr/libexec/qemu-kvm /usr/local/bin/qemu-spice spice-protocol \u4f1a\u4f5c\u4e3a qemu-kvm \u7684\u4f9d\u8d56\u81ea\u52a8\u5b89\u88c5 \u5b89\u88c5\u4f9d\u8d56\u5de5\u5177 \u00b6 yum install qemu-vdagent qemu-img \u5173\u95ed\u9632\u706b\u5899\uff0c\u4e3a\u4e86\u5ba2\u6237\u7aef\u80fd\u4e0e\u670d\u52a1\u7aef\u901a\u4fe1 \u00b6 systemctl stop firewalld systemctl disable firewalld \u542f\u52a8\u865a\u62df\u673a \u00b6 qemu-img create img/win7.img 15G \u4f7f\u7528qemu-kvm qemu-spice -boot order=dc -vga qxl -m 3072 -spice port=3001,disable-ticketing -soundhw hda -device virtio-serial -chardev spicevmc,id=vdagent,debug=0,name=vdagent -device virtserialport,chardev=vdagent,name=com.redhat.spice.0 -cdrom cn_windows_7_ultimate_with_sp1_x64_dvd_618537.iso img/win7.img \u4f7f\u7528virt-manager \u8fd9\u79cd\u65b9\u5f0f\u7684\u7a33\u5b9a\u6027\u66f4\u597d Client \u00b6 \u5f00\u542fCPU\u865a\u62df\u5316\u6280\u672f \u5b89\u88c5\u4f9d\u8d56\u5de5\u5177 \u00b6 yum install spice-gtk3 virt-viewer \u5982\u679c\u6ca1\u6709\u56fe\u5f62\u5316\u754c\u9762\uff1a \u53c2\u8003 \u5b89\u88c5\u56fe\u5f62\u754c\u9762 \u5728\u56fe\u5f62\u5316\u754c\u9762\uff1a remote-viewer spice://server:3001 Windows Guest \u00b6 \u5b89\u88c5vdagent\u9a71\u52a8 \u00b6 \u88c5\u4e86 spice-nsis \u8fd9\u4e2a\u5de5\u5177\u5305\u4e4b\u540e\u624d\u80fd\u62d6\u62fd\u6587\u4ef6\u3001\u5171\u4eab\u526a\u5207\u677f\u7b49\u64cd\u4f5c \u5de5\u5177\u5305\u4e0b\u8f7d\u5730\u5740\uff1a https://www.spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-latest.exe \u5305\u542b\u4e86 QXL \u9a71\u52a8\u3001 QXL-WDDM-DOD \u9a71\u52a8\u3001 SPICE agent","title":"\u4f7f\u7528\u8303\u4f8b"},{"location":"spice/%E4%BD%BF%E7%94%A8%E8%8C%83%E4%BE%8B/#host","text":"\u5f00\u542fCPU\u865a\u62df\u5316\u6280\u672f","title":"Host"},{"location":"spice/%E4%BD%BF%E7%94%A8%E8%8C%83%E4%BE%8B/#qemu-kvm-qemu-spice","text":"yum install qemu-kvm ln -s /usr/libexec/qemu-kvm /usr/local/bin/qemu-spice spice-protocol \u4f1a\u4f5c\u4e3a qemu-kvm \u7684\u4f9d\u8d56\u81ea\u52a8\u5b89\u88c5","title":"\u5b89\u88c5 qemu-kvm \u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u91cd\u547d\u540d\u4e3aqemu-spice"},{"location":"spice/%E4%BD%BF%E7%94%A8%E8%8C%83%E4%BE%8B/#_1","text":"yum install qemu-vdagent qemu-img","title":"\u5b89\u88c5\u4f9d\u8d56\u5de5\u5177"},{"location":"spice/%E4%BD%BF%E7%94%A8%E8%8C%83%E4%BE%8B/#_2","text":"systemctl stop firewalld systemctl disable firewalld","title":"\u5173\u95ed\u9632\u706b\u5899\uff0c\u4e3a\u4e86\u5ba2\u6237\u7aef\u80fd\u4e0e\u670d\u52a1\u7aef\u901a\u4fe1"},{"location":"spice/%E4%BD%BF%E7%94%A8%E8%8C%83%E4%BE%8B/#_3","text":"qemu-img create img/win7.img 15G \u4f7f\u7528qemu-kvm qemu-spice -boot order=dc -vga qxl -m 3072 -spice port=3001,disable-ticketing -soundhw hda -device virtio-serial -chardev spicevmc,id=vdagent,debug=0,name=vdagent -device virtserialport,chardev=vdagent,name=com.redhat.spice.0 -cdrom cn_windows_7_ultimate_with_sp1_x64_dvd_618537.iso img/win7.img \u4f7f\u7528virt-manager \u8fd9\u79cd\u65b9\u5f0f\u7684\u7a33\u5b9a\u6027\u66f4\u597d","title":"\u542f\u52a8\u865a\u62df\u673a"},{"location":"spice/%E4%BD%BF%E7%94%A8%E8%8C%83%E4%BE%8B/#client","text":"\u5f00\u542fCPU\u865a\u62df\u5316\u6280\u672f","title":"Client"},{"location":"spice/%E4%BD%BF%E7%94%A8%E8%8C%83%E4%BE%8B/#_4","text":"yum install spice-gtk3 virt-viewer \u5982\u679c\u6ca1\u6709\u56fe\u5f62\u5316\u754c\u9762\uff1a \u53c2\u8003 \u5b89\u88c5\u56fe\u5f62\u754c\u9762 \u5728\u56fe\u5f62\u5316\u754c\u9762\uff1a remote-viewer spice://server:3001","title":"\u5b89\u88c5\u4f9d\u8d56\u5de5\u5177"},{"location":"spice/%E4%BD%BF%E7%94%A8%E8%8C%83%E4%BE%8B/#windows-guest","text":"","title":"Windows Guest"},{"location":"spice/%E4%BD%BF%E7%94%A8%E8%8C%83%E4%BE%8B/#vdagent","text":"\u88c5\u4e86 spice-nsis \u8fd9\u4e2a\u5de5\u5177\u5305\u4e4b\u540e\u624d\u80fd\u62d6\u62fd\u6587\u4ef6\u3001\u5171\u4eab\u526a\u5207\u677f\u7b49\u64cd\u4f5c \u5de5\u5177\u5305\u4e0b\u8f7d\u5730\u5740\uff1a https://www.spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-latest.exe \u5305\u542b\u4e86 QXL \u9a71\u52a8\u3001 QXL-WDDM-DOD \u9a71\u52a8\u3001 SPICE agent","title":"\u5b89\u88c5vdagent\u9a71\u52a8"},{"location":"spice/%E5%87%BD%E6%95%B0%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6/","text":"ffmpeg-1.2.2 \u4e0e vdagent-win-0.8 \u00b6 \u89c6\u9891\u6587\u4ef6\u7684\u8bfb\u5199\u51fd\u6570\u91cd\u5b9a\u5411 \u00b6 int avio_read ( AVIOContext * s , unsigned char * buf , int size ) int64_t avio_seek ( AVIOContext * s , int64_t offset , int whence ) int64_t avio_size ( AVIOContext * s ) int avio_open ( AVIOContext ** s , const char * filename , int flags ) int avio_close ( AVIOContext * s ) \u5f53\u865a\u62df\u673a\u64ad\u653e\u89c6\u9891\u8fc7\u7a0b\u4e2d\u8c03\u7528\u4ee5\u4e0a\u7684\u51fd\u6570\u65f6\uff0c\u4f1a\u628a\u6587\u4ef6\u540d\u4fe1\u606f\uff0c\u8bfb\u53d6\u6587\u4ef6\u7684 \u957f\u5ea6\u7b49\u4fe1\u606f\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u7684\u64ad\u653e\u5668\uff0c\u64ad\u653e\u5668\u7684 FFMPEG \u7684\u5e95\u5c42\u51fd\u6570\u4f1a\u901a\u8fc7 Socket \u7684\u65b9\u5f0f\u8bfb\u53d6\u6587\u4ef6\u6570\u636e,\u6570\u636e\u7684\u8bfb\u5199\u4f20\u8f93\u5728\u4e0b\u9762\u7684\u7ae0\u8282\u4f1a\u8be6\u7ec6\u8bf4\u660e\u3002 \u731c\u60f3\uff1a 1.vdagent\u8c03\u7528\u88ab\u4fee\u6539\u8fc7\u7684ffmpeg\u63a5\u53e3\uff0cffmpeg\u63a5\u53e3\u4f1a\u6309\u7167vdagent\u7684\u6d88\u606f\u5f62\u5f0f\u53d1\u9001\u63a7\u5236\u4fe1\u606f\u5230Client\uff1b2.ffmpeg\u7684\u63a5\u53e3\u88ab\u8c03\u7528\u7684\u65f6\u5019\u4f1a\u89e6\u53d1\u4e00\u4e2ahook\uff0c\u6b64\u65f6\u4f1a\u8c03\u7528vdagent\u65b9\u6cd5\u53d1\u9001\u4fe1\u606f\u5230Client \u63a7\u5236\u4fe1\u606f\u7684\u8bfb\u5199\u51fd\u6570\u91cd\u5b9a\u5411 \u00b6 \u4ee5\u4e0a\u7684\u8fd9\u4e9b\u51fd\u6570\u5728\u9700\u8981\u91cd\u5b9a\u5411\u5230\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u7684\u64ad\u653e\u5668\u4f9d\u636e\u4f20\u56de\u6765\u7684\u63a7\u5236 \u4fe1\u606f\u6765\u64ad\u653e\u89c6\u9891\u8fc7\u7a0b\u3002 av_open_input_file\u5df2\u7ecf\u5f03\u7528\u4e86\uff1a - avformat.h \u00b6 Add avformat_open_input and avformat_write_header(). Deprecate av_open_input_stream, av_open_input_file, AVFormatParameters and av_write_header. \u53d1\u9001\u63a7\u5236\u4fe1\u606f\u5230\u5ba2\u6237\u7aef\u9700\u8981\u5b9e\u73b0\u7684\u51fd\u6570 \u53d1\u9001\u64ad\u653e\u89c6\u9891\u6587\u4ef6\u7684\u6587\u4ef6\u540d SendFileName(const char *filename)\uff1b av_open_input_file \u4e2d\u8c03\u7528 \u5f97\u5230\u64ad\u653e\u89c6\u9891\u6587\u4ef6\u7684\u7a97\u53e3\u5750\u6807 SendDisplayArea(const int nWidth,const int nHeight)\uff1b video_image_display \u4e2d\u5728 SDL_DisplayYUVOverlay \u4e4b\u540e\u8c03\u7528 \u5feb\u8fdb\uff0c\u5feb\u9000\u63a7\u5236 SendSeekPos(int64_t timestamp, int flags)\uff1b av_seek_frame \u4e2d\u8c03\u7528 ffmpeg\u5982\u4f55\u4e0evdagent\u901a\u4fe1 \u00b6 \u6587\u4ef6\u4f20\u8f93\u6a21\u5757\u7684\u5b9e\u73b0 \u00b6 Guest OS \u548c Client OS \u4e4b\u95f4\u7684\u901a\u8fc7 UDP \u8fdb\u884c\u6587\u4ef6\u4f20\u8f93 Client OS \u89c6\u9891\u64ad\u653e\u6a21\u5757 \u00b6 \u57fa\u4e8eSDL\u7684\u89c6\u9891\u64ad\u653e\u5668\u7684\u5b9e\u73b0\u3002 spice\u5ba2\u6237\u7aef\u7684\u91cd\u65b0\u7f16\u8bd1\uff0c\u6dfb\u52a0\u4e0e\u64ad\u653e\u5668\u4e92\u52a8\u7684\u4ee3\u7801\u3002","title":"\u51fd\u6570\u6240\u5728\u6587\u4ef6"},{"location":"spice/%E5%87%BD%E6%95%B0%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6/#ffmpeg-122-vdagent-win-08","text":"","title":"ffmpeg-1.2.2 \u4e0e vdagent-win-0.8"},{"location":"spice/%E5%87%BD%E6%95%B0%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6/#_1","text":"int avio_read ( AVIOContext * s , unsigned char * buf , int size ) int64_t avio_seek ( AVIOContext * s , int64_t offset , int whence ) int64_t avio_size ( AVIOContext * s ) int avio_open ( AVIOContext ** s , const char * filename , int flags ) int avio_close ( AVIOContext * s ) \u5f53\u865a\u62df\u673a\u64ad\u653e\u89c6\u9891\u8fc7\u7a0b\u4e2d\u8c03\u7528\u4ee5\u4e0a\u7684\u51fd\u6570\u65f6\uff0c\u4f1a\u628a\u6587\u4ef6\u540d\u4fe1\u606f\uff0c\u8bfb\u53d6\u6587\u4ef6\u7684 \u957f\u5ea6\u7b49\u4fe1\u606f\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u7684\u64ad\u653e\u5668\uff0c\u64ad\u653e\u5668\u7684 FFMPEG \u7684\u5e95\u5c42\u51fd\u6570\u4f1a\u901a\u8fc7 Socket \u7684\u65b9\u5f0f\u8bfb\u53d6\u6587\u4ef6\u6570\u636e,\u6570\u636e\u7684\u8bfb\u5199\u4f20\u8f93\u5728\u4e0b\u9762\u7684\u7ae0\u8282\u4f1a\u8be6\u7ec6\u8bf4\u660e\u3002 \u731c\u60f3\uff1a 1.vdagent\u8c03\u7528\u88ab\u4fee\u6539\u8fc7\u7684ffmpeg\u63a5\u53e3\uff0cffmpeg\u63a5\u53e3\u4f1a\u6309\u7167vdagent\u7684\u6d88\u606f\u5f62\u5f0f\u53d1\u9001\u63a7\u5236\u4fe1\u606f\u5230Client\uff1b2.ffmpeg\u7684\u63a5\u53e3\u88ab\u8c03\u7528\u7684\u65f6\u5019\u4f1a\u89e6\u53d1\u4e00\u4e2ahook\uff0c\u6b64\u65f6\u4f1a\u8c03\u7528vdagent\u65b9\u6cd5\u53d1\u9001\u4fe1\u606f\u5230Client","title":"\u89c6\u9891\u6587\u4ef6\u7684\u8bfb\u5199\u51fd\u6570\u91cd\u5b9a\u5411"},{"location":"spice/%E5%87%BD%E6%95%B0%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6/#_2","text":"\u4ee5\u4e0a\u7684\u8fd9\u4e9b\u51fd\u6570\u5728\u9700\u8981\u91cd\u5b9a\u5411\u5230\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u7684\u64ad\u653e\u5668\u4f9d\u636e\u4f20\u56de\u6765\u7684\u63a7\u5236 \u4fe1\u606f\u6765\u64ad\u653e\u89c6\u9891\u8fc7\u7a0b\u3002 av_open_input_file\u5df2\u7ecf\u5f03\u7528\u4e86\uff1a","title":"\u63a7\u5236\u4fe1\u606f\u7684\u8bfb\u5199\u51fd\u6570\u91cd\u5b9a\u5411"},{"location":"spice/%E5%87%BD%E6%95%B0%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6/#-avformath","text":"Add avformat_open_input and avformat_write_header(). Deprecate av_open_input_stream, av_open_input_file, AVFormatParameters and av_write_header. \u53d1\u9001\u63a7\u5236\u4fe1\u606f\u5230\u5ba2\u6237\u7aef\u9700\u8981\u5b9e\u73b0\u7684\u51fd\u6570 \u53d1\u9001\u64ad\u653e\u89c6\u9891\u6587\u4ef6\u7684\u6587\u4ef6\u540d SendFileName(const char *filename)\uff1b av_open_input_file \u4e2d\u8c03\u7528 \u5f97\u5230\u64ad\u653e\u89c6\u9891\u6587\u4ef6\u7684\u7a97\u53e3\u5750\u6807 SendDisplayArea(const int nWidth,const int nHeight)\uff1b video_image_display \u4e2d\u5728 SDL_DisplayYUVOverlay \u4e4b\u540e\u8c03\u7528 \u5feb\u8fdb\uff0c\u5feb\u9000\u63a7\u5236 SendSeekPos(int64_t timestamp, int flags)\uff1b av_seek_frame \u4e2d\u8c03\u7528","title":"- avformat.h"},{"location":"spice/%E5%87%BD%E6%95%B0%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6/#ffmpegvdagent","text":"","title":"ffmpeg\u5982\u4f55\u4e0evdagent\u901a\u4fe1"},{"location":"spice/%E5%87%BD%E6%95%B0%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6/#_3","text":"Guest OS \u548c Client OS \u4e4b\u95f4\u7684\u901a\u8fc7 UDP \u8fdb\u884c\u6587\u4ef6\u4f20\u8f93","title":"\u6587\u4ef6\u4f20\u8f93\u6a21\u5757\u7684\u5b9e\u73b0"},{"location":"spice/%E5%87%BD%E6%95%B0%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6/#client-os","text":"\u57fa\u4e8eSDL\u7684\u89c6\u9891\u64ad\u653e\u5668\u7684\u5b9e\u73b0\u3002 spice\u5ba2\u6237\u7aef\u7684\u91cd\u65b0\u7f16\u8bd1\uff0c\u6dfb\u52a0\u4e0e\u64ad\u653e\u5668\u4e92\u52a8\u7684\u4ee3\u7801\u3002","title":"Client OS \u89c6\u9891\u64ad\u653e\u6a21\u5757"},{"location":"spice/%E7%AE%80%E4%BB%8B/","text":"\u76ee\u5f55 \u00b6 \u7b97\u6cd5 \u00b6 Quic\u3001GLZ/LZ\u4e3a\u65e0\u635f\u538b\u7f29\u56fe\u7247\u7b97\u6cd5\uff0c\u5c5e\u4e8eSPICE\u4e13\u6709\u7b97\u6cd5\uff1bJPEG\u662f\u6709\u635f\u538b\u7f29\u7b97\u6cd5\u3002 MJPEG\uff08Motion JPEG\uff09\u89c6\u9891\u538b\u7f29\u7b97\u6cd5\uff0c\u4ee525\u5e27/\u79d2\u7684\u901f\u5ea6\u4f7f\u7528JPEG\u7b97\u6cd5\u538b\u7f29\u89c6\u9891\uff0c\u662fspice\u91c7\u7528\u7684\u7b97\u6cd5\u3002 \u64ad\u653e\u89c6\u9891\u65f6\uff0c\u670d\u52a1\u7aef\u89e3\u538b\u89c6\u9891\uff0c\u89e3\u538b\u540e\u901a\u8fc7Guest OS\u7684\u8bbe\u5907\u9a71\u52a8\u4f20\u9012\u7ed9\u4e3b\u673a\uff0c\u4e3b\u673a\u4f7f\u7528MJPEG\u4f20\u9001\u7ed9\u5ba2\u6237\u7aef\u3002 \u89c6\u9891\u5904\u7406\u6d41\u7a0b \u91cd\u5b9a\u5411\u67b6\u6784 \u00b6 \u63a7\u5236\u6d41\u548c\u89c6\u9891\u6570\u636e\u6d41 \u00b6 \u5728\u89c6\u9891\u7684\u4f20\u9001\u64ad\u653e\u8fc7\u7a0b\u4e2d\u4e3b\u8981\u4ea7\u751f\u4e24\u4e2a\u6570\u636e\u6d41\uff1a \u7b2c\u4e00\u4e2a\u662f\u89c6\u9891\u4fe1\u606f\u63a7\u5236\u6d41\uff1a\u4e3b\u8981\u662f\u7531 FFMPEG HOOK \u6a21\u5757\u622a\u83b7\u89c6\u9891\u64ad\u653e\u7684\u76f8\u5173\u6570\u636e\uff0c\u901a\u8fc7 SPICE \u547d\u4ee4\u901a\u9053\u4f20\u7ed9 Client OS \u7aef\uff0c\u6700\u7ec8\u7ed9 FFMPEG Player \u6a21\u5757\u3002 \u7b2c\u4e8c\u4e2a\u662f\u89c6\u9891\u6587\u4ef6\u7684\u4f20\u9001\uff1a\u5728 FFMPEG HOOK \u5f97\u5230\u64ad\u653e\u7684\u6587\u4ef6\u6570\u636e\u540e\uff0c\u89c6\u9891\u7684\u63a7\u5236\u4fe1\u606f\u4f1a\u4f20\u9001\u7ed9 Client0S , FFMPEG Player \u6a21\u5757\u4f1a\u901a\u8fc7 FILE SHARE \u6a21\u5757\u8bf7\u6c42\u6587\u4ef6\u6570\u636e\u3002 \u63a7\u5236\u4fe1\u606f\u4f20\u9001\u4f9d\u8d56spice\u7684\u4f20\u9001\u65b9\u5f0fvirtio-serial\uff08\u4e5f\u53ebisa-serial\uff09\uff1bqemu\u63d0\u4f9b\u4e86\u4e32\u53e3\u8bbe\u5907\u7684\u6a21\u62df\u53ca\u6570\u636e\u4ea4\u6362\u901a\u9053\u3002\u8868\u73b0\u5f62\u5f0f\u662fwindows\u4e2d\u7684\u4e32\u53e3\u8bbe\u5907\u548clinux socket\u6587\u4ef6\uff1b\u4e32\u53e3\u8bbe\u5907\u5b58\u5728\u4e8eGuest OS\u4e2d\uff0clinux socket\u5b58\u5728\u4e8eHost OS\u4e2d\u3002 spice\u63a7\u5236\u4fe1\u606f\u4f20\u9012 \u89c6\u9891\u4f20\u8f93\u547d\u4ee4\u63a7\u5236\u5b9a\u4e49\u4e0e\u5b9e\u73b0 \u00b6 FFMPEG\u89e3\u7801\u5e93\u548c\u89c6\u9891\u4f20\u8f93 \u00b6 \u5173\u95edspice\u89c6\u9891\u538b\u7f29\u65b9\u5f0f \u00b6 \u5728\u89c6\u9891\u91cd\u5b9a\u5411\u7684\u6a21\u5f0f\u4e0b\uff0cspice\u534f\u8bae\u7684\u542f\u52a8\u53c2\u6570\u5206\u522b\u8bbe\u5b9a\u5982\u4e0b\uff1a mage-compression\u2002=\u2002auto_glz\u2002 jpeg-wan-compression\u2002=\u2002never\u2002 zlib-glz-wan-compression\u2002=\u2002never\u2002 streaming-video\u2002= off \u5728GUEST OS\u7aefFFMPEG\u89e3\u7801\u5e93\u7684\u91cd\u5b9a\u4e49 \u00b6 Guest OS \u4e2d\u4fee\u6539\u4e86 FFMPEG \u7684\u89e3\u7801\u5e93,\u5728\u89e3\u7801\u5e93\u4e2d\u76f8\u5173\u51fd\u6570\u4e2d\u622a\u83b7\u4e86\u76f8\u5173\u89c6\u9891\u6587\u4ef6\u6570\u636e\u4ee5\u53ca\u64ad\u653e\u8fc7\u7a0b\u4e2d\u7684\u53c2\u6570\u3002 \u8bfb\u53d6\u89c6\u9891\u6587\u4ef6 \u00b6 \u89c6\u9891\u89e3\u7801\u6a21\u5757 \u00b6 ffplay.c vdagent-win-0.8.0 vdagent spice-gtk client spice-nsis guest spice server \u9700\u8981\u4fee\u6539\u7684\u4ee3\u7801\uff1a vdagent-win-0.8.0 vd_agent.h \u6dfb\u52a0\u547d\u4ee4\u679a\u4e3e\u7c7b \u5b9a\u4e49\u6d88\u606f\u7684\u7ed3\u6784\u4f53 vdagent.cpp dispatch_message(VDAgentMessage* msg, uint32_t port) \u5904\u7406\u547d\u4ee4\uff0c\u5c06\u6570\u636e\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef","title":"\u7b80\u4ecb"},{"location":"spice/%E7%AE%80%E4%BB%8B/#_1","text":"","title":"\u76ee\u5f55"},{"location":"spice/%E7%AE%80%E4%BB%8B/#_2","text":"Quic\u3001GLZ/LZ\u4e3a\u65e0\u635f\u538b\u7f29\u56fe\u7247\u7b97\u6cd5\uff0c\u5c5e\u4e8eSPICE\u4e13\u6709\u7b97\u6cd5\uff1bJPEG\u662f\u6709\u635f\u538b\u7f29\u7b97\u6cd5\u3002 MJPEG\uff08Motion JPEG\uff09\u89c6\u9891\u538b\u7f29\u7b97\u6cd5\uff0c\u4ee525\u5e27/\u79d2\u7684\u901f\u5ea6\u4f7f\u7528JPEG\u7b97\u6cd5\u538b\u7f29\u89c6\u9891\uff0c\u662fspice\u91c7\u7528\u7684\u7b97\u6cd5\u3002 \u64ad\u653e\u89c6\u9891\u65f6\uff0c\u670d\u52a1\u7aef\u89e3\u538b\u89c6\u9891\uff0c\u89e3\u538b\u540e\u901a\u8fc7Guest OS\u7684\u8bbe\u5907\u9a71\u52a8\u4f20\u9012\u7ed9\u4e3b\u673a\uff0c\u4e3b\u673a\u4f7f\u7528MJPEG\u4f20\u9001\u7ed9\u5ba2\u6237\u7aef\u3002 \u89c6\u9891\u5904\u7406\u6d41\u7a0b","title":"\u7b97\u6cd5"},{"location":"spice/%E7%AE%80%E4%BB%8B/#_3","text":"","title":"\u91cd\u5b9a\u5411\u67b6\u6784"},{"location":"spice/%E7%AE%80%E4%BB%8B/#_4","text":"\u5728\u89c6\u9891\u7684\u4f20\u9001\u64ad\u653e\u8fc7\u7a0b\u4e2d\u4e3b\u8981\u4ea7\u751f\u4e24\u4e2a\u6570\u636e\u6d41\uff1a \u7b2c\u4e00\u4e2a\u662f\u89c6\u9891\u4fe1\u606f\u63a7\u5236\u6d41\uff1a\u4e3b\u8981\u662f\u7531 FFMPEG HOOK \u6a21\u5757\u622a\u83b7\u89c6\u9891\u64ad\u653e\u7684\u76f8\u5173\u6570\u636e\uff0c\u901a\u8fc7 SPICE \u547d\u4ee4\u901a\u9053\u4f20\u7ed9 Client OS \u7aef\uff0c\u6700\u7ec8\u7ed9 FFMPEG Player \u6a21\u5757\u3002 \u7b2c\u4e8c\u4e2a\u662f\u89c6\u9891\u6587\u4ef6\u7684\u4f20\u9001\uff1a\u5728 FFMPEG HOOK \u5f97\u5230\u64ad\u653e\u7684\u6587\u4ef6\u6570\u636e\u540e\uff0c\u89c6\u9891\u7684\u63a7\u5236\u4fe1\u606f\u4f1a\u4f20\u9001\u7ed9 Client0S , FFMPEG Player \u6a21\u5757\u4f1a\u901a\u8fc7 FILE SHARE \u6a21\u5757\u8bf7\u6c42\u6587\u4ef6\u6570\u636e\u3002 \u63a7\u5236\u4fe1\u606f\u4f20\u9001\u4f9d\u8d56spice\u7684\u4f20\u9001\u65b9\u5f0fvirtio-serial\uff08\u4e5f\u53ebisa-serial\uff09\uff1bqemu\u63d0\u4f9b\u4e86\u4e32\u53e3\u8bbe\u5907\u7684\u6a21\u62df\u53ca\u6570\u636e\u4ea4\u6362\u901a\u9053\u3002\u8868\u73b0\u5f62\u5f0f\u662fwindows\u4e2d\u7684\u4e32\u53e3\u8bbe\u5907\u548clinux socket\u6587\u4ef6\uff1b\u4e32\u53e3\u8bbe\u5907\u5b58\u5728\u4e8eGuest OS\u4e2d\uff0clinux socket\u5b58\u5728\u4e8eHost OS\u4e2d\u3002 spice\u63a7\u5236\u4fe1\u606f\u4f20\u9012","title":"\u63a7\u5236\u6d41\u548c\u89c6\u9891\u6570\u636e\u6d41"},{"location":"spice/%E7%AE%80%E4%BB%8B/#_5","text":"","title":"\u89c6\u9891\u4f20\u8f93\u547d\u4ee4\u63a7\u5236\u5b9a\u4e49\u4e0e\u5b9e\u73b0"},{"location":"spice/%E7%AE%80%E4%BB%8B/#ffmpeg","text":"","title":"FFMPEG\u89e3\u7801\u5e93\u548c\u89c6\u9891\u4f20\u8f93"},{"location":"spice/%E7%AE%80%E4%BB%8B/#spice","text":"\u5728\u89c6\u9891\u91cd\u5b9a\u5411\u7684\u6a21\u5f0f\u4e0b\uff0cspice\u534f\u8bae\u7684\u542f\u52a8\u53c2\u6570\u5206\u522b\u8bbe\u5b9a\u5982\u4e0b\uff1a mage-compression\u2002=\u2002auto_glz\u2002 jpeg-wan-compression\u2002=\u2002never\u2002 zlib-glz-wan-compression\u2002=\u2002never\u2002 streaming-video\u2002= off","title":"\u5173\u95edspice\u89c6\u9891\u538b\u7f29\u65b9\u5f0f"},{"location":"spice/%E7%AE%80%E4%BB%8B/#guest-osffmpeg","text":"Guest OS \u4e2d\u4fee\u6539\u4e86 FFMPEG \u7684\u89e3\u7801\u5e93,\u5728\u89e3\u7801\u5e93\u4e2d\u76f8\u5173\u51fd\u6570\u4e2d\u622a\u83b7\u4e86\u76f8\u5173\u89c6\u9891\u6587\u4ef6\u6570\u636e\u4ee5\u53ca\u64ad\u653e\u8fc7\u7a0b\u4e2d\u7684\u53c2\u6570\u3002","title":"\u5728GUEST OS\u7aefFFMPEG\u89e3\u7801\u5e93\u7684\u91cd\u5b9a\u4e49"},{"location":"spice/%E7%AE%80%E4%BB%8B/#_6","text":"","title":"\u8bfb\u53d6\u89c6\u9891\u6587\u4ef6"},{"location":"spice/%E7%AE%80%E4%BB%8B/#_7","text":"ffplay.c vdagent-win-0.8.0 vdagent spice-gtk client spice-nsis guest spice server \u9700\u8981\u4fee\u6539\u7684\u4ee3\u7801\uff1a vdagent-win-0.8.0 vd_agent.h \u6dfb\u52a0\u547d\u4ee4\u679a\u4e3e\u7c7b \u5b9a\u4e49\u6d88\u606f\u7684\u7ed3\u6784\u4f53 vdagent.cpp dispatch_message(VDAgentMessage* msg, uint32_t port) \u5904\u7406\u547d\u4ee4\uff0c\u5c06\u6570\u636e\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef","title":"\u89c6\u9891\u89e3\u7801\u6a21\u5757"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ESXI-hypervisor%E8%BD%AC%E6%8D%A2/","text":"VMware-ESXi-hypervisor\u865a\u62df\u673a\u8f6c\u6362 \u00b6 \u6240\u6709\u7684VMware\u5e73\u53f0\u7684windows\u865a\u62df\u673a\u90fd\u9700\u8981\u5148\u5378\u8f7d VMware-tools \u3002 \u8f93\u51fa\u5230ovirt\u53c2\u8003\uff1a VMware-ova\u8f6c\u6362 \u5c3d\u91cf\u4f7f\u7528ova\u6216vmx\u7684\u8f93\u5165\u65b9\u5f0f\uff0c\u56e0\u4e3a\u5b83\u4eec\u6bd4\u672c\u7bc7\u7684\u65b9\u6cd5\u66f4\u5feb\u4e14\u9700\u8981\u7684\u7a7a\u95f4\u4e5f\u66f4\u5c11\u3002 \u53ef\u4ee5\u5148\u4f7f\u7528 virt-v2v-copy-to-local(1) \u62f7\u8d1d\u865a\u62df\u673a\u4ecehypervisor\u5230\u672c\u5730\u6587\u4ef6\uff0c\u7136\u540e\u8f6c\u6362\u5b83\u3002 1. URI \u00b6 esx://root@esxi.example.com?no_verify = 1 ?no_verify=1 \u53c2\u6570\u7528\u4e8e\u53d6\u6d88TLS\u8bc1\u4e66\u68c0\u67e5\u3002 2. \u6d4b\u8bd5libvirt\u5230ESXi hypervisor\u7684\u8fde\u63a5 \u00b6 \u4f7f\u7528 virsh \u5de5\u5177\uff1a $ virsh -c esx://root@esxi.example.com?no_verify = 1 list --all Enter root ' s password for esxi.example.com: *** Id Name State ---------------------------------------------------- - guest shut off 3. \u590d\u5236\u865a\u62df\u673a\u5230\u672c\u5730 \u00b6 \u4f7f\u7528libvirt URI\u7684 -ic \u9009\u9879\uff0c\u590d\u5236\u4e00\u4e2a\u865a\u62df\u673a\u5230\u672c\u5730\uff1a $ virt-v2v-copy-to-local -ic esx://root@esxi.example.com?no_verify = 1 guest \u521b\u5efa guest.xml , guest-disk1 , ... \u6b64\u8fc7\u7a0b\u4e2d\u5171\u9700\u8981\u8f93\u5165\u4e09\u6b21\u5bc6\u7801\uff0c\u7b2c\u4e00\u6b21\u662flibvirt\u8fde\u63a5\u65f6\uff0c\u540e\u4e24\u6b21\u662fcurl\u547d\u4ee4\u8fde\u63a5\u65f6\uff08\u4e00\u5757\u78c1\u76d8\u4e24\u6b21\uff0c\u4e24\u5757\u78c1\u76d8\u5c31\u662f\u56db\u6b21\u2026\u2026\uff09\uff0c --password-file <file> \u9009\u9879\u53ef\u4ee5\u4ee3\u66ff\u624b\u52a8\u8f93\u5165\u5bc6\u7801\u3002 4. \u6267\u884c virt-v2v \u8f6c\u6362 \u00b6 $ virt-v2v -i libvirtxml guest.xml -o local -os /var/tmp 5. \u6e05\u7406 \u00b6 \u5220\u6389 guest.xml \u3001 guest-disk* \u6587\u4ef6","title":"VMware-ESXI-hypervisor\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ESXI-hypervisor%E8%BD%AC%E6%8D%A2/#vmware-esxi-hypervisor","text":"\u6240\u6709\u7684VMware\u5e73\u53f0\u7684windows\u865a\u62df\u673a\u90fd\u9700\u8981\u5148\u5378\u8f7d VMware-tools \u3002 \u8f93\u51fa\u5230ovirt\u53c2\u8003\uff1a VMware-ova\u8f6c\u6362 \u5c3d\u91cf\u4f7f\u7528ova\u6216vmx\u7684\u8f93\u5165\u65b9\u5f0f\uff0c\u56e0\u4e3a\u5b83\u4eec\u6bd4\u672c\u7bc7\u7684\u65b9\u6cd5\u66f4\u5feb\u4e14\u9700\u8981\u7684\u7a7a\u95f4\u4e5f\u66f4\u5c11\u3002 \u53ef\u4ee5\u5148\u4f7f\u7528 virt-v2v-copy-to-local(1) \u62f7\u8d1d\u865a\u62df\u673a\u4ecehypervisor\u5230\u672c\u5730\u6587\u4ef6\uff0c\u7136\u540e\u8f6c\u6362\u5b83\u3002","title":"VMware-ESXi-hypervisor\u865a\u62df\u673a\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ESXI-hypervisor%E8%BD%AC%E6%8D%A2/#1-uri","text":"esx://root@esxi.example.com?no_verify = 1 ?no_verify=1 \u53c2\u6570\u7528\u4e8e\u53d6\u6d88TLS\u8bc1\u4e66\u68c0\u67e5\u3002","title":"1. URI"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ESXI-hypervisor%E8%BD%AC%E6%8D%A2/#2-libvirtesxi-hypervisor","text":"\u4f7f\u7528 virsh \u5de5\u5177\uff1a $ virsh -c esx://root@esxi.example.com?no_verify = 1 list --all Enter root ' s password for esxi.example.com: *** Id Name State ---------------------------------------------------- - guest shut off","title":"2. \u6d4b\u8bd5libvirt\u5230ESXi hypervisor\u7684\u8fde\u63a5"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ESXI-hypervisor%E8%BD%AC%E6%8D%A2/#3","text":"\u4f7f\u7528libvirt URI\u7684 -ic \u9009\u9879\uff0c\u590d\u5236\u4e00\u4e2a\u865a\u62df\u673a\u5230\u672c\u5730\uff1a $ virt-v2v-copy-to-local -ic esx://root@esxi.example.com?no_verify = 1 guest \u521b\u5efa guest.xml , guest-disk1 , ... \u6b64\u8fc7\u7a0b\u4e2d\u5171\u9700\u8981\u8f93\u5165\u4e09\u6b21\u5bc6\u7801\uff0c\u7b2c\u4e00\u6b21\u662flibvirt\u8fde\u63a5\u65f6\uff0c\u540e\u4e24\u6b21\u662fcurl\u547d\u4ee4\u8fde\u63a5\u65f6\uff08\u4e00\u5757\u78c1\u76d8\u4e24\u6b21\uff0c\u4e24\u5757\u78c1\u76d8\u5c31\u662f\u56db\u6b21\u2026\u2026\uff09\uff0c --password-file <file> \u9009\u9879\u53ef\u4ee5\u4ee3\u66ff\u624b\u52a8\u8f93\u5165\u5bc6\u7801\u3002","title":"3. \u590d\u5236\u865a\u62df\u673a\u5230\u672c\u5730"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ESXI-hypervisor%E8%BD%AC%E6%8D%A2/#4-virt-v2v","text":"$ virt-v2v -i libvirtxml guest.xml -o local -os /var/tmp","title":"4. \u6267\u884c virt-v2v \u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ESXI-hypervisor%E8%BD%AC%E6%8D%A2/#5","text":"\u5220\u6389 guest.xml \u3001 guest-disk* \u6587\u4ef6","title":"5. \u6e05\u7406"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ova%E8%BD%AC%E6%8D%A2/","text":"VMware-ova\u865a\u62df\u673a\u8f6c\u6362 \u00b6 \u6240\u6709\u7684VMware\u5e73\u53f0\u7684windows\u865a\u62df\u673a\u90fd\u9700\u8981\u5148\u5378\u8f7d VMware-tools \u3002 \u521b\u5efaova \u00b6 \u521b\u5efaova\u6587\u4ef6\u6709\u4e24\u79cd\u65b9\u5f0f\u3002\u7b2c\u4e00\u79cd\u662f\u901a\u8fc7\u754c\u9762\u7684\u5bfc\u51faovf\uff0covf\u5f62\u5f0f\u5bfc\u51fa\u4e3a\u6587\u4ef6\u5939\uff0cova\u5f62\u5f0f\u5bfc\u51fa\u4e3a\u6587\u4ef6\u3002\u7b2c\u4e8c\u79cd\u662f\u4f7f\u7528VMware\u7684\u4e13\u6709\u5de5\u5177 ovftool \uff1a ovftool --noSSLVerify \\ vi://USER:PASSWORD@esxi.example.com/VM \\ VM.ova \u8fde\u63a5\u5230vCenter\uff1a ovftool --noSSLVerify \\ vi://USER:PASSWORD@vcenter.example.com/DATACENTER-NAME/vm/VM \\ VM.ova \u5bf9\u4e8eActive Directory-aware\u9a8c\u8bc1\uff0c\u4f60\u5fc5\u987b\u4ee5ascii\u5341\u516d\u8fdb\u5236\u4ee3\u7801\uff08\\\uff09\u7684\u5f62\u5f0f\u8868\u8fbe@\u5b57\u7b26\uff1a vi://DOMAIN%5cUSER:PASSWORD@... \u6302\u8f7d\u76ee\u5f55 \u00b6 Linux\u5b89\u88c5\u6302\u8f7d\u5de5\u5177 yum install cifs-utils \u6302\u8f7dwindows\u76ee\u5f55 mount.cifs [//172.16.2.27/ova](notion://172.16.2.27/ova) /tmp/ova_tmp -o user=phy,pass=KVM.123456 \u6302\u8f7d\u5931\u8d25\u65f6\u52a0\u4e0a\u53c2\u6570\uff1a mount.cifs //172.16.2.27/ova ova_tmp/ -o user=phy,pass=KVM.123456,sec=ntlm \u6267\u884c\u8f6c\u6362 \u00b6 \u8f93\u51fa\u5230ovirt\u7684\u9009\u9879 virt-v2v -i ova guest.ova \\ -o rhv-upload -oc https://ovirt-engine.example.com/ovirt-engine/api \\ -os ovirt-data -op /tmp/ovirt-admin-password -of raw \\ -oo rhv-cafile=/tmp/ca.pem -oo rhv-direct \\ --bridge ovirtmgmt \u901a\u8fc7REST API\u76f4\u63a5\u4e0a\u4f20\u5ba2\u6237\u673a\u5230oVirt\u6216RHV\uff0c\u8981\u6c42 oVirt/RHV \u2265 4.2 \u6307\u5b9a -o rhv-upload -oc https://ovirt-engine.example.com/ovirt-engine/api?username=admin@internal \u53ef\u5411URL\u6dfb\u52a0\u7528\u6237\u540d\u6216\u7aef\u53e3\u53f7\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u7528\u6237\u540d\u5219\u4f7f\u7528 admin@internal -of raw \u53ea\u80fd\u8f93\u51faraw\u683c\u5f0f\u7684\u78c1\u76d8 -op password-file \u7528\u4e8e\u8fde\u63a5ovirt-engine\u7684\u5bc6\u7801\u6587\u4ef6\u3002\u8be5\u6587\u4ef6\u5e94\u5305\u542b\u5b8c\u6574\u7684\u5bc6\u7801\uff0c\u672b\u5c3e\u4e0d\u80fd\u6709\u6362\u884c\u7b26\uff0c\u6743\u9650\u6539\u4e3a0600\u3002 -os ovirt-data \u5b58\u50a8\u57df -oo rhv-cafile=ca.pem ca.pem\u6587\u4ef6\uff08\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff09\uff0c\u4eceovirt-engine\u4e0a\u7684 /etc/pki/ovirt-engine/ca.pem \u590d\u5236\u3002 -oo rhv-cluster=CLUSTERNAME \u96c6\u7fa4\u7684\u540d\u5b57\u3002\u9ed8\u8ba4\u4f7f\u7528 Default -oo rhv-direct \u8868\u793a\u4f1a\u76f4\u63a5\u4e0a\u4f20\u78c1\u76d8\u5230ovirt-node\uff0c\u5426\u5219\u901a\u8fc7ovirt-engine\u4ee3\u7406\u4e0a\u4f20\u78c1\u76d8\u3002\u76f4\u63a5\u4e0a\u4f20\u8981\u6c42\u7f51\u7edc\u80fd\u8bbf\u95ee\u5230node\u3002\u975e\u76f4\u63a5\u4e0a\u4f20\u7684\u65b9\u5f0f\u4f1a\u6709\u70b9\u6162\uff0c\u4f46\u662f\u80fd\u5728\u6240\u6709\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002 -oo rhv-verifypeer \u901a\u8fc7\u9488\u5bf9\u9881\u53d1\u673a\u6784\u68c0\u67e5\u670d\u52a1\u5668\u7684\u8bc1\u4e66\u6765\u9a8c\u8bc1oVirt/RHV\u670d\u52a1\u5668\u7684\u8eab\u4efd\u3002 \u8f93\u51fa\u5230ovirt\uff08\u8001\u65b9\u6cd5\uff09 \u672c\u8282\u8bf4\u660e\u53ea\u9002\u7528\u4e8e -o rhv \u8f93\u51fa\u6a21\u5f0f\u3002 \u5982\u679c\u4f60\u4f7f\u7528RHV-M\u7528\u6237\u754c\u9762\u7684virt-v2v\uff0c\u90a3\u4e48\u5728\u540e\u53f0\u4f7f\u7528 -o vdsm \u8f93\u51fa\u6a21\u5f0f\u7531vdsm\u7ba1\u7406\u5bfc\u5165\u3002 \u4f60\u5fc5\u987b\u6307\u5b9a -o rhv \u548c -os \u9009\u9879\u6307\u660eRHV-M\u7684\u5bfc\u51fa\u57df\u3002\u4e5f\u53ef\u4ee5\u6307\u5b9aNFS\u670d\u52a1\u5668\u548c\u6302\u8f7d\u70b9\uff0c\u4f8b\u5982 -os rhv-storage:/rhv/export \uff0c\u6216\u8005\u5148\u6302\u8f7d\u7136\u540e\u6307\u5b9a\u6302\u8f7d\u70b9\uff0c\u4f8b\u5982 -os /tmp/mnt \u3002 \u4e0d\u8981\u6307\u5411\u6570\u636e\u57df \u3002 \u4e0d\u652f\u6301 -oo \u3001 -op \u9009\u9879\uff0c\u4e0d\u9700\u8981 -oc \u9009\u9879\u3002 \u5b9e\u9645\u64cd\u4f5c \u51c6\u5907\u73af\u5883 #\u5b89\u88c5pip wget https://bootstrap.pypa.io/get-pip.py python get-pip.py #\u5b89\u88c5ovirtsdk4\u6a21\u5757 yum install gcc libxml2-devel python-devel pip install ovirt-engine-sdk-python == 4 .2.5 \u8fdb\u884c\u8f6c\u6362 virt-v2v -v -x -i ova ova_190319140049/centos2.ova -o rhv -os 172 .16.2.124:/home/exports -of raw/qcow2 -bridge ovirtmgmt 2 > & 1 | tee virt-v2v-ovirt.log \u95ee\u9898 \u7531\u4e8eova\u4e0d\u5305\u542b\u7f51\u5361\u7684mac\u5730\u5740\uff0c\u6240\u4ee5\u9700\u8981\u5728\u754c\u9762\u4e2d\u6307\u5b9a\u7f51\u5361\u7684mac\u5730\u5740\uff0c\u6216\u8005\u76f4\u63a5\u4fee\u6539ocml\u4e2d\u751f\u6210\u7684xml\u6587\u4ef6\uff0c\u6dfb\u52a0mac\u4fe1\u606f\u3002","title":"VMware-ova\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ova%E8%BD%AC%E6%8D%A2/#vmware-ova","text":"\u6240\u6709\u7684VMware\u5e73\u53f0\u7684windows\u865a\u62df\u673a\u90fd\u9700\u8981\u5148\u5378\u8f7d VMware-tools \u3002","title":"VMware-ova\u865a\u62df\u673a\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ova%E8%BD%AC%E6%8D%A2/#ova","text":"\u521b\u5efaova\u6587\u4ef6\u6709\u4e24\u79cd\u65b9\u5f0f\u3002\u7b2c\u4e00\u79cd\u662f\u901a\u8fc7\u754c\u9762\u7684\u5bfc\u51faovf\uff0covf\u5f62\u5f0f\u5bfc\u51fa\u4e3a\u6587\u4ef6\u5939\uff0cova\u5f62\u5f0f\u5bfc\u51fa\u4e3a\u6587\u4ef6\u3002\u7b2c\u4e8c\u79cd\u662f\u4f7f\u7528VMware\u7684\u4e13\u6709\u5de5\u5177 ovftool \uff1a ovftool --noSSLVerify \\ vi://USER:PASSWORD@esxi.example.com/VM \\ VM.ova \u8fde\u63a5\u5230vCenter\uff1a ovftool --noSSLVerify \\ vi://USER:PASSWORD@vcenter.example.com/DATACENTER-NAME/vm/VM \\ VM.ova \u5bf9\u4e8eActive Directory-aware\u9a8c\u8bc1\uff0c\u4f60\u5fc5\u987b\u4ee5ascii\u5341\u516d\u8fdb\u5236\u4ee3\u7801\uff08\\\uff09\u7684\u5f62\u5f0f\u8868\u8fbe@\u5b57\u7b26\uff1a vi://DOMAIN%5cUSER:PASSWORD@...","title":"\u521b\u5efaova"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ova%E8%BD%AC%E6%8D%A2/#_1","text":"Linux\u5b89\u88c5\u6302\u8f7d\u5de5\u5177 yum install cifs-utils \u6302\u8f7dwindows\u76ee\u5f55 mount.cifs [//172.16.2.27/ova](notion://172.16.2.27/ova) /tmp/ova_tmp -o user=phy,pass=KVM.123456 \u6302\u8f7d\u5931\u8d25\u65f6\u52a0\u4e0a\u53c2\u6570\uff1a mount.cifs //172.16.2.27/ova ova_tmp/ -o user=phy,pass=KVM.123456,sec=ntlm","title":"\u6302\u8f7d\u76ee\u5f55"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-ova%E8%BD%AC%E6%8D%A2/#_2","text":"\u8f93\u51fa\u5230ovirt\u7684\u9009\u9879 virt-v2v -i ova guest.ova \\ -o rhv-upload -oc https://ovirt-engine.example.com/ovirt-engine/api \\ -os ovirt-data -op /tmp/ovirt-admin-password -of raw \\ -oo rhv-cafile=/tmp/ca.pem -oo rhv-direct \\ --bridge ovirtmgmt \u901a\u8fc7REST API\u76f4\u63a5\u4e0a\u4f20\u5ba2\u6237\u673a\u5230oVirt\u6216RHV\uff0c\u8981\u6c42 oVirt/RHV \u2265 4.2 \u6307\u5b9a -o rhv-upload -oc https://ovirt-engine.example.com/ovirt-engine/api?username=admin@internal \u53ef\u5411URL\u6dfb\u52a0\u7528\u6237\u540d\u6216\u7aef\u53e3\u53f7\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u7528\u6237\u540d\u5219\u4f7f\u7528 admin@internal -of raw \u53ea\u80fd\u8f93\u51faraw\u683c\u5f0f\u7684\u78c1\u76d8 -op password-file \u7528\u4e8e\u8fde\u63a5ovirt-engine\u7684\u5bc6\u7801\u6587\u4ef6\u3002\u8be5\u6587\u4ef6\u5e94\u5305\u542b\u5b8c\u6574\u7684\u5bc6\u7801\uff0c\u672b\u5c3e\u4e0d\u80fd\u6709\u6362\u884c\u7b26\uff0c\u6743\u9650\u6539\u4e3a0600\u3002 -os ovirt-data \u5b58\u50a8\u57df -oo rhv-cafile=ca.pem ca.pem\u6587\u4ef6\uff08\u8bc1\u4e66\u9881\u53d1\u673a\u6784\uff09\uff0c\u4eceovirt-engine\u4e0a\u7684 /etc/pki/ovirt-engine/ca.pem \u590d\u5236\u3002 -oo rhv-cluster=CLUSTERNAME \u96c6\u7fa4\u7684\u540d\u5b57\u3002\u9ed8\u8ba4\u4f7f\u7528 Default -oo rhv-direct \u8868\u793a\u4f1a\u76f4\u63a5\u4e0a\u4f20\u78c1\u76d8\u5230ovirt-node\uff0c\u5426\u5219\u901a\u8fc7ovirt-engine\u4ee3\u7406\u4e0a\u4f20\u78c1\u76d8\u3002\u76f4\u63a5\u4e0a\u4f20\u8981\u6c42\u7f51\u7edc\u80fd\u8bbf\u95ee\u5230node\u3002\u975e\u76f4\u63a5\u4e0a\u4f20\u7684\u65b9\u5f0f\u4f1a\u6709\u70b9\u6162\uff0c\u4f46\u662f\u80fd\u5728\u6240\u6709\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002 -oo rhv-verifypeer \u901a\u8fc7\u9488\u5bf9\u9881\u53d1\u673a\u6784\u68c0\u67e5\u670d\u52a1\u5668\u7684\u8bc1\u4e66\u6765\u9a8c\u8bc1oVirt/RHV\u670d\u52a1\u5668\u7684\u8eab\u4efd\u3002 \u8f93\u51fa\u5230ovirt\uff08\u8001\u65b9\u6cd5\uff09 \u672c\u8282\u8bf4\u660e\u53ea\u9002\u7528\u4e8e -o rhv \u8f93\u51fa\u6a21\u5f0f\u3002 \u5982\u679c\u4f60\u4f7f\u7528RHV-M\u7528\u6237\u754c\u9762\u7684virt-v2v\uff0c\u90a3\u4e48\u5728\u540e\u53f0\u4f7f\u7528 -o vdsm \u8f93\u51fa\u6a21\u5f0f\u7531vdsm\u7ba1\u7406\u5bfc\u5165\u3002 \u4f60\u5fc5\u987b\u6307\u5b9a -o rhv \u548c -os \u9009\u9879\u6307\u660eRHV-M\u7684\u5bfc\u51fa\u57df\u3002\u4e5f\u53ef\u4ee5\u6307\u5b9aNFS\u670d\u52a1\u5668\u548c\u6302\u8f7d\u70b9\uff0c\u4f8b\u5982 -os rhv-storage:/rhv/export \uff0c\u6216\u8005\u5148\u6302\u8f7d\u7136\u540e\u6307\u5b9a\u6302\u8f7d\u70b9\uff0c\u4f8b\u5982 -os /tmp/mnt \u3002 \u4e0d\u8981\u6307\u5411\u6570\u636e\u57df \u3002 \u4e0d\u652f\u6301 -oo \u3001 -op \u9009\u9879\uff0c\u4e0d\u9700\u8981 -oc \u9009\u9879\u3002 \u5b9e\u9645\u64cd\u4f5c \u51c6\u5907\u73af\u5883 #\u5b89\u88c5pip wget https://bootstrap.pypa.io/get-pip.py python get-pip.py #\u5b89\u88c5ovirtsdk4\u6a21\u5757 yum install gcc libxml2-devel python-devel pip install ovirt-engine-sdk-python == 4 .2.5 \u8fdb\u884c\u8f6c\u6362 virt-v2v -v -x -i ova ova_190319140049/centos2.ova -o rhv -os 172 .16.2.124:/home/exports -of raw/qcow2 -bridge ovirtmgmt 2 > & 1 | tee virt-v2v-ovirt.log \u95ee\u9898 \u7531\u4e8eova\u4e0d\u5305\u542b\u7f51\u5361\u7684mac\u5730\u5740\uff0c\u6240\u4ee5\u9700\u8981\u5728\u754c\u9762\u4e2d\u6307\u5b9a\u7f51\u5361\u7684mac\u5730\u5740\uff0c\u6216\u8005\u76f4\u63a5\u4fee\u6539ocml\u4e2d\u751f\u6210\u7684xml\u6587\u4ef6\uff0c\u6dfb\u52a0mac\u4fe1\u606f\u3002","title":"\u6267\u884c\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/","text":"VMware-vCenter\u865a\u62df\u673a\u8f6c\u6362 \u00b6 \u4ece VMware vCenter \u8f6c\u6362\u865a\u62df\u673a\u5230 ovirt \u5e73\u53f0\u3002 \u8981\u6c42 \uff1avCenter >= 5.0 \u4e3e\u4f8b\u573a\u666f\uff1a \u6709\u4e00\u4e2aVMware vCenter\u670d\u52a1\u5668\uff0c\u5730\u5740\u662f vcenter.example.com \uff0c\u4e00\u4e2a\u6570\u636e\u4e2d\u5fc3 Datacenter \uff0c\u548c\u4e00\u4e2a ESXi hypervisor \u53eb\u505a esxi \u3002\u8981\u8f6c\u6362\u7684\u865a\u62df\u673a\u53eb vmware_guest \u3002 virt-v2v -ic vpx://vcenter.example.com/Datacenter/esxi vmware_guest \\ -o rhv-upload -oc https://ovirt-engine.example.com/ovirt-engine/api \\ -os ovirt-data -op /tmp/ovirt-admin-password -of raw \\ -oo rhv-cafile = /tmp/ca.pem -oo rhv-direct \\ --bridge ovirtmgmt \u8f93\u51fa\u5230ovirt\u53c2\u8003\uff1a VMware-ova\u8f6c\u6362 \u8f93\u5165\u6a21\u5f0f \u00b6 \u9ed8\u8ba4\u4f7f\u7528libvirt\u4ecevCenter\u83b7\u53d6\u4fe1\u606f\uff0c\u6240\u4ee5\u4f7f\u7528\u8be5\u6a21\u5f0f\u65f6\u9ed8\u8ba4\u6dfb\u52a0 -i libvirt \u9009\u9879\u3002 1. vCenter\uff1a\u4ecewindows\u5ba2\u6237\u673a\u79fb\u9664 VMware-tools \u00b6 \u5bf9\u4e8ewindows\u5ba2\u6237\u673a\uff0c\u5728\u8f6c\u6362\u4e4b\u524d\u9700\u8981\u5c06 VMware-tools \u79fb\u9664\u3002\u5426\u5219\u5728\u8f6c\u6362\u5b8c\u6210\u4e4b\u540e\u6bcf\u6b21\u542f\u52a8\u5ba2\u6237\u673a\u7684\u65f6\u5019\u90fd\u4f1a\u62b1\u6028\uff0c\u5e76\u4e14\u8be5\u5de5\u5177\u4e0d\u80fd\u5378\u8f7d\u3002 2. vCenter\uff1aURI \u00b6 libvirt URI \u683c\u5f0f\uff1a vpx://user@server/Datacenter/esxi user@ \u53ef\u9009\u3002\u5982\u679c\u5305\u542b \\ \uff08eg. DOMAIN\\USER \uff09\uff0c\u4f7f\u7528 %5c \uff08\u5341\u516d\u8fdb\u5236ASCII\u7801\uff09\u4ee3\u66ff\uff08eg. DOMAIN%5cUSER \uff09\u3002\u5176\u5b83\u6807\u70b9\u7b26\u53f7\u53ef\u80fd\u4e5f\u9700\u8981\u5982\u6b64\u3002@\u662f %40 \uff0c . \u4e0d\u9700\u8981\u8f6c\u6362\uff0c \u53ef\u5728\u6b64\u67e5\u8be2 \u3002\u8fd9\u4e2a\u5730\u65b9\u4e00\u5b9a\u8981\u52a0\u4e0a\u57df\u540d\uff0c\u4f8b\uff1a vpx://administrator%40vsphere.local@172.16.2.178/Datacenter/cluster/172.16.2.162?no_verify=1 server \u670d\u52a1\u5668\u57df\u540d Datacenter \u6570\u636e\u4e2d\u5fc3\u7684\u540d\u5b57\u3002\u7a7a\u683c\u4f7f\u7528 %20 \u4ee3\u66ff\u3002 esxi \u8fd0\u884c\u865a\u62df\u673a\u7684ESXi hypervisor\u7684\u540d\u5b57 \u5982\u679c\u4f7f\u7528\u6587\u4ef6\u5939\u90e8\u7f72VMware\uff0c\u53ef\u80fd\u9700\u8981\u5c06\u5176\u6dfb\u52a0\u5230URI\uff0ceg\uff1a vpx://user@server/Folder/Datacenter/esxi \u8be6\u7ec6\u7684libvirt URIs 3. \u6d4b\u8bd5libvirt\u5230vCenter\u7684\u8fde\u63a5 \u00b6 \u4f7f\u7528 virsh \u5217\u51fa\u865a\u62df\u673a\uff1a $ virsh -c 'vpx://root@vcenter.example.com/Datacenter/esxi' list --all Enter root ' s password for vcenter.example.com: *** Id Name State ---------------------------------------------------- - Fedora 20 shut off - Windows 2003 shut off \u5982\u679c\u51fa\u73b0\u4e86\u8bc1\u4e66\u76f8\u5173\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u5bfc\u5165vCenter\u4e3b\u673a\u7684\u8bc1\u4e66\uff0c\u6216\u8005\u8df3\u8fc7\u8bc1\u4e66\u9a8c\u8bc1\uff1a $ virsh -c 'vpx://root@vcenter.example.com/Datacenter/esxi?no_verify=1' list --all \u4f60\u4e5f\u5e94\u8be5\u5c1d\u8bd5\u4ece\u4efb\u610f\u865a\u62df\u673a\u590d\u5236\u5143\u6570\u636e\uff1a $ virsh -c 'vpx://root@vcenter.example.com/Datacenter/esxi' dumpxml \"Windows 2003\" <domain type = 'vmware' > <name>Windows 2003 </name> [ ... ] </domain> \u5982\u679c\u4e0a\u8ff0\u6b65\u9aa4\u5931\u8d25\u4e86\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u8fdb\u884c\u8f6c\u6362\uff01 4. vCenter\uff1a\u5bfc\u5165\u865a\u62df\u673a \u00b6 $ virt-v2v -ic 'vpx://root@vcenter.example.com/Datacenter/esxi?no_verify=1' \\ \"Windows 2003\" \\ --password-file vCenter.pass -o local -os /var/tmp \u865a\u62df\u673a\u5fc5\u987b\u5173\u673a \u3002 \u5982\u679c\u4e0d\u60f3\u5728\u8f6c\u6362\u65f6\u8f93\u5165\u5bc6\u7801\uff0c\u4f7f\u7528 --password-file <file> \u9009\u9879\u6307\u5b9a\u5bc6\u7801\u6587\u4ef6\u3002 5. vCenter\uff1aNon-Administrator \u89d2\u8272 \u00b6 \u53ef\u4ee5\u4f7f\u7528\u975e\u7ba1\u7406\u5458\u89d2\u8272\u6267\u884c\u8f6c\u6362\uff0c\u4f46\u662f\u9700\u8981\u4e3a\u5176\u63d0\u4f9b\u6700\u5c0f\u6743\u9650\uff1a \u5728vCenter\u521b\u5efa\u89d2\u8272 \u6253\u5f00\u4ee5\u4e0b\u5bf9\u8c61 Datastore: - Browse datastore - Low level file operations Sessions: - Validate session Virtual Machine: Provisioning: - Allow disk access - Allow read-only disk access - Guest Operating system management by VIX API 6. vCenter\uff1a\u9632\u706b\u5899\u53ca\u4ee3\u7406\u8bbe\u7f6e \u00b6 6.1 vCenter\uff1a\u7aef\u53e3 \u00b6 \u82e5\u662f\u6709\u9632\u706b\u5899\uff0c\u9700\u8981\u6253\u5f00 443 \uff08https\uff09\u548c 5480 \u7aef\u53e3\u3002\u524d\u8005\u7528\u4e8e\u590d\u5236\u78c1\u76d8\uff0c\u540e\u8005\u7528\u4e8e\u67e5\u8be2\u865a\u62df\u673a\u5143\u6570\u636e\u3002 \u5982\u679c\u4f7f\u7528\u4e86\u975e\u9ed8\u8ba4\u7aef\u53e3\uff0c\u9700\u8981\u5728URI\u4e2d\u6307\u5b9a\u3002\u8fd9\u4e9b\u7aef\u53e3\u53ea\u7528\u4e8evirt-v2v\u8f6c\u6362\uff0c\u5982\u679c\u60f3\u8981\u4f7f\u7528\u5176\u4ed6\u529f\u80fd\u9700\u8981\u6253\u5f00\u5176\u4ed6\u7aef\u53e3\u3002 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 port 443 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 virt-v2v \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 vCenter \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 ESXi \u2502 \u2502 conversion \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 server \u2502 \u2502 hypervisor \u2502 \u2502 server \u2502 port 5480 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502guest\u2502 \u2502 \u2514\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2518 \u7bad\u5934\u8868\u793aTCP\u542f\u52a8\u65b9\u5411\uff0c\u4e0d\u662f\u6570\u636e\u4f20\u8f93\u65b9\u5411\u3002 \u4ece\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0cvirt-v2v \u4e0d\u662f\u76f4\u63a5\u548cESXI\u8fde\u63a5\uff0c\u800c\u662fvCenter\u8fde\u63a5\u5230hypervisor\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u5728vCenter\u4e0ehypervisor\u4e4b\u95f4\u6709\u9632\u706b\u5899\u7684\u8bdd\uff0c\u9700\u8981\u6253\u5f00\u989d\u5916\u7684\u7aef\u53e3\u3002 \u5728\u505a\u8f6c\u6362\u65f6\u4ee3\u7406\u73af\u5883\u53d8\u91cf\uff08 https_proxy , all_proxy , no_proxy , HTTPS_PROXY , ALL_PROXY and NO_PROXY \uff09\u4f1a\u5931\u6548\u3002 7. vCenter\uff1aSSL/TLS \u8bc1\u4e66\u95ee\u9898 \u00b6 \u53ef\u80fd\u4f1a\u770b\u5230\u8fd9\u4e2a\u9519\u8bef\uff1a CURL: Error opening file: SSL: no alternative certificate subject name matches target host name \uff08\u4e5f\u8bb8\u6253\u5f00\u8c03\u8bd5\u6a21\u5f0f virt-v2v -v -x \u624d\u80fd\u770b\u5230\u8fd9\u4e2a\u4fe1\u606f\uff09 \u8fd9\u662f\u56e0\u4e3a\u4f7f\u7528\u4e86IP\u5730\u5740\u8bbf\u95ee\uff0c\u9700\u8981\u4f7f\u7528vCenter\u670d\u52a1\u5668\u5b8c\u5168\u5408\u683c\u7684\u57df\u540d\u3002 vCenter\u670d\u52a1\u5668\u4e0d\u5339\u914d\u7684 FQDN \u548cIP\u5730\u5740\uff08\u6bd4\u5982\u670d\u52a1\u5668\u83b7\u53d6\u4e86\u4e00\u4e2a\u65b0\u7684ip\u5730\u5740\uff09\u4f1a\u5bfc\u81f4\u53e6\u4e00\u4e2a\u8bc1\u4e66\u95ee\u9898\u3002\u4fee\u590d\u65b9\u6cd5\uff1a\u6539\u53d8DHCP\u670d\u52a1\u6216\u7f51\u7edc\u670d\u52a1\u914d\u7f6e\uff0c\u8ba9vCenter\u670d\u52a1\u5668\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684IP\u5730\u5740\uff1b\u7136\u540e\u767b\u5f55vCenter\u670d\u52a1\u5668\u7684admin\u63a7\u5236\u53f0 https://vcenter:5480/ \uff0c\u5728 Admin \u6807\u7b7e\u4e0b\uff0c\u9009\u62e9 Certificate regeneration enabled \uff0c\u7136\u540e\u91cd\u542f\u3002","title":"VMware-vCenter\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/#vmware-vcenter","text":"\u4ece VMware vCenter \u8f6c\u6362\u865a\u62df\u673a\u5230 ovirt \u5e73\u53f0\u3002 \u8981\u6c42 \uff1avCenter >= 5.0 \u4e3e\u4f8b\u573a\u666f\uff1a \u6709\u4e00\u4e2aVMware vCenter\u670d\u52a1\u5668\uff0c\u5730\u5740\u662f vcenter.example.com \uff0c\u4e00\u4e2a\u6570\u636e\u4e2d\u5fc3 Datacenter \uff0c\u548c\u4e00\u4e2a ESXi hypervisor \u53eb\u505a esxi \u3002\u8981\u8f6c\u6362\u7684\u865a\u62df\u673a\u53eb vmware_guest \u3002 virt-v2v -ic vpx://vcenter.example.com/Datacenter/esxi vmware_guest \\ -o rhv-upload -oc https://ovirt-engine.example.com/ovirt-engine/api \\ -os ovirt-data -op /tmp/ovirt-admin-password -of raw \\ -oo rhv-cafile = /tmp/ca.pem -oo rhv-direct \\ --bridge ovirtmgmt \u8f93\u51fa\u5230ovirt\u53c2\u8003\uff1a VMware-ova\u8f6c\u6362","title":"VMware-vCenter\u865a\u62df\u673a\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/#_1","text":"\u9ed8\u8ba4\u4f7f\u7528libvirt\u4ecevCenter\u83b7\u53d6\u4fe1\u606f\uff0c\u6240\u4ee5\u4f7f\u7528\u8be5\u6a21\u5f0f\u65f6\u9ed8\u8ba4\u6dfb\u52a0 -i libvirt \u9009\u9879\u3002","title":"\u8f93\u5165\u6a21\u5f0f"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/#1-vcenterwindowsvmware-tools","text":"\u5bf9\u4e8ewindows\u5ba2\u6237\u673a\uff0c\u5728\u8f6c\u6362\u4e4b\u524d\u9700\u8981\u5c06 VMware-tools \u79fb\u9664\u3002\u5426\u5219\u5728\u8f6c\u6362\u5b8c\u6210\u4e4b\u540e\u6bcf\u6b21\u542f\u52a8\u5ba2\u6237\u673a\u7684\u65f6\u5019\u90fd\u4f1a\u62b1\u6028\uff0c\u5e76\u4e14\u8be5\u5de5\u5177\u4e0d\u80fd\u5378\u8f7d\u3002","title":"1. vCenter\uff1a\u4ecewindows\u5ba2\u6237\u673a\u79fb\u9664VMware-tools"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/#2-vcenteruri","text":"libvirt URI \u683c\u5f0f\uff1a vpx://user@server/Datacenter/esxi user@ \u53ef\u9009\u3002\u5982\u679c\u5305\u542b \\ \uff08eg. DOMAIN\\USER \uff09\uff0c\u4f7f\u7528 %5c \uff08\u5341\u516d\u8fdb\u5236ASCII\u7801\uff09\u4ee3\u66ff\uff08eg. DOMAIN%5cUSER \uff09\u3002\u5176\u5b83\u6807\u70b9\u7b26\u53f7\u53ef\u80fd\u4e5f\u9700\u8981\u5982\u6b64\u3002@\u662f %40 \uff0c . \u4e0d\u9700\u8981\u8f6c\u6362\uff0c \u53ef\u5728\u6b64\u67e5\u8be2 \u3002\u8fd9\u4e2a\u5730\u65b9\u4e00\u5b9a\u8981\u52a0\u4e0a\u57df\u540d\uff0c\u4f8b\uff1a vpx://administrator%40vsphere.local@172.16.2.178/Datacenter/cluster/172.16.2.162?no_verify=1 server \u670d\u52a1\u5668\u57df\u540d Datacenter \u6570\u636e\u4e2d\u5fc3\u7684\u540d\u5b57\u3002\u7a7a\u683c\u4f7f\u7528 %20 \u4ee3\u66ff\u3002 esxi \u8fd0\u884c\u865a\u62df\u673a\u7684ESXi hypervisor\u7684\u540d\u5b57 \u5982\u679c\u4f7f\u7528\u6587\u4ef6\u5939\u90e8\u7f72VMware\uff0c\u53ef\u80fd\u9700\u8981\u5c06\u5176\u6dfb\u52a0\u5230URI\uff0ceg\uff1a vpx://user@server/Folder/Datacenter/esxi \u8be6\u7ec6\u7684libvirt URIs","title":"2. vCenter\uff1aURI"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/#3-libvirtvcenter","text":"\u4f7f\u7528 virsh \u5217\u51fa\u865a\u62df\u673a\uff1a $ virsh -c 'vpx://root@vcenter.example.com/Datacenter/esxi' list --all Enter root ' s password for vcenter.example.com: *** Id Name State ---------------------------------------------------- - Fedora 20 shut off - Windows 2003 shut off \u5982\u679c\u51fa\u73b0\u4e86\u8bc1\u4e66\u76f8\u5173\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u5bfc\u5165vCenter\u4e3b\u673a\u7684\u8bc1\u4e66\uff0c\u6216\u8005\u8df3\u8fc7\u8bc1\u4e66\u9a8c\u8bc1\uff1a $ virsh -c 'vpx://root@vcenter.example.com/Datacenter/esxi?no_verify=1' list --all \u4f60\u4e5f\u5e94\u8be5\u5c1d\u8bd5\u4ece\u4efb\u610f\u865a\u62df\u673a\u590d\u5236\u5143\u6570\u636e\uff1a $ virsh -c 'vpx://root@vcenter.example.com/Datacenter/esxi' dumpxml \"Windows 2003\" <domain type = 'vmware' > <name>Windows 2003 </name> [ ... ] </domain> \u5982\u679c\u4e0a\u8ff0\u6b65\u9aa4\u5931\u8d25\u4e86\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u8fdb\u884c\u8f6c\u6362\uff01","title":"3. \u6d4b\u8bd5libvirt\u5230vCenter\u7684\u8fde\u63a5"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/#4-vcenter","text":"$ virt-v2v -ic 'vpx://root@vcenter.example.com/Datacenter/esxi?no_verify=1' \\ \"Windows 2003\" \\ --password-file vCenter.pass -o local -os /var/tmp \u865a\u62df\u673a\u5fc5\u987b\u5173\u673a \u3002 \u5982\u679c\u4e0d\u60f3\u5728\u8f6c\u6362\u65f6\u8f93\u5165\u5bc6\u7801\uff0c\u4f7f\u7528 --password-file <file> \u9009\u9879\u6307\u5b9a\u5bc6\u7801\u6587\u4ef6\u3002","title":"4. vCenter\uff1a\u5bfc\u5165\u865a\u62df\u673a"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/#5-vcenternon-administrator","text":"\u53ef\u4ee5\u4f7f\u7528\u975e\u7ba1\u7406\u5458\u89d2\u8272\u6267\u884c\u8f6c\u6362\uff0c\u4f46\u662f\u9700\u8981\u4e3a\u5176\u63d0\u4f9b\u6700\u5c0f\u6743\u9650\uff1a \u5728vCenter\u521b\u5efa\u89d2\u8272 \u6253\u5f00\u4ee5\u4e0b\u5bf9\u8c61 Datastore: - Browse datastore - Low level file operations Sessions: - Validate session Virtual Machine: Provisioning: - Allow disk access - Allow read-only disk access - Guest Operating system management by VIX API","title":"5. vCenter\uff1aNon-Administrator \u89d2\u8272"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/#6-vcenter","text":"","title":"6. vCenter\uff1a\u9632\u706b\u5899\u53ca\u4ee3\u7406\u8bbe\u7f6e"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/#61-vcenter","text":"\u82e5\u662f\u6709\u9632\u706b\u5899\uff0c\u9700\u8981\u6253\u5f00 443 \uff08https\uff09\u548c 5480 \u7aef\u53e3\u3002\u524d\u8005\u7528\u4e8e\u590d\u5236\u78c1\u76d8\uff0c\u540e\u8005\u7528\u4e8e\u67e5\u8be2\u865a\u62df\u673a\u5143\u6570\u636e\u3002 \u5982\u679c\u4f7f\u7528\u4e86\u975e\u9ed8\u8ba4\u7aef\u53e3\uff0c\u9700\u8981\u5728URI\u4e2d\u6307\u5b9a\u3002\u8fd9\u4e9b\u7aef\u53e3\u53ea\u7528\u4e8evirt-v2v\u8f6c\u6362\uff0c\u5982\u679c\u60f3\u8981\u4f7f\u7528\u5176\u4ed6\u529f\u80fd\u9700\u8981\u6253\u5f00\u5176\u4ed6\u7aef\u53e3\u3002 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 port 443 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 virt-v2v \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 vCenter \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 ESXi \u2502 \u2502 conversion \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 server \u2502 \u2502 hypervisor \u2502 \u2502 server \u2502 port 5480 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502guest\u2502 \u2502 \u2514\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2518 \u7bad\u5934\u8868\u793aTCP\u542f\u52a8\u65b9\u5411\uff0c\u4e0d\u662f\u6570\u636e\u4f20\u8f93\u65b9\u5411\u3002 \u4ece\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0cvirt-v2v \u4e0d\u662f\u76f4\u63a5\u548cESXI\u8fde\u63a5\uff0c\u800c\u662fvCenter\u8fde\u63a5\u5230hypervisor\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u5728vCenter\u4e0ehypervisor\u4e4b\u95f4\u6709\u9632\u706b\u5899\u7684\u8bdd\uff0c\u9700\u8981\u6253\u5f00\u989d\u5916\u7684\u7aef\u53e3\u3002 \u5728\u505a\u8f6c\u6362\u65f6\u4ee3\u7406\u73af\u5883\u53d8\u91cf\uff08 https_proxy , all_proxy , no_proxy , HTTPS_PROXY , ALL_PROXY and NO_PROXY \uff09\u4f1a\u5931\u6548\u3002","title":"6.1 vCenter\uff1a\u7aef\u53e3"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vCenter%E8%BD%AC%E6%8D%A2/#7-vcenterssltls","text":"\u53ef\u80fd\u4f1a\u770b\u5230\u8fd9\u4e2a\u9519\u8bef\uff1a CURL: Error opening file: SSL: no alternative certificate subject name matches target host name \uff08\u4e5f\u8bb8\u6253\u5f00\u8c03\u8bd5\u6a21\u5f0f virt-v2v -v -x \u624d\u80fd\u770b\u5230\u8fd9\u4e2a\u4fe1\u606f\uff09 \u8fd9\u662f\u56e0\u4e3a\u4f7f\u7528\u4e86IP\u5730\u5740\u8bbf\u95ee\uff0c\u9700\u8981\u4f7f\u7528vCenter\u670d\u52a1\u5668\u5b8c\u5168\u5408\u683c\u7684\u57df\u540d\u3002 vCenter\u670d\u52a1\u5668\u4e0d\u5339\u914d\u7684 FQDN \u548cIP\u5730\u5740\uff08\u6bd4\u5982\u670d\u52a1\u5668\u83b7\u53d6\u4e86\u4e00\u4e2a\u65b0\u7684ip\u5730\u5740\uff09\u4f1a\u5bfc\u81f4\u53e6\u4e00\u4e2a\u8bc1\u4e66\u95ee\u9898\u3002\u4fee\u590d\u65b9\u6cd5\uff1a\u6539\u53d8DHCP\u670d\u52a1\u6216\u7f51\u7edc\u670d\u52a1\u914d\u7f6e\uff0c\u8ba9vCenter\u670d\u52a1\u5668\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684IP\u5730\u5740\uff1b\u7136\u540e\u767b\u5f55vCenter\u670d\u52a1\u5668\u7684admin\u63a7\u5236\u53f0 https://vcenter:5480/ \uff0c\u5728 Admin \u6807\u7b7e\u4e0b\uff0c\u9009\u62e9 Certificate regeneration enabled \uff0c\u7136\u540e\u91cd\u542f\u3002","title":"7. vCenter\uff1aSSL/TLS \u8bc1\u4e66\u95ee\u9898"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vddk%E8%BD%AC%E6%8D%A2/","text":"VMware-vddk\u865a\u62df\u673a\u8f6c\u6362 \u00b6 \u6b64\u79cd\u8f6c\u6362\u65b9\u5f0f\u53ef\u5728 vCenter \u4e0e ESXi \u670d\u52a1\u5668\uff08\u7248\u672c>=5.5\uff09\u4e0a\u9762\u4f7f\u7528\u3002\u63d0\u4f9b\u7684uri\u8fde\u63a5\u4e5f\u662f\u8fd9\u4e24\u79cd\u5f62\u5f0f\u7684\u3002\u4e0b\u9762\u4ecb\u7ecd\u6700\u7b80\u5355\u7684\u8f6c\u6362\u7528\u6cd5\u3002 \u9700\u8981\u5728VMware\u4e0b\u8f7d \u5f00\u53d1\u5e93 \uff0c\u4f46\u662f\u6b64\u5e93\u662f\u975e\u5f00\u6e90\u7684\uff0c\u4e0d\u5141\u8bb8\u91cd\u65b0\u5206\u53d1\u6216\u5546\u4e1a\u7528\u9014\uff0c\u614e\u7528\u3002 1.\u83b7\u53d6\u670d\u52a1\u5668\u7684\u6307\u7eb9 \u00b6 \u5728ESXi\u670d\u52a1\u5668\u4e0a\u9762\u6267\u884c\uff1a openssl x509 -in /etc/vmware/ssl/rui.crt -fingerprint -sha1 -noout \u6216\u5728vCenter\u670d\u52a1\u5668\u4e0a\u9762\u6267\u884c\uff1a openssl x509 -in /etc/vmware-vpx/ssl/rui.crt -fingerprint -sha1 -noout 2.\u6d4b\u8bd5URI\u8fde\u63a5 \u00b6 \u6d4b\u8bd5\u65b9\u6cd5\u4e0evCenter\u7684\u65b9\u5f0f\u4e00\u81f4\uff0c\u53c2\u8003\uff1a VMware-vCenter\u8f6c\u6362 3.\u6267\u884c\u8f6c\u6362 \u00b6 virt-v2v -ic esx://root@192.168.216.153?no_verify = 1 centos-esxi-1 \\ -it vddk \\ -io vddk-libdir = vmware-vix-disklib-distrib/ \\ -io vddk-thumbprint = B2:01:D5:F3:B5:F1:9E:4A:C4:1D:53:4F:18:07:2B:66:B8:AD:E7:95 \\ -o rhv -os 172 .16.2.124:/home/exports --password-file esxi.pass vddk-libdir \u6307\u5b9a\u5f00\u53d1\u5e93\u6240\u5728\u76ee\u5f55 vddk-thumbprint \u6307\u5b9a\u670d\u52a1\u5668\u7684\u6307\u7eb9 \u5176\u5b83\u53ef\u9009\u9009\u9879\uff1a -io vddk-config , -io vddk-cookie , -io vddk-nfchostport , -io vddk-port , -io vddk-snapshot , -io vddk-transports and -io vddk-vimapiver \uff0c\u53ef\u901a\u8fc7 man nbdkit-vddk-plugin \u67e5\u770b\u5177\u4f53\u610f\u601d\u3002","title":"VMware-vddk\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vddk%E8%BD%AC%E6%8D%A2/#vmware-vddk","text":"\u6b64\u79cd\u8f6c\u6362\u65b9\u5f0f\u53ef\u5728 vCenter \u4e0e ESXi \u670d\u52a1\u5668\uff08\u7248\u672c>=5.5\uff09\u4e0a\u9762\u4f7f\u7528\u3002\u63d0\u4f9b\u7684uri\u8fde\u63a5\u4e5f\u662f\u8fd9\u4e24\u79cd\u5f62\u5f0f\u7684\u3002\u4e0b\u9762\u4ecb\u7ecd\u6700\u7b80\u5355\u7684\u8f6c\u6362\u7528\u6cd5\u3002 \u9700\u8981\u5728VMware\u4e0b\u8f7d \u5f00\u53d1\u5e93 \uff0c\u4f46\u662f\u6b64\u5e93\u662f\u975e\u5f00\u6e90\u7684\uff0c\u4e0d\u5141\u8bb8\u91cd\u65b0\u5206\u53d1\u6216\u5546\u4e1a\u7528\u9014\uff0c\u614e\u7528\u3002","title":"VMware-vddk\u865a\u62df\u673a\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vddk%E8%BD%AC%E6%8D%A2/#1","text":"\u5728ESXi\u670d\u52a1\u5668\u4e0a\u9762\u6267\u884c\uff1a openssl x509 -in /etc/vmware/ssl/rui.crt -fingerprint -sha1 -noout \u6216\u5728vCenter\u670d\u52a1\u5668\u4e0a\u9762\u6267\u884c\uff1a openssl x509 -in /etc/vmware-vpx/ssl/rui.crt -fingerprint -sha1 -noout","title":"1.\u83b7\u53d6\u670d\u52a1\u5668\u7684\u6307\u7eb9"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vddk%E8%BD%AC%E6%8D%A2/#2uri","text":"\u6d4b\u8bd5\u65b9\u6cd5\u4e0evCenter\u7684\u65b9\u5f0f\u4e00\u81f4\uff0c\u53c2\u8003\uff1a VMware-vCenter\u8f6c\u6362","title":"2.\u6d4b\u8bd5URI\u8fde\u63a5"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vddk%E8%BD%AC%E6%8D%A2/#3","text":"virt-v2v -ic esx://root@192.168.216.153?no_verify = 1 centos-esxi-1 \\ -it vddk \\ -io vddk-libdir = vmware-vix-disklib-distrib/ \\ -io vddk-thumbprint = B2:01:D5:F3:B5:F1:9E:4A:C4:1D:53:4F:18:07:2B:66:B8:AD:E7:95 \\ -o rhv -os 172 .16.2.124:/home/exports --password-file esxi.pass vddk-libdir \u6307\u5b9a\u5f00\u53d1\u5e93\u6240\u5728\u76ee\u5f55 vddk-thumbprint \u6307\u5b9a\u670d\u52a1\u5668\u7684\u6307\u7eb9 \u5176\u5b83\u53ef\u9009\u9009\u9879\uff1a -io vddk-config , -io vddk-cookie , -io vddk-nfchostport , -io vddk-port , -io vddk-snapshot , -io vddk-transports and -io vddk-vimapiver \uff0c\u53ef\u901a\u8fc7 man nbdkit-vddk-plugin \u67e5\u770b\u5177\u4f53\u610f\u601d\u3002","title":"3.\u6267\u884c\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vmx%E8%BD%AC%E6%8D%A2/","text":"VMware-vmx\u865a\u62df\u673a\u8f6c\u6362 \u00b6 \u6240\u6709\u7684VMware\u5e73\u53f0\u7684windows\u865a\u62df\u673a\u90fd\u9700\u8981\u5148\u5378\u8f7d VMware-tools \u3002 \u4eceVMware\u7684vmx\u6587\u4ef6\u5bfc\u5165\u865a\u62df\u673a\u3002 \u5728\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\u4e0b\u6709\u7528\uff1a VMware\u865a\u62df\u673a\u5b58\u50a8\u5728\u5355\u72ec\u7684NFS\u670d\u52a1\u5668\u5e76\u4e14\u53ef\u4ee5\u76f4\u63a5\u6302\u8f7dNFS\u5b58\u50a8\u3002 \u80fd\u901a\u8fc7SSH\u8fde\u63a5\u5230VMware ESXI hypervisor\uff0c\u5e76\u6709\u4e00\u4e2a\u542b\u6709\u865a\u62df\u673a\u7684 /vmfs/volumes \u6587\u4ef6\u5939\u3002 \u5982\u679c\u6709\u6587\u4ef6\u5939\u5305\u542b\u540e\u7f00\u540d\u4e3a .vmx\u3001.vmxf\u3001.nvram\u3001\u4e00\u4e2a\u6216\u591a\u4e2a.vmdk \u78c1\u76d8\u6620\u50cf\u7684\u6587\u4ef6\u5939\uff0c\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002\u5c31\u662f\u865a\u62df\u673a\u5de5\u4f5c\u76ee\u5f55\u3002 \u8f6c\u6362\u4e4b\u524d\u5148\u5173\u673a \u3002 \u8f93\u51fa\u5230ovirt\u53c2\u8003\uff1a VMware-ova\u8f6c\u6362 1. \u83b7\u53d6\u5b58\u50a8\u57df \u00b6 \u5982\u679c\u4e0d\u80fd\u5728\u672c\u5730\u83b7\u53d6vmx\u548cvmdk\uff0c\u90a3\u4e48\u5fc5\u987b\u6302\u8f7d\u5230\u8f6c\u6362\u670d\u52a1\u5668\u4e0a\u9762\u6216\u8005\u5728 ESXI hypervisor \u8bbe\u7f6eSSH\u514d\u5bc6\u767b\u5f55\u3002 2. \u4f7f\u7528ssh-agent\u8bbe\u7f6e\u514d\u5bc6\u767b\u5f55 \u00b6 \u9996\u5148\u6253\u5f00 EXSI \u7684 ssh \u529f\u80fd\u3002 \u7136\u540e\u6dfb\u52a0\u8f6c\u6362\u670d\u52a1\u5668\u7684ssh\u516c\u94a5\u5230ESXI hypervisor\u7684 /etc/ssh/keys-root/authorized_keys \uff0c\u7136\u540e\u9a8c\u8bc1\u3002 \u6700\u540e\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u5c06\u79c1\u94a5\u6258\u7ba1\u7ed9 ssh-agent \uff1a eval ` ssh-agent -s ` ssh-add \u8be5\u6a21\u5f0f\u4e0d\u652f\u6301\u4ea4\u4e92\u5f0f\u5bc6\u7801\u8f93\u5165\uff0c\u6240\u4ee5\u5fc5\u987b\u8fd9\u6837\u8bbe\u7f6e\u3002 3. \u6784\u9020SSH URI \u00b6 \u6784\u9020\u6307\u5411vmx\u6587\u4ef6\u7684URI\u3002\u7c7b\u4f3c\u4e8e\u8fd9\u6837\uff1a ssh://root@esxi.example.com/vmfs/volumes/datastore1/my%20guest/my%20guest.vmx \u6240\u6709\u7684non-ASCII\u5b57\u7b26\u90fd\u5fc5\u987b\u8f6c\u6362\uff08\u4f8b\uff1a\u7a7a\u683c -> %20\uff09\u3002 \u82e5\u4e0d\u4f7f\u7528\u9ed8\u8ba4\u768422\u7aef\u53e3\uff0c\u53ef\u5728\u4e3b\u673a\u540d\u540e\u9762\u52a0\u4e0a\u7aef\u53e3\u53f7\u3002 4. \u5bfc\u5165\u865a\u62df\u673a \u00b6 \u4ece\u672c\u5730\u6216NFS\u5bfc\u5165\uff1a $ virt-v2v -i vmx guest.vmx -o local -os /var/tmp \u901a\u8fc7ssh\u5bfc\u5165\uff1a $ virt-v2v \\ -i vmx -it ssh \\ \"ssh://root@esxi.example.com/vmfs/volumes/datastore1/guest/guest.vmx\" \\ -o local -os /var/tmp","title":"VMware-vmx\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vmx%E8%BD%AC%E6%8D%A2/#vmware-vmx","text":"\u6240\u6709\u7684VMware\u5e73\u53f0\u7684windows\u865a\u62df\u673a\u90fd\u9700\u8981\u5148\u5378\u8f7d VMware-tools \u3002 \u4eceVMware\u7684vmx\u6587\u4ef6\u5bfc\u5165\u865a\u62df\u673a\u3002 \u5728\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\u4e0b\u6709\u7528\uff1a VMware\u865a\u62df\u673a\u5b58\u50a8\u5728\u5355\u72ec\u7684NFS\u670d\u52a1\u5668\u5e76\u4e14\u53ef\u4ee5\u76f4\u63a5\u6302\u8f7dNFS\u5b58\u50a8\u3002 \u80fd\u901a\u8fc7SSH\u8fde\u63a5\u5230VMware ESXI hypervisor\uff0c\u5e76\u6709\u4e00\u4e2a\u542b\u6709\u865a\u62df\u673a\u7684 /vmfs/volumes \u6587\u4ef6\u5939\u3002 \u5982\u679c\u6709\u6587\u4ef6\u5939\u5305\u542b\u540e\u7f00\u540d\u4e3a .vmx\u3001.vmxf\u3001.nvram\u3001\u4e00\u4e2a\u6216\u591a\u4e2a.vmdk \u78c1\u76d8\u6620\u50cf\u7684\u6587\u4ef6\u5939\uff0c\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002\u5c31\u662f\u865a\u62df\u673a\u5de5\u4f5c\u76ee\u5f55\u3002 \u8f6c\u6362\u4e4b\u524d\u5148\u5173\u673a \u3002 \u8f93\u51fa\u5230ovirt\u53c2\u8003\uff1a VMware-ova\u8f6c\u6362","title":"VMware-vmx\u865a\u62df\u673a\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vmx%E8%BD%AC%E6%8D%A2/#1","text":"\u5982\u679c\u4e0d\u80fd\u5728\u672c\u5730\u83b7\u53d6vmx\u548cvmdk\uff0c\u90a3\u4e48\u5fc5\u987b\u6302\u8f7d\u5230\u8f6c\u6362\u670d\u52a1\u5668\u4e0a\u9762\u6216\u8005\u5728 ESXI hypervisor \u8bbe\u7f6eSSH\u514d\u5bc6\u767b\u5f55\u3002","title":"1. \u83b7\u53d6\u5b58\u50a8\u57df"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vmx%E8%BD%AC%E6%8D%A2/#2-ssh-agent","text":"\u9996\u5148\u6253\u5f00 EXSI \u7684 ssh \u529f\u80fd\u3002 \u7136\u540e\u6dfb\u52a0\u8f6c\u6362\u670d\u52a1\u5668\u7684ssh\u516c\u94a5\u5230ESXI hypervisor\u7684 /etc/ssh/keys-root/authorized_keys \uff0c\u7136\u540e\u9a8c\u8bc1\u3002 \u6700\u540e\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u5c06\u79c1\u94a5\u6258\u7ba1\u7ed9 ssh-agent \uff1a eval ` ssh-agent -s ` ssh-add \u8be5\u6a21\u5f0f\u4e0d\u652f\u6301\u4ea4\u4e92\u5f0f\u5bc6\u7801\u8f93\u5165\uff0c\u6240\u4ee5\u5fc5\u987b\u8fd9\u6837\u8bbe\u7f6e\u3002","title":"2. \u4f7f\u7528ssh-agent\u8bbe\u7f6e\u514d\u5bc6\u767b\u5f55"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vmx%E8%BD%AC%E6%8D%A2/#3-ssh-uri","text":"\u6784\u9020\u6307\u5411vmx\u6587\u4ef6\u7684URI\u3002\u7c7b\u4f3c\u4e8e\u8fd9\u6837\uff1a ssh://root@esxi.example.com/vmfs/volumes/datastore1/my%20guest/my%20guest.vmx \u6240\u6709\u7684non-ASCII\u5b57\u7b26\u90fd\u5fc5\u987b\u8f6c\u6362\uff08\u4f8b\uff1a\u7a7a\u683c -> %20\uff09\u3002 \u82e5\u4e0d\u4f7f\u7528\u9ed8\u8ba4\u768422\u7aef\u53e3\uff0c\u53ef\u5728\u4e3b\u673a\u540d\u540e\u9762\u52a0\u4e0a\u7aef\u53e3\u53f7\u3002","title":"3. \u6784\u9020SSH URI"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/VMware-vmx%E8%BD%AC%E6%8D%A2/#4","text":"\u4ece\u672c\u5730\u6216NFS\u5bfc\u5165\uff1a $ virt-v2v -i vmx guest.vmx -o local -os /var/tmp \u901a\u8fc7ssh\u5bfc\u5165\uff1a $ virt-v2v \\ -i vmx -it ssh \\ \"ssh://root@esxi.example.com/vmfs/volumes/datastore1/guest/guest.vmx\" \\ -o local -os /var/tmp","title":"4. \u5bfc\u5165\u865a\u62df\u673a"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/Xen%E8%BD%AC%E6%8D%A2/","text":"Xen\u865a\u62df\u673a\u8f6c\u6362 \u00b6 \u53ef\u63a5\u53d7\u8f93\u5165\u6765\u6e90\uff1a RHEL 5 Xen or SLES and openSUSE Xen hosts \u3002 \u8f93\u5165\u9009\u9879\u81ea\u5e26 -i libvirt \u3002 \u8f93\u51fa\u5230ovirt\u53c2\u8003\uff1a VMware-ova\u8f6c\u6362 \u3002 1. \u4f7f\u7528ssh-agent\u8bbe\u7f6e\u514d\u5bc6\u767b\u5f55 \u00b6 \u6dfb\u52a0\u8f6c\u6362\u670d\u52a1\u5668\u7684ssh\u516c\u94a5\u5230Xen\u4e3b\u673a\u7684 ~/.ssh/authorized_keys \uff0c\u7136\u540e\u9a8c\u8bc1\u3002 \u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u5c06\u79c1\u94a5\u6258\u7ba1\u7ed9 ssh-agent \uff1a eval ` ssh-agent -s ` ssh-add \u8be5\u6a21\u5f0f\u4e0d\u652f\u6301\u4ea4\u4e92\u5f0f\u5bc6\u7801\u8f93\u5165\uff0c\u6240\u4ee5\u5fc5\u987b\u8fd9\u6837\u8bbe\u7f6e\u3002 \u968f\u7740\u4e00\u4e9b\u73b0\u4ee3ssh\u5b9e\u73b0\uff0c\u7981\u7528\u4e86\u4e0eRHEL 5 sshd\u4ea4\u4e92\u64cd\u4f5c\u6240\u9700\u7684\u4f20\u7edf\u52a0\u5bc6\u7b56\u7565\u3002\u9700\u8981\u5728\u8f6c\u6362\u670d\u52a1\u5668\u4e0a\u9762\u542f\u7528\uff0c\u5148\u9605\u8bfb update-crypto-policies(8) \uff1a update-crypto-policies LEGACY 2. \u6d4b\u8bd5libvirt\u5230Xen\u4e3b\u673a\u7684\u8fde\u63a5 \u00b6 \u4f7f\u7528 virsh \uff1a $ virsh -c xen+ssh://root@xen.example.com list --all Id Name State ---------------------------------------------------- 0 Domain-0 running - rhel49-x86_64-pv shut off \u4f60\u4e5f\u5e94\u8be5\u5c1d\u8bd5\u4ece\u4efb\u610f\u865a\u62df\u673a\u590d\u5236\u5143\u6570\u636e\uff1a $ virsh -c xen+ssh://root@xen.example.com dumpxml rhel49-x86_64-pv <domain type = 'xen' > <name>rhel49-x86_64-pv</name> [ ... ] </domain> \u5982\u679c\u4e0a\u8ff0\u6b65\u9aa4\u5931\u8d25\u4e86\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u8fdb\u884c\u8f6c\u6362\uff01 \u5982\u679c\u865a\u62df\u673a\u78c1\u76d8\u4f4d\u4e8e\u4e3b\u673a\u5757\u8bbe\u5907\u4e0a\u9762\uff0c\u90a3\u4e48\u8f6c\u6362\u5c06\u5931\u8d25\uff01 \u53c2\u8003 \"XEN OR SSH CONVERSIONS FROM BLOCK DEVICES\" 3. \u8f6c\u6362\u865a\u62df\u673a \u00b6 $ LIBGUESTFS_BACKEND = direct \\ virt-v2v -ic 'xen+ssh://root@xen.example.com' \\ rhel49-x86_64-pv \\ -o local -os /var/tmp rhel49-x86_64-pv\u662f\u865a\u62df\u673a\u540d\u5b57\uff0c \u5fc5\u987b\u5173\u673a \u3002 XEN OR SSH CONVERSIONS FROM BLOCK DEVICES \u00b6 \u5f53\u524dvirt-v2v\u7684\u4e00\u4e2a\u7f3a\u9677\u662f\uff1a\u5982\u679c\u865a\u62df\u673a\u78c1\u76d8\u4f4d\u4e8e\u4e3b\u673a\u7684\u5757\u8bbe\u5907\u4e0a\u9762\uff0c\u5219\u4e0d\u80fd\u83b7\u53d6Xen\u7684\u865a\u62df\u673a\uff08\u6216\u8005\u4efb\u4f55\u901a\u8fc7ssh\u8fdc\u7a0b\u5b9a\u4f4d\u7684\u865a\u62df\u673a\uff09\u3002 \u53ef\u4ee5\u5728\u865a\u62df\u673a\u7684XML\u6587\u4ef6\u4e2d\u67e5\u770b\u662f\u5426\u4f7f\u7528\u4e86\u4e3b\u673a\u5757\u8bbe\u5907\uff1a <disk type= 'block' device= 'disk' > ... <source dev= '/dev/VG/guest' /> \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u529e\u6cd5\u662f\u5148\u4f7f\u7528 virt-v2v-copy-to-local \u590d\u5236\u865a\u62df\u673a\u5230\u8f6c\u6362\u670d\u52a1\u5668\uff0c\u518d\u4f7f\u7528 virt-v2v \u8fdb\u884c\u8f6c\u6362\u3002\u6b64\u65f6\u5c31\u9700\u8981\u6709\u8db3\u591f\u7684\u7a7a\u95f4\u5b58\u50a8\u6574\u4e2a\u590d\u5236\u7684\u865a\u62df\u673a\u3002 virt-v2v-copy-to-local -ic xen+ssh://root@xen.example.com guest virt-v2v -i libvirtxml guest.xml -o local -os /var/tmp rm guest.xml guest-disk*","title":"Xen\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/Xen%E8%BD%AC%E6%8D%A2/#xen","text":"\u53ef\u63a5\u53d7\u8f93\u5165\u6765\u6e90\uff1a RHEL 5 Xen or SLES and openSUSE Xen hosts \u3002 \u8f93\u5165\u9009\u9879\u81ea\u5e26 -i libvirt \u3002 \u8f93\u51fa\u5230ovirt\u53c2\u8003\uff1a VMware-ova\u8f6c\u6362 \u3002","title":"Xen\u865a\u62df\u673a\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/Xen%E8%BD%AC%E6%8D%A2/#1-ssh-agent","text":"\u6dfb\u52a0\u8f6c\u6362\u670d\u52a1\u5668\u7684ssh\u516c\u94a5\u5230Xen\u4e3b\u673a\u7684 ~/.ssh/authorized_keys \uff0c\u7136\u540e\u9a8c\u8bc1\u3002 \u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u5c06\u79c1\u94a5\u6258\u7ba1\u7ed9 ssh-agent \uff1a eval ` ssh-agent -s ` ssh-add \u8be5\u6a21\u5f0f\u4e0d\u652f\u6301\u4ea4\u4e92\u5f0f\u5bc6\u7801\u8f93\u5165\uff0c\u6240\u4ee5\u5fc5\u987b\u8fd9\u6837\u8bbe\u7f6e\u3002 \u968f\u7740\u4e00\u4e9b\u73b0\u4ee3ssh\u5b9e\u73b0\uff0c\u7981\u7528\u4e86\u4e0eRHEL 5 sshd\u4ea4\u4e92\u64cd\u4f5c\u6240\u9700\u7684\u4f20\u7edf\u52a0\u5bc6\u7b56\u7565\u3002\u9700\u8981\u5728\u8f6c\u6362\u670d\u52a1\u5668\u4e0a\u9762\u542f\u7528\uff0c\u5148\u9605\u8bfb update-crypto-policies(8) \uff1a update-crypto-policies LEGACY","title":"1. \u4f7f\u7528ssh-agent\u8bbe\u7f6e\u514d\u5bc6\u767b\u5f55"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/Xen%E8%BD%AC%E6%8D%A2/#2-libvirtxen","text":"\u4f7f\u7528 virsh \uff1a $ virsh -c xen+ssh://root@xen.example.com list --all Id Name State ---------------------------------------------------- 0 Domain-0 running - rhel49-x86_64-pv shut off \u4f60\u4e5f\u5e94\u8be5\u5c1d\u8bd5\u4ece\u4efb\u610f\u865a\u62df\u673a\u590d\u5236\u5143\u6570\u636e\uff1a $ virsh -c xen+ssh://root@xen.example.com dumpxml rhel49-x86_64-pv <domain type = 'xen' > <name>rhel49-x86_64-pv</name> [ ... ] </domain> \u5982\u679c\u4e0a\u8ff0\u6b65\u9aa4\u5931\u8d25\u4e86\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u8fdb\u884c\u8f6c\u6362\uff01 \u5982\u679c\u865a\u62df\u673a\u78c1\u76d8\u4f4d\u4e8e\u4e3b\u673a\u5757\u8bbe\u5907\u4e0a\u9762\uff0c\u90a3\u4e48\u8f6c\u6362\u5c06\u5931\u8d25\uff01 \u53c2\u8003 \"XEN OR SSH CONVERSIONS FROM BLOCK DEVICES\"","title":"2. \u6d4b\u8bd5libvirt\u5230Xen\u4e3b\u673a\u7684\u8fde\u63a5"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/Xen%E8%BD%AC%E6%8D%A2/#3","text":"$ LIBGUESTFS_BACKEND = direct \\ virt-v2v -ic 'xen+ssh://root@xen.example.com' \\ rhel49-x86_64-pv \\ -o local -os /var/tmp rhel49-x86_64-pv\u662f\u865a\u62df\u673a\u540d\u5b57\uff0c \u5fc5\u987b\u5173\u673a \u3002","title":"3. \u8f6c\u6362\u865a\u62df\u673a"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/Xen%E8%BD%AC%E6%8D%A2/#xen-or-ssh-conversions-from-block-devices","text":"\u5f53\u524dvirt-v2v\u7684\u4e00\u4e2a\u7f3a\u9677\u662f\uff1a\u5982\u679c\u865a\u62df\u673a\u78c1\u76d8\u4f4d\u4e8e\u4e3b\u673a\u7684\u5757\u8bbe\u5907\u4e0a\u9762\uff0c\u5219\u4e0d\u80fd\u83b7\u53d6Xen\u7684\u865a\u62df\u673a\uff08\u6216\u8005\u4efb\u4f55\u901a\u8fc7ssh\u8fdc\u7a0b\u5b9a\u4f4d\u7684\u865a\u62df\u673a\uff09\u3002 \u53ef\u4ee5\u5728\u865a\u62df\u673a\u7684XML\u6587\u4ef6\u4e2d\u67e5\u770b\u662f\u5426\u4f7f\u7528\u4e86\u4e3b\u673a\u5757\u8bbe\u5907\uff1a <disk type= 'block' device= 'disk' > ... <source dev= '/dev/VG/guest' /> \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u529e\u6cd5\u662f\u5148\u4f7f\u7528 virt-v2v-copy-to-local \u590d\u5236\u865a\u62df\u673a\u5230\u8f6c\u6362\u670d\u52a1\u5668\uff0c\u518d\u4f7f\u7528 virt-v2v \u8fdb\u884c\u8f6c\u6362\u3002\u6b64\u65f6\u5c31\u9700\u8981\u6709\u8db3\u591f\u7684\u7a7a\u95f4\u5b58\u50a8\u6574\u4e2a\u590d\u5236\u7684\u865a\u62df\u673a\u3002 virt-v2v-copy-to-local -ic xen+ssh://root@xen.example.com guest virt-v2v -i libvirtxml guest.xml -o local -os /var/tmp rm guest.xml guest-disk*","title":"XEN OR SSH CONVERSIONS FROM BLOCK DEVICES"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/","text":"\u5b98\u7f51 libguestfs \u662f\u8bbf\u95ee\u5e76\u4fee\u6539\u865a\u62df\u673a\u78c1\u76d8\u6620\u50cf\u7684\u4e00\u7cfb\u5217\u5de5\u5177\u3002 \u5b83\u662f\u4e00\u4e2aC\u8bed\u8a00\u5e93\u3002 \u4e0b\u9762\u662f\u5176\u4f53\u7cfb\u7ed3\u6784\u3002 \u539f\u6587\u5730\u5740 1.\u67b6\u6784 \u00b6 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 main program \u2502 \u2502 \u2502 \u2502 \u2502 child process / appliance \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 qemu \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 RPC \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 libguestfs \u25c0\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u25b6 guestfsd \u2502 \u2502 \u2502 \u2502 \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 Linux kernel \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 virtio-scsi \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Device or \u2502 \u2502 disk image \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 libguestfs\u7684\u5b9e\u73b0\u65b9\u5f0f\u662f\u901a\u8fc7\u4f7f\u7528 qemu \u8fd0\u884c\u4e00\u4e2a appliance \uff08\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u5c0f\u865a\u62df\u673a\uff09\u3002 qemu \u4f5c\u4e3a\u4e3b\u7a0b\u5e8f\u7684\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u8fd0\u884c\u3002 \u94fe\u63a5\u5230\u4e3b\u7a0b\u5e8f\u7684 library \u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u7136\u540e\u5728 guestfs_launch \u51fd\u6570\u4e2d\u521b\u5efaappliance\u3002 \u5728 appliance \u5185\u90e8\u662f\u4e00\u4e2alinux\u5185\u6838\u3001\u4e00\u5806\u5b8c\u6574\u7684\u7528\u6237\u7a7a\u95f4\u5de5\u5177\uff08\u4f8b\u5982LVM\u3001ext2\u7a0b\u5e8f\uff09\u548c\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b guestfsd \uff08\u4ee5\u4e0b\u4f7f\u7528 daemon \u4ee3\u66ff\uff09\u3002 library \u544a\u8bc9 daemon \u4f7f\u7528\u8fdc\u7a0b\u7a0b\u5e8f\u8c03\u7528\uff08RPC\uff09\u3002 libguestfs API \u8c03\u7528\u548c\u5bf9\u5b88\u62a4\u8fdb\u7a0b\u7684 RPC \u8c03\u7528\u4e4b\u95f4\u901a\u5e38\u5b58\u5728\u4e00\u5bf9\u4e00\u7684\u5bf9\u5e94\u5173\u7cfb\u3002\u6700\u540e\uff0c disk image \u88ab\u9644\u52a0\u5230qemu\u8fdb\u7a0b\uff0c\u8be5\u8fdb\u7a0b\u5c06\u8bbe\u5907\u7684linux\u5185\u6838\u5bf9\u8bbe\u5907\u7684\u8bbf\u95ee\u8f6c\u6362\u4e3a\u5bf9\u6620\u50cf\u7684\u8bbf\u95ee\u3002 2.\u72b6\u6001\u673a \u00b6 libguestfs\u4f7f\u7528\u72b6\u6001\u673a\u6765\u5efa\u6a21\u5b50\u8fdb\u7a0b\uff1a \u6b63\u5e38\u7684\u72b6\u6001\u8f6c\u6362\u6d41\u7a0b\uff1a CONFIG \uff1a\u5904\u7406\u7a0b\u5e8f\u5df2\u88ab\u521b\u5efa\uff0c\u4f46\u662f\u8fd8\u6ca1\u6709\u5b50\u8fdb\u7a0b LAUNCHING \uff1a\u5b50\u8fdb\u7a0b\u6b63\u5728\u542f\u52a8 READY \uff1a\u6b64\u65f6\u610f\u5473\u7740appliance\u5df2\u7ecf\u542f\u52a8\uff0c\u53ef\u4ee5\u53d1\u9001\u52a8\u4f5c\u5e76\u88ab\u5b50\u8fdb\u7a0b\u6267\u884c guest \uff08\u6307\u865a\u62df\u673a\u6620\u50cfimage\uff0c\u53ef\u901a\u8fc7 virt-builder \u521b\u5efa\uff09\u53ef\u80fd\u4f1a\u88ab\u6740\u6389\uff08\u51fd\u6570 guestfs_kill_subprocess\uff09\uff0c\u6216\u5728\u4efb\u4f55\u65f6\u95f4\u5f02\u6b65\u5730\u6b7b\u6389\uff08\u4e00\u4e9b\u5185\u90e8\u9519\u8bef\uff09\uff0c\u5bfc\u81f4\u72b6\u6001\u56de\u5230 CONFIG \u3002 \u914d\u7f6e\u547d\u4ee4\uff08\u4f8b\u5982\u51fd\u6570 guestfs_set_path\uff09\u53ea\u80fd\u5728 CONFIG \u72b6\u6001\u53d1\u51fa\u3002 API \u63d0\u4f9b\u4e86\u4ece CONFIG \u7ecf\u8fc7 LAUNCHING \u5230 READY \u7684\u8c03\u7528\uff1a\u51fd\u6570 guestfs_launch \u4f1a\u963b\u585e\u76f4\u5230\u5b50\u8fdb\u7a0b\u662f READY \u72b6\u6001\uff08\u6216\u8005\u5931\u8d25\u3001\u8d85\u65f6\uff09\u3002\u51fd\u6570 guestfs_launch \u5728\u8fd0\u884c\u7684\u65f6\u5019\u5728\u5185\u90e8\u4f1a\u5c06\u72b6\u6001\u4ece CONFIG \u53d8\u4e3a LAUNCHING \u3002 API\u52a8\u4f5c\uff08\u4f8b\u5982\u51fd\u6570 guestfs_mount\uff09\u53ea\u80fd\u5728 READY \u72b6\u6001\u7684\u65f6\u5019\u53d1\u9001\u3002\u8fd9\u4e9bAPI\u8c03\u7528\u4f1a\u963b\u585e\u4f4f\u76f4\u5230\u547d\u4ee4\u88ab\u6267\u884c\u3002\u540c\u4e00\u65f6\u95f4\u53ea\u4f1a\u6267\u884c\u4e00\u4e2a\u547d\u4ee4\u3002 \u6700\u540e\uff0c\u5b50\u8fdb\u7a0b\u53d1\u9001\u5f02\u6b65\u4fe1\u606f\u5230\u4e3b\u7a0b\u5e8f\uff0c\u4f8b\u5982\u5185\u6838\u65e5\u5fd7\u4fe1\u606f\u3002\u4f60\u53ef\u4ee5\u6ce8\u518c\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u6765\u63a5\u6536\u8fd9\u4e9b\u4fe1\u606f\u3002 3.\u5185\u90e8 \u00b6 3.1 appliance \u542f\u52a8\u8fdb\u7a0b \u00b6 \u5f00\u542f\u8c03\u8bd5\u6a21\u5f0f\uff0c\u5728\u547d\u4ee4\u884c\u5934\u90e8\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\u53c2\u6570\uff1a LIBGUESTFS_TRACE=1 LIBGUESTFS_DEBUG=1 \u3002 LIBGUESTFS_TRACE = 1 LIBGUESTFS_DEBUG = 1 virt-v2v -i ova centos2.ova -o local -os /var/tmp/ -of qcow2 2 > & 1 | tee virt-v2v.log 3.1.1 \u521b\u5efa appliance \u00b6 \u8c03\u7528 supermin --build \u521b\u5efa\uff1akernel\u3001small initrd\u3001appliance\u3002\u8be6\u7ec6\u7684supermin\u8bf4\u660e\uff1a supermin(1) \u3002 appliance\u9ed8\u8ba4\u5b58\u50a8\u5728 /var/tmp/.guestfs-<UID> \u4e0b\u3002 3.1.2 \u5f00\u542f qemu \u5e76\u542f\u52a8 kernel \u00b6 \u8c03\u7528qemu\u542f\u52a8kernel\u3002 3.1.3 \u8fd0\u884cinitrd \u00b6 supermin --build \u6784\u5efa\u4e86\u4e00\u4e2a\u5c0f\u7684initrd\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u4e3a\u4e86appliance\u80fd\u88ab\u6302\u8f7d\u548c\u542f\u52a8\u53bb\u8f7d\u5165\u8db3\u591f\u7684\u5185\u6838\u6a21\u5757\u3002 initrd\u662f\u4e00\u4e2acpio\u6587\u4ef6\uff0c\u5728 /var/tmp/.guestfs-<UID>/appliance.d/initrd \uff0cinitrd\u542f\u52a8\u65f6\u53ef\u4ee5\u770b\u5230\u5185\u6838\u8f7d\u5165\u4fe1\u606f\u3002 3.1.4 \u627e\u5230\u5e76\u6302\u8f7dappliance\u8bbe\u5907 \u00b6 appliance\u662f\u4e00\u4e2a\u7a00\u758f\u6587\u4ef6\uff0c\u5305\u542b\u4e86ext2\u6587\u4ef6\u7cfb\u7edf\uff08\u5305\u542b\u4e86\u4e00\u4e2alinux\u64cd\u4f5c\u7cfb\u7edf\uff09\u3002\u6b63\u5e38\u60c5\u51b5\u4e0b\u88ab\u79f0\u4f5c /var/tmp/.guestfs-<UID>/appliance.d/root \u3002 libguestfs\u9996\u5148\u68c0\u67e5\u88abqemu\u66b4\u9732\u7684\u5e38\u89c4\u78c1\u76d8\uff08eg. /dev/vda\uff09\uff0c\u6700\u540e\u4e00\u4e2a\u88ab\u52a0\u5230qemu\u4e2d\u7684\u662fappliance\uff08eg. /dev/vdb\uff09\u3002 \u4e8e\u662finitrd\u6700\u540e\u7684\u5de5\u4f5c\u662f\u5b9a\u4f4d\u5230appliance\u78c1\u76d8\uff0c\u6302\u8f7d\u5b83\uff0c\u8f6c\u6362root\u5230appliance\uff0c\u7136\u540e\u4eceappliance\u8fd0\u884c /init \u3002 3.1.5 \u521d\u59cb\u5316appliance \u00b6 \u73b0\u5728appliance\u81ea\u884c\u521d\u59cb\u5316\u3002\u5305\u62ec\u542f\u52a8\u67d0\u4e9b\u7ebf\u7a0b\uff0c\u53ef\u80fd\u4f1a\u6253\u5370\u8c03\u8bd5\u4fe1\u606f\uff0c\u6700\u7ec8\u8fd0\u884c daemon \u3002 3.1.6 daemon \u00b6 \u6700\u7ec8appliance\u4e2d\u8fd0\u884c daemon \u3002 daemon\u671f\u5f85\u770b\u5230\u88abqemu\u516c\u5f00\u7684\u547d\u540d\u7684virtio-serial\u7aef\u53e3\uff08\u5728 /dev/virtio-ports/ \u4e0b\uff09\uff0c\u7136\u540e\u5728\u53e6\u4e00\u7aef\u8fde\u63a5\u5230 library \u3002 daemon\u8fde\u63a5\u5230\u8fd9\u4e2a\u7aef\u53e3\u5e76\u53d1\u9001\u5173\u952e\u5b57 GUESTFS_LAUNCH_FLAG \u6765\u521d\u59cb\u5316\u901a\u4fe1\u534f\u8bae\u3002 3.2 \u901a\u4fe1\u534f\u8bae \u00b6 \u5728 qemu \u865a\u62df\u673a\u5185\u8fd0\u884c\u7684 library \u4e0e daemon \u4e4b\u95f4\u901a\u4fe1\u7684\u534f\u8bae\uff0c\u5728 XDR \u7684\u57fa\u7840\u4e0a\u6784\u5efa\u3002 \u8be6\u7ec6\u7684\u683c\u5f0f\u5728 common/protocol/guestfs_protocol.x \u4e2d\u3002 \u5b58\u5728\u4e24\u79cd\u901a\u4fe1\u60c5\u51b5\uff1a \u666e\u901a\u51fd\u6570\uff0c\u4e0d\u5e26\u6709\u4efb\u4f55 FileIn \u548c FileOut \u53c2\u6570\uff0c\u4f7f\u7528\u975e\u5e38\u7b80\u5355\u7684 request/reply \u4fe1\u606f\u6765\u5904\u7406\u3002 \u53e6\u4e00\u79cd\u5c31\u662f\u5e26\u6709\u4e00\u4e2a FileIn \u6216 FileOut \u53c2\u6570\u7684\u51fd\u6570\uff0c\u5728\u7b2c\u4e00\u79cd\u7684\u57fa\u7840\u4e0a\uff0c\u4fe1\u606f\u53ef\u80fd\u5e26\u6709\u4f7f\u7528 \u5206\u5757\u7f16\u7801\u53d1\u9001\u7684\u6587\u4ef6 \u3002 3.2.3 \u666e\u901a\u51fd\u6570 \u00b6 \u8bf7\u6c42 \u4fe1\u606f\u5982\u4e0b\uff1a total length ( header + arguments , but not including the length word itself ) struct guestfs_message_header ( encoded as XDR ) struct guestfs_ < foo > _args ( encoded as XDR ) total length \u4f7f daemon \u5206\u914d\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u7f13\u5b58\u533a\uff0c\u5176\u4e2d\u53ef\u4ee5\u5bb9\u7eb3\u6d88\u606f\u7684\u5176\u4f59\u90e8\u5206\u3002\u603b\u957f\u5ea6\u4e0d\u8d85\u8fc7 GUESTFS_MESSAGE_MAX \uff08\u5f53\u524d\u662f4MB\uff09\u3002 \u8bb8\u591a\u51fd\u6570\u4e0d\u5e26\u6709\u53c2\u6570\uff0c\u6b64\u65f6\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u88ab\u5ffd\u7565\u3002 \u5934\u90e8 guestfs_message_header \u5305\u542b\u4e86\u6570\u5b57\uff08 guestfs_proc \uff09\uff0c\u5b83\u662f\u63a5\u6536\u5668\u77e5\u9053\u53c2\u6570\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u65b9\u5f0f\uff0c\u6216\u8005\u4e0d\u77e5\u9053\u662f\u4ec0\u4e48\u7c7b\u578b\u3002 \u5728\u5934\u4fe1\u606f\u4e2d\u7684 bitmask \uff08\u4f4d\u63a9\u7801\uff09\u8bf4\u660e\u54ea\u4e9b\u53ef\u9009\u53c2\u6570 guestfs_<foo>_args \u662f\u6709\u7528\u7684\u3002 bitmask \u4e5f\u4f1a\u68c0\u67e5\u662f\u5426\u5305\u542b\u4e86 daemon \u4e0d\u77e5\u9053\u7684 bits \uff0c\u8fd9\u4f1a\u5f15\u8d77\u62d2\u7edd\u8c03\u7528\u3002 \u56de\u5e94 \u4fe1\u606f\u5982\u4e0b\uff1a total length ( header + ret , but not including the length word itself ) struct guestfs_message_header ( encoded as XDR ) struct guestfs_ < foo > _ret ( encoded as XDR ) \u4e0e\u8bf7\u6c42\u4fe1\u606f\u7c7b\u4f3c\uff0c\u5982\u679c\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u5728\u5934\u4fe1\u606f\u4e2d\u4f1a\u8bbe\u7f6e\u4e00\u4e2a\u6807\u5fd7\uff0c\u56de\u5e94\u4fe1\u606f\u4f1a\u6539\u53d8\u6210\u5982\u4e0b\u6240\u793a\uff1a total length ( header + error , but not including the length word itself ) struct guestfs_message_header ( encoded as XDR ) struct guestfs_message_error ( encoded as XDR ) 3.2.4 \u5e26\u6709 FileIn \u53c2\u6570\u7684\u51fd\u6570 \u00b6 \u5e26\u6709\u6b64\u53c2\u6570\u8868\u660e\u8f6c\u6362\u4e00\u4e2a\u6587\u4ef6\u5230guest\u3002 \u8bf7\u6c42 \u4fe1\u606f\u5982\u4e0b\uff1a total length ( header + arguments , but not including the length word itself , and not including the chunks ) struct guestfs_message_header ( encoded as XDR ) struct guestfs_ < foo > _args ( encoded as XDR ) sequence of chunks for FileIn param # 0 sequence of chunks for FileIn param # 1 etc . sequence of chunks \uff1a length of chunk ( not including length word itself ) struct guestfs_chunk ( encoded as XDR ) length of chunk struct guestfs_chunk ( encoded as XDR ) ... length of chunk struct guestfs_chunk ( with data . data_len == 0 ) \u6700\u540e\u4e00\u4e2achunk\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u6807\u5fd7\u6765\u8868\u660e\u662f\u6210\u529f\u5b8c\u6210\u8fd8\u662f\u63d0\u524d\u53d6\u6d88\u3002 \u5199\u5165\u7684\u65f6\u5019\u6ca1\u6709\u4efb\u4f55\u4e00\u4e2a\u51fd\u6570\u6709\u8d85\u8fc7\u4e00\u4e2a FileIn \u7684\u53c2\u6570\uff0c\u867d\u7136\u7406\u8bba\u4e0a\u652f\u6301\u3002 library (sender) \u548c daemon (receiver) \u90fd\u53ef\u80fd\u53d6\u6d88\u8f6c\u6362\u3002 library \u7684\u505a\u6cd5\u662f\u901a\u8fc7\u8bbe\u7f6e\u4e0a\u8ff0\u7684chunk\u6807\u5fd7\u4f4d\u3002\u5f53 daemon \u770b\u5230\u540e\uff0c\u5b83\u4f1a\u53d6\u6d88\u6574\u4e2aRPC\uff0c\u4e0d\u53d1\u9001\u4e5f\u4e0d\u56de\u5e94\uff0c\u7136\u540e\u8bfb\u53d6\u4e0b\u4e00\u6b21\u8bf7\u6c42\u3002 daemon \u7684\u505a\u6cd5\u662f\u5411socket\u5199\u5165\u4e00\u4e2a\u5173\u952e\u5b57 GUESTFS_CANCEL_FLAG \uff0c\u5728\u8f6c\u6362\u7684\u65f6\u5019library\u4f1a\u76d1\u542c\uff0c\u5f53\u5b83\u6536\u5230\u8fd9\u4e2a\u5173\u952e\u5b57\u7684\u65f6\u5019\uff0c\u4f1a\u901a\u8fc7\u4e0a\u8ff0\u65b9\u5f0f\u53d6\u6d88\u8f6c\u6362\u3002\u5373\u4f7f\u5728\u8f6c\u6362\u5b8c\u6210\u65f6\uff08library\u5b8c\u6210\u5199\u5165\u5e76\u4e14\u5f00\u59cb\u76d1\u542c\u56de\u5e94\u4fe1\u606f\uff09\u4ea6\u53ef\u4ee5\u53d1\u9001\u8be5\u5173\u952e\u5b57\uff0c\u8fd9\u4e2a\u865a\u5047\u7684\u53d6\u6d88\u6807\u8bb0\u4e0d\u4f1a\u4e0e\u56de\u5e94\u6d88\u606f\u6df7\u6dc6\u3002\uff1f\uff1f\uff1f \u8be5\u534f\u8bae\u5141\u8bb8\u4f20\u8f93\u4efb\u610f\u5927\u5c0f\u7684\u6587\u4ef6\uff0c\u4ee5\u53ca\u9884\u5148\u4e0d\u77e5\u9053\u5927\u5c0f\u7684\u6587\u4ef6\uff08\u6765\u81eapipe\u6216socket\uff09\u3002\u56e0\u4e3achunk\u5f88\u5c0f\uff0c\u6240\u4ee5library\u548cdaemon\u90fd\u4e0d\u9700\u8981\u5728\u5185\u5b58\u4e2d\u4fdd\u7559\u592a\u591a\u5185\u5bb9\u3002 3.2.5 \u5e26\u6709 FileOut \u53c2\u6570\u7684\u51fd\u6570 \u00b6 \u4e0e FileIn \u5b8c\u5168\u76f8\u540c\uff0c\u53ea\u662f\u4e24\u8005\u89d2\u8272\u4e92\u6362\u3002 total length ( header + ret , but not including the length word itself , and not including the chunks ) struct guestfs_message_header ( encoded as XDR ) struct guestfs_ < foo > _ret ( encoded as XDR ) sequence of chunks for FileOut param # 0 sequence of chunks for FileOut param # 1 etc . 3.3 \u521d\u59cb\u5316\u4fe1\u606f \u00b6 daemon \u542f\u52a8\u65f6\u5b83\u4f1a\u53d1\u9001\u4e00\u4e2a\u521d\u59cb\u5316\u5173\u952e\u5b57 GUESTFS_LAUNCH_FLAG \u8868\u660eguest\u548cdaemon\u662f\u6d3b\u52a8\u7684\u3002\u8fd9\u662f\u51fd\u6570 guestfs_launch \u7b49\u5f85\u7684\u5185\u5bb9\u3002 3.4 \u8fdb\u5c55\u901a\u77e5\u4fe1\u606f \u00b6 daemon \u53ef\u80fd\u5728\u4efb\u4f55\u65f6\u95f4\u53d1\u9001\u8fdb\u5c55\u901a\u77e5\u4fe1\u606f\u3002\u8fd9\u4e9b\u4fe1\u606f\u533a\u5206\u4e8e\u5176\u5b83\u4fe1\u606f\u7684\u5730\u65b9\u5728\u4e8e\uff1a\u6b63\u5e38\u957f\u5ea6\u5355\u8bcd length \u88ab\u66ff\u6362\u4e3a GUESTFS_PROGRESS_FLAG \uff0c\u540e\u8ddf\u56fa\u5b9a\u5927\u5c0f\u7684\u8fdb\u5c55\u4fe1\u606f\u3002 \u5982\u679c\u6ce8\u518c\u8fc7\u56de\u8c03\uff0c library \u5c06\u5b83\u4eec\u8f6c\u5316\u5230\u8fdb\u5c55\u56de\u8c03\uff08\u53c2\u9605 \"GUESTFS_EVENT_PROGRESS\" \uff09\uff0c\u5426\u5219\u4e22\u5f03\u4e4b\u3002 daemon \u9650\u5236\u4e86\u8fd9\u79cd\u4fe1\u606f\u53d1\u9001\u9891\u7387\uff08see daemon/proto.c:notify_progress \uff09\u3002\u4e0d\u662f\u6240\u6709\u7684\u8c03\u7528\u90fd\u4f1a\u4ea7\u751f\u8fdb\u5c55\u4fe1\u606f\u3002 3.5 fixed appliance \u00b6 libguestfs \u6216 libguestfs tools \u8fd0\u884c\u65f6\uff0c\u5b83\u4eec\u4e3a\u4e00\u4e2a appliance \u5bfb\u627e\u4e00\u4e2a\u8def\u5f84\u3002\u8fd9\u4e2a\u8def\u5f84\u88ab\u6784\u5efa\u5230libguestfs\u4e2d\uff0c\u6216\u4f7f\u7528\u73af\u5883\u53d8\u91cf LIBGUESTFS_PATH \u6765\u8bbe\u7f6e\u3002 \u6b63\u5e38\u60c5\u51b5\u4e0b\u4e00\u4e2a supermin appliance \u4f4d\u4e8e \"SUPERMIN APPLIANCE\" \u3002libguestfs\u901a\u8fc7\u8fd0\u884c supermin --build \u5c06\u5176\u91cd\u5efa\u4e3a\u5b8c\u6574\u7684appliance\u3002 \u4f46\u662f\uff0c\u4e00\u4e2a\u7b80\u6613\u7684 fixed appliance \u4e5f\u80fd\u4f7f\u7528\u3002libguestfs\u901a\u8fc7\u67e5\u627e\u5305\u542b\u4ee5\u4e0b\u6240\u6709\u6587\u4ef6\u7684\u8def\u5f84\u4e0a\u7684\u76ee\u5f55\u6765\u68c0\u6d4b\u5b83\uff1a kernel initrd root README.fixed \u5982\u679c\u627e\u5230\u4e86fixed appliance\uff0clibguestfs\u4f1a\u5b8c\u5168\u8df3\u8fc7supermin\uff0c\u7136\u540e\u4f7f\u7528\u56fa\u5b9a\u8bbe\u5907\u4e2d\u7684kernel\u3001initrd\u548croot disk\u8fd0\u884c\u865a\u62df\u673a\uff08\u4f7f\u7528qemu\u6216\u5f53\u524d\u7684\u540e\u53f0\uff0csee \"BACKEND\" \uff09\u3002 4. \u6784\u5efalibguestfs \u00b6 cd libguestfs/ ./autogen.sh --disable-erlang \\ --disable-gobject \\ --disable-golang \\ --disable-haskell \\ --disable-lua \\ --disable-php \\ --disable-ruby make -j 10 make INSTALLDIRS = vendor DESTDIR = /home/tmp/ install # \u53ef\u9009","title":"libguestfs"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#1","text":"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 main program \u2502 \u2502 \u2502 \u2502 \u2502 child process / appliance \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 qemu \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 RPC \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 libguestfs \u25c0\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u25b6 guestfsd \u2502 \u2502 \u2502 \u2502 \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 Linux kernel \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 virtio-scsi \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Device or \u2502 \u2502 disk image \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 libguestfs\u7684\u5b9e\u73b0\u65b9\u5f0f\u662f\u901a\u8fc7\u4f7f\u7528 qemu \u8fd0\u884c\u4e00\u4e2a appliance \uff08\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u5c0f\u865a\u62df\u673a\uff09\u3002 qemu \u4f5c\u4e3a\u4e3b\u7a0b\u5e8f\u7684\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u8fd0\u884c\u3002 \u94fe\u63a5\u5230\u4e3b\u7a0b\u5e8f\u7684 library \u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u7136\u540e\u5728 guestfs_launch \u51fd\u6570\u4e2d\u521b\u5efaappliance\u3002 \u5728 appliance \u5185\u90e8\u662f\u4e00\u4e2alinux\u5185\u6838\u3001\u4e00\u5806\u5b8c\u6574\u7684\u7528\u6237\u7a7a\u95f4\u5de5\u5177\uff08\u4f8b\u5982LVM\u3001ext2\u7a0b\u5e8f\uff09\u548c\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b guestfsd \uff08\u4ee5\u4e0b\u4f7f\u7528 daemon \u4ee3\u66ff\uff09\u3002 library \u544a\u8bc9 daemon \u4f7f\u7528\u8fdc\u7a0b\u7a0b\u5e8f\u8c03\u7528\uff08RPC\uff09\u3002 libguestfs API \u8c03\u7528\u548c\u5bf9\u5b88\u62a4\u8fdb\u7a0b\u7684 RPC \u8c03\u7528\u4e4b\u95f4\u901a\u5e38\u5b58\u5728\u4e00\u5bf9\u4e00\u7684\u5bf9\u5e94\u5173\u7cfb\u3002\u6700\u540e\uff0c disk image \u88ab\u9644\u52a0\u5230qemu\u8fdb\u7a0b\uff0c\u8be5\u8fdb\u7a0b\u5c06\u8bbe\u5907\u7684linux\u5185\u6838\u5bf9\u8bbe\u5907\u7684\u8bbf\u95ee\u8f6c\u6362\u4e3a\u5bf9\u6620\u50cf\u7684\u8bbf\u95ee\u3002","title":"1.\u67b6\u6784"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#2","text":"libguestfs\u4f7f\u7528\u72b6\u6001\u673a\u6765\u5efa\u6a21\u5b50\u8fdb\u7a0b\uff1a \u6b63\u5e38\u7684\u72b6\u6001\u8f6c\u6362\u6d41\u7a0b\uff1a CONFIG \uff1a\u5904\u7406\u7a0b\u5e8f\u5df2\u88ab\u521b\u5efa\uff0c\u4f46\u662f\u8fd8\u6ca1\u6709\u5b50\u8fdb\u7a0b LAUNCHING \uff1a\u5b50\u8fdb\u7a0b\u6b63\u5728\u542f\u52a8 READY \uff1a\u6b64\u65f6\u610f\u5473\u7740appliance\u5df2\u7ecf\u542f\u52a8\uff0c\u53ef\u4ee5\u53d1\u9001\u52a8\u4f5c\u5e76\u88ab\u5b50\u8fdb\u7a0b\u6267\u884c guest \uff08\u6307\u865a\u62df\u673a\u6620\u50cfimage\uff0c\u53ef\u901a\u8fc7 virt-builder \u521b\u5efa\uff09\u53ef\u80fd\u4f1a\u88ab\u6740\u6389\uff08\u51fd\u6570 guestfs_kill_subprocess\uff09\uff0c\u6216\u5728\u4efb\u4f55\u65f6\u95f4\u5f02\u6b65\u5730\u6b7b\u6389\uff08\u4e00\u4e9b\u5185\u90e8\u9519\u8bef\uff09\uff0c\u5bfc\u81f4\u72b6\u6001\u56de\u5230 CONFIG \u3002 \u914d\u7f6e\u547d\u4ee4\uff08\u4f8b\u5982\u51fd\u6570 guestfs_set_path\uff09\u53ea\u80fd\u5728 CONFIG \u72b6\u6001\u53d1\u51fa\u3002 API \u63d0\u4f9b\u4e86\u4ece CONFIG \u7ecf\u8fc7 LAUNCHING \u5230 READY \u7684\u8c03\u7528\uff1a\u51fd\u6570 guestfs_launch \u4f1a\u963b\u585e\u76f4\u5230\u5b50\u8fdb\u7a0b\u662f READY \u72b6\u6001\uff08\u6216\u8005\u5931\u8d25\u3001\u8d85\u65f6\uff09\u3002\u51fd\u6570 guestfs_launch \u5728\u8fd0\u884c\u7684\u65f6\u5019\u5728\u5185\u90e8\u4f1a\u5c06\u72b6\u6001\u4ece CONFIG \u53d8\u4e3a LAUNCHING \u3002 API\u52a8\u4f5c\uff08\u4f8b\u5982\u51fd\u6570 guestfs_mount\uff09\u53ea\u80fd\u5728 READY \u72b6\u6001\u7684\u65f6\u5019\u53d1\u9001\u3002\u8fd9\u4e9bAPI\u8c03\u7528\u4f1a\u963b\u585e\u4f4f\u76f4\u5230\u547d\u4ee4\u88ab\u6267\u884c\u3002\u540c\u4e00\u65f6\u95f4\u53ea\u4f1a\u6267\u884c\u4e00\u4e2a\u547d\u4ee4\u3002 \u6700\u540e\uff0c\u5b50\u8fdb\u7a0b\u53d1\u9001\u5f02\u6b65\u4fe1\u606f\u5230\u4e3b\u7a0b\u5e8f\uff0c\u4f8b\u5982\u5185\u6838\u65e5\u5fd7\u4fe1\u606f\u3002\u4f60\u53ef\u4ee5\u6ce8\u518c\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u6765\u63a5\u6536\u8fd9\u4e9b\u4fe1\u606f\u3002","title":"2.\u72b6\u6001\u673a"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#3","text":"","title":"3.\u5185\u90e8"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#31-appliance","text":"\u5f00\u542f\u8c03\u8bd5\u6a21\u5f0f\uff0c\u5728\u547d\u4ee4\u884c\u5934\u90e8\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\u53c2\u6570\uff1a LIBGUESTFS_TRACE=1 LIBGUESTFS_DEBUG=1 \u3002 LIBGUESTFS_TRACE = 1 LIBGUESTFS_DEBUG = 1 virt-v2v -i ova centos2.ova -o local -os /var/tmp/ -of qcow2 2 > & 1 | tee virt-v2v.log","title":"3.1 appliance\u542f\u52a8\u8fdb\u7a0b"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#311-appliance","text":"\u8c03\u7528 supermin --build \u521b\u5efa\uff1akernel\u3001small initrd\u3001appliance\u3002\u8be6\u7ec6\u7684supermin\u8bf4\u660e\uff1a supermin(1) \u3002 appliance\u9ed8\u8ba4\u5b58\u50a8\u5728 /var/tmp/.guestfs-<UID> \u4e0b\u3002","title":"3.1.1 \u521b\u5efa appliance"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#312-qemu-kernel","text":"\u8c03\u7528qemu\u542f\u52a8kernel\u3002","title":"3.1.2 \u5f00\u542f qemu \u5e76\u542f\u52a8 kernel"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#313-initrd","text":"supermin --build \u6784\u5efa\u4e86\u4e00\u4e2a\u5c0f\u7684initrd\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u4e3a\u4e86appliance\u80fd\u88ab\u6302\u8f7d\u548c\u542f\u52a8\u53bb\u8f7d\u5165\u8db3\u591f\u7684\u5185\u6838\u6a21\u5757\u3002 initrd\u662f\u4e00\u4e2acpio\u6587\u4ef6\uff0c\u5728 /var/tmp/.guestfs-<UID>/appliance.d/initrd \uff0cinitrd\u542f\u52a8\u65f6\u53ef\u4ee5\u770b\u5230\u5185\u6838\u8f7d\u5165\u4fe1\u606f\u3002","title":"3.1.3 \u8fd0\u884cinitrd"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#314-appliance","text":"appliance\u662f\u4e00\u4e2a\u7a00\u758f\u6587\u4ef6\uff0c\u5305\u542b\u4e86ext2\u6587\u4ef6\u7cfb\u7edf\uff08\u5305\u542b\u4e86\u4e00\u4e2alinux\u64cd\u4f5c\u7cfb\u7edf\uff09\u3002\u6b63\u5e38\u60c5\u51b5\u4e0b\u88ab\u79f0\u4f5c /var/tmp/.guestfs-<UID>/appliance.d/root \u3002 libguestfs\u9996\u5148\u68c0\u67e5\u88abqemu\u66b4\u9732\u7684\u5e38\u89c4\u78c1\u76d8\uff08eg. /dev/vda\uff09\uff0c\u6700\u540e\u4e00\u4e2a\u88ab\u52a0\u5230qemu\u4e2d\u7684\u662fappliance\uff08eg. /dev/vdb\uff09\u3002 \u4e8e\u662finitrd\u6700\u540e\u7684\u5de5\u4f5c\u662f\u5b9a\u4f4d\u5230appliance\u78c1\u76d8\uff0c\u6302\u8f7d\u5b83\uff0c\u8f6c\u6362root\u5230appliance\uff0c\u7136\u540e\u4eceappliance\u8fd0\u884c /init \u3002","title":"3.1.4 \u627e\u5230\u5e76\u6302\u8f7dappliance\u8bbe\u5907"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#315-appliance","text":"\u73b0\u5728appliance\u81ea\u884c\u521d\u59cb\u5316\u3002\u5305\u62ec\u542f\u52a8\u67d0\u4e9b\u7ebf\u7a0b\uff0c\u53ef\u80fd\u4f1a\u6253\u5370\u8c03\u8bd5\u4fe1\u606f\uff0c\u6700\u7ec8\u8fd0\u884c daemon \u3002","title":"3.1.5 \u521d\u59cb\u5316appliance"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#316-daemon","text":"\u6700\u7ec8appliance\u4e2d\u8fd0\u884c daemon \u3002 daemon\u671f\u5f85\u770b\u5230\u88abqemu\u516c\u5f00\u7684\u547d\u540d\u7684virtio-serial\u7aef\u53e3\uff08\u5728 /dev/virtio-ports/ \u4e0b\uff09\uff0c\u7136\u540e\u5728\u53e6\u4e00\u7aef\u8fde\u63a5\u5230 library \u3002 daemon\u8fde\u63a5\u5230\u8fd9\u4e2a\u7aef\u53e3\u5e76\u53d1\u9001\u5173\u952e\u5b57 GUESTFS_LAUNCH_FLAG \u6765\u521d\u59cb\u5316\u901a\u4fe1\u534f\u8bae\u3002","title":"3.1.6 daemon"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#32","text":"\u5728 qemu \u865a\u62df\u673a\u5185\u8fd0\u884c\u7684 library \u4e0e daemon \u4e4b\u95f4\u901a\u4fe1\u7684\u534f\u8bae\uff0c\u5728 XDR \u7684\u57fa\u7840\u4e0a\u6784\u5efa\u3002 \u8be6\u7ec6\u7684\u683c\u5f0f\u5728 common/protocol/guestfs_protocol.x \u4e2d\u3002 \u5b58\u5728\u4e24\u79cd\u901a\u4fe1\u60c5\u51b5\uff1a \u666e\u901a\u51fd\u6570\uff0c\u4e0d\u5e26\u6709\u4efb\u4f55 FileIn \u548c FileOut \u53c2\u6570\uff0c\u4f7f\u7528\u975e\u5e38\u7b80\u5355\u7684 request/reply \u4fe1\u606f\u6765\u5904\u7406\u3002 \u53e6\u4e00\u79cd\u5c31\u662f\u5e26\u6709\u4e00\u4e2a FileIn \u6216 FileOut \u53c2\u6570\u7684\u51fd\u6570\uff0c\u5728\u7b2c\u4e00\u79cd\u7684\u57fa\u7840\u4e0a\uff0c\u4fe1\u606f\u53ef\u80fd\u5e26\u6709\u4f7f\u7528 \u5206\u5757\u7f16\u7801\u53d1\u9001\u7684\u6587\u4ef6 \u3002","title":"3.2 \u901a\u4fe1\u534f\u8bae"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#323","text":"\u8bf7\u6c42 \u4fe1\u606f\u5982\u4e0b\uff1a total length ( header + arguments , but not including the length word itself ) struct guestfs_message_header ( encoded as XDR ) struct guestfs_ < foo > _args ( encoded as XDR ) total length \u4f7f daemon \u5206\u914d\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u7f13\u5b58\u533a\uff0c\u5176\u4e2d\u53ef\u4ee5\u5bb9\u7eb3\u6d88\u606f\u7684\u5176\u4f59\u90e8\u5206\u3002\u603b\u957f\u5ea6\u4e0d\u8d85\u8fc7 GUESTFS_MESSAGE_MAX \uff08\u5f53\u524d\u662f4MB\uff09\u3002 \u8bb8\u591a\u51fd\u6570\u4e0d\u5e26\u6709\u53c2\u6570\uff0c\u6b64\u65f6\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u88ab\u5ffd\u7565\u3002 \u5934\u90e8 guestfs_message_header \u5305\u542b\u4e86\u6570\u5b57\uff08 guestfs_proc \uff09\uff0c\u5b83\u662f\u63a5\u6536\u5668\u77e5\u9053\u53c2\u6570\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u65b9\u5f0f\uff0c\u6216\u8005\u4e0d\u77e5\u9053\u662f\u4ec0\u4e48\u7c7b\u578b\u3002 \u5728\u5934\u4fe1\u606f\u4e2d\u7684 bitmask \uff08\u4f4d\u63a9\u7801\uff09\u8bf4\u660e\u54ea\u4e9b\u53ef\u9009\u53c2\u6570 guestfs_<foo>_args \u662f\u6709\u7528\u7684\u3002 bitmask \u4e5f\u4f1a\u68c0\u67e5\u662f\u5426\u5305\u542b\u4e86 daemon \u4e0d\u77e5\u9053\u7684 bits \uff0c\u8fd9\u4f1a\u5f15\u8d77\u62d2\u7edd\u8c03\u7528\u3002 \u56de\u5e94 \u4fe1\u606f\u5982\u4e0b\uff1a total length ( header + ret , but not including the length word itself ) struct guestfs_message_header ( encoded as XDR ) struct guestfs_ < foo > _ret ( encoded as XDR ) \u4e0e\u8bf7\u6c42\u4fe1\u606f\u7c7b\u4f3c\uff0c\u5982\u679c\u53d1\u751f\u4e86\u9519\u8bef\uff0c\u5728\u5934\u4fe1\u606f\u4e2d\u4f1a\u8bbe\u7f6e\u4e00\u4e2a\u6807\u5fd7\uff0c\u56de\u5e94\u4fe1\u606f\u4f1a\u6539\u53d8\u6210\u5982\u4e0b\u6240\u793a\uff1a total length ( header + error , but not including the length word itself ) struct guestfs_message_header ( encoded as XDR ) struct guestfs_message_error ( encoded as XDR )","title":"3.2.3 \u666e\u901a\u51fd\u6570"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#324-filein","text":"\u5e26\u6709\u6b64\u53c2\u6570\u8868\u660e\u8f6c\u6362\u4e00\u4e2a\u6587\u4ef6\u5230guest\u3002 \u8bf7\u6c42 \u4fe1\u606f\u5982\u4e0b\uff1a total length ( header + arguments , but not including the length word itself , and not including the chunks ) struct guestfs_message_header ( encoded as XDR ) struct guestfs_ < foo > _args ( encoded as XDR ) sequence of chunks for FileIn param # 0 sequence of chunks for FileIn param # 1 etc . sequence of chunks \uff1a length of chunk ( not including length word itself ) struct guestfs_chunk ( encoded as XDR ) length of chunk struct guestfs_chunk ( encoded as XDR ) ... length of chunk struct guestfs_chunk ( with data . data_len == 0 ) \u6700\u540e\u4e00\u4e2achunk\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u6807\u5fd7\u6765\u8868\u660e\u662f\u6210\u529f\u5b8c\u6210\u8fd8\u662f\u63d0\u524d\u53d6\u6d88\u3002 \u5199\u5165\u7684\u65f6\u5019\u6ca1\u6709\u4efb\u4f55\u4e00\u4e2a\u51fd\u6570\u6709\u8d85\u8fc7\u4e00\u4e2a FileIn \u7684\u53c2\u6570\uff0c\u867d\u7136\u7406\u8bba\u4e0a\u652f\u6301\u3002 library (sender) \u548c daemon (receiver) \u90fd\u53ef\u80fd\u53d6\u6d88\u8f6c\u6362\u3002 library \u7684\u505a\u6cd5\u662f\u901a\u8fc7\u8bbe\u7f6e\u4e0a\u8ff0\u7684chunk\u6807\u5fd7\u4f4d\u3002\u5f53 daemon \u770b\u5230\u540e\uff0c\u5b83\u4f1a\u53d6\u6d88\u6574\u4e2aRPC\uff0c\u4e0d\u53d1\u9001\u4e5f\u4e0d\u56de\u5e94\uff0c\u7136\u540e\u8bfb\u53d6\u4e0b\u4e00\u6b21\u8bf7\u6c42\u3002 daemon \u7684\u505a\u6cd5\u662f\u5411socket\u5199\u5165\u4e00\u4e2a\u5173\u952e\u5b57 GUESTFS_CANCEL_FLAG \uff0c\u5728\u8f6c\u6362\u7684\u65f6\u5019library\u4f1a\u76d1\u542c\uff0c\u5f53\u5b83\u6536\u5230\u8fd9\u4e2a\u5173\u952e\u5b57\u7684\u65f6\u5019\uff0c\u4f1a\u901a\u8fc7\u4e0a\u8ff0\u65b9\u5f0f\u53d6\u6d88\u8f6c\u6362\u3002\u5373\u4f7f\u5728\u8f6c\u6362\u5b8c\u6210\u65f6\uff08library\u5b8c\u6210\u5199\u5165\u5e76\u4e14\u5f00\u59cb\u76d1\u542c\u56de\u5e94\u4fe1\u606f\uff09\u4ea6\u53ef\u4ee5\u53d1\u9001\u8be5\u5173\u952e\u5b57\uff0c\u8fd9\u4e2a\u865a\u5047\u7684\u53d6\u6d88\u6807\u8bb0\u4e0d\u4f1a\u4e0e\u56de\u5e94\u6d88\u606f\u6df7\u6dc6\u3002\uff1f\uff1f\uff1f \u8be5\u534f\u8bae\u5141\u8bb8\u4f20\u8f93\u4efb\u610f\u5927\u5c0f\u7684\u6587\u4ef6\uff0c\u4ee5\u53ca\u9884\u5148\u4e0d\u77e5\u9053\u5927\u5c0f\u7684\u6587\u4ef6\uff08\u6765\u81eapipe\u6216socket\uff09\u3002\u56e0\u4e3achunk\u5f88\u5c0f\uff0c\u6240\u4ee5library\u548cdaemon\u90fd\u4e0d\u9700\u8981\u5728\u5185\u5b58\u4e2d\u4fdd\u7559\u592a\u591a\u5185\u5bb9\u3002","title":"3.2.4 \u5e26\u6709FileIn\u53c2\u6570\u7684\u51fd\u6570"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#325-fileout","text":"\u4e0e FileIn \u5b8c\u5168\u76f8\u540c\uff0c\u53ea\u662f\u4e24\u8005\u89d2\u8272\u4e92\u6362\u3002 total length ( header + ret , but not including the length word itself , and not including the chunks ) struct guestfs_message_header ( encoded as XDR ) struct guestfs_ < foo > _ret ( encoded as XDR ) sequence of chunks for FileOut param # 0 sequence of chunks for FileOut param # 1 etc .","title":"3.2.5 \u5e26\u6709FileOut\u53c2\u6570\u7684\u51fd\u6570"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#33","text":"daemon \u542f\u52a8\u65f6\u5b83\u4f1a\u53d1\u9001\u4e00\u4e2a\u521d\u59cb\u5316\u5173\u952e\u5b57 GUESTFS_LAUNCH_FLAG \u8868\u660eguest\u548cdaemon\u662f\u6d3b\u52a8\u7684\u3002\u8fd9\u662f\u51fd\u6570 guestfs_launch \u7b49\u5f85\u7684\u5185\u5bb9\u3002","title":"3.3 \u521d\u59cb\u5316\u4fe1\u606f"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#34","text":"daemon \u53ef\u80fd\u5728\u4efb\u4f55\u65f6\u95f4\u53d1\u9001\u8fdb\u5c55\u901a\u77e5\u4fe1\u606f\u3002\u8fd9\u4e9b\u4fe1\u606f\u533a\u5206\u4e8e\u5176\u5b83\u4fe1\u606f\u7684\u5730\u65b9\u5728\u4e8e\uff1a\u6b63\u5e38\u957f\u5ea6\u5355\u8bcd length \u88ab\u66ff\u6362\u4e3a GUESTFS_PROGRESS_FLAG \uff0c\u540e\u8ddf\u56fa\u5b9a\u5927\u5c0f\u7684\u8fdb\u5c55\u4fe1\u606f\u3002 \u5982\u679c\u6ce8\u518c\u8fc7\u56de\u8c03\uff0c library \u5c06\u5b83\u4eec\u8f6c\u5316\u5230\u8fdb\u5c55\u56de\u8c03\uff08\u53c2\u9605 \"GUESTFS_EVENT_PROGRESS\" \uff09\uff0c\u5426\u5219\u4e22\u5f03\u4e4b\u3002 daemon \u9650\u5236\u4e86\u8fd9\u79cd\u4fe1\u606f\u53d1\u9001\u9891\u7387\uff08see daemon/proto.c:notify_progress \uff09\u3002\u4e0d\u662f\u6240\u6709\u7684\u8c03\u7528\u90fd\u4f1a\u4ea7\u751f\u8fdb\u5c55\u4fe1\u606f\u3002","title":"3.4 \u8fdb\u5c55\u901a\u77e5\u4fe1\u606f"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#35-fixed-appliance","text":"libguestfs \u6216 libguestfs tools \u8fd0\u884c\u65f6\uff0c\u5b83\u4eec\u4e3a\u4e00\u4e2a appliance \u5bfb\u627e\u4e00\u4e2a\u8def\u5f84\u3002\u8fd9\u4e2a\u8def\u5f84\u88ab\u6784\u5efa\u5230libguestfs\u4e2d\uff0c\u6216\u4f7f\u7528\u73af\u5883\u53d8\u91cf LIBGUESTFS_PATH \u6765\u8bbe\u7f6e\u3002 \u6b63\u5e38\u60c5\u51b5\u4e0b\u4e00\u4e2a supermin appliance \u4f4d\u4e8e \"SUPERMIN APPLIANCE\" \u3002libguestfs\u901a\u8fc7\u8fd0\u884c supermin --build \u5c06\u5176\u91cd\u5efa\u4e3a\u5b8c\u6574\u7684appliance\u3002 \u4f46\u662f\uff0c\u4e00\u4e2a\u7b80\u6613\u7684 fixed appliance \u4e5f\u80fd\u4f7f\u7528\u3002libguestfs\u901a\u8fc7\u67e5\u627e\u5305\u542b\u4ee5\u4e0b\u6240\u6709\u6587\u4ef6\u7684\u8def\u5f84\u4e0a\u7684\u76ee\u5f55\u6765\u68c0\u6d4b\u5b83\uff1a kernel initrd root README.fixed \u5982\u679c\u627e\u5230\u4e86fixed appliance\uff0clibguestfs\u4f1a\u5b8c\u5168\u8df3\u8fc7supermin\uff0c\u7136\u540e\u4f7f\u7528\u56fa\u5b9a\u8bbe\u5907\u4e2d\u7684kernel\u3001initrd\u548croot disk\u8fd0\u884c\u865a\u62df\u673a\uff08\u4f7f\u7528qemu\u6216\u5f53\u524d\u7684\u540e\u53f0\uff0csee \"BACKEND\" \uff09\u3002","title":"3.5 fixed appliance"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/libguestfs/#4-libguestfs","text":"cd libguestfs/ ./autogen.sh --disable-erlang \\ --disable-gobject \\ --disable-golang \\ --disable-haskell \\ --disable-lua \\ --disable-php \\ --disable-ruby make -j 10 make INSTALLDIRS = vendor DESTDIR = /home/tmp/ install # \u53ef\u9009","title":"4. \u6784\u5efalibguestfs"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v-make-disk%E8%84%9A%E6%9C%AC%E5%88%86%E6%9E%90/","text":"\u5b98\u65b9\u6587\u6863 \u7528\u4e8e\u521b\u5efa\u5305\u542b virt-p2v \u7684 \u53ef\u5f15\u5bfc\u78c1\u76d8\u6620\u50cf \u6216 USB key \u7684\u811a\u672c\uff0c\u4f7f\u7528 virt-builder \u5b9e\u73b0\u3002 \u811a\u672c\u4f4d\u4e8e /libguestfs/p2v/virt-p2v-make-disk \u3002 \u4f7f\u7528\u4ecb\u7ecd \u00b6 \u8f93\u51fa\u4e00\u4e2a\u81ea\u52a8\u8fd0\u884cvirt-p2v\u7684USB\u542f\u52a8\u76d8\u5230 /dev/sdX \uff1a virt-p2v-make-disk -o /dev/sdX \u8f93\u51fa\u4e00\u4e2a\u81ea\u52a8\u8fd0\u884cvirt-p2v\u3001\u53ef\u542f\u52a8\u7684\u865a\u62df\u78c1\u76d8\uff1b\u5728qemu\u4e0b\u542f\u52a8\uff1a virt-p2v-make-disk -o /var/tmp/p2v.img qemu-kvm -m 1024 -boot c \\ -drive file = /var/tmp/p2v.img,if = virtio,index = 0 \\ -drive file = /var/tmp/guest.img,if = virtio,index = 1 \u811a\u672c\u5206\u6790 \u00b6 1.\u89e3\u6790\u4f20\u5165\u7684\u9009\u9879\uff0c\u5305\u62ec\u81ea\u8eab\u7684\u9009\u9879\u3001virt-builder\u53ef\u63a5\u53d7\u7684\u9009\u9879\u3001\u5e2e\u52a9\u9009\u9879\u3002 2.\u83b7\u53d6\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u3002 \u200b \u6ca1\u6709\u8bbe\u7f6e\u7684\u8bdd\uff0c\u53bb\u68c0\u67e5 /etc/redhat-release \u6216 /etc/debian_version \u662f\u5426\u5b58\u5728\uff0c\u524d\u8005\u4f7f\u7528fedora\u7cfb\u7edf\uff0c\u540e\u8005\u4f7f\u7528debian\u7cfb\u7edf\uff1b\u90fd\u6ca1\u6709\u7684\u8bdd\u9700\u8981\u91cd\u65b0\u6307\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u3002 3.\u786e\u5b9a\u4f7f\u7528xz\u6587\u4ef6\u3002 \u200b \u5982\u679c\u4f20\u5165\u4e86 --arch \u9009\u9879\uff0c\u4f7f\u7528 virt_p2v_xz_binary=\"$libdir/virt-p2v.$arch.xz\" \uff0c\u5426\u5219\u4f7f\u7528 virt_p2v_xz_binary=\"$libdir/virt-p2v.xz\" \u3002\u524d\u8005\u9700\u8981\u81ea\u884c\u6784\u5efa\u3002 4.\u521b\u5efa\u4e34\u65f6\u8f93\u51fa\u76ee\u5f55\u3002 \u200b tmpdir=\"$(mktemp -d)\" 5.\u89e3\u538bxz\u6587\u4ef6\u5230\u4e34\u65f6\u76ee\u5f55\u3002 6.\u4f9d\u636e\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u8bfb\u53d6\u4e0d\u540c\u7684\u4f9d\u8d56\u6587\u4ef6\u3002 centos-* | fedora-* | rhel-* | scientificlinux-* ) depsfile = \" $datadir /dependencies.redhat\" \u91cd\u6784initramfs debian-* | ubuntu-* ) depsfile = \" $datadir /dependencies.debian\" archlinux-* ) depsfile = \" $datadir /dependencies.archlinux\" opensuse-* | suse-* ) depsfile = \" $datadir /dependencies.suse\" 7.\u6267\u884c virt-builder \u547d\u4ee4 virt-builder \" $osversion \" \\ $verbose_option \\ --output \" $output \" \\ $arch_option \\ $preinstall_args \\ --update \\ --install \" $install \" \\ --root-password password:p2v \\ --upload \" $datadir \" /issue:/etc/issue \\ --upload \" $datadir \" /issue:/etc/issue.net \\ --mkdir /usr/bin \\ --upload \" $virt_p2v_binary \" :/usr/bin/virt-p2v \\ --chmod 0755 :/usr/bin/virt-p2v \\ --upload \" $datadir \" /launch-virt-p2v:/usr/bin/ \\ --chmod 0755 :/usr/bin/launch-virt-p2v \\ --upload \" $datadir \" /p2v.service:/etc/systemd/system/ \\ --mkdir /etc/systemd/system/multi-user.target.wants \\ --link /etc/systemd/system/p2v.service:/etc/systemd/system/multi-user.target.wants/p2v.service \\ --edit '/lib/systemd/system/getty@.service: s/^ExecStart=(.*)/ExecStart=$1 -a root/ ' \\ --edit '/etc/systemd/logind.conf: s/^[Login]/[Login]\\nReserveVT=1\\n/ ' \\ $upload \\ $extra_args \\ \" ${ passthru [@] } \" \\ $final_args 8.\u6e05\u7406\u4e34\u65f6\u76ee\u5f55","title":"virt-p2v-make-disk\u811a\u672c\u5206\u6790"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v-make-disk%E8%84%9A%E6%9C%AC%E5%88%86%E6%9E%90/#_1","text":"\u8f93\u51fa\u4e00\u4e2a\u81ea\u52a8\u8fd0\u884cvirt-p2v\u7684USB\u542f\u52a8\u76d8\u5230 /dev/sdX \uff1a virt-p2v-make-disk -o /dev/sdX \u8f93\u51fa\u4e00\u4e2a\u81ea\u52a8\u8fd0\u884cvirt-p2v\u3001\u53ef\u542f\u52a8\u7684\u865a\u62df\u78c1\u76d8\uff1b\u5728qemu\u4e0b\u542f\u52a8\uff1a virt-p2v-make-disk -o /var/tmp/p2v.img qemu-kvm -m 1024 -boot c \\ -drive file = /var/tmp/p2v.img,if = virtio,index = 0 \\ -drive file = /var/tmp/guest.img,if = virtio,index = 1","title":"\u4f7f\u7528\u4ecb\u7ecd"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v-make-disk%E8%84%9A%E6%9C%AC%E5%88%86%E6%9E%90/#_2","text":"1.\u89e3\u6790\u4f20\u5165\u7684\u9009\u9879\uff0c\u5305\u62ec\u81ea\u8eab\u7684\u9009\u9879\u3001virt-builder\u53ef\u63a5\u53d7\u7684\u9009\u9879\u3001\u5e2e\u52a9\u9009\u9879\u3002 2.\u83b7\u53d6\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u3002 \u200b \u6ca1\u6709\u8bbe\u7f6e\u7684\u8bdd\uff0c\u53bb\u68c0\u67e5 /etc/redhat-release \u6216 /etc/debian_version \u662f\u5426\u5b58\u5728\uff0c\u524d\u8005\u4f7f\u7528fedora\u7cfb\u7edf\uff0c\u540e\u8005\u4f7f\u7528debian\u7cfb\u7edf\uff1b\u90fd\u6ca1\u6709\u7684\u8bdd\u9700\u8981\u91cd\u65b0\u6307\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u3002 3.\u786e\u5b9a\u4f7f\u7528xz\u6587\u4ef6\u3002 \u200b \u5982\u679c\u4f20\u5165\u4e86 --arch \u9009\u9879\uff0c\u4f7f\u7528 virt_p2v_xz_binary=\"$libdir/virt-p2v.$arch.xz\" \uff0c\u5426\u5219\u4f7f\u7528 virt_p2v_xz_binary=\"$libdir/virt-p2v.xz\" \u3002\u524d\u8005\u9700\u8981\u81ea\u884c\u6784\u5efa\u3002 4.\u521b\u5efa\u4e34\u65f6\u8f93\u51fa\u76ee\u5f55\u3002 \u200b tmpdir=\"$(mktemp -d)\" 5.\u89e3\u538bxz\u6587\u4ef6\u5230\u4e34\u65f6\u76ee\u5f55\u3002 6.\u4f9d\u636e\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u8bfb\u53d6\u4e0d\u540c\u7684\u4f9d\u8d56\u6587\u4ef6\u3002 centos-* | fedora-* | rhel-* | scientificlinux-* ) depsfile = \" $datadir /dependencies.redhat\" \u91cd\u6784initramfs debian-* | ubuntu-* ) depsfile = \" $datadir /dependencies.debian\" archlinux-* ) depsfile = \" $datadir /dependencies.archlinux\" opensuse-* | suse-* ) depsfile = \" $datadir /dependencies.suse\" 7.\u6267\u884c virt-builder \u547d\u4ee4 virt-builder \" $osversion \" \\ $verbose_option \\ --output \" $output \" \\ $arch_option \\ $preinstall_args \\ --update \\ --install \" $install \" \\ --root-password password:p2v \\ --upload \" $datadir \" /issue:/etc/issue \\ --upload \" $datadir \" /issue:/etc/issue.net \\ --mkdir /usr/bin \\ --upload \" $virt_p2v_binary \" :/usr/bin/virt-p2v \\ --chmod 0755 :/usr/bin/virt-p2v \\ --upload \" $datadir \" /launch-virt-p2v:/usr/bin/ \\ --chmod 0755 :/usr/bin/launch-virt-p2v \\ --upload \" $datadir \" /p2v.service:/etc/systemd/system/ \\ --mkdir /etc/systemd/system/multi-user.target.wants \\ --link /etc/systemd/system/p2v.service:/etc/systemd/system/multi-user.target.wants/p2v.service \\ --edit '/lib/systemd/system/getty@.service: s/^ExecStart=(.*)/ExecStart=$1 -a root/ ' \\ --edit '/etc/systemd/logind.conf: s/^[Login]/[Login]\\nReserveVT=1\\n/ ' \\ $upload \\ $extra_args \\ \" ${ passthru [@] } \" \\ $final_args 8.\u6e05\u7406\u4e34\u65f6\u76ee\u5f55","title":"\u811a\u672c\u5206\u6790"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E4%BB%8B%E7%BB%8D/","text":"1.\u7f51\u7edc\u8bbe\u7f6e 2.GUI\u4ea4\u4e92\u5f0f\u914d\u7f6e 2.1 \u7528\u6237\u540d\u5bc6\u7801\u6216SSH\u914d\u7f6e 2.2 \u78c1\u76d8\u548c\u865a\u62df\u673a\u7f51\u7edc\u914d\u7f6e 2.3 \u8f6c\u6362\u8fd0\u884c\u754c\u9762 3. \u5185\u6838\u547d\u4ee4\u884c\u914d\u7f6e 4.SSH\u8ba4\u8bc1 5.\u5de5\u4f5c\u65b9\u5f0f 6.\u4f7f\u7528 \u539f\u6587\u5730\u5740\uff1a virt-p2v \u4e0d\u8981\u76f4\u63a5\u8fd0\u884c virt-p2v \u3002\u4f60\u5e94\u8be5\u4f7f\u7528\u53ef\u542f\u52a8 CDROM,ISO,PXE image \u6765\u542f\u52a8\u7269\u7406\u673a\u3002\u8fd9\u4e2a\u6620\u50cf\u5305\u62ecvirt-p2v\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e76\u4f1a\u81ea\u52a8\u5730\u8fd0\u884c\u5b83\u3002\u8fd9\u4e48\u505a\u7684\u539f\u56e0\u662f\u88ab\u8f6c\u6362\u7684\u78c1\u76d8\u5fc5\u987b\u662f\u975e\u6d3b\u52a8\u72b6\u6001\uff0c\u56e0\u4e3a\u5176\u4ed6\u7a0b\u5e8f\u4f1a\u4fee\u6539\u6d3b\u52a8\u78c1\u76d8\u7684\u5185\u5bb9\u3002\u8fd9\u4e2a\u542f\u52a8\u6620\u50cf\u7531 virt-p2v-make-disk \u5236\u4f5c\u3002 1.\u7f51\u7edc\u8bbe\u7f6e \u00b6 virt-p2v \u5728\u7269\u7406\u673a\u4e0a\u9762\u8fd0\u884c\u3002\u5b83\u901a\u8fc7 SSH \u4e0e\u8f6c\u6362\u670d\u52a1\u5668\uff08\u5b89\u88c5\u4e86 virt-v2v \uff09\u901a\u4fe1\u3002 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 virt-p2v \u2502 \u2502 virt-v2v \u2502 \u2502 ( physical \u2502 ssh connection \u2502 ( conversion \u2502 \u2502 server ) \u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u25b6 server ) \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 virt-v2v \u6267\u884c\u771f\u6b63\u7684\u8f6c\u6362\u3002 SSH\u8fde\u63a5\u603b\u662f\u4ece\u7269\u7406\u673a\u53d1\u8d77\u3002 virt-p2v \u9700\u8981SSH\u7684\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u529f\u80fd ssh -R \uff0c\u5fc5\u987b\u5728\u8f6c\u6362\u670d\u52a1\u5668\u5f00\u542f\u6b64\u529f\u80fd\u3002 SSH\u7684scp\u529f\u80fd\u4e5f\u5fc5\u987b\u5f00\u542f\u3002 \u8f6c\u6362\u7684\u901f\u5ea6\u5f88\u5927\u7a0b\u5ea6\u4e0a\u53d6\u51b3\u4e8e\u4e24\u8005\u7684\u7f51\u7edc\u60c5\u51b5\u3002 2.GUI\u4ea4\u4e92\u5f0f\u914d\u7f6e \u00b6 \u542f\u52a8\u6620\u50cf\u65f6\uff0c\u4f1a\u6709\u4e00\u4e9b\u914d\u7f6e\u3002 2.1 \u7528\u6237\u540d\u5bc6\u7801\u6216SSH\u914d\u7f6e \u00b6 \u5fc5\u987b\u8981\u914d\u7f6e\u7f51\u7edc\u3002 2.2 \u78c1\u76d8\u548c\u865a\u62df\u673a\u7f51\u7edc\u914d\u7f6e \u00b6 \u914d\u7f6e\u865a\u62df\u673a\u7684\u53c2\u6570\uff0cvirt-v2v\u7684\u9009\u9879\uff0c\u8981\u8f6c\u6362\u7684\u786c\u76d8\uff0c\u53ef\u79fb\u52a8\u5a92\u4f53\uff08CD...\uff09\uff0c\u8981\u5728\u865a\u62df\u673a\u4e0a\u521b\u5efa\u7684\u7f51\u7edc\u63a5\u53e3 2.3 \u8f6c\u6362\u8fd0\u884c\u754c\u9762 \u00b6 \u8f6c\u6362\u5b8c\u6210\u4e4b\u540e\uff0c\u62d4\u6389U\u76d8\uff0c\u5173\u95ed\u7269\u7406\u673a\u3002 3. \u5185\u6838\u547d\u4ee4\u884c\u914d\u7f6e \u00b6 \u5982\u679c\u4f60\u4e0d\u60f3\u901a\u8fc7\u56fe\u5f62\u754c\u9762\u914d\u7f6e\uff0c\u53ef\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002 \u5728\u54ea\u91cc\u8bbe\u7f6e\u547d\u4ee4\u884c\u53c2\u6570\u53d6\u51b3\u4e8ePXE\u5b9e\u73b0\uff0c\u4f46\u662f\u5bf9\u4e8epxelinux\u53ef\u4ee5\u5728 pxelinux.cfg \u6587\u4ef6\u4e2d\u6269\u5c55 APPEND \u5b57\u6bb5\u3002\u6bd4\u5982\uff1a DEFAULT p2v TIMEOUT 20 PROMPT 0 LABEL p2v KERNEL vmlinuz0 APPEND initrd = initrd0.img [ .... ] p2v.server = conv.example.com p2v.password = secret p2v.o = libvirt \u4e0b\u9762\u662f\u6240\u6709\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff1a KERNEL COMMAND LINE CONFIGURATION 4.SSH\u8ba4\u8bc1 \u00b6 \u6bd4\u5bc6\u7801\u65b9\u5f0f\u66f4\u5b89\u5168\u7684\u662fSSH\u8ba4\u8bc1\u3002 \u521b\u5efa\u65e0\u5bc6\u7801\u7684ssh\u5bc6\u94a5\u5bf9\uff0c\u5c06\u516c\u94a5\u653e\u5728\u8f6c\u6362\u670d\u52a1\u5668\u7684 authorized_keys \u4e2d\u3002 5.\u5de5\u4f5c\u65b9\u5f0f \u00b6 \u9996\u5148\u5efa\u7acb\u4e00\u4e2a\u6216\u591a\u4e2aSSH\u8fde\u63a5\u6765\u67e5\u8be2\u8fdc\u7a0b virt-v2v \u7684\u7248\u672c\u53ca\u5176\u529f\u80fd\u3002\u6d4b\u8bd5\u8fde\u63a5\u5728\u8f6c\u6362\u5f00\u59cb\u524d\u4f1a\u88ab\u5173\u95ed\u3002 virt-p2v \u51c6\u5907\u597d\u8f6c\u6362\u65f6\uff0c\u4f1a\u6253\u5f00\u4e00\u4e2aSSH\u63a7\u5236\u8fde\u63a5\uff0c\u9996\u5148\u53d1\u9001\u4e00\u4e2a\u521b\u5efa\u6587\u4ef6\u5939\u7684\u547d\u4ee4\u5728\u8f6c\u6362\u670d\u52a1\u5668\u4e0a\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\u5939\u3002\u683c\u5f0f\uff1a /tmp/virt-p2v-YYYYMMDD-XXXXXXXX \u3002 \u5176\u4e0b\u6709\u5982\u4e0b\u5185\u5bb9\uff1a dmesg lscpu lspci lsscsi lsusb \u200b (before conversion) \u200b \u7269\u7406\u673a\u4e0a\u7684\u5bf9\u5e94\u6307\u4ee4\u8f93\u51fa\uff08\u5373 dmesg(1) \uff0c lscpu(1) \uff09\u3002 \u200b dmesg \u8f93\u51fa\u7528\u4e8e\u68c0\u67e5\u9519\u8bef\u3002\u5176\u5b83\u7684\u8f93\u51fa\u7528\u4e8e\u8c03\u8bd5\u65b0\u786c\u4ef6\u914d\u7f6e\u3002 environment \u200b (before conversion) \u200b virt-v2v \u7684\u8fd0\u884c\u73af\u5883 name \u200b (before conversion) \u200b \u7269\u7406\u673a\u7684\u4e3b\u673a\u540d physical.xml \u200b (before conversion) \u200b \u63cf\u8ff0\u7269\u7406\u673a\u7684libvirt XML\u3002\u901a\u8fc7 -i libvirtxml \u9009\u9879\u4f20\u9012\u7269\u7406\u673a\u6570\u636e\u7ed9 virt-v2v \u3002 \u200b \u6ce8\u610f \uff1a\u8fd9\u4e0d\u662f\u771f\u6b63\u7684libvirt XML\u3002 p2v-version v2v-version \u200b (before conversion) \u200b virt-v2v \u548c virt-p2v \u7684\u7248\u672c status \u200b (after conversion) \u200b \u6700\u7ec8\u7684\u8f6c\u6362\u540e\u7684\u72b6\u6001\u30020\u4ee3\u8868\u6210\u529f time \u200b (before conversion) \u200b \u8f6c\u6362\u7684\u5f00\u59cb\u65f6\u95f4 virt-v2v-conversion-log.txt \u200b (during/after conversion) \u200b \u8f6c\u6362\u65e5\u5fd7\u3002\u53ea\u6709 virt-v2v \u547d\u4ee4\u7684\u8f93\u51fa\u3002 virt-v2v-wrapper.sh \u200b (before conversion) \u200b \u8fd0\u884c virt-v2v \u65f6\u6267\u884c\u7684\u5c01\u88c5\u811a\u672c\u3002 \u5728\u771f\u6b63\u7684\u8f6c\u6362\u5f00\u59cb\u4e4b\u524d\uff0c virt-p2v \u5efa\u7acb\u4e00\u4e2a\u6216\u591a\u4e2a\u8fde\u63a5\u7528\u4e8e\u6570\u636e\u4f20\u8f93\u3002 \u5f53\u524d\u7684\u4f20\u8f93\u534f\u8bae\u662fssh\u4ee3\u7406\u7684 NBD \uff08Network Block Device\uff09\u3002\u9ed8\u8ba4\u662f qemu-nbd \uff08QEMU Disk Network Block Device Server\uff09\u3002 \u666e\u901a\u60c5\u51b5\u4e0b\u6bcf\u4e2a\u7269\u7406\u786c\u76d8\u90fd\u6709\u4e00\u4e2assh\u8fde\u63a5\uff1a \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 virt-p2v \u2502 \u2502 virt-v2v \u2502 \u2502 ( physical \u2502 control connection \u2502 ( conversion \u2502 \u2502 server ) \u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u25b6 server ) \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 data connection \u2502 \u2502 \u2502 \u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u25b6 \u2502 \u2502qemu-nbd \u2190 \u2500\u2518 \u2502 \u2502\u2514\u2500 \u2190 NBD \u2502 \u2502/dev/sda \u2502 \u2502 requests \u2502 \u223c \u223c \u223c \u223c \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u56e0\u4e3a\u4f7f\u7528\u4e86ssh\u7684\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u529f\u80fd\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0aNBD\u8bf7\u6c42\u53ef\u4ee5\u4ece\u8f6c\u6362\u670d\u52a1\u5668\u53d1\u9001\u5230\u7269\u7406\u673a\u3002\u8fd9\u6837 virt-2v \u53ef\u4ee5\u901a\u8fc7libguestfs\u53ef\u4ee5\u6253\u5f00\u76f4\u63a5\u8bfb\u53d6\u7269\u7406\u786c\u76d8\u7684nbd\u8fde\u63a5\u3002 \u957f\u957f\u7684virt-v2v\u547d\u4ee4\u88ab\u5305\u88c5\u5728\u811a\u672c\u4e2d\u7136\u540e\u4e0a\u4f20\u5230\u8f6c\u6362\u670d\u52a1\u5668\u3002\u6700\u540e\u4e00\u6b65\u5c31\u662f\u8fd0\u884c\u8fd9\u4e2a\u811a\u672c\uff0c\u7136\u540e\u8fd0\u884c virt-v2v \u547d\u4ee4\u3002virt-v2v\u547d\u4ee4\u5f15\u7528 physical.xml \u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u53c8\u5f15\u7528 data connection \u7684NBD\u76d1\u542c\u7aef\u53e3\u3002 virt-v2v -v -x --colours -i libvirtxml -o \"libvirt\" -oa sparse -os \"/var/tmp\" --root first physical.xml </dev/null 6.\u4f7f\u7528 \u00b6 \u9996\u5148\u5b89\u88c5 virt-p2v-maker \u3002 \u5229\u7528 virt-p2v-make-disk \u5236\u4f5c\u4e00\u4e2a\u8fd0\u884c virt-p2v \u7684\u542f\u52a8\u76d8\uff08\u8981\u914d\u7f6e\u597d\u7f51\u7edc\u548cDNS\uff09\uff1a # USB\u542f\u52a8\u76d8 # \u5b89\u88c5 libguestfs-xfs RPM\u5305\uff0c\u5220\u9664\u6389USB\u7684\u6240\u6709\u5206\u533a\uff0c\u4f7f\u7528 partprobe \u66f4\u65b0\u5206\u533a\u8868 virt-p2v-make-disk -o /dev/sdX # \u865a\u62df\u542f\u52a8\u78c1\u76d8 virt-p2v-make-disk -v -o /var/tmp/p2v.img centos-7.5 2 > & 1 | tee virt-p2v.log \u56e0\u4e3a\u4f7f\u7528VMware\u865a\u62df\u673a\u6a21\u62df\u7269\u7406\u673a\uff0c\u6240\u4ee5\u9700\u8981\u518d\u5c06\u5176\u8f6c\u6362\u4e3a vmdk \u683c\u5f0f\uff1a qemu-img convert -f raw p2v.img -O vmdk p2v.vmdk \u7136\u540e\u5c06\u8fd9\u4e2a\u78c1\u76d8\u6dfb\u52a0\u5230\u865a\u62df\u673a\u4e0a\u9762\uff0c\u8bbe\u7f6e\u5f00\u673a\u542f\u52a8\u8fdb\u5165\u56fa\u4ef6\uff0c\u8c03\u6574\u786c\u76d8\u7684\u542f\u52a8\u987a\u5e8f\uff0c\u5f00\u673a\u65f6\u9009\u62e9\u542f\u52a8\u76d8\u7684linux\u5185\u6838\uff0c\u6b64\u65f6\u5373\u8fdb\u5165\u4e86 virt-p2v \u7684\u542f\u52a8\u76d8\u3002\u7136\u540e\u6309\u7167\u63d0\u793a\u8fdb\u884c\u914d\u7f6e\u5373\u53ef\u5f00\u59cb\u8f6c\u6362\u3002 \u6ce8\u610f \uff1a\u9009\u62e9libvirt\u4f5c\u4e3a\u8f93\u51fa\u683c\u5f0f\u7684\u65f6\u5019\uff0c os \u9009\u9879\u586b\u5199 pool \u7684\u540d\u5b57\uff0c\u53ef\u901a\u8fc7 virsh pool-list \u67e5\u770b\u6709\u54ea\u4e9bpool\u3002","title":"virt-p2v\u4ecb\u7ecd"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E4%BB%8B%E7%BB%8D/#1","text":"virt-p2v \u5728\u7269\u7406\u673a\u4e0a\u9762\u8fd0\u884c\u3002\u5b83\u901a\u8fc7 SSH \u4e0e\u8f6c\u6362\u670d\u52a1\u5668\uff08\u5b89\u88c5\u4e86 virt-v2v \uff09\u901a\u4fe1\u3002 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 virt-p2v \u2502 \u2502 virt-v2v \u2502 \u2502 ( physical \u2502 ssh connection \u2502 ( conversion \u2502 \u2502 server ) \u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u25b6 server ) \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 virt-v2v \u6267\u884c\u771f\u6b63\u7684\u8f6c\u6362\u3002 SSH\u8fde\u63a5\u603b\u662f\u4ece\u7269\u7406\u673a\u53d1\u8d77\u3002 virt-p2v \u9700\u8981SSH\u7684\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u529f\u80fd ssh -R \uff0c\u5fc5\u987b\u5728\u8f6c\u6362\u670d\u52a1\u5668\u5f00\u542f\u6b64\u529f\u80fd\u3002 SSH\u7684scp\u529f\u80fd\u4e5f\u5fc5\u987b\u5f00\u542f\u3002 \u8f6c\u6362\u7684\u901f\u5ea6\u5f88\u5927\u7a0b\u5ea6\u4e0a\u53d6\u51b3\u4e8e\u4e24\u8005\u7684\u7f51\u7edc\u60c5\u51b5\u3002","title":"1.\u7f51\u7edc\u8bbe\u7f6e"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E4%BB%8B%E7%BB%8D/#2gui","text":"\u542f\u52a8\u6620\u50cf\u65f6\uff0c\u4f1a\u6709\u4e00\u4e9b\u914d\u7f6e\u3002","title":"2.GUI\u4ea4\u4e92\u5f0f\u914d\u7f6e"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E4%BB%8B%E7%BB%8D/#21-ssh","text":"\u5fc5\u987b\u8981\u914d\u7f6e\u7f51\u7edc\u3002","title":"2.1 \u7528\u6237\u540d\u5bc6\u7801\u6216SSH\u914d\u7f6e"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E4%BB%8B%E7%BB%8D/#22","text":"\u914d\u7f6e\u865a\u62df\u673a\u7684\u53c2\u6570\uff0cvirt-v2v\u7684\u9009\u9879\uff0c\u8981\u8f6c\u6362\u7684\u786c\u76d8\uff0c\u53ef\u79fb\u52a8\u5a92\u4f53\uff08CD...\uff09\uff0c\u8981\u5728\u865a\u62df\u673a\u4e0a\u521b\u5efa\u7684\u7f51\u7edc\u63a5\u53e3","title":"2.2 \u78c1\u76d8\u548c\u865a\u62df\u673a\u7f51\u7edc\u914d\u7f6e"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E4%BB%8B%E7%BB%8D/#23","text":"\u8f6c\u6362\u5b8c\u6210\u4e4b\u540e\uff0c\u62d4\u6389U\u76d8\uff0c\u5173\u95ed\u7269\u7406\u673a\u3002","title":"2.3 \u8f6c\u6362\u8fd0\u884c\u754c\u9762"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E4%BB%8B%E7%BB%8D/#3","text":"\u5982\u679c\u4f60\u4e0d\u60f3\u901a\u8fc7\u56fe\u5f62\u754c\u9762\u914d\u7f6e\uff0c\u53ef\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002 \u5728\u54ea\u91cc\u8bbe\u7f6e\u547d\u4ee4\u884c\u53c2\u6570\u53d6\u51b3\u4e8ePXE\u5b9e\u73b0\uff0c\u4f46\u662f\u5bf9\u4e8epxelinux\u53ef\u4ee5\u5728 pxelinux.cfg \u6587\u4ef6\u4e2d\u6269\u5c55 APPEND \u5b57\u6bb5\u3002\u6bd4\u5982\uff1a DEFAULT p2v TIMEOUT 20 PROMPT 0 LABEL p2v KERNEL vmlinuz0 APPEND initrd = initrd0.img [ .... ] p2v.server = conv.example.com p2v.password = secret p2v.o = libvirt \u4e0b\u9762\u662f\u6240\u6709\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff1a KERNEL COMMAND LINE CONFIGURATION","title":"3. \u5185\u6838\u547d\u4ee4\u884c\u914d\u7f6e"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E4%BB%8B%E7%BB%8D/#4ssh","text":"\u6bd4\u5bc6\u7801\u65b9\u5f0f\u66f4\u5b89\u5168\u7684\u662fSSH\u8ba4\u8bc1\u3002 \u521b\u5efa\u65e0\u5bc6\u7801\u7684ssh\u5bc6\u94a5\u5bf9\uff0c\u5c06\u516c\u94a5\u653e\u5728\u8f6c\u6362\u670d\u52a1\u5668\u7684 authorized_keys \u4e2d\u3002","title":"4.SSH\u8ba4\u8bc1"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E4%BB%8B%E7%BB%8D/#5","text":"\u9996\u5148\u5efa\u7acb\u4e00\u4e2a\u6216\u591a\u4e2aSSH\u8fde\u63a5\u6765\u67e5\u8be2\u8fdc\u7a0b virt-v2v \u7684\u7248\u672c\u53ca\u5176\u529f\u80fd\u3002\u6d4b\u8bd5\u8fde\u63a5\u5728\u8f6c\u6362\u5f00\u59cb\u524d\u4f1a\u88ab\u5173\u95ed\u3002 virt-p2v \u51c6\u5907\u597d\u8f6c\u6362\u65f6\uff0c\u4f1a\u6253\u5f00\u4e00\u4e2aSSH\u63a7\u5236\u8fde\u63a5\uff0c\u9996\u5148\u53d1\u9001\u4e00\u4e2a\u521b\u5efa\u6587\u4ef6\u5939\u7684\u547d\u4ee4\u5728\u8f6c\u6362\u670d\u52a1\u5668\u4e0a\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\u5939\u3002\u683c\u5f0f\uff1a /tmp/virt-p2v-YYYYMMDD-XXXXXXXX \u3002 \u5176\u4e0b\u6709\u5982\u4e0b\u5185\u5bb9\uff1a dmesg lscpu lspci lsscsi lsusb \u200b (before conversion) \u200b \u7269\u7406\u673a\u4e0a\u7684\u5bf9\u5e94\u6307\u4ee4\u8f93\u51fa\uff08\u5373 dmesg(1) \uff0c lscpu(1) \uff09\u3002 \u200b dmesg \u8f93\u51fa\u7528\u4e8e\u68c0\u67e5\u9519\u8bef\u3002\u5176\u5b83\u7684\u8f93\u51fa\u7528\u4e8e\u8c03\u8bd5\u65b0\u786c\u4ef6\u914d\u7f6e\u3002 environment \u200b (before conversion) \u200b virt-v2v \u7684\u8fd0\u884c\u73af\u5883 name \u200b (before conversion) \u200b \u7269\u7406\u673a\u7684\u4e3b\u673a\u540d physical.xml \u200b (before conversion) \u200b \u63cf\u8ff0\u7269\u7406\u673a\u7684libvirt XML\u3002\u901a\u8fc7 -i libvirtxml \u9009\u9879\u4f20\u9012\u7269\u7406\u673a\u6570\u636e\u7ed9 virt-v2v \u3002 \u200b \u6ce8\u610f \uff1a\u8fd9\u4e0d\u662f\u771f\u6b63\u7684libvirt XML\u3002 p2v-version v2v-version \u200b (before conversion) \u200b virt-v2v \u548c virt-p2v \u7684\u7248\u672c status \u200b (after conversion) \u200b \u6700\u7ec8\u7684\u8f6c\u6362\u540e\u7684\u72b6\u6001\u30020\u4ee3\u8868\u6210\u529f time \u200b (before conversion) \u200b \u8f6c\u6362\u7684\u5f00\u59cb\u65f6\u95f4 virt-v2v-conversion-log.txt \u200b (during/after conversion) \u200b \u8f6c\u6362\u65e5\u5fd7\u3002\u53ea\u6709 virt-v2v \u547d\u4ee4\u7684\u8f93\u51fa\u3002 virt-v2v-wrapper.sh \u200b (before conversion) \u200b \u8fd0\u884c virt-v2v \u65f6\u6267\u884c\u7684\u5c01\u88c5\u811a\u672c\u3002 \u5728\u771f\u6b63\u7684\u8f6c\u6362\u5f00\u59cb\u4e4b\u524d\uff0c virt-p2v \u5efa\u7acb\u4e00\u4e2a\u6216\u591a\u4e2a\u8fde\u63a5\u7528\u4e8e\u6570\u636e\u4f20\u8f93\u3002 \u5f53\u524d\u7684\u4f20\u8f93\u534f\u8bae\u662fssh\u4ee3\u7406\u7684 NBD \uff08Network Block Device\uff09\u3002\u9ed8\u8ba4\u662f qemu-nbd \uff08QEMU Disk Network Block Device Server\uff09\u3002 \u666e\u901a\u60c5\u51b5\u4e0b\u6bcf\u4e2a\u7269\u7406\u786c\u76d8\u90fd\u6709\u4e00\u4e2assh\u8fde\u63a5\uff1a \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 virt-p2v \u2502 \u2502 virt-v2v \u2502 \u2502 ( physical \u2502 control connection \u2502 ( conversion \u2502 \u2502 server ) \u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u25b6 server ) \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 data connection \u2502 \u2502 \u2502 \u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u25b6 \u2502 \u2502qemu-nbd \u2190 \u2500\u2518 \u2502 \u2502\u2514\u2500 \u2190 NBD \u2502 \u2502/dev/sda \u2502 \u2502 requests \u2502 \u223c \u223c \u223c \u223c \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u56e0\u4e3a\u4f7f\u7528\u4e86ssh\u7684\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u529f\u80fd\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0aNBD\u8bf7\u6c42\u53ef\u4ee5\u4ece\u8f6c\u6362\u670d\u52a1\u5668\u53d1\u9001\u5230\u7269\u7406\u673a\u3002\u8fd9\u6837 virt-2v \u53ef\u4ee5\u901a\u8fc7libguestfs\u53ef\u4ee5\u6253\u5f00\u76f4\u63a5\u8bfb\u53d6\u7269\u7406\u786c\u76d8\u7684nbd\u8fde\u63a5\u3002 \u957f\u957f\u7684virt-v2v\u547d\u4ee4\u88ab\u5305\u88c5\u5728\u811a\u672c\u4e2d\u7136\u540e\u4e0a\u4f20\u5230\u8f6c\u6362\u670d\u52a1\u5668\u3002\u6700\u540e\u4e00\u6b65\u5c31\u662f\u8fd0\u884c\u8fd9\u4e2a\u811a\u672c\uff0c\u7136\u540e\u8fd0\u884c virt-v2v \u547d\u4ee4\u3002virt-v2v\u547d\u4ee4\u5f15\u7528 physical.xml \u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u53c8\u5f15\u7528 data connection \u7684NBD\u76d1\u542c\u7aef\u53e3\u3002 virt-v2v -v -x --colours -i libvirtxml -o \"libvirt\" -oa sparse -os \"/var/tmp\" --root first physical.xml </dev/null","title":"5.\u5de5\u4f5c\u65b9\u5f0f"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E4%BB%8B%E7%BB%8D/#6","text":"\u9996\u5148\u5b89\u88c5 virt-p2v-maker \u3002 \u5229\u7528 virt-p2v-make-disk \u5236\u4f5c\u4e00\u4e2a\u8fd0\u884c virt-p2v \u7684\u542f\u52a8\u76d8\uff08\u8981\u914d\u7f6e\u597d\u7f51\u7edc\u548cDNS\uff09\uff1a # USB\u542f\u52a8\u76d8 # \u5b89\u88c5 libguestfs-xfs RPM\u5305\uff0c\u5220\u9664\u6389USB\u7684\u6240\u6709\u5206\u533a\uff0c\u4f7f\u7528 partprobe \u66f4\u65b0\u5206\u533a\u8868 virt-p2v-make-disk -o /dev/sdX # \u865a\u62df\u542f\u52a8\u78c1\u76d8 virt-p2v-make-disk -v -o /var/tmp/p2v.img centos-7.5 2 > & 1 | tee virt-p2v.log \u56e0\u4e3a\u4f7f\u7528VMware\u865a\u62df\u673a\u6a21\u62df\u7269\u7406\u673a\uff0c\u6240\u4ee5\u9700\u8981\u518d\u5c06\u5176\u8f6c\u6362\u4e3a vmdk \u683c\u5f0f\uff1a qemu-img convert -f raw p2v.img -O vmdk p2v.vmdk \u7136\u540e\u5c06\u8fd9\u4e2a\u78c1\u76d8\u6dfb\u52a0\u5230\u865a\u62df\u673a\u4e0a\u9762\uff0c\u8bbe\u7f6e\u5f00\u673a\u542f\u52a8\u8fdb\u5165\u56fa\u4ef6\uff0c\u8c03\u6574\u786c\u76d8\u7684\u542f\u52a8\u987a\u5e8f\uff0c\u5f00\u673a\u65f6\u9009\u62e9\u542f\u52a8\u76d8\u7684linux\u5185\u6838\uff0c\u6b64\u65f6\u5373\u8fdb\u5165\u4e86 virt-p2v \u7684\u542f\u52a8\u76d8\u3002\u7136\u540e\u6309\u7167\u63d0\u793a\u8fdb\u884c\u914d\u7f6e\u5373\u53ef\u5f00\u59cb\u8f6c\u6362\u3002 \u6ce8\u610f \uff1a\u9009\u62e9libvirt\u4f5c\u4e3a\u8f93\u51fa\u683c\u5f0f\u7684\u65f6\u5019\uff0c os \u9009\u9879\u586b\u5199 pool \u7684\u540d\u5b57\uff0c\u53ef\u901a\u8fc7 virsh pool-list \u67e5\u770b\u6709\u54ea\u4e9bpool\u3002","title":"6.\u4f7f\u7528"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/virt-p2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/","text":"\u5176\u5b9e virt-p2v \u8c03\u7528\u4e86 virt-v2v \u6765\u8fdb\u884c\u78c1\u76d8\u8f6c\u6362\uff0c\u53ea\u662f\u5728\u83b7\u53d6\u78c1\u76d8\u7684\u65f6\u5019\u6709\u533a\u522b\u3002 \u7a0b\u5e8f virt-v2v virt-v2v \u78c1\u76d8\u7c7b\u578b \u672c\u5730\u865a\u62df\u78c1\u76d8 \u8fdc\u7a0b\u7269\u7406\u78c1\u76d8 \u78c1\u76d8\u8bfb\u53d6\u65b9\u5f0f \u76f4\u63a5\u8bfb\u53d6 \u901a\u8fc7NBD\u534f\u8bae\u8bfb\u53d6 virt-p2v \u7684\u5de5\u4f5c\u65b9\u5f0f\u53c2\u8003\uff1a virt-p2v\u4ecb\u7ecd virt-v2v \u78c1\u76d8\u8f6c\u6362\u6d41\u7a0b\u53c2\u8003\uff1a \u4ee5ova\u4e3a\u4f8bvirt-v2v\u78c1\u76d8\u8f6c\u6362\u6d41\u7a0b","title":"virt-p2v\u78c1\u76d8\u8f6c\u6362\u6d41\u7a0b"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/","text":"1.\u89e3\u6790\u547d\u4ee4\u884c\uff0c\u521d\u59cb\u5316\u8f93\u5165\u8f93\u51fa\u6a21\u5757 \u00b6 let cmdline , input , output = parse_cmdline () in 2.\u83b7\u53d6\u4fe1\u606f \u00b6 let source = open_source cmdline input in 2.1\u5904\u7406\u8f93\u5165 \u00b6 let source = input # source () in \u65e5\u5fd7\uff1a tar -xf 'centos2.ova' -C '/var/tmp/ova.x0YFry' \u4fe1\u606f\u65e5\u5fd7\uff1a source name: centos2 hypervisor type: vmware memory: 1073741824 ( bytes ) nr vCPUs: 1 CPU vendor: CPU model: CPU topology: CPU features: firmware: bios display: video: sound: disks: /var/tmp/ova.x0YFry/centos2-disk1.vmdk ( vmdk ) [ scsi ] removable media: CD-ROM [ ide ] in slot 0 NICs: Bridge \"nat\" [ e1000 ] 3.\u521b\u5efaoverlay\u78c1\u76d8\uff08copy\u6a21\u5f0f\u72ec\u6709\uff09 \u00b6 let overlays = create_overlays source . s_disks in \u65e5\u5fd7\uff1a qemu-img 'create' '-q' '-f' 'qcow2' '-b' '/var/tmp/ova.x0YFry/centos2-disk1.vmdk' '-o' 'compat=1.1,backing_fmt=vmdk' '/var/tmp/v2vovl36099b.qcow2' 4.\u521d\u59cb\u5316target\u7ed3\u6784\u4f53\uff08copy\u6a21\u5f0f\u72ec\u6709\uff09 \u00b6 let targets = init_targets cmdline output source overlays in 5.\u521b\u5efa\u5904\u7406\u5668 \u00b6 let g = open_guestfs ~ identifier : \"v2v\" () in 6.\u542f\u52a8appliance\u3001\u5b88\u62a4\u8fdb\u7a0bguestfsd \u00b6 g # launch () ; supermin5\u521b\u5efaappliance\uff0c\u6d4b\u8bd5qemu\uff0c\u4f7f\u7528qemu-kvm\u5f00\u542fappliance supermin5\u8f7d\u5165\u6a21\u5757\uff1b\u521b\u5efa\u8bbe\u5907\u76ee\u5f55\uff08/dev/**\uff09\u5e76\u6302\u8f7d\uff1b\u8bbe\u7f6e\u7f51\u7edc\uff1b\u5206\u914d\u903b\u8f91\u5377\u7ec4 libguestfs\u63a5\u6536\u5230GUESTFS_LAUNCH_FLAG\u4fe1\u53f7\uff0cappliance\u542f\u52a8\u6210\u529f 7.\u68c0\u6d4b\u6e90\u78c1\u76d8\uff0c\u83b7\u53d6\u4fe1\u606f \u00b6 let inspect = Inspect_source . inspect_source cmdline . root_choice g in \u65e5\u5fd7\uff1a i_root = /dev/cl/root i_type = linux i_distro = centos i_arch = x86_64 i_major_version = 7 i_minor_version = 5 i_package_format = rpm i_package_management = yum i_product_name = CentOS Linux release 7 .5.1804 ( Core ) i_product_variant = unknown i_firmware = BIOS i_windows_systemroot = i_windows_software_hive = i_windows_system_hive = i_windows_current_control_set = 8.\u4f30\u7b97\u6bcf\u4e2a target disk \u7684\u7a7a\u95f4\u8981\u6c42 \u00b6 let mpstats = get_mpstats g in check_guest_free_space mpstats ; check_target_free_space mpstats source targets output \u65e5\u5fd7\uff1a [ 133 .5 ] Checking for sufficient free disk space in the guest [ 133 .5 ] Estimating space required on target for each disk mpstats: mountpoint statvfs /dev/sda1 /boot ( xfs ) : bsize = 4096 blocks = 259584 bfree = 224126 bavail = 224126 mountpoint statvfs /dev/cl/root / ( xfs ) : bsize = 4096 blocks = 4452864 bfree = 4185952 bavail = 4185952 estimate_target_size: fs_total_size = 19302187008 [ 18 .0G ] estimate_target_size: source_total_size = 21474836480 [ 20 .0G ] estimate_target_size: ratio = 0 .899 estimate_target_size: fs_free = 18063679488 [ 16 .8G ] estimate_target_size: scaled_saving = 16236143164 [ 15 .1G ] estimate_target_size: sda: 5238693316 [ 4 .9G ] 9.\u8fdb\u884c\u78c1\u76d8\u8f6c\u6362 \u00b6 let guestcaps = do_convert g inspect source output rcaps in \u7ed3\u679c\u65e5\u5fd7\uff1a guestcaps: rm_f = 0 gcaps_block_bus = virtio-blk gcaps_net_bus = virtio-net gcaps_video = qxl gcaps_arch = x86_64 gcaps_acpi = true virt-v2v: This guest has virtio drivers installed. detect_kernels\u65e5\u5fd7 kernels offered by the bootloader in this guest ( first in list is default ) : * kernel 3 .10.0-514.el7.x86_64 ( x86_64 ) /boot/vmlinuz-3.10.0-514.el7.x86_64 -- kernel_info.ki_vmlinuz /boot/initramfs-3.10.0-514.el7.x86_64.img -- kernel_info.ki_initrd /boot/config-3.10.0-514.el7.x86_64 -- kernel_info.ki_config_file /lib/modules/3.10.0-514.el7.x86_64 -- kernel_info.ki_modpath 2347 modules found virtio: blk = true net = true rng = true balloon = true -- ki.ki_supports_virtio_blk ki.ki_supports_virtio_net pvpanic = true xen = false debug = false -- ki.ki_is_xen_pv_only_kernel ki.ki_is_debug remap_block_devices\u65e5\u5fd7 block device map: sda -> vda xvda -> vda ... libguestfs: trace: v2v: aug_get \"/files/boot/grub2/device.map/hd0\" libguestfs: trace: v2v: aug_get = \"/dev/sda\" libguestfs: trace: v2v: aug_set \"/files/boot/grub2/device.map/hd0\" \"/dev/vda\" 10.\u51cf\u5c11\u8f6c\u6362\u91cf \u00b6 g # umount_all () ; do_fstrim g inspect ; \u65e5\u5fd7\uff1a libguestfs: trace: v2v: fstrim \"/\" guestfsd: < = fstrim ( 0x14e ) request length 72 bytes commandrvf: fstrim -v /sysroot/ /sysroot/: 16 GiB ( 17179185152 bytes ) trimmed guestfsd: = > fstrim ( 0x14e ) took 0 .15 secs libguestfs: trace: v2v: fstrim = 0 11.\u5173\u95ed\u5b88\u62a4\u8fdb\u7a0b \u00b6 g # umount_all () ; g # shutdown () ; g # close () ; \u65e5\u5fd7\uff1a umount-all: /proc/mounts: fsname = rootfs dir = / type = rootfs opts = rw freq = 0 passno = 0 umount-all: /proc/mounts: fsname = proc dir = /proc type = proc opts = rw,relatime freq = 0 passno = 0 umount-all: /proc/mounts: fsname = /dev/root dir = / type = ext2 opts = rw,noatime freq = 0 passno = 0 umount-all: /proc/mounts: fsname = /proc dir = /proc type = proc opts = rw,relatime freq = 0 passno = 0 umount-all: /proc/mounts: fsname = /sys dir = /sys type = sysfs opts = rw,relatime freq = 0 passno = 0 ... libguestfs: sending SIGTERM to process 6353 libguestfs: qemu maxrss 604960K libguestfs: trace: v2v: shutdown = 0 libguestfs: trace: v2v: close libguestfs: closing guestfs handle 0x2488810 ( state 0 ) libguestfs: command: run: rm libguestfs: command: run: \\ -rf /tmp/libguestfsCZ1315 libguestfs: command: run: rm libguestfs: command: run: \\ -rf /tmp/libguestfs5EMQ5o ----------------------------------\u4ee5\u4e0b\u662fcopy\u6a21\u5f0f\u72ec\u6709\u7684\u6b65\u9aa4------------------------- 12.\u5206\u914d\u78c1\u76d8\u5230\u603b\u7ebf \u00b6 let target_buses = Target_bus_assignment.target_bus_assignment source targets guestcaps in \u65e5\u5fd7\uff1a [ 188 .3 ] Assigning disks to buses virtio-blk slot 0 : target_file = [ file ] /var/tmp/qemu-vm/centos2-sda target_format = qcow2 target_estimated_size = 5238693316 target_overlay = /var/tmp/v2vovl36099b.qcow2 target_overlay.ov_source = /var/tmp/ova.x0YFry/centos2-disk1.vmdk ide slot 0 : CD-ROM [ ide ] in slot 0 13.\u521b\u5efa\u76ee\u7684\u78c1\u76d8 \u00b6 let targets = if not cmdline . do_copy then targets else copy_targets cmdline targets input output in 13.1\u521b\u5efa\u76ee\u7684\u78c1\u76d8 \u00b6 output # disk_create t . target_file t . target_format t . target_overlay . ov_virtual_size ? preallocation ? compat ; \u65e5\u5fd7\uff1a [ 188 .3 ] Copying disk 1 /1 to /var/tmp/qemu-vm/centos2-sda ( qcow2 ) target_file = [ file ] /var/tmp/qemu-vm/centos2-sda target_format = qcow2 target_estimated_size = 5238693316 target_overlay = /var/tmp/v2vovl36099b.qcow2 target_overlay.ov_source = /var/tmp/ova.x0YFry/centos2-disk1.vmdk disk_create \"/var/tmp/qemu-vm/centos2-sda\" \"qcow2\" 21474836480 \"preallocation:sparse\" \"compat:1.1\" 13.2\u8f6c\u6362\u76ee\u7684\u78c1\u76d8 \u00b6 let cmd = [ \"qemu-img\" ; \"convert\" ] @ ( if not ( quiet () ) then [ \"-p\" ] else [] ) @ [ \"-n\" ; \"-f\" ; \"qcow2\" ; \"-O\" ; t . target_format ] @ ( if cmdline . compressed then [ \"-c\" ] else [] ) @ [ overlay_file ; t . target_file ] in run_command cmd \u65e5\u5fd7\uff1a qemu-img 'convert' '-p' '-n' '-f' 'qcow2' '-O' 'qcow2' '/var/tmp/v2vovl36099b.qcow2' '/var/tmp/qemu-vm/centos2-sda' 14.\u751f\u6210 metadata \u6587\u4ef6 \u00b6 output # create_metadata source targets target_buses guestcaps inspect target_firmware ; \u65e5\u5fd7\uff1a Creating output metadata 15.\u4e24\u79cd\u8f6c\u6362\u6a21\u5f0f \u00b6 15.1 copying \u6a21\u5f0f \uff1a \u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c\u78c1\u76d8\u7684\u8f6c\u6362\u6d41\u7a0b\u662f\u8fd9\u6837\u7684\uff1a source -> overlay -> target \u3002 \u83b7\u53d6\u539fVM\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u78c1\u76d8source\u63cf\u8ff0\u3002 \u5728\u6e90\u78c1\u76d8\u7684\u4e0a\u9762\u653e\u53ef\u5199\u7684\u53e0\u52a0\u78c1\u76d8overlay\u3002 \u5728overlay\u4e0a\u9762\u505a\u8f6c\u6362\u3002 \u590d\u5236overlay\u5230\u76ee\u6807\u78c1\u76d8target\u3002 15.2 in place \u6a21\u5f0f \uff1a\u4e0d\u4f1a\u5728\u76ee\u6807Hypervisor\u521b\u5efa\u65b0\u7684\u865a\u62df\u673a\uff0c\u800c\u662f\u8c03\u6574\u539fVM\u7684\u64cd\u4f5c\u7cfb\u7edf\u4ee5\u5728\u8f93\u5165\u7684Hypervisor\u4e0a\u8fd0\u884c\u3002 virt-v2v -ic qemu:///system converted_vm --in-place virt-v2v \u9ed8\u8ba4\u4f7f\u7528 copying \u6a21\u5f0f\uff0c\u5728\u4ee5\u4e0b\u573a\u666f\u4e2d\u53ef\u80fd\u4f1a\u7528\u5230 in place \u6a21\u5f0f\uff1a \u200b \u4e00\u4e2a\u5916\u6765VM\u5df2\u7ecf\u88ab\u5bfc\u5165\u5230\u57fa\u4e8eKVM\u7684Hypervisor\u4e0a\uff0c\u4f46\u662f\u4ecd\u7136\u9700\u8981\u5728guest\u4e0a\u9762\u8c03\u6574\u4f7f\u5b83\u8fd0\u884c\u5728\u65b0\u7684\u865a\u62df\u786c\u4ef6\u4e0a\u3002 \u200b \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5047\u8bbe\u7b2c\u4e09\u65b9\u5de5\u5177\u57fa\u4e8e\u539fVM\u914d\u7f6e\u548c\u5185\u5bb9\u5728\u652f\u6301\u7684\u57fa\u4e8eKVM\u7684Hypervisor\u4e2d\u521b\u5efa\u4e86\u76ee\u6807VM\uff0c\u4f46\u662f\u9700\u8981\u4f7f\u7528\u66f4\u9002\u5408KVM\u7684\u865a\u62df\u8bbe\u5907\uff08\u6bd4\u5982virtio\u5b58\u50a8\u7f51\u7edc\u3001\u7f51\u7edc\u7b49\uff09\u3002 15.3 \u4e24\u79cd\u6a21\u5f0f\u7684\u533a\u522b \uff1a \u8f6c\u6362\u6a21\u5f0f copying in place \u662f\u5426\u5728\u6e90\u78c1\u76d8\u4e0a\u505a\u4fee\u6539 \u5426 \u662f \u662f\u5426\u521b\u5efaoverlays\u78c1\u76d8 \u662f \u5426 \u5728\u54ea\u4e2a\u78c1\u76d8\u4e0a\u505a\u8f6c\u6362 overlay\u78c1\u76d8 \u6e90\u78c1\u76d8","title":"\u4ee5ova\u4e3a\u4f8bvirt-v2v\u78c1\u76d8\u8f6c\u6362\u6d41\u7a0b"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#1","text":"let cmdline , input , output = parse_cmdline () in","title":"1.\u89e3\u6790\u547d\u4ee4\u884c\uff0c\u521d\u59cb\u5316\u8f93\u5165\u8f93\u51fa\u6a21\u5757"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#2","text":"let source = open_source cmdline input in","title":"2.\u83b7\u53d6\u4fe1\u606f"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#21","text":"let source = input # source () in \u65e5\u5fd7\uff1a tar -xf 'centos2.ova' -C '/var/tmp/ova.x0YFry' \u4fe1\u606f\u65e5\u5fd7\uff1a source name: centos2 hypervisor type: vmware memory: 1073741824 ( bytes ) nr vCPUs: 1 CPU vendor: CPU model: CPU topology: CPU features: firmware: bios display: video: sound: disks: /var/tmp/ova.x0YFry/centos2-disk1.vmdk ( vmdk ) [ scsi ] removable media: CD-ROM [ ide ] in slot 0 NICs: Bridge \"nat\" [ e1000 ]","title":"2.1\u5904\u7406\u8f93\u5165"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#3overlaycopy","text":"let overlays = create_overlays source . s_disks in \u65e5\u5fd7\uff1a qemu-img 'create' '-q' '-f' 'qcow2' '-b' '/var/tmp/ova.x0YFry/centos2-disk1.vmdk' '-o' 'compat=1.1,backing_fmt=vmdk' '/var/tmp/v2vovl36099b.qcow2'","title":"3.\u521b\u5efaoverlay\u78c1\u76d8\uff08copy\u6a21\u5f0f\u72ec\u6709\uff09"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#4targetcopy","text":"let targets = init_targets cmdline output source overlays in","title":"4.\u521d\u59cb\u5316target\u7ed3\u6784\u4f53\uff08copy\u6a21\u5f0f\u72ec\u6709\uff09"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#5","text":"let g = open_guestfs ~ identifier : \"v2v\" () in","title":"5.\u521b\u5efa\u5904\u7406\u5668"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#6applianceguestfsd","text":"g # launch () ; supermin5\u521b\u5efaappliance\uff0c\u6d4b\u8bd5qemu\uff0c\u4f7f\u7528qemu-kvm\u5f00\u542fappliance supermin5\u8f7d\u5165\u6a21\u5757\uff1b\u521b\u5efa\u8bbe\u5907\u76ee\u5f55\uff08/dev/**\uff09\u5e76\u6302\u8f7d\uff1b\u8bbe\u7f6e\u7f51\u7edc\uff1b\u5206\u914d\u903b\u8f91\u5377\u7ec4 libguestfs\u63a5\u6536\u5230GUESTFS_LAUNCH_FLAG\u4fe1\u53f7\uff0cappliance\u542f\u52a8\u6210\u529f","title":"6.\u542f\u52a8appliance\u3001\u5b88\u62a4\u8fdb\u7a0bguestfsd"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#7","text":"let inspect = Inspect_source . inspect_source cmdline . root_choice g in \u65e5\u5fd7\uff1a i_root = /dev/cl/root i_type = linux i_distro = centos i_arch = x86_64 i_major_version = 7 i_minor_version = 5 i_package_format = rpm i_package_management = yum i_product_name = CentOS Linux release 7 .5.1804 ( Core ) i_product_variant = unknown i_firmware = BIOS i_windows_systemroot = i_windows_software_hive = i_windows_system_hive = i_windows_current_control_set =","title":"7.\u68c0\u6d4b\u6e90\u78c1\u76d8\uff0c\u83b7\u53d6\u4fe1\u606f"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#8-target-disk","text":"let mpstats = get_mpstats g in check_guest_free_space mpstats ; check_target_free_space mpstats source targets output \u65e5\u5fd7\uff1a [ 133 .5 ] Checking for sufficient free disk space in the guest [ 133 .5 ] Estimating space required on target for each disk mpstats: mountpoint statvfs /dev/sda1 /boot ( xfs ) : bsize = 4096 blocks = 259584 bfree = 224126 bavail = 224126 mountpoint statvfs /dev/cl/root / ( xfs ) : bsize = 4096 blocks = 4452864 bfree = 4185952 bavail = 4185952 estimate_target_size: fs_total_size = 19302187008 [ 18 .0G ] estimate_target_size: source_total_size = 21474836480 [ 20 .0G ] estimate_target_size: ratio = 0 .899 estimate_target_size: fs_free = 18063679488 [ 16 .8G ] estimate_target_size: scaled_saving = 16236143164 [ 15 .1G ] estimate_target_size: sda: 5238693316 [ 4 .9G ]","title":"8.\u4f30\u7b97\u6bcf\u4e2a target disk \u7684\u7a7a\u95f4\u8981\u6c42"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#9","text":"let guestcaps = do_convert g inspect source output rcaps in \u7ed3\u679c\u65e5\u5fd7\uff1a guestcaps: rm_f = 0 gcaps_block_bus = virtio-blk gcaps_net_bus = virtio-net gcaps_video = qxl gcaps_arch = x86_64 gcaps_acpi = true virt-v2v: This guest has virtio drivers installed. detect_kernels\u65e5\u5fd7 kernels offered by the bootloader in this guest ( first in list is default ) : * kernel 3 .10.0-514.el7.x86_64 ( x86_64 ) /boot/vmlinuz-3.10.0-514.el7.x86_64 -- kernel_info.ki_vmlinuz /boot/initramfs-3.10.0-514.el7.x86_64.img -- kernel_info.ki_initrd /boot/config-3.10.0-514.el7.x86_64 -- kernel_info.ki_config_file /lib/modules/3.10.0-514.el7.x86_64 -- kernel_info.ki_modpath 2347 modules found virtio: blk = true net = true rng = true balloon = true -- ki.ki_supports_virtio_blk ki.ki_supports_virtio_net pvpanic = true xen = false debug = false -- ki.ki_is_xen_pv_only_kernel ki.ki_is_debug remap_block_devices\u65e5\u5fd7 block device map: sda -> vda xvda -> vda ... libguestfs: trace: v2v: aug_get \"/files/boot/grub2/device.map/hd0\" libguestfs: trace: v2v: aug_get = \"/dev/sda\" libguestfs: trace: v2v: aug_set \"/files/boot/grub2/device.map/hd0\" \"/dev/vda\"","title":"9.\u8fdb\u884c\u78c1\u76d8\u8f6c\u6362"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#10","text":"g # umount_all () ; do_fstrim g inspect ; \u65e5\u5fd7\uff1a libguestfs: trace: v2v: fstrim \"/\" guestfsd: < = fstrim ( 0x14e ) request length 72 bytes commandrvf: fstrim -v /sysroot/ /sysroot/: 16 GiB ( 17179185152 bytes ) trimmed guestfsd: = > fstrim ( 0x14e ) took 0 .15 secs libguestfs: trace: v2v: fstrim = 0","title":"10.\u51cf\u5c11\u8f6c\u6362\u91cf"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#11","text":"g # umount_all () ; g # shutdown () ; g # close () ; \u65e5\u5fd7\uff1a umount-all: /proc/mounts: fsname = rootfs dir = / type = rootfs opts = rw freq = 0 passno = 0 umount-all: /proc/mounts: fsname = proc dir = /proc type = proc opts = rw,relatime freq = 0 passno = 0 umount-all: /proc/mounts: fsname = /dev/root dir = / type = ext2 opts = rw,noatime freq = 0 passno = 0 umount-all: /proc/mounts: fsname = /proc dir = /proc type = proc opts = rw,relatime freq = 0 passno = 0 umount-all: /proc/mounts: fsname = /sys dir = /sys type = sysfs opts = rw,relatime freq = 0 passno = 0 ... libguestfs: sending SIGTERM to process 6353 libguestfs: qemu maxrss 604960K libguestfs: trace: v2v: shutdown = 0 libguestfs: trace: v2v: close libguestfs: closing guestfs handle 0x2488810 ( state 0 ) libguestfs: command: run: rm libguestfs: command: run: \\ -rf /tmp/libguestfsCZ1315 libguestfs: command: run: rm libguestfs: command: run: \\ -rf /tmp/libguestfs5EMQ5o ----------------------------------\u4ee5\u4e0b\u662fcopy\u6a21\u5f0f\u72ec\u6709\u7684\u6b65\u9aa4-------------------------","title":"11.\u5173\u95ed\u5b88\u62a4\u8fdb\u7a0b"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#12","text":"let target_buses = Target_bus_assignment.target_bus_assignment source targets guestcaps in \u65e5\u5fd7\uff1a [ 188 .3 ] Assigning disks to buses virtio-blk slot 0 : target_file = [ file ] /var/tmp/qemu-vm/centos2-sda target_format = qcow2 target_estimated_size = 5238693316 target_overlay = /var/tmp/v2vovl36099b.qcow2 target_overlay.ov_source = /var/tmp/ova.x0YFry/centos2-disk1.vmdk ide slot 0 : CD-ROM [ ide ] in slot 0","title":"12.\u5206\u914d\u78c1\u76d8\u5230\u603b\u7ebf"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#13","text":"let targets = if not cmdline . do_copy then targets else copy_targets cmdline targets input output in","title":"13.\u521b\u5efa\u76ee\u7684\u78c1\u76d8"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#131","text":"output # disk_create t . target_file t . target_format t . target_overlay . ov_virtual_size ? preallocation ? compat ; \u65e5\u5fd7\uff1a [ 188 .3 ] Copying disk 1 /1 to /var/tmp/qemu-vm/centos2-sda ( qcow2 ) target_file = [ file ] /var/tmp/qemu-vm/centos2-sda target_format = qcow2 target_estimated_size = 5238693316 target_overlay = /var/tmp/v2vovl36099b.qcow2 target_overlay.ov_source = /var/tmp/ova.x0YFry/centos2-disk1.vmdk disk_create \"/var/tmp/qemu-vm/centos2-sda\" \"qcow2\" 21474836480 \"preallocation:sparse\" \"compat:1.1\"","title":"13.1\u521b\u5efa\u76ee\u7684\u78c1\u76d8"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#132","text":"let cmd = [ \"qemu-img\" ; \"convert\" ] @ ( if not ( quiet () ) then [ \"-p\" ] else [] ) @ [ \"-n\" ; \"-f\" ; \"qcow2\" ; \"-O\" ; t . target_format ] @ ( if cmdline . compressed then [ \"-c\" ] else [] ) @ [ overlay_file ; t . target_file ] in run_command cmd \u65e5\u5fd7\uff1a qemu-img 'convert' '-p' '-n' '-f' 'qcow2' '-O' 'qcow2' '/var/tmp/v2vovl36099b.qcow2' '/var/tmp/qemu-vm/centos2-sda'","title":"13.2\u8f6c\u6362\u76ee\u7684\u78c1\u76d8"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#14-metadata","text":"output # create_metadata source targets target_buses guestcaps inspect target_firmware ; \u65e5\u5fd7\uff1a Creating output metadata","title":"14.\u751f\u6210 metadata \u6587\u4ef6"},{"location":"%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BD%AC%E6%8D%A2/%E4%BB%A5ova%E4%B8%BA%E4%BE%8Bvirt-v2v%E7%A3%81%E7%9B%98%E8%BD%AC%E6%8D%A2%E6%B5%81%E7%A8%8B/#15","text":"15.1 copying \u6a21\u5f0f \uff1a \u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c\u78c1\u76d8\u7684\u8f6c\u6362\u6d41\u7a0b\u662f\u8fd9\u6837\u7684\uff1a source -> overlay -> target \u3002 \u83b7\u53d6\u539fVM\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u78c1\u76d8source\u63cf\u8ff0\u3002 \u5728\u6e90\u78c1\u76d8\u7684\u4e0a\u9762\u653e\u53ef\u5199\u7684\u53e0\u52a0\u78c1\u76d8overlay\u3002 \u5728overlay\u4e0a\u9762\u505a\u8f6c\u6362\u3002 \u590d\u5236overlay\u5230\u76ee\u6807\u78c1\u76d8target\u3002 15.2 in place \u6a21\u5f0f \uff1a\u4e0d\u4f1a\u5728\u76ee\u6807Hypervisor\u521b\u5efa\u65b0\u7684\u865a\u62df\u673a\uff0c\u800c\u662f\u8c03\u6574\u539fVM\u7684\u64cd\u4f5c\u7cfb\u7edf\u4ee5\u5728\u8f93\u5165\u7684Hypervisor\u4e0a\u8fd0\u884c\u3002 virt-v2v -ic qemu:///system converted_vm --in-place virt-v2v \u9ed8\u8ba4\u4f7f\u7528 copying \u6a21\u5f0f\uff0c\u5728\u4ee5\u4e0b\u573a\u666f\u4e2d\u53ef\u80fd\u4f1a\u7528\u5230 in place \u6a21\u5f0f\uff1a \u200b \u4e00\u4e2a\u5916\u6765VM\u5df2\u7ecf\u88ab\u5bfc\u5165\u5230\u57fa\u4e8eKVM\u7684Hypervisor\u4e0a\uff0c\u4f46\u662f\u4ecd\u7136\u9700\u8981\u5728guest\u4e0a\u9762\u8c03\u6574\u4f7f\u5b83\u8fd0\u884c\u5728\u65b0\u7684\u865a\u62df\u786c\u4ef6\u4e0a\u3002 \u200b \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5047\u8bbe\u7b2c\u4e09\u65b9\u5de5\u5177\u57fa\u4e8e\u539fVM\u914d\u7f6e\u548c\u5185\u5bb9\u5728\u652f\u6301\u7684\u57fa\u4e8eKVM\u7684Hypervisor\u4e2d\u521b\u5efa\u4e86\u76ee\u6807VM\uff0c\u4f46\u662f\u9700\u8981\u4f7f\u7528\u66f4\u9002\u5408KVM\u7684\u865a\u62df\u8bbe\u5907\uff08\u6bd4\u5982virtio\u5b58\u50a8\u7f51\u7edc\u3001\u7f51\u7edc\u7b49\uff09\u3002 15.3 \u4e24\u79cd\u6a21\u5f0f\u7684\u533a\u522b \uff1a \u8f6c\u6362\u6a21\u5f0f copying in place \u662f\u5426\u5728\u6e90\u78c1\u76d8\u4e0a\u505a\u4fee\u6539 \u5426 \u662f \u662f\u5426\u521b\u5efaoverlays\u78c1\u76d8 \u662f \u5426 \u5728\u54ea\u4e2a\u78c1\u76d8\u4e0a\u505a\u8f6c\u6362 overlay\u78c1\u76d8 \u6e90\u78c1\u76d8","title":"15.\u4e24\u79cd\u8f6c\u6362\u6a21\u5f0f"}]}
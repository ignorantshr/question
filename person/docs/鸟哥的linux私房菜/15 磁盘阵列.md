RAID：Redundant Arrays of Inexpensive Disks，廉价磁盘的冗余阵列，可通过硬件或软件实现。

## 类型

[redhat 介绍](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/storage_administration_guide/ch-raid)。

### RAID-0

也被称为“条带化”（ striping ）。 这种模式的 RAID 会将磁盘先切出 等量的区块（名为 chunk， 一般可设置 4K~1 M 之间 ），然后当一个文件要写 入 RAID 时，该文件会依据 chunk 的大小切割好，之后再依序放到各个磁盘里面去，所以每个磁盘所存储的每个文件的数据量都是相同的（在每个磁盘容量足够的情况下）。 

以较低的固有成本实现了较高的 I/O 性能，但没有提供冗余。如果使用相同型号与容量的磁盘来组成时，效果较佳。不允许丢失磁盘。

### RAID-1

“镜像化”（mirroring）。将数据在每个磁盘上都完整的存储一份。

提供了很好的数据可靠性，并提高了读取密集型应用程序的性能，但写入性能差，成本较高。可以丢失到只剩一个磁盘。

### RAID-4

级别4使用集中在单个磁盘上的奇偶校验保护数据。由于专用的奇偶校验磁盘决定了对RAID阵列的所有写入事务的固有瓶颈，所以很少使用。

RAID 4阵列的性能始终是不对称的，这意味着读取将胜过写入。只允许丢失任意一个非奇偶校验磁盘。

### RAID-5

最常见的RAID类型。通过在阵列的所有成员磁盘上分配奇偶校验，RAID 5消除了4级固有的写瓶颈。唯一的性能瓶颈是奇偶校验计算过程本身，但对于现代CPU和软件RAID而言这根本算不上瓶颈。但如果磁盘数量太多，也会影响速度。

与级别4一样，级别5具有非对称性能，读取操作明显优于写入操作。RAID级别5的存储容量的计算方法与级别4相同。只允许丢失任意一个磁盘。

### RAID-6

当数据冗余和保护而非性能是最重要的考虑因素，但不能接受级别1低下的空间效率时，这是RAID的常见级别。级别6使用复杂的奇偶校验方案，能够从阵列中任何两个磁盘丢失中恢复。这种复杂的奇偶校验方案在软件RAID设备上显着增加了CPU负担，并且在写入事务期间也增加了负担。

RAID级别6阵列的总容量的计算方法类似于RAID级别5和4，不同之处在于，必须为额外的奇偶校验存储空间从设备数中减去2个设备（而不是1个）。只允许丢失任意两个磁盘。

### RAID-10，RAID-01

此RAID级别将级别0的性能优势与级别1的冗余相结合。

RAID-10 是指先将磁盘组成各自的RAID-1冗余阵列，再将每个冗余阵列作为一个磁盘组成RAID-0阵列，是最推荐的存储方式。RAID-01则刚好相反。

提高了空间利用率与读写性能。

### Spare Disk

磁盘阵列中的磁盘坏掉时，需要**手动**的更换新磁盘，然后阵列会主动的rebuild数据到新磁盘上。如果系统不支持热插拔，还需要关机才能更换磁盘。

Spare Disk（备用磁盘）的作用就是一个或多个没有在阵列中的磁盘，在阵列中的磁盘有损坏时，自动地将损坏磁盘更换为备用磁盘，将损坏的磁盘移除阵列，立即rebuild数据系统。若OS支持热插拔，那么将损坏的拔出，更换一块新的磁盘，再将它设置为备用磁盘，简直完美！

### 各等级RAID对比

![磁盘阵列对比](img/磁盘阵列对比.png)

## 软件磁盘阵列与硬件磁盘阵列

硬件组成磁盘阵列需要磁盘阵列卡实现。优点：卡上面有专门的芯片处理RAID任务，所以很多任务（奇偶校验的运算）不会消耗OS的I/O总线。高级的阵列卡还支持热插拔。缺点：很贵；低阶主板的阵列芯片不支持高阶功能；OS必须有阵列卡的驱动，才能识别所产生的磁盘。

软件磁盘阵列通过软件来仿真阵列，centos使用的是`mdadm`，支持partition或disk为磁盘单位，支持热插拔。

!!! note
	硬件磁盘阵列在linux的设备名是`/dev/sd?`；软件仿真的则是`/dev/md?`。Intel 的南桥芯片磁盘阵列，在 Linux 下面反而会是 /dev/md126, /dev/md127 等等设备文件名。

### Firmware RAID

固件 RAID 也称为 ATARAID，是一种软件 RAID，可以使用基于固件的菜单配置 RAID 集。这种类型的 RAID 使用的固件也挂钩到 BIOS 中，允许您从其 RAID 集启动。不同的供应商使用不同的磁盘元数据格式来标记 RAID 集成员。
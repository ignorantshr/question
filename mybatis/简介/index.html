<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="shihr">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>简介.md - Sink</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\u5b89\u88c5", url: "#_top", children: [
          ]},
          {title: "\u4ece XML \u4e2d\u6784\u5efa SqlSessionFactory", url: "#xml-sqlsessionfactory", children: [
          ]},
          {title: "\u4ece SqlSessionFactory \u4e2d\u83b7\u53d6 SqlSession", url: "#sqlsessionfactory-sqlsession", children: [
          ]},
          {title: "\u4f5c\u7528\u57df\uff08Scope\uff09\u548c\u751f\u547d\u5468\u671f", url: "#scope", children: [
              {title: "SqlSessionFactoryBuilder", url: "#sqlsessionfactorybuilder" },
              {title: "SqlSessionFactory", url: "#sqlsessionfactory" },
              {title: "SqlSession", url: "#sqlsession" },
              {title: "\u6620\u5c04\u5668\u5b9e\u4f8b", url: "#_2" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../XML配置/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../XML配置/" class="btn btn-xs btn-link">
        XML配置.md
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../设计模式/模式/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../设计模式/模式/" class="btn btn-xs btn-link">
        模式
      </a>
    </div>
    
  </div>

    

    <p><a href="http://www.mybatis.org/mybatis-3/zh/index.html">mybatis参考文档</a></p>
<h3 id="_1">安装</h3>
<p>pom.xml</p>
<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
  &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
  &lt;version&gt;x.x.x&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h3 id="xml-sqlsessionfactory">从 XML 中构建 SqlSessionFactory</h3>
<h3 id="sqlsessionfactory-sqlsession">从 SqlSessionFactory 中获取 SqlSession</h3>
<p><strong>命名解析：</strong>为了减少输入量，MyBatis 对所有的命名配置元素（包括语句，结果映射，缓存等）使用了如下的命名解析规则。</p>
<ul>
<li>完全限定名（比如 “com.mypackage.MyMapper.selectAllThings）将被直接用于查找及使用。</li>
<li>短名称（比如 “selectAllThings”）如果全局唯一也可以作为一个单独的引用。 如果不唯一，有两个或两个以上的相同名称（比如 “com.foo.selectAllThings” 和 “com.bar.selectAllThings”），那么使用时就会产生“短名称不唯一”的错误，这种情况下就必须使用完全限定名。</li>
</ul>
<h3 id="scope">作用域（Scope）和生命周期</h3>
<p><strong>对象生命周期和依赖注入框架</strong></p>
<p>依赖注入框架可以创建线程安全的、基于事务的 SqlSession 和映射器，并将它们直接注入到你的 bean 中，因此可以直接忽略它们的生命周期。</p>
<h4 id="sqlsessionfactorybuilder">SqlSessionFactoryBuilder</h4>
<p>这个类可以被实例化、使用和丢弃，一旦创建了 SqlSessionFactory，就不再需要它了。SqlSessionFactoryBuilder 实例的最佳作用域是方法作用域（也就是局部方法变量）</p>
<h4 id="sqlsessionfactory">SqlSessionFactory</h4>
<p>SqlSessionFactory 一旦被创建就应该在应用的运行期间一直存在，没有任何理由丢弃它或重新创建另一个实例。因此 SqlSessionFactory 的最佳作用域是应用作用域。</p>
<h4 id="sqlsession">SqlSession</h4>
<p>每个线程都应该有它自己的 SqlSession 实例。SqlSession 的实例不是线程安全的，因此是不能被共享的，所以它的最佳的作用域是请求或方法作用域。</p>
<p>绝对不能将 SqlSession 实例的引用放在一个类的静态域，甚至一个类的实例变量也不行。 也绝不能将 SqlSession 实例的引用放在任何类型的托管作用域中。</p>
<p>每次收到的 HTTP 请求，就可以打开一个 SqlSession，返回一个响应，就关闭它。</p>
<h4 id="_2">映射器实例</h4>
<p>映射器是一些由你创建的、绑定你映射的语句的接口。映射器接口的实例是从 SqlSession 中获得的。映射器实例的最佳作用域是方法作用域。</p>
<pre><code class="java">SqlSession session = sqlSessionFactory.openSession();
try {
  BlogMapper mapper = session.getMapper(BlogMapper.class);
  // 你的应用逻辑代码
} finally {
  session.close();
}
</code></pre>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../XML配置/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../XML配置/" class="btn btn-xs btn-link">
        XML配置.md
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../设计模式/模式/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../设计模式/模式/" class="btn btn-xs btn-link">
        模式
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>
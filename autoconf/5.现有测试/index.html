<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="shihr">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>5.现有测试 - Sink</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "5.2 \u5907\u9009\u7a0b\u5e8f", url: "#_top", children: [
              {title: "5.2.1 \u7279\u6b8a\u7a0b\u5e8f\u68c0\u67e5", url: "#521" },
              {title: "5.2.2 \u901a\u7528\u7a0b\u5e8f\u548c\u6587\u4ef6\u68c0\u67e5", url: "#522" },
          ]},
          {title: "5.4 \u5e93\u6587\u4ef6", url: "#54", children: [
              {title: "AC_CHECK_LIB (library, function, [action-if-found], [action-if-not-found], [other-libraries])", url: "#ac_check_lib-library-function-action-if-found-action-if-not-found-other-libraries" },
          ]},
          {title: "5.10 \u7f16\u8bd1\u5668\u548c\u6267\u884c\u5668", url: "#510", children: [
              {title: "5.10.3 C\u7f16\u8bd1\u5668\u7279\u6027", url: "#5103-c" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../6.编写测试/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../6.编写测试/" class="btn btn-xs btn-link">
        6.编写测试
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../4.初始化和输出文件/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../4.初始化和输出文件/" class="btn btn-xs btn-link">
        4.初始化和输出文件
      </a>
    </div>
    
  </div>

    

    <h2 id="52">5.2 备选程序</h2>
<p>这些宏用于检查指定程序的存在或者行为。经常从几个备选程序中选择一个出来。</p>
<h3 id="521">5.2.1 特殊程序检查</h3>
<h4 id="ac_prog_ln_s">AC_PROG_LN_S</h4>
<p>如果当前文件系统支持<code>ln -s</code>，设置输出变量<em>LN_S</em>为<code>ln -s</code>；否则，如果支持<code>ln</code>，设置<em>LN_S</em>为<code>ln</code>，否则设置为<code>cp -pR</code>。</p>
<pre><code>AC_PROG_LN_S
</code></pre>

<h3 id="522">5.2.2 通用程序和文件检查</h3>
<p>这些宏不会被特定的测试宏所覆盖。
强烈建议声明<em>variable</em>为<em>precious variable</em>。<a href="../7.测试结果/#ac_arg_var">See AC_ARG_VAR</a></p>
<h4 id="ac_check_prog-variable-prog-to-check-for-value-if-found-value-if-not-found-path-path-reject">AC_CHECK_PROG <em>(variable, prog-to-check-for, value-if-found, [value-if-not-found], [path = ‘$PATH’], [reject])</em></h4>
<p>检查<em>path</em>中是否存才<em>prog-to-check-for</em>。<em>variable</em>=存在 ? <em>value-if-found</em>: <em>value-if-not-found</em>。总是忽视<em>reject</em>（一个文件名的绝对路径），在这种情况下，<em>variable</em>=<em>prog-to-check-for</em>的绝对路径。</p>
<p>调用<code>AC_SUBST</code>赋值。</p>
<p>测试结果可以通过设置<em>variable</em>或者<em>ac_cv_prog_variable</em>的值来覆盖。</p>
<h4 id="ac_check_progs-variable-progs-to-check-for-value-if-not-found-path-path">AC_CHECK_PROGS <em>(variable, progs-to-check-for, [value-if-not-found], [path = ‘$PATH’])</em></h4>
<p>检查每个在<em>progs-to-check-for</em>中的程序（以空格分隔）在<em>path</em>中是否存在。如果发现了一个，设置<em>variable</em>的值为该程序的名字；否则继续查找下一个。如果都没有找到，设值为<em>value-if-not-found</em>；如果该参数没有指定，变量的值不会改变。</p>
<p>余下的说明同上。</p>
<pre><code>AC_CHECK_PROGS(FLEX,flex,none)
</code></pre>

<h4 id="ac_check_tool-variable-prog-to-check-for-value-if-not-found-path-path">AC_CHECK_TOOL <em>(variable, prog-to-check-for, [value-if-not-found], [path = ‘$PATH’])</em></h4>
<p>类似于<code>AC_CHECK_PROG</code>，但是首先查找选项<code>--host</code>指定前缀的程序，使用<code>-</code>连接。</p>
<pre><code>AC_CHECK_TOOL([RANLIB], [ranlib], [:])
</code></pre>

<p>运行‘configure --build=x86_64-gnu --host=i386-gnu’：首先查找i386-gnu-ranlib，没有再查找ranlib，否则就是:。</p>
<h4 id="ac_check_tools-variable-progs-to-check-for-value-if-not-found-path-path">AC_CHECK_TOOLS <em>(variable, progs-to-check-for, [value-if-not-found], [path = ‘$PATH’])</em></h4>
<p>先查找<code>AC_CANONICAL_HOST</code>指定前缀的程序，使用<code>-</code>连接。如果没有一个被找到，那么去掉前缀继续查找<em>tools</em>。余下的说明参考<code>AC_CHECK_PROGS</code>。</p>
<pre><code>AC_CHECK_TOOLS(AR,[ar gar],ar)
</code></pre>

<h4 id="ac_path_prog-variable-prog-to-check-for-value-if-not-found-path-path">AC_PATH_PROG <em>(variable, prog-to-check-for, [value-if-not-found], [path = ‘$PATH’])</em></h4>
<p>检查命令是否安装。类似于<code>AC_CHECK_PROG</code>，检查<em>path</em>中是否存在<em>prog-to-check-for</em>。区别在于总是设置<em>variable</em>=<em>prog-to-check-for</em>的绝对路径。</p>
<p>该测试结果可以通过对<em>variable</em>赋值的方式改变。</p>
<p>测试结果被缓存在<em>ac_cv_path_variable</em>变量中。</p>
<pre><code>AC_PATH_PROG(LDCONFIG, ldconfig, true, [/sbin /usr/sbin $PATH])
</code></pre>

<h4 id="ac_path_progs-variable-progs-to-check-for-value-if-not-found-path-path">AC_PATH_PROGS <em>(variable, progs-to-check-for, [value-if-not-found], [path = ‘$PATH’])</em></h4>
<p>说明参考<code>AC_PATH_PROG</code>。有任何一个程序被找到，赋值给<em>variable</em>。</p>
<h2 id="54">5.4 库文件</h2>
<h4 id="ac_check_lib-library-function-action-if-found-action-if-not-found-other-libraries">AC_CHECK_LIB <em>(library, function, [action-if-found], [action-if-not-found], [other-libraries])</em></h4>
<p>通过尝试链接一个调用含有<em>library</em>的<em>function</em>的测试程序，测试<em>library</em>是否可用。如果没有指定<em>action-if-found</em>，默认的操作是链接-l<em>library</em>到<em>LIBS</em>并且定义'HAVE_LIB<em>library</em>'（全部大写）。</p>
<h2 id="510">5.10 编译器和执行器</h2>
<h3 id="5103-c">5.10.3 C编译器特性</h3>
<h4 id="ac_prog_cc-compiler-search-list">AC_PROG_CC <em>([compiler-search-list])</em></h4>
<p>指定一个C编译器，如果<code>CC</code>没有在环境中设置，那么检查<code>gcc and cc</code>，然后是其它的C编译器。设置找到的编译器给变量<code>CC</code>。</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../6.编写测试/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../6.编写测试/" class="btn btn-xs btn-link">
        6.编写测试
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../4.初始化和输出文件/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../4.初始化和输出文件/" class="btn btn-xs btn-link">
        4.初始化和输出文件
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>